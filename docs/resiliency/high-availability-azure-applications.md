---
title: "Haute disponibilité des applications Azure"
description: "Présentation technique et informations détaillées sur la conception et le développement d’applications pour la haute disponibilité sur Microsoft Azure."
author: adamglick
ms.date: 05/31/2017
ms.openlocfilehash: 46b7b802326a8de03546528aaeb1a1c6419d41db
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/14/2017
---
[!INCLUDE [header](../_includes/header.md)]
# <a name="high-availability-for-applications-built-on-microsoft-azure"></a><span data-ttu-id="b9547-103">Haute disponibilité pour les applications développées sur Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="b9547-103">High availability for applications built on Microsoft Azure</span></span>
<span data-ttu-id="b9547-104">Une application hautement disponible absorbe les variations de disponibilité, de charge et les défaillances temporaires de services dépendants et de matériel.</span><span class="sxs-lookup"><span data-stu-id="b9547-104">A highly available application absorbs fluctuations in availability, load, and temporary failures in dependent services and hardware.</span></span> <span data-ttu-id="b9547-105">L’application continue à fonctionner de manière acceptable, tel que défini par les besoins de votre entreprise ou les contrats de niveau de service de l’application.</span><span class="sxs-lookup"><span data-stu-id="b9547-105">The application continues to perform acceptably, as defined by business requirements or application service-level agreements (SLAs).</span></span>

## <a name="azure-high-availability-features"></a><span data-ttu-id="b9547-106">Fonctionnalités de haute disponibilité Azure</span><span class="sxs-lookup"><span data-stu-id="b9547-106">Azure high-availability features</span></span>
<span data-ttu-id="b9547-107">Azure dispose de nombreuses fonctionnalités intégrées de plateforme qui prennent en charge des applications hautement disponibles.</span><span class="sxs-lookup"><span data-stu-id="b9547-107">Azure has many built-in platform features that support highly available applications.</span></span> <span data-ttu-id="b9547-108">Cette section décrit certaines de ces fonctionnalités clés.</span><span class="sxs-lookup"><span data-stu-id="b9547-108">This section describes some of those key features.</span></span>

### <a name="fabric-controller"></a><span data-ttu-id="b9547-109">Contrôleur de structure</span><span class="sxs-lookup"><span data-stu-id="b9547-109">Fabric controller</span></span>
<span data-ttu-id="b9547-110">Le contrôleur de structure Azure provisionne et surveille l’état des instances de calcul Azure.</span><span class="sxs-lookup"><span data-stu-id="b9547-110">The Azure fabric controller provisions and monitors the condition of Azure compute instances.</span></span> <span data-ttu-id="b9547-111">Le contrôleur de structure surveille l’état du matériel et des logiciels des instances hôtes et de la machine invitée.</span><span class="sxs-lookup"><span data-stu-id="b9547-111">The fabric controller monitors the status of the hardware and software of the host and guest machine instances.</span></span> <span data-ttu-id="b9547-112">Quand il détecte une défaillance, il maintient les contrats de niveau de service en déplaçant automatiquement les instances de machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="b9547-112">When it detects a failure, it maintains SLAs by automatically relocating the VM instances.</span></span> <span data-ttu-id="b9547-113">Le concept de domaines d’erreur et de mise à niveau englobe en outre les contrats de niveau de service de calcul.</span><span class="sxs-lookup"><span data-stu-id="b9547-113">The concept of fault and upgrade domains further supports the compute SLA.</span></span>

<span data-ttu-id="b9547-114">Quand plusieurs instances de rôle de service cloud sont déployées, Azure les répartit sur différents domaines d’erreur.</span><span class="sxs-lookup"><span data-stu-id="b9547-114">When multiple Cloud Service role instances are deployed, Azure deploys these instances to different fault domains.</span></span> <span data-ttu-id="b9547-115">En fait, une limite de domaine d’erreur est un autre rack matériel de la région.</span><span class="sxs-lookup"><span data-stu-id="b9547-115">A fault domain boundary is essentially a different hardware rack in the same region.</span></span> <span data-ttu-id="b9547-116">Les domaines d’erreur réduisent la probabilité qu’une défaillance matérielle localisée interrompe le service d’une application.</span><span class="sxs-lookup"><span data-stu-id="b9547-116">Fault domains reduce the probability that a localized hardware failure interrupts the service of an application.</span></span> <span data-ttu-id="b9547-117">Vous ne pouvez pas gérer le nombre de domaines d’erreur de vos rôles web ou rôles de travail.</span><span class="sxs-lookup"><span data-stu-id="b9547-117">You cannot manage the number of fault domains of your worker roles or web roles.</span></span> <span data-ttu-id="b9547-118">Le contrôleur de structure sollicite des ressources dédiées qui sont séparées des applications Azure hébergées.</span><span class="sxs-lookup"><span data-stu-id="b9547-118">The fabric controller uses dedicated resources that are separate from Azure-hosted applications.</span></span> <span data-ttu-id="b9547-119">Il requiert un temps d’activité de 100 %, dans la mesure où il constitue le noyau du système Azure.</span><span class="sxs-lookup"><span data-stu-id="b9547-119">It requires 100 percent uptime because it serves as the nucleus of the Azure system.</span></span> <span data-ttu-id="b9547-120">Il surveille et gère les instances de rôle au sein des domaines d’erreur.</span><span class="sxs-lookup"><span data-stu-id="b9547-120">It monitors and manages role instances across fault domains.</span></span>

<span data-ttu-id="b9547-121">Le diagramme suivant représente les ressources Azure partagées qui sont déployées et gérées par le contrôleur de structure au sein des différents domaines d’erreur.</span><span class="sxs-lookup"><span data-stu-id="b9547-121">The following diagram shows Azure shared resources that the fabric controller deploys and manages across different fault domains.</span></span>

![Vue simplifiée de l’isolement de domaines d’erreur](./images/high-availability-azure-applications/fault-domain-isolation.png)

<span data-ttu-id="b9547-123">Tandis que les domaines d’erreur sont des séparations physiques visant à atténuer une défaillance, les domaines de mise à niveau sont des unités logiques de séparation d’instance qui déterminent les instances d’un service qui doivent être mises à niveau à un moment précis.</span><span class="sxs-lookup"><span data-stu-id="b9547-123">While fault domains are physical separations to mitigate failure, upgrade domains are logical units of instance separation that determine which instances of a service will be upgraded at a specific time.</span></span> <span data-ttu-id="b9547-124">Par défaut, cinq domaines de mise à niveau sont définis pour votre déploiement de service hébergé.</span><span class="sxs-lookup"><span data-stu-id="b9547-124">By default, five upgrade domains are defined for your hosted service deployment.</span></span> <span data-ttu-id="b9547-125">Toutefois, vous pouvez modifier cette valeur dans le fichier de définition de service.</span><span class="sxs-lookup"><span data-stu-id="b9547-125">However, you can change that value in the service definition file.</span></span> <span data-ttu-id="b9547-126">Par exemple, si vous avez huit instances de rôle web, il y a deux instances dans trois domaines de mise à niveau et deux instances dans un domaine de mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="b9547-126">For example, if you have eight instances of your web role, there are two instances in three upgrade domains and two instances in one upgrade domain.</span></span> <span data-ttu-id="b9547-127">Azure définit la séquence de mise à jour en fonction du nombre de domaines de mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="b9547-127">Azure defines the update sequence based on the number of upgrade domains.</span></span> <span data-ttu-id="b9547-128">Pour plus d’informations, consultez [Mettre à jour un service cloud](/azure/cloud-services/cloud-services-update-azure-service/).</span><span class="sxs-lookup"><span data-stu-id="b9547-128">For more information, see [Update a cloud service](/azure/cloud-services/cloud-services-update-azure-service/).</span></span>

### <a name="features-in-other-services"></a><span data-ttu-id="b9547-129">Fonctionnalités dans d’autres services</span><span class="sxs-lookup"><span data-stu-id="b9547-129">Features in other services</span></span>
<span data-ttu-id="b9547-130">En plus des fonctionnalités de plateforme qui prennent en charge une haute disponibilité des ressources de calcul, Azure intègre des fonctionnalités de haute disponibilité à ses autres services.</span><span class="sxs-lookup"><span data-stu-id="b9547-130">In addition to the platform features that support high availability of compute resources, Azure embeds high-availability features in its other services.</span></span> <span data-ttu-id="b9547-131">Par exemple, Stockage Azure conserve au moins trois réplicas de toutes les données dans votre compte de stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="b9547-131">For example, Azure Storage maintains at least three replicas of all data in your Azure storage account.</span></span> <span data-ttu-id="b9547-132">Il permet également la géoréplication pour stocker des copies de vos données dans une région secondaire.</span><span class="sxs-lookup"><span data-stu-id="b9547-132">It also enables geo-replication to store copies of your data in a secondary region.</span></span> <span data-ttu-id="b9547-133">Le réseau de distribution de contenu Azure permet la mise en cache d’objets blob dans le monde entier, à des fins de redondance, de scalabilité et de plus faible latence.</span><span class="sxs-lookup"><span data-stu-id="b9547-133">The Azure Content Delivery Network allows blobs to be cached around the world for redundancy, scalability, and lower latency.</span></span> <span data-ttu-id="b9547-134">Azure SQL Database gère également plusieurs réplicas.</span><span class="sxs-lookup"><span data-stu-id="b9547-134">Azure SQL Database maintains multiple replicas as well.</span></span>

<span data-ttu-id="b9547-135">Pour plus d’informations sur les fonctionnalités de disponibilité de plateforme Azure, consultez [Guide technique sur la résilience](index.md).</span><span class="sxs-lookup"><span data-stu-id="b9547-135">For a deeper discussion of Azure platform availability features, see [Resiliency technical guidance](index.md).</span></span> <span data-ttu-id="b9547-136">Consultez également [Best practices for designing large-scale services on Windows Azure](https://azure.microsoft.com/blog/best-practices-for-designing-large-scale-services-on-windows-azure/) (Bonnes pratiques de conception de services à grande échelle sur Microsoft Azure).</span><span class="sxs-lookup"><span data-stu-id="b9547-136">Also see [Best practices for designing large-scale services on Windows Azure](https://azure.microsoft.com/blog/best-practices-for-designing-large-scale-services-on-windows-azure/).</span></span>

<span data-ttu-id="b9547-137">Bien qu’Azure offre de nombreuses fonctionnalités qui prennent en charge la haute disponibilité, il est important de comprendre leurs limitations :</span><span class="sxs-lookup"><span data-stu-id="b9547-137">Although Azure provides multiple features that support high availability, it's important to understand their limitations:</span></span>

* <span data-ttu-id="b9547-138">Pour le calcul, Azure garantit que vos rôles sont disponibles et opérationnels, mais il ne peut pas détecter si votre application est exécutée ou surchargée.</span><span class="sxs-lookup"><span data-stu-id="b9547-138">For compute, Azure guarantees that your roles are available and running, but it cannot detect whether your application is running or overloaded.</span></span>
* <span data-ttu-id="b9547-139">Pour Azure SQL Database, les données sont répliquées de manière synchrone au sein de la région.</span><span class="sxs-lookup"><span data-stu-id="b9547-139">For Azure SQL Database, data is replicated synchronously within the region.</span></span> <span data-ttu-id="b9547-140">Vous pouvez choisir la géoréplication active, qui autorise jusqu’à quatre copies supplémentaires de base de données dans la même région (ou différentes régions).</span><span class="sxs-lookup"><span data-stu-id="b9547-140">You can choose active geo-replication, which allows up to four additional database copies in the same region (or different regions).</span></span> <span data-ttu-id="b9547-141">Bien que ces réplicas de base de données ne soient pas des sauvegardes à un point dans le temps, SQL Database fournit des fonctionnalités de sauvegarde à un point dans le temps.</span><span class="sxs-lookup"><span data-stu-id="b9547-141">While these database replicas are not point-in-time backups, SQL Database does provide point-in-time backup capabilities.</span></span> <span data-ttu-id="b9547-142">Pour plus d’informations, consultez [Récupérer une base de données Azure SQL à l’aide de sauvegardes de données automatisées : restauration à un point dans le temps](/azure/sql-database/sql-database-recovery-using-backups#point-in-time-restore).</span><span class="sxs-lookup"><span data-stu-id="b9547-142">For more information, see [Recover an Azure SQL Database using automated data backups: Point-in-time restore](/azure/sql-database/sql-database-recovery-using-backups#point-in-time-restore).</span></span>
* <span data-ttu-id="b9547-143">Pour Stockage Azure, les données de tables et les données des objets blob sont répliquées par défaut dans une autre région.</span><span class="sxs-lookup"><span data-stu-id="b9547-143">For Azure Storage, table data and blob data are replicated by default to an alternate region.</span></span> <span data-ttu-id="b9547-144">Toutefois, vous ne pouvez pas accéder aux réplicas avant que Microsoft ne décide de basculer sur l’autre site.</span><span class="sxs-lookup"><span data-stu-id="b9547-144">However, you cannot access the replicas until Microsoft chooses to fail over to the alternate site.</span></span> <span data-ttu-id="b9547-145">Un basculement de région se produit uniquement pendant l’interruption de service prolongée à l’échelle de la région, et il n’existe aucun contrat de niveau de service dédié au temps de basculement géographique.</span><span class="sxs-lookup"><span data-stu-id="b9547-145">A region failover occurs only during a prolonged region-wide service disruption, and there is no SLA for geo-failover time.</span></span> <span data-ttu-id="b9547-146">Il est également important de noter que les altérations de données se propagent rapidement entre les réplicas.</span><span class="sxs-lookup"><span data-stu-id="b9547-146">It's also important to note that any data corruption quickly spreads to the replicas.</span></span> <span data-ttu-id="b9547-147">Pour ces raisons, vous devez compléter les fonctionnalités de disponibilité de plateforme avec des fonctionnalités de disponibilité spécifiques à l’application, notamment la fonctionnalité de capture instantanée d’objet blob pour créer des sauvegardes de données blob à un point dans le temps.</span><span class="sxs-lookup"><span data-stu-id="b9547-147">For these reasons, you must supplement platform availability features with application-specific availability features, including the blob snapshot feature to create point-in-time backups of blob data.</span></span>

### <a name="availability-sets-for-azure-virtual-machines"></a><span data-ttu-id="b9547-148">Groupes à haute disponibilité pour Machines virtuelles Azure</span><span class="sxs-lookup"><span data-stu-id="b9547-148">Availability sets for Azure Virtual Machines</span></span>
<span data-ttu-id="b9547-149">Ce document est principalement axé sur les services cloud qui utilisent un modèle Platform as a Service (PaaS).</span><span class="sxs-lookup"><span data-stu-id="b9547-149">This document primarily focuses on cloud services, which use a platform-as-a-service (PaaS) model.</span></span> <span data-ttu-id="b9547-150">Il existe également des fonctions de disponibilité spécifiques pour Machines virtuelles Azure qui utilisent un modèle Infrastructure as a Service (IaaS).</span><span class="sxs-lookup"><span data-stu-id="b9547-150">There are also specific availability features for Azure Virtual Machines, which use an infrastructure-as-a-service (IaaS) model.</span></span> <span data-ttu-id="b9547-151">Pour atteindre une haute disponibilité avec Machines virtuelles, vous devez utiliser des groupes à haute disponibilité, qui remplissent une fonction similaire pour les domaines d’erreur et de mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="b9547-151">To achieve high availability with Virtual Machines, you must use availability sets, which serve a similar function to fault and upgrade domains.</span></span> <span data-ttu-id="b9547-152">Au sein d’un groupe à haute disponibilité, Azure positionne les machines virtuelles de manière à ce que les défaillances matérielles localisées et les activités de maintenance ne provoquent pas la panne de toutes les machines de ce groupe.</span><span class="sxs-lookup"><span data-stu-id="b9547-152">Within an availability set, Azure positions the virtual machines in a way that prevents localized hardware faults and maintenance activities from bringing down all the machines in that group.</span></span> <span data-ttu-id="b9547-153">Des groupes à haute disponibilité sont requis pour respecter les contrats de niveau de service dédiés à la disponibilité de Machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="b9547-153">Availability sets are required to achieve the Azure SLA for the availability of Virtual Machines.</span></span>

<span data-ttu-id="b9547-154">Le diagramme suivant montre deux groupes à haute disponibilité pour les machines virtuelles web et SQL Server, respectivement.</span><span class="sxs-lookup"><span data-stu-id="b9547-154">The following diagram shows two availability sets for web and SQL Server virtual machines, respectively.</span></span>

![Groupes à haute disponibilité pour Machines virtuelles Azure](./images/high-availability-azure-applications/availability-set-for-azure-virtual-machines.png)

> [!NOTE]
> <span data-ttu-id="b9547-156">Dans le diagramme précédent, SQL Server est installé et exécuté sur des machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="b9547-156">In the preceding diagram, SQL Server is installed and running on virtual machines.</span></span> <span data-ttu-id="b9547-157">Cette configuration est différente d’Azure SQL Database, dans laquelle la base de données est fournie en tant que service géré.</span><span class="sxs-lookup"><span data-stu-id="b9547-157">This is different from Azure SQL Database, which provides a database as a managed service.</span></span>
> 
> 

## <a name="application-strategies-for-high-availability"></a><span data-ttu-id="b9547-158">Stratégies d’application pour la haute disponibilité</span><span class="sxs-lookup"><span data-stu-id="b9547-158">Application strategies for high availability</span></span>
<span data-ttu-id="b9547-159">La plupart des stratégies d’application dédiées à la haute disponibilité impliquent la redondance ou la suppression de dépendances rigides entre les composants applicatifs.</span><span class="sxs-lookup"><span data-stu-id="b9547-159">Most application strategies for high availability involve either redundancy or the removal of hard dependencies between application components.</span></span> <span data-ttu-id="b9547-160">La conception des applications doit prendre en charge la tolérance de panne durant les temps d’arrêt sporadiques des services Azure ou tiers.</span><span class="sxs-lookup"><span data-stu-id="b9547-160">Application design should support fault tolerance during sporadic downtime of Azure or third-party services.</span></span> <span data-ttu-id="b9547-161">Les sections suivantes décrivent des modèles d’application dédiés à l’amélioration de la disponibilité de vos services cloud.</span><span class="sxs-lookup"><span data-stu-id="b9547-161">The following sections describe application patterns for improving the availability of your cloud services.</span></span>

### <a name="asynchronous-communication-and-durable-queues"></a><span data-ttu-id="b9547-162">Communication asynchrone et files d’attente durables</span><span class="sxs-lookup"><span data-stu-id="b9547-162">Asynchronous communication and durable queues</span></span>
<span data-ttu-id="b9547-163">Pour augmenter la disponibilité dans les applications Azure, pensez à la communication asynchrone intervenant entre des services faiblement couplés.</span><span class="sxs-lookup"><span data-stu-id="b9547-163">To increase availability in Azure applications, consider asynchronous communication between loosely coupled services.</span></span> <span data-ttu-id="b9547-164">Dans ce modèle, des messages sont écrits dans des files d’attente de stockage ou des files d’attente Azure Service Bus, pour traitement ultérieur.</span><span class="sxs-lookup"><span data-stu-id="b9547-164">In this pattern, messages are written to either storage queues or Azure Service Bus queues for later processing.</span></span> <span data-ttu-id="b9547-165">Quand un message est écrit dans la file d’attente, le contrôle revient immédiatement à l’expéditeur.</span><span class="sxs-lookup"><span data-stu-id="b9547-165">When a message is written to the queue, control immediately returns to the sender.</span></span> <span data-ttu-id="b9547-166">Un autre service de l’application, généralement implémenté en tant que rôle de travail, traite le message.</span><span class="sxs-lookup"><span data-stu-id="b9547-166">Another service of the application (typically implemented as a worker role) processes the message.</span></span> <span data-ttu-id="b9547-167">Si le service de traitement arrête de fonctionner, les messages s’accumulent dans la file d’attente, jusqu’à restauration du service de traitement.</span><span class="sxs-lookup"><span data-stu-id="b9547-167">If the processing service stops working, the messages accumulate in the queue until the processing service is restored.</span></span> <span data-ttu-id="b9547-168">Il n’existe aucune dépendance directe entre l’expéditeur frontend et le processeur de message.</span><span class="sxs-lookup"><span data-stu-id="b9547-168">There is no direct dependency between the front-end sender and the message processor.</span></span> <span data-ttu-id="b9547-169">Cela élimine les appels de service synchrones qui peuvent provoquer des goulots d’étranglement dans les applications distribuées.</span><span class="sxs-lookup"><span data-stu-id="b9547-169">This eliminates synchronous service calls that can cause bottlenecks in distributed applications.</span></span>

<span data-ttu-id="b9547-170">Une variante de ce modèle stocke les informations relatives aux appels échoués de la base de données dans Stockage Azure (objets blob, tables ou files d’attente) ou les files d’attente Service Bus.</span><span class="sxs-lookup"><span data-stu-id="b9547-170">A variation of this pattern stores information about failed database calls in Azure Storage (blobs, tables, or queues) or Service Bus queues.</span></span> <span data-ttu-id="b9547-171">Par exemple, un appel synchrone au sein d’une application vers un autre service (comme Azure SQL Database) échoue de façon répétée.</span><span class="sxs-lookup"><span data-stu-id="b9547-171">For example, a synchronous call within an application to another service (such as Azure SQL Database) fails repeatedly.</span></span> <span data-ttu-id="b9547-172">Vous pouvez être en mesure de sérialiser cette demande en instances de stockage durable.</span><span class="sxs-lookup"><span data-stu-id="b9547-172">You might be able to serialize that request into durable storage.</span></span> <span data-ttu-id="b9547-173">Ultérieurement, durant la remise en ligne du service ou de la base de données, l’application peut de nouveau envoyer la demande à partir du stockage.</span><span class="sxs-lookup"><span data-stu-id="b9547-173">At some later point when the service or database is back online, the application can resubmit the request from storage.</span></span> <span data-ttu-id="b9547-174">Cependant, dans ce modèle, l’emplacement intermédiaire est uniquement utilisé pendant les défaillances, pas en tant que composante régulière du workflow applicatif.</span><span class="sxs-lookup"><span data-stu-id="b9547-174">The difference in this model is that the intermediate location is used only during failures, not as a regular part of the application workflow.</span></span>

<span data-ttu-id="b9547-175">Dans les deux scénarios, une communication asynchrone et un stockage intermédiaire empêchent que la panne d’un service principal n’arrête l’intégralité de l’application.</span><span class="sxs-lookup"><span data-stu-id="b9547-175">In both scenarios, asynchronous communication and intermediate storage prevent a downed back-end service from bringing down the entire application.</span></span> <span data-ttu-id="b9547-176">Les files d’attente font office d’intermédiaires logiques.</span><span class="sxs-lookup"><span data-stu-id="b9547-176">Queues serve as a logical intermediary.</span></span> <span data-ttu-id="b9547-177">Pour plus d’informations sur la sélection d’un service de file d’attente, consultez [Files d’attente Azure et files d’attente Service Bus &mdash; comparaison et différences](/azure/service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted/).</span><span class="sxs-lookup"><span data-stu-id="b9547-177">For more information on choosing between queuing services, see [Azure queues and Azure Service Bus queues &mdash; compared and contrasted](/azure/service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted/).</span></span>

### <a name="fault-detection-and-retry-logic"></a><span data-ttu-id="b9547-178">Logique de détection des erreurs et de nouvelle tentative</span><span class="sxs-lookup"><span data-stu-id="b9547-178">Fault detection and retry logic</span></span>
<span data-ttu-id="b9547-179">L’un des aspects clés de la conception d’applications hautement disponibles est la capacité à utiliser une logique de nouvelle tentative au sein du code pour faciliter le traitement d’un service temporairement indisponible.</span><span class="sxs-lookup"><span data-stu-id="b9547-179">A key aspect of the design of highly available applications is the use of retry logic within code to gracefully handle a service that is temporarily unavailable.</span></span> <span data-ttu-id="b9547-180">Les versions récentes des SDK pour Stockage Azure et Azure Service Bus prennent en charge les nouvelles tentatives en mode natif.</span><span class="sxs-lookup"><span data-stu-id="b9547-180">Recent versions of SDKs for both Azure Storage and Azure Service Bus natively support retries.</span></span> <span data-ttu-id="b9547-181">Pour plus d’informations sur la fourniture d’une logique de nouvelle tentative personnalisée pour votre application, consultez [Modèle de nouvelle tentative](../patterns/retry.md).</span><span class="sxs-lookup"><span data-stu-id="b9547-181">For more information on providing custom retry logic for your application, see the [Retry pattern](../patterns/retry.md).</span></span>

### <a name="reference-data-pattern-for-high-availability"></a><span data-ttu-id="b9547-182">Modèle de données de référence pour la haute disponibilité</span><span class="sxs-lookup"><span data-stu-id="b9547-182">Reference data pattern for high availability</span></span>
<span data-ttu-id="b9547-183">Les données de référence sont les données en lecture seule d’une application.</span><span class="sxs-lookup"><span data-stu-id="b9547-183">Reference data is the read-only data of an application.</span></span> <span data-ttu-id="b9547-184">Ces données fournissent le contexte professionnel au sein duquel l’application génère les données transactionnelles durant une opération commerciale.</span><span class="sxs-lookup"><span data-stu-id="b9547-184">This data provides the business context within which the application generates transactional data during a business operation.</span></span> <span data-ttu-id="b9547-185">L’intégrité des données transactionnelles dépend d’un instantané des données de référence au moment où la transaction a été effectuée.</span><span class="sxs-lookup"><span data-stu-id="b9547-185">The integrity of transactional data depends on a snapshot of the reference data at the time the transaction was completed.</span></span>

<span data-ttu-id="b9547-186">Les données de référence sont nécessaires au bon fonctionnement de l’application.</span><span class="sxs-lookup"><span data-stu-id="b9547-186">Reference data is necessary for the proper operation of the application.</span></span> <span data-ttu-id="b9547-187">Diverses applications créent et gèrent les données de référence ; les systèmes de gestion des données de référence (MDM, Master Data Management) remplissent souvent cette fonction.</span><span class="sxs-lookup"><span data-stu-id="b9547-187">Various applications create and maintain reference data; master data management (MDM) systems often perform this function.</span></span> <span data-ttu-id="b9547-188">Ces systèmes sont responsables du cycle de vie des données de référence.</span><span class="sxs-lookup"><span data-stu-id="b9547-188">These systems are responsible for the life cycle of the reference data.</span></span> <span data-ttu-id="b9547-189">Parmi les données de référence, citons les catalogues de produits, les informations sur les employés, sur les pièces et sur les équipements.</span><span class="sxs-lookup"><span data-stu-id="b9547-189">Examples of reference data include product catalog, employee master, parts master, and equipment master.</span></span> <span data-ttu-id="b9547-190">Les données de référence peuvent également provenir de l’extérieur de l’organisation, comme les codes postaux ou les taux d’imposition.</span><span class="sxs-lookup"><span data-stu-id="b9547-190">Reference data can also originate from outside the organization, for example, postal codes or tax rates.</span></span> <span data-ttu-id="b9547-191">Les stratégies dédiées à l’augmentation de la disponibilité des données de référence sont généralement moins complexes que celles associées aux données transactionnelles.</span><span class="sxs-lookup"><span data-stu-id="b9547-191">Strategies for increasing the availability of reference data are typically less difficult than those for transactional data.</span></span> <span data-ttu-id="b9547-192">Les données de référence présentent l’avantage d’être principalement immuables.</span><span class="sxs-lookup"><span data-stu-id="b9547-192">Reference data has the advantage of being mostly immutable.</span></span>

<span data-ttu-id="b9547-193">Des rôles web et de travail Azure qui consomment de manière autonome des données de référence peuvent être créés pendant l’exécution en déployant ces données de référence avec l’application.</span><span class="sxs-lookup"><span data-stu-id="b9547-193">Azure web and worker roles that consume reference data can be made autonomous at runtime by deploying the reference data along with the application.</span></span> <span data-ttu-id="b9547-194">Cette approche est idéale si la taille du stockage local permet un déploiement de ce type.</span><span class="sxs-lookup"><span data-stu-id="b9547-194">This approach is ideal if the size of the local storage allows such a deployment.</span></span> <span data-ttu-id="b9547-195">Les bases de données SQL intégrées, les bases de données NoSQL ou les fichiers XML déployés localement contribuent à l’autonomie des unités d’échelle de calcul Azure.</span><span class="sxs-lookup"><span data-stu-id="b9547-195">Embedded SQL databases, NoSQL databases, or XML files deployed locally help with the autonomy of Azure compute scale units.</span></span> <span data-ttu-id="b9547-196">Toutefois, vous devez disposer d’un mécanisme permettant de mettre à jour les données de chaque rôle sans nécessiter de nouveau déploiement.</span><span class="sxs-lookup"><span data-stu-id="b9547-196">However, you should have a mechanism to update the data in each role without requiring redeployment.</span></span> <span data-ttu-id="b9547-197">Pour ce faire, placez les mises à jour des données de référence sur un point de terminaison de stockage cloud (par exemple, le stockage d’objets blob Azure ou une Base de données SQL).</span><span class="sxs-lookup"><span data-stu-id="b9547-197">To do this, place any updates to the reference data at a cloud storage endpoint (for example, Azure Blob storage or SQL Database).</span></span> <span data-ttu-id="b9547-198">Sur chaque rôle, ajoutez un code téléchargeant les mises à jour des données dans les nœuds de calcul lors du démarrage.</span><span class="sxs-lookup"><span data-stu-id="b9547-198">Add code to each role that downloads the data updates into the compute nodes at role startup.</span></span> <span data-ttu-id="b9547-199">Sinon, ajoutez un code qui donne les moyens à un administrateur d’effectuer un téléchargement forcé dans les instances de rôle.</span><span class="sxs-lookup"><span data-stu-id="b9547-199">Alternatively, add code that allows an administrator to perform a forced download into the role instances.</span></span>

<span data-ttu-id="b9547-200">Pour augmenter la disponibilité, les rôles doivent également contenir un ensemble de données de référence, à utiliser en cas de défaillance du stockage.</span><span class="sxs-lookup"><span data-stu-id="b9547-200">To increase availability, the roles should also contain a set of reference data in case storage is down.</span></span> <span data-ttu-id="b9547-201">Les rôles peuvent démarrer avec un ensemble de base de données de référence, jusqu’à la mise à disposition pour les mises à jour des ressources de stockage.</span><span class="sxs-lookup"><span data-stu-id="b9547-201">Roles can start with a basic set of reference data until the storage resource becomes available for the updates.</span></span>

![Haute disponibilité des applications via les nœuds de calcul autonomes](./images/high-availability-azure-applications/application-high-availability-through-autonomous-compute-nodes.png)

<span data-ttu-id="b9547-203">Avec ce modèle, le démarrage des nouveaux déploiements ou instances de rôle peut prendre plus de temps si vous déployez ou téléchargez de grands volumes de données de référence.</span><span class="sxs-lookup"><span data-stu-id="b9547-203">With this pattern, new deployments or role instances may take longer to start if you are deploying or downloading large amounts of reference data.</span></span> <span data-ttu-id="b9547-204">Ce compromis peut être acceptable pour l’autonomie, dans la mesure où les données de référence sont immédiatement disponibles à chaque rôle, sans plus dépendre des services de stockage externes.</span><span class="sxs-lookup"><span data-stu-id="b9547-204">This tradeoff might be acceptable for the autonomy of having the reference data immediately available on each role, rather than depending on external storage services.</span></span>

### <a name="transactional-data-pattern-for-high-availability"></a><span data-ttu-id="b9547-205">Modèle de données transactionnel pour la haute disponibilité</span><span class="sxs-lookup"><span data-stu-id="b9547-205">Transactional data pattern for high availability</span></span>
<span data-ttu-id="b9547-206">Les données transactionnelles sont les données générées par l’application dans un contexte professionnel.</span><span class="sxs-lookup"><span data-stu-id="b9547-206">Transactional data is the data that the application generates in a business context.</span></span> <span data-ttu-id="b9547-207">Les données transactionnelles sont une combinaison de l’ensemble de processus d’entreprise implémentés par l’application et des données de référence qui prennent en charge ces processus.</span><span class="sxs-lookup"><span data-stu-id="b9547-207">Transactional data is a combination of the set of business processes that the application implements and the reference data that supports these processes.</span></span> <span data-ttu-id="b9547-208">Parmi les données transactionnelles, citons les commandes, les avis d’expédition anticipée, les factures et les opportunités de gestion des relations client (CRM, Customer Relationship Management).</span><span class="sxs-lookup"><span data-stu-id="b9547-208">Examples of transactional data can include orders, advanced shipping notices, invoices, and customer relationship management (CRM) opportunities.</span></span> <span data-ttu-id="b9547-209">Les données transactionnelles sont fournies aux systèmes externes à des fins de consignation ou de traitement ultérieur.</span><span class="sxs-lookup"><span data-stu-id="b9547-209">Transactional data is supplied to external systems for record keeping or for further processing.</span></span>

<span data-ttu-id="b9547-210">Les données de référence peuvent changer au sein des systèmes qui en sont responsables.</span><span class="sxs-lookup"><span data-stu-id="b9547-210">Reference data can change within the systems that are responsible for that data.</span></span> <span data-ttu-id="b9547-211">Ainsi, les données transactionnelles doivent enregistrer le contexte des données de référence ponctuelles pour réduire les dépendances externes, au bénéfice d’une cohérence sémantique.</span><span class="sxs-lookup"><span data-stu-id="b9547-211">Therefore, transactional data must save the point-in-time reference data context to minimize external dependencies for its semantic consistency.</span></span> <span data-ttu-id="b9547-212">Par exemple, un produit peut être supprimé du catalogue quelques mois après l’exécution d’une commande.</span><span class="sxs-lookup"><span data-stu-id="b9547-212">For example, a product may be removed from the catalog several months after an order is fulfilled.</span></span> <span data-ttu-id="b9547-213">Nous vous recommandons de stocker autant de contexte des données de référence que possible avec la transaction.</span><span class="sxs-lookup"><span data-stu-id="b9547-213">Storing as much reference data context as possible with the transaction is recommended.</span></span> <span data-ttu-id="b9547-214">Cette approche préserve la sémantique associée à la transaction, même si une modification des données de référence était prévue une fois la transaction capturée.</span><span class="sxs-lookup"><span data-stu-id="b9547-214">This approach preserves the semantics associated with the transaction, even if the reference data changes after the transaction is captured.</span></span>

<span data-ttu-id="b9547-215">Comme mentionné précédemment, les architectures qui valorisent un couplage faible et une communication asynchrone peuvent fournir des niveaux de disponibilité plus élevés.</span><span class="sxs-lookup"><span data-stu-id="b9547-215">As mentioned previously, architectures that use loose coupling and asynchronous communication can provide higher levels of availability.</span></span> <span data-ttu-id="b9547-216">Cela est également vrai pour les données transactionnelles, mais l’implémentation est plus complexe.</span><span class="sxs-lookup"><span data-stu-id="b9547-216">This is true for transactional data as well, but the implementation is more complex.</span></span> <span data-ttu-id="b9547-217">Pour garantir la transaction, les modèles transactionnels traditionnelles reposent généralement sur la base de données.</span><span class="sxs-lookup"><span data-stu-id="b9547-217">Traditional transactional patterns usually rely on the database for guaranteeing the transaction.</span></span> <span data-ttu-id="b9547-218">Lorsque vous introduisez des couches intermédiaires, le code d’application doit traiter correctement les données des différentes couches pour assurer une cohérence et une durabilité suffisantes.</span><span class="sxs-lookup"><span data-stu-id="b9547-218">When you introduce intermediate layers, the application code must correctly handle the data at various layers to ensure sufficient consistency and durability.</span></span>

<span data-ttu-id="b9547-219">La séquence suivante décrit un workflow qui sépare la capture des données transactionnelles de son traitement :</span><span class="sxs-lookup"><span data-stu-id="b9547-219">The following sequence describes a workflow that separates the capture of transactional data from its processing:</span></span>

1. <span data-ttu-id="b9547-220">Nœud de calcul Web : présenter les données de référence.</span><span class="sxs-lookup"><span data-stu-id="b9547-220">Web compute node: Present reference data.</span></span>
2. <span data-ttu-id="b9547-221">Stockage externe : enregistrer les données transactionnelles intermédiaires.</span><span class="sxs-lookup"><span data-stu-id="b9547-221">External storage: Save intermediate transactional data.</span></span>
3. <span data-ttu-id="b9547-222">Nœud de calcul Web : exécuter la transaction de l’utilisateur final.</span><span class="sxs-lookup"><span data-stu-id="b9547-222">Web compute node: Complete the end-user transaction.</span></span>
4. <span data-ttu-id="b9547-223">Nœud de calcul web : envoyer les données transactionnelles complètes avec leur contexte des données de référence vers un stockage durable temporaire garantissant la fourniture d’une réponse prévisible.</span><span class="sxs-lookup"><span data-stu-id="b9547-223">Web compute node: Send the completed transactional data with its reference data context to temporary durable storage that is guaranteed to give a predictable response.</span></span>
5. <span data-ttu-id="b9547-224">Nœud de calcul Web : signaler à l’utilisateur final l’exécution de la transaction.</span><span class="sxs-lookup"><span data-stu-id="b9547-224">Web compute node: Signal the end-user completion of the transaction.</span></span>
6. <span data-ttu-id="b9547-225">Nœud de calcul d’arrière-plan : extraire les données transactionnelles, les traiter davantage si nécessaire et les envoyer vers leur emplacement de stockage final au sein du système actuel.</span><span class="sxs-lookup"><span data-stu-id="b9547-225">Background compute node: Extract the transactional data, process it further if necessary, and send it to its final storage location in the current system.</span></span>

<span data-ttu-id="b9547-226">Le diagramme suivant représente une implémentation possible de cette conception dans un service cloud hébergé Azure.</span><span class="sxs-lookup"><span data-stu-id="b9547-226">The following diagram shows one possible implementation of this design in an Azure-hosted cloud service.</span></span>

![Haute disponibilité via un couplage faible](./images/disaster-recovery-high-availability-azure-applications/application-high-availability-through-loose-coupling.png)

<span data-ttu-id="b9547-228">Les flèches en pointillés du diagramme précédent font état d’un traitement asynchrone.</span><span class="sxs-lookup"><span data-stu-id="b9547-228">The dashed arrows in the preceding diagram indicate asynchronous processing.</span></span> <span data-ttu-id="b9547-229">Le rôle web frontal n’a pas connaissance de ce traitement asynchrone.</span><span class="sxs-lookup"><span data-stu-id="b9547-229">The front-end web role is not aware of this asynchronous processing.</span></span> <span data-ttu-id="b9547-230">Avec cette configuration, la transaction est stockée à sa destination finale avec une référence au système actuel.</span><span class="sxs-lookup"><span data-stu-id="b9547-230">This leads to the storage of the transaction at its final destination with reference to the current system.</span></span> <span data-ttu-id="b9547-231">En raison de la latence introduite par ce modèle asynchrone, les données transactionnelles ne peuvent pas être immédiatement interrogées.</span><span class="sxs-lookup"><span data-stu-id="b9547-231">Due to the latency that this asynchronous model introduces, the transactional data is not immediately available for query.</span></span> <span data-ttu-id="b9547-232">Par conséquent, pour satisfaire aux besoins immédiats de l’interface utilisateur, chaque unité de données transactionnelles doit être enregistrée dans un cache ou une session d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="b9547-232">Therefore, each unit of the transactional data needs to be saved in a cache or a user session to meet the immediate UI needs.</span></span>

<span data-ttu-id="b9547-233">Le rôle Web est autonome du reste de l’infrastructure.</span><span class="sxs-lookup"><span data-stu-id="b9547-233">The web role is autonomous from the rest of the infrastructure.</span></span> <span data-ttu-id="b9547-234">Son profil de disponibilité est une combinaison du rôle web et de la file d’attente Azure, non pas de l’intégralité de l’infrastructure.</span><span class="sxs-lookup"><span data-stu-id="b9547-234">Its availability profile is a combination of the web role and the Azure queue and not the entire infrastructure.</span></span> <span data-ttu-id="b9547-235">En plus de la haute disponibilité, cette approche prend en charge la mise à l’échelle horizontale du rôle web, indépendamment du stockage principal.</span><span class="sxs-lookup"><span data-stu-id="b9547-235">In addition to high availability, this approach allows the web role to scale horizontally, independent of the back-end storage.</span></span> <span data-ttu-id="b9547-236">Ce modèle de haute disponibilité peut avoir une incidence sur la rentabilité des opérations.</span><span class="sxs-lookup"><span data-stu-id="b9547-236">This high-availability model can have an impact on the economics of operations.</span></span> <span data-ttu-id="b9547-237">Les composants supplémentaires comme les files d’attente Azure et les rôles de travail peuvent affecter les coûts mensuels d’utilisation.</span><span class="sxs-lookup"><span data-stu-id="b9547-237">Additional components like Azure queues and worker roles can affect monthly usage costs.</span></span>

<span data-ttu-id="b9547-238">Le diagramme précédent représente une implémentation de cette approche dissociée des données transactionnelles.</span><span class="sxs-lookup"><span data-stu-id="b9547-238">The previous diagram shows one implementation of this decoupled approach to transactional data.</span></span> <span data-ttu-id="b9547-239">Il existe de nombreuses autres implémentations possibles.</span><span class="sxs-lookup"><span data-stu-id="b9547-239">There are many other possible implementations.</span></span> <span data-ttu-id="b9547-240">La liste suivante vous propose quelques alternatives :</span><span class="sxs-lookup"><span data-stu-id="b9547-240">The following list provides some alternatives:</span></span>

* <span data-ttu-id="b9547-241">Un rôle de travail peut être placé entre le rôle web et la file d’attente de stockage.</span><span class="sxs-lookup"><span data-stu-id="b9547-241">A worker role might be placed between the web role and the storage queue.</span></span>
* <span data-ttu-id="b9547-242">Une file d’attente Service Bus peut remplacer une file d’attente de stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="b9547-242">A Service Bus queue can be used instead of an Azure Storage queue.</span></span>
* <span data-ttu-id="b9547-243">La destination finale peut être Stockage Azure ou un autre fournisseur de base de données.</span><span class="sxs-lookup"><span data-stu-id="b9547-243">The final destination might be Azure Storage or a different database provider.</span></span>
* <span data-ttu-id="b9547-244">La fonctionnalité Azure Cache peut être utilisée au niveau de la couche Web pour prendre en charge les besoins immédiats de mise en cache après la transaction.</span><span class="sxs-lookup"><span data-stu-id="b9547-244">Azure Cache can be used at the web layer to provide the immediate caching requirements after the transaction.</span></span>

### <a name="scalability-patterns"></a><span data-ttu-id="b9547-245">Modèles de scalabilité</span><span class="sxs-lookup"><span data-stu-id="b9547-245">Scalability patterns</span></span>
<span data-ttu-id="b9547-246">Il est important de noter que la scalabilité d’un service cloud affecte directement la disponibilité.</span><span class="sxs-lookup"><span data-stu-id="b9547-246">It's important to note that the scalability of a cloud service directly affects availability.</span></span> <span data-ttu-id="b9547-247">Si l’accroissement de la charge affecte la réactivité de votre service, l’utilisateur a l’impression que l’application est en panne.</span><span class="sxs-lookup"><span data-stu-id="b9547-247">If increased load causes your service to be unresponsive, the user perception is that the application is down.</span></span> <span data-ttu-id="b9547-248">Suivez des pratiques de scalabilité éprouvées en fonction des prévisions de charge de votre application et des besoins futurs.</span><span class="sxs-lookup"><span data-stu-id="b9547-248">Follow proven practices for scalability based on your expected application load and future expectations.</span></span> <span data-ttu-id="b9547-249">L’optimisation de la mise à l’échelle implique de nombreuses questions : faut-il utiliser un ou plusieurs comptes de stockage ? Comment se déroule le partage entre plusieurs bases de données ? Quelles stratégies de mise en cache implémenter ?</span><span class="sxs-lookup"><span data-stu-id="b9547-249">Maximizing scale involves many considerations, such as single versus multiple storage accounts, sharing across multiple databases, and caching strategies.</span></span> <span data-ttu-id="b9547-250">Pour obtenir des informations détaillées sur ces modèles, consultez [Best practices for designing large-scale services on Microsoft Azure](https://azure.microsoft.com/blog/best-practices-for-designing-large-scale-services-on-windows-azure/) (Bonnes pratiques pour concevoir des services à grande échelle sur Microsoft Azure).</span><span class="sxs-lookup"><span data-stu-id="b9547-250">For in-depth information about these patterns, see [Best practices for designing large-scale services on Microsoft Azure](https://azure.microsoft.com/blog/best-practices-for-designing-large-scale-services-on-windows-azure/).</span></span>

## <a name="next-steps"></a><span data-ttu-id="b9547-251">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="b9547-251">Next steps</span></span>
<span data-ttu-id="b9547-252">Cette série de document couvre la récupération d’urgence et la haute disponibilité des applications développées sur Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="b9547-252">This series of documents covers disaster recovery and high availability for applications built on Microsoft Azure.</span></span> <span data-ttu-id="b9547-253">Le prochain article de la série est [Récupération d’urgence des applications développées sur Microsoft Azure](disaster-recovery-azure-applications.md).</span><span class="sxs-lookup"><span data-stu-id="b9547-253">The next article in the series is [Disaster recovery for applications built on Microsoft Azure](disaster-recovery-azure-applications.md).</span></span>

