---
title: Déployer SAP NetWeaver et SAP HANA sur Azure
description: Pratiques éprouvées d’exécution de SAP HANA dans un environnement à haute disponibilité dans Azure.
author: njray
ms.date: 06/29/2017
ms.openlocfilehash: 33171164c59a520a87ef3209c5bb1b208377221c
ms.sourcegitcommit: c441fd165e6bebbbbbc19854ec6f3676be9c3b25
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/30/2018
---
# <a name="deploy-sap-netweaver-and-sap-hana-on-azure"></a><span data-ttu-id="1bc22-103">Déployer SAP NetWeaver et SAP HANA sur Azure</span><span class="sxs-lookup"><span data-stu-id="1bc22-103">Deploy SAP NetWeaver and SAP HANA on Azure</span></span>

<span data-ttu-id="1bc22-104">Cette architecture de référence présente un ensemble de pratiques éprouvées pour l’exécution de SAP HANA dans un environnement à haute disponibilité dans Azure.</span><span class="sxs-lookup"><span data-stu-id="1bc22-104">This reference architecture shows a set of proven practices for running SAP HANA in a high availability environment on Azure.</span></span> [<span data-ttu-id="1bc22-105">**Déployez cette solution**.</span><span class="sxs-lookup"><span data-stu-id="1bc22-105">**Deploy this solution**.</span></span>](#deploy-the-solution)

<span data-ttu-id="1bc22-106">![0][0]</span><span class="sxs-lookup"><span data-stu-id="1bc22-106">![0][0]</span></span>

<span data-ttu-id="1bc22-107">*Téléchargez un [fichier Visio][visio-download] de cette architecture.*</span><span class="sxs-lookup"><span data-stu-id="1bc22-107">*Download a [Visio file][visio-download] of this architecture.*</span></span>

> [!NOTE]
> <span data-ttu-id="1bc22-108">Le déploiement de cette architecture de référence requiert une licence appropriée des produits SAP et d’autres technologies non Microsoft.</span><span class="sxs-lookup"><span data-stu-id="1bc22-108">Deploying this reference architecture requires appropriate licensing of SAP products and other non-Microsoft technologies.</span></span> <span data-ttu-id="1bc22-109">Pour plus d’informations sur le partenariat entre Microsoft et SAP, consultez [SAP HANA sur Azure][sap-hana-on-azure].</span><span class="sxs-lookup"><span data-stu-id="1bc22-109">For information about the partnership between Microsoft and SAP, see [SAP HANA on Azure][sap-hana-on-azure].</span></span>

## <a name="architecture"></a><span data-ttu-id="1bc22-110">Architecture</span><span class="sxs-lookup"><span data-stu-id="1bc22-110">Architecture</span></span>

<span data-ttu-id="1bc22-111">L’architecture est constituée des composants suivants.</span><span class="sxs-lookup"><span data-stu-id="1bc22-111">The architecture consists of the following components.</span></span>

- <span data-ttu-id="1bc22-112">**Réseau virtuel**.</span><span class="sxs-lookup"><span data-stu-id="1bc22-112">**Virtual network (VNet)**.</span></span> <span data-ttu-id="1bc22-113">Un réseau virtuel est une représentation d’un réseau isolé logiquement dans Azure.</span><span class="sxs-lookup"><span data-stu-id="1bc22-113">A VNet is a representation of a logically isolated network in Azure.</span></span> <span data-ttu-id="1bc22-114">Toutes les machines virtuelles de cette architecture de référence sont déployées sur le même réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="1bc22-114">All of the VMs in this reference architecture are deployed to the same VNet.</span></span> <span data-ttu-id="1bc22-115">Le réseau virtuel est en outre subdivisé en sous-réseaux.</span><span class="sxs-lookup"><span data-stu-id="1bc22-115">The VNet is further subdivided into subnets.</span></span> <span data-ttu-id="1bc22-116">Créez un sous-réseau distinct pour chaque couche, y compris l’application (SAP NetWeaver), la base de données (SAP HANA), la gestion (le jumpbox) et Active Directory.</span><span class="sxs-lookup"><span data-stu-id="1bc22-116">Create a separate subnet for each tier, including application (SAP NetWeaver), database (SAP HANA), management (the jumpbox), and Active Directory.</span></span>

- <span data-ttu-id="1bc22-117">**Machines virtuelles**.</span><span class="sxs-lookup"><span data-stu-id="1bc22-117">**Virtual machines (VMs)**.</span></span> <span data-ttu-id="1bc22-118">Les machines virtuelles de cette architecture sont regroupées en plusieurs couches distinctes.</span><span class="sxs-lookup"><span data-stu-id="1bc22-118">The VMs for this architecture are grouped into several distinct tiers.</span></span>

    - <span data-ttu-id="1bc22-119">**SAP NetWeaver**.</span><span class="sxs-lookup"><span data-stu-id="1bc22-119">**SAP NetWeaver**.</span></span> <span data-ttu-id="1bc22-120">Inclut SAP ASCS, SAP Web Dispatcher et les serveurs d’applications SAP.</span><span class="sxs-lookup"><span data-stu-id="1bc22-120">Includes SAP ASCS, SAP Web Dispatcher, and the SAP application servers.</span></span> 
    
    - <span data-ttu-id="1bc22-121">**SAP HANA**.</span><span class="sxs-lookup"><span data-stu-id="1bc22-121">**SAP HANA**.</span></span> <span data-ttu-id="1bc22-122">Cette architecture de référence utilise SAP HANA pour la couche de base de données, en cours d’exécution sur une seule instance [GS5][vm-sizes-mem].</span><span class="sxs-lookup"><span data-stu-id="1bc22-122">This reference architecture uses SAP HANA for the database tier, running on a single [GS5][vm-sizes-mem] instance.</span></span> <span data-ttu-id="1bc22-123">SAP HANA est certifié pour les charges de travail OLAP de production sur GS5 ou [SAP HANA sur des grandes instances Azure][azure-large-instances].</span><span class="sxs-lookup"><span data-stu-id="1bc22-123">SAP HANA is certified for production OLAP workloads on GS5 or [SAP HANA on Azure Large Instances][azure-large-instances].</span></span> <span data-ttu-id="1bc22-124">Cette architecture de référence est destinée aux machines virtuelles Azure de série G et M.</span><span class="sxs-lookup"><span data-stu-id="1bc22-124">This reference architecture is for Azure virtual machines in the G-series and M-series.</span></span> <span data-ttu-id="1bc22-125">Pour plus d’informations sur SAP HANA sur les grandes instances Azure de grande taille, consultez [Vue d’ensemble et architecture de SAP HANA (grandes instances) sur Azure][azure-large-instances].</span><span class="sxs-lookup"><span data-stu-id="1bc22-125">For information about SAP HANA on Azure Large Instances, see [SAP HANA (large instances) overview and architecture on Azure][azure-large-instances].</span></span>
   
    - <span data-ttu-id="1bc22-126">**Jumpbox**.</span><span class="sxs-lookup"><span data-stu-id="1bc22-126">**Jumpbox**.</span></span> <span data-ttu-id="1bc22-127">Également appelé hôte bastion.</span><span class="sxs-lookup"><span data-stu-id="1bc22-127">Also called a bastion host.</span></span> <span data-ttu-id="1bc22-128">Il s’agit d’une machine virtuelle sécurisée sur le réseau, utilisée par les administrateurs pour se connecter aux autres machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="1bc22-128">This is a secure VM on the network that administrators use to connect to the other VMs.</span></span> 
     
    - <span data-ttu-id="1bc22-129">**Contrôleurs de domaine Windows Server Active Directory (AD).**</span><span class="sxs-lookup"><span data-stu-id="1bc22-129">**Windows Server Active Directory (AD) domain controllers.**</span></span> <span data-ttu-id="1bc22-130">Les contrôleurs de domaine sont utilisés pour configurer le cluster de basculement Windows Server (voir ci-dessous).</span><span class="sxs-lookup"><span data-stu-id="1bc22-130">The domain controllers are used to configure the Windows Server Failover Cluster (see below).</span></span>
 
- <span data-ttu-id="1bc22-131">**Groupes à haute disponibilité**.</span><span class="sxs-lookup"><span data-stu-id="1bc22-131">**Availability sets**.</span></span> <span data-ttu-id="1bc22-132">Placez les machines virtuelles pour le SAP Web Dispatcher, le serveur d’applications SAP et les rôles SAP ACSC dans des groupes à haute disponibilité distincts et configurez au moins deux machines virtuelles pour chaque rôle.</span><span class="sxs-lookup"><span data-stu-id="1bc22-132">Place the VMs for the SAP Web Dispatcher, SAP application server, and SAP ACSC roles into separate availability sets, and provision at least two VMs for each role.</span></span> <span data-ttu-id="1bc22-133">Cela rend les machines virtuelles éligibles à un contrat de niveau de service (SLA) plus élevé.</span><span class="sxs-lookup"><span data-stu-id="1bc22-133">This makes the VMs eligible for a higher service level agreement (SLA).</span></span>
    
- <span data-ttu-id="1bc22-134">**Cartes réseau**.</span><span class="sxs-lookup"><span data-stu-id="1bc22-134">**NICs.**</span></span> <span data-ttu-id="1bc22-135">Les machines virtuelles qui s’exécutent sur SAP NetWeaver et SAP HANA nécessitent deux cartes réseau.</span><span class="sxs-lookup"><span data-stu-id="1bc22-135">The VMs that run SAP NetWeaver and SAP HANA require two network interfaces (NICs).</span></span> <span data-ttu-id="1bc22-136">Chaque carte réseau est affectée à un sous-réseau différent, pour séparer les différents types de trafic.</span><span class="sxs-lookup"><span data-stu-id="1bc22-136">Each NIC is assigned to a different subnet, to segregate different types of traffic.</span></span> <span data-ttu-id="1bc22-137">Consultez les [recommandations](#recommendations) ci-dessous pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="1bc22-137">See [Recommendations](#recommendations) below for more information.</span></span>

- <span data-ttu-id="1bc22-138">**Cluster de basculement Windows Server**.</span><span class="sxs-lookup"><span data-stu-id="1bc22-138">**Windows Server Failover Cluster**.</span></span> <span data-ttu-id="1bc22-139">Les machines virtuelles qui exécutent SAP ACSC sont configurées comme un cluster de basculement pour une haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="1bc22-139">The VMs that run SAP ACSC are configured as a failover cluster for high availability.</span></span> <span data-ttu-id="1bc22-140">Pour prendre en charge le cluster de basculement SIOS DataKeeper Cluster Edition exécute la fonction de volume partagé de cluster (CSV) par la réplication de disques indépendants détenus par les nœuds de cluster.</span><span class="sxs-lookup"><span data-stu-id="1bc22-140">To support the failover cluster, SIOS DataKeeper Cluster Edition performs the cluster shared volume (CSV) function by replicating independent disks owned by the cluster nodes.</span></span> <span data-ttu-id="1bc22-141">Pour plus de détails, consultez [Running SAP applications on the Microsoft platform][running-sap] (Exécution d’applications SAP sur la plateforme Microsoft).</span><span class="sxs-lookup"><span data-stu-id="1bc22-141">For details, see [Running SAP applications on the Microsoft platform][running-sap].</span></span>
    
- <span data-ttu-id="1bc22-142">**Équilibreurs de charge.**</span><span class="sxs-lookup"><span data-stu-id="1bc22-142">**Load balancers.**</span></span> <span data-ttu-id="1bc22-143">Deux instances [Azure Load Balancer] [ azure-lb] sont utilisées.</span><span class="sxs-lookup"><span data-stu-id="1bc22-143">Two [Azure Load Balancer][azure-lb] instances are used.</span></span> <span data-ttu-id="1bc22-144">La première, illustrée à gauche du diagramme, répartit le trafic sur les machines virtuelles SAP Web Dispatcher.</span><span class="sxs-lookup"><span data-stu-id="1bc22-144">The first, shown on the left of the diagram, distributes traffic to the SAP Web Dispatcher VMs.</span></span> <span data-ttu-id="1bc22-145">Cette configuration implémente l’option de répartiteur web parallèle décrite dans [High Availability of the SAP Web Dispatcher][sap-dispatcher-ha] (Haute disponibilité du SAP Web Dispatcher).</span><span class="sxs-lookup"><span data-stu-id="1bc22-145">This configuration implements the parallel web dispatcher option described in [High Availability of the SAP Web Dispatcher][sap-dispatcher-ha].</span></span> <span data-ttu-id="1bc22-146">Le deuxième équilibreur de charge présenté sur la droite permet le basculement au sein du cluster de basculement Windows Server, en dirigeant les connexions entrantes vers le nœud actif/sain.</span><span class="sxs-lookup"><span data-stu-id="1bc22-146">The second load balancer, shown on the right, enables failover in the Windows Server Failover Cluster, by directing incoming connections to the active/healthy node.</span></span>

- <span data-ttu-id="1bc22-147">**Passerelle VPN.**</span><span class="sxs-lookup"><span data-stu-id="1bc22-147">**VPN Gateway.**</span></span> <span data-ttu-id="1bc22-148">La passerelle VPN étend votre réseau local sur le réseau virtuel Azure.</span><span class="sxs-lookup"><span data-stu-id="1bc22-148">The VPN Gateway extends your on-premises network to the Azure VNet.</span></span> <span data-ttu-id="1bc22-149">Vous pouvez également utiliser ExpressRoute, qui utilise une connexion privée dédiée qui ne passe pas par l’Internet public.</span><span class="sxs-lookup"><span data-stu-id="1bc22-149">You can also use ExpressRoute, which uses a dedicated private connection that does not go over the public Internet.</span></span> <span data-ttu-id="1bc22-150">L’exemple de solution ne déploie pas la passerelle.</span><span class="sxs-lookup"><span data-stu-id="1bc22-150">The example solution does not deploy the gateway.</span></span> <span data-ttu-id="1bc22-151">Pour plus d’informations, consultez la section [Connecter un réseau local à Azure][hybrid-networking].</span><span class="sxs-lookup"><span data-stu-id="1bc22-151">For more information, see [Connect an on-premises network to Azure][hybrid-networking].</span></span>

## <a name="recommendations"></a><span data-ttu-id="1bc22-152">Recommandations</span><span class="sxs-lookup"><span data-stu-id="1bc22-152">Recommendations</span></span>

<span data-ttu-id="1bc22-153">Vos exigences peuvent différer de celles de l’architecture décrite ici.</span><span class="sxs-lookup"><span data-stu-id="1bc22-153">Your requirements might differ from the architecture described here.</span></span> <span data-ttu-id="1bc22-154">Utilisez ces recommandations comme point de départ.</span><span class="sxs-lookup"><span data-stu-id="1bc22-154">Use these recommendations as a starting point.</span></span>

### <a name="load-balancers"></a><span data-ttu-id="1bc22-155">Équilibreurs de charge</span><span class="sxs-lookup"><span data-stu-id="1bc22-155">Load balancers</span></span>

<span data-ttu-id="1bc22-156">[SAP Web Dispatcher][sap-dispatcher] traite l’équilibrage du trafic HTTP(S) sur les serveurs à double pile (ABAP et Java).</span><span class="sxs-lookup"><span data-stu-id="1bc22-156">[SAP Web Dispatcher][sap-dispatcher] handles load balancing of HTTP(S) traffic to dual-stack servers (ABAP and Java).</span></span> <span data-ttu-id="1bc22-157">SAP a préconisé des serveurs d’applications à pile unique pendant des années, c’est pourquoi peu d’applications s’exécutent sur un modèle de déploiement à double pile de nos jours.</span><span class="sxs-lookup"><span data-stu-id="1bc22-157">SAP has advocated single-stack application servers for years, so very few applications run on a dual-stack deployment model nowadays.</span></span> <span data-ttu-id="1bc22-158">L’équilibreur de charge Azure indiqué dans le diagramme d’architecture implémente le cluster à haute disponibilité pour SAP Web Dispatcher.</span><span class="sxs-lookup"><span data-stu-id="1bc22-158">The Azure load balancer shown in the architecture diagram implements the high availability cluster for the SAP Web Dispatcher.</span></span>

<span data-ttu-id="1bc22-159">L’équilibrage de charge du trafic sur les serveurs d’applications est géré dans SAP.</span><span class="sxs-lookup"><span data-stu-id="1bc22-159">Load balancing of traffic to the application servers is handled within SAP.</span></span> <span data-ttu-id="1bc22-160">Pour le trafic à partir de clients SAPGUI se connectant à un serveur SAP via DIAG et RFC, le serveur de messagerie SCS équilibre la charge en créant des [groupes de connexion][logon-groups] du serveur d’applications SAP.</span><span class="sxs-lookup"><span data-stu-id="1bc22-160">For traffic from SAPGUI clients connecting to a SAP server via DIAG and Remote Function Calls (RFC), the SCS message server balances the load by creating SAP App Server [Logon Groups][logon-groups].</span></span> 

<span data-ttu-id="1bc22-161">SMLG est une transaction SAP ABAP permettant de gérer la fonction d’équilibrage de la charge de connexion des Services centraux SAP.</span><span class="sxs-lookup"><span data-stu-id="1bc22-161">SMLG is an SAP ABAP transaction used to manage the logon load balancing capability of SAP Central Services.</span></span> <span data-ttu-id="1bc22-162">Le pool principal du groupe de connexion dispose de plusieurs serveurs d’applications.</span><span class="sxs-lookup"><span data-stu-id="1bc22-162">The backend pool of the logon group has more than one ABAP application server.</span></span> <span data-ttu-id="1bc22-163">Les clients accédant aux services de cluster ASC se connectent à l’équilibreur de charge Azure via une adresse IP de serveur frontal.</span><span class="sxs-lookup"><span data-stu-id="1bc22-163">Clients accessing ASCS cluster services connect to the Azure load balancer through a frontend IP address.</span></span> <span data-ttu-id="1bc22-164">Le nom du réseau virtuel du cluster ASC possède également une adresse IP.</span><span class="sxs-lookup"><span data-stu-id="1bc22-164">The ASCS cluster virtual network name also has an IP address.</span></span> <span data-ttu-id="1bc22-165">Si vous le souhaitez, cette adresse peut être associée à une adresse IP supplémentaire sur l’équilibreur de charge Azure, afin que le cluster puisse être géré à distance.</span><span class="sxs-lookup"><span data-stu-id="1bc22-165">Optionally, this address can be associated with an additional IP address on the Azure load balancer, so that the cluster can be managed remotely.</span></span>  

### <a name="nics"></a><span data-ttu-id="1bc22-166">Cartes réseau</span><span class="sxs-lookup"><span data-stu-id="1bc22-166">NICs</span></span>

<span data-ttu-id="1bc22-167">Les fonctions de gestion du paysage SAP nécessitent la séparation du trafic du serveur sur différentes cartes réseau.</span><span class="sxs-lookup"><span data-stu-id="1bc22-167">SAP landscape management functions require segregation of server traffic on different NICs.</span></span> <span data-ttu-id="1bc22-168">Par exemple, les données d’entreprise doivent être séparées du trafic administratif et de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="1bc22-168">For example, business data should be separated from administrative traffic and backup traffic.</span></span> <span data-ttu-id="1bc22-169">L’affectation de plusieurs cartes réseau à différents sous-réseaux permet cette séparation des données.</span><span class="sxs-lookup"><span data-stu-id="1bc22-169">Assigning multiple NICs to different subnets enables this data segregation.</span></span> <span data-ttu-id="1bc22-170">Pour plus d’informations, consultez « Réseau » dans le document PDF [Building High Availability for SAP NetWeaver and SAP HANA] [ sap-ha] (Créer la haute disponibilité pour SAP NetWeaver et SAP HANA).</span><span class="sxs-lookup"><span data-stu-id="1bc22-170">For more information, see "Network" in [Building High Availability for SAP NetWeaver and SAP HANA][sap-ha] (PDF).</span></span>

<span data-ttu-id="1bc22-171">Attribuer la carte réseau d’administration au sous-réseau de gestion et affectez la carte réseau de communication des données à un sous-réseau distinct.</span><span class="sxs-lookup"><span data-stu-id="1bc22-171">Assign the administration NIC to the management subnet, and assign the data communication NIC to a separate subnet.</span></span> <span data-ttu-id="1bc22-172">Pour obtenir des informations relatives à la configuration, consultez [Créer et gérer une machine virtuelle Windows équipée de plusieurs cartes d’interface réseau][multiple-vm-nics].</span><span class="sxs-lookup"><span data-stu-id="1bc22-172">For configuration details, see [Create and manage a Windows virtual machine that has multiple NICs][multiple-vm-nics].</span></span>

### <a name="azure-storage"></a><span data-ttu-id="1bc22-173">Stockage Azure</span><span class="sxs-lookup"><span data-stu-id="1bc22-173">Azure Storage</span></span>

<span data-ttu-id="1bc22-174">Avec toutes les machines virtuelles du serveur de base de données, nous recommandons l’utilisation du Stockage Premium Azure pour la latence en lecture/écriture.</span><span class="sxs-lookup"><span data-stu-id="1bc22-174">With all database server VMs, we recommend using Azure Premium Storage for consistent read/write latency.</span></span> <span data-ttu-id="1bc22-175">Pour les serveurs d’applications SAP, y compris les machines virtuelles (A)SCS, vous pouvez utiliser le stockage standard Azure, car l’exécution d’applications s’effectue en mémoire et utilise les disques uniquement pour la connexion.</span><span class="sxs-lookup"><span data-stu-id="1bc22-175">For SAP application servers, including the (A)SCS virtual machines, you can use Azure Standard Storage, because application execution takes place in memory and uses disks for logging only.</span></span>

<span data-ttu-id="1bc22-176">Pour une meilleure fiabilité, nous recommandons l’utilisation d’[Azure Managed Disks][managed-disks].</span><span class="sxs-lookup"><span data-stu-id="1bc22-176">For best reliability, we recommend using [Azure Managed Disks][managed-disks].</span></span> <span data-ttu-id="1bc22-177">Les disques gérés assurent que les disques des machines virtuelles au sein d’un groupe à haute disponibilité sont isolés afin d’éviter des points de défaillance uniques.</span><span class="sxs-lookup"><span data-stu-id="1bc22-177">Managed disks ensure that the disks for VMs within an availability set are isolated to avoid single points of failure.</span></span>

> [!NOTE]
> <span data-ttu-id="1bc22-178">Actuellement, le modèle Resource Manager de cette architecture de référence n’utilise pas de disques gérés.</span><span class="sxs-lookup"><span data-stu-id="1bc22-178">Currently the Resource Manager template for this reference architecture does not use managed disks.</span></span> <span data-ttu-id="1bc22-179">Nous avons l’intention de mettre à jour le modèle pour utiliser des managed disks.</span><span class="sxs-lookup"><span data-stu-id="1bc22-179">We are planning to update the template to use managed disks.</span></span>

<span data-ttu-id="1bc22-180">Pour obtenir un débit de bande passante de disque et d’ES/S élevé, les pratiques courantes en termes d’optimisation des performances du volume de stockage s’appliquent à la disposition du stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="1bc22-180">To achieve high IOPS and disk bandwidth throughput, the common practices in storage volume performance optimization apply to Azure storage layout.</span></span> <span data-ttu-id="1bc22-181">Par exemple, l’entrelacement de plusieurs disques pour créer un plus grand volume de disque améliore les performances d’E/S.</span><span class="sxs-lookup"><span data-stu-id="1bc22-181">For example, striping multiple disks together to create a larger disk volume improves IO performance.</span></span> <span data-ttu-id="1bc22-182">L’activation du cache de lecture sur un contenu de stockage qui change rarement améliore la vitesse de récupération des données.</span><span class="sxs-lookup"><span data-stu-id="1bc22-182">Enabling the read cache on storage content that changes infrequently enhances the speed of data retrieval.</span></span> <span data-ttu-id="1bc22-183">Pour plus d’informations sur les exigences en termes de performances, consultez [SAP note 1943937 - Hardware Configuration Check Tool][sap-1943937] (Note SAP 1943937 - Outil de vérification de la configuration matérielle).</span><span class="sxs-lookup"><span data-stu-id="1bc22-183">For details about performance requirements, see [SAP note 1943937 - Hardware Configuration Check Tool][sap-1943937].</span></span>

<span data-ttu-id="1bc22-184">Pour le magasin de données de sauvegarde, nous recommandons l’utilisation du [niveau de stockage froid] [ cool-blob-storage] du stockage d’objets Blob Azure.</span><span class="sxs-lookup"><span data-stu-id="1bc22-184">For the backup data store, we recommend using the [cool storage tier][cool-blob-storage] of Azure Blob storage.</span></span> <span data-ttu-id="1bc22-185">Le niveau de stockage froid est un moyen économique de stocker les données à long terme moins souvent sollicitées.</span><span class="sxs-lookup"><span data-stu-id="1bc22-185">The cool storage tier is a cost-effective way to store data that is less frequently accessed and long-lived.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="1bc22-186">Considérations relatives à l’extensibilité</span><span class="sxs-lookup"><span data-stu-id="1bc22-186">Scalability considerations</span></span>

<span data-ttu-id="1bc22-187">Au niveau de la couche de l’application SAP, Azure propose un large éventail de tailles de machines virtuelles pour une augmentation de la taille des instances.</span><span class="sxs-lookup"><span data-stu-id="1bc22-187">At the SAP application layer, Azure offers a wide range of virtual machine sizes for scaling up.</span></span> <span data-ttu-id="1bc22-188">Consultez [Note SAP 1928533 - Applications SAP sur Azure : produits et types de machines virtuelles pris en charge pour obtenir une liste exhaustive][sap-1928533].</span><span class="sxs-lookup"><span data-stu-id="1bc22-188">For an inclusive list, see [SAP note 1928533 - SAP Applications on Azure: Supported Products and Azure VM Types][sap-1928533].</span></span> <span data-ttu-id="1bc22-189">Augmentez la taille des instances en ajoutant davantage de machines virtuelles au groupe à haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="1bc22-189">Scale out by adding more VMs to the availability set.</span></span>

<span data-ttu-id="1bc22-190">Pour SAP HANA sur des machines virtuelles avec des applications SAP OLTP et OLAP, la taille de machine virtuelle certifiée par SAP est GS5 avec une seule instance de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="1bc22-190">For SAP HANA on Azure virtual machines with both OLTP and OLAP SAP applications, the SAP-certified virtual machine size is GS5 with a single VM instance.</span></span> <span data-ttu-id="1bc22-191">Pour des charges de travail supérieures, Microsoft propose également de [grandes instances Azure] [ azure-large-instances] pour SAP HANA sur les serveurs physiques colocalisés dans un centre de données certifié Microsoft Azure, qui fournit actuellement jusqu’à 4 To de capacité de mémoire pour une seule instance unique.</span><span class="sxs-lookup"><span data-stu-id="1bc22-191">For larger workloads, Microsoft also offers [Azure Large Instances][azure-large-instances] for SAP HANA on physical servers co-located in a Microsoft Azure certified datacenter, which provides up to 4 TB of memory capacity for a single instance at this time.</span></span> <span data-ttu-id="1bc22-192">Une configuration à plusieurs nœuds est également possible avec une capacité totale de mémoire pouvant atteindre 32 To.</span><span class="sxs-lookup"><span data-stu-id="1bc22-192">Multi-node configuration is also possible with a total memory capacity of up to 32 TB.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="1bc22-193">Considérations relatives à la disponibilité</span><span class="sxs-lookup"><span data-stu-id="1bc22-193">Availability considerations</span></span>

<span data-ttu-id="1bc22-194">Dans cette installation distribuée de l’application SAP sur une base de données centralisée, l’installation de base est répliquée pour une haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="1bc22-194">In this distributed installation of the SAP application on a centralized database, the base installation is replicated to achieve high availability.</span></span> <span data-ttu-id="1bc22-195">Pour chaque couche de l’architecture, la conception de la haute disponibilité varie :</span><span class="sxs-lookup"><span data-stu-id="1bc22-195">For each layer of the architecture, the high availability design varies:</span></span>

- <span data-ttu-id="1bc22-196">**Répartiteur web**</span><span class="sxs-lookup"><span data-stu-id="1bc22-196">**Web Dispatcher.**</span></span> <span data-ttu-id="1bc22-197">La haute disponibilité est assurée grâce aux instances SAP Web Dispatcher redondantes avec le trafic de l’application SAP.</span><span class="sxs-lookup"><span data-stu-id="1bc22-197">High availability is achieved with redundant SAP Web Dispatcher instances with SAP application traffic.</span></span> <span data-ttu-id="1bc22-198">Consultez [SAP Web Dispatcher] [ swd] dans la Documentation SAP.</span><span class="sxs-lookup"><span data-stu-id="1bc22-198">See [SAP Web Dispatcher][swd] in the SAP Documentation.</span></span>

- <span data-ttu-id="1bc22-199">**ASC.**</span><span class="sxs-lookup"><span data-stu-id="1bc22-199">**ASCS.**</span></span> <span data-ttu-id="1bc22-200">Pour la haute disponibilité d’ASC sur les machines virtuelles Windows Azure, le Clustering de basculement Windows Server est utilisé avec SIOS DataKeeper pour implémenter le volume partagé de cluster.</span><span class="sxs-lookup"><span data-stu-id="1bc22-200">For high availability of ASCS on Azure Windows virtual machines, Windows Sever Failover Clustering is used with SIOS DataKeeper to implement the cluster shared volume.</span></span> <span data-ttu-id="1bc22-201">Pour obtenir des informations relatives à l’implémentation, consultez [Clustering SAP ASCS on Azure][clustering] (Clustering de SAP ASCS sur Azure).</span><span class="sxs-lookup"><span data-stu-id="1bc22-201">For implementation details, see [Clustering SAP ASCS on Azure][clustering].</span></span>

- <span data-ttu-id="1bc22-202">**Serveurs d’applications.**</span><span class="sxs-lookup"><span data-stu-id="1bc22-202">**Application servers.**</span></span> <span data-ttu-id="1bc22-203">La haute disponibilité est obtenue en équilibrant la charge du trafic au sein d’un pool de serveurs d’applications.</span><span class="sxs-lookup"><span data-stu-id="1bc22-203">High availability is achieved by load balancing traffic within a pool of application servers.</span></span>

- <span data-ttu-id="1bc22-204">**Couche de la base de données.**</span><span class="sxs-lookup"><span data-stu-id="1bc22-204">**Database tier.**</span></span> <span data-ttu-id="1bc22-205">Cette architecture de référence déploie une seule instance de base de données SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="1bc22-205">This reference architecture deploys a single SAP HANA database instance.</span></span> <span data-ttu-id="1bc22-206">Pour la haute disponibilité, déployez plusieurs instances et utilisez la Réplication de système HANA pour mettre en œuvre le basculement manuel.</span><span class="sxs-lookup"><span data-stu-id="1bc22-206">For high availability, deploy more than one instance and use HANA System Replication (HSR) to implement manual failover.</span></span> <span data-ttu-id="1bc22-207">Pour activer le basculement automatique, une extension à haute disponibilité pour la distribution de Linux spécifique est requise.</span><span class="sxs-lookup"><span data-stu-id="1bc22-207">To enable automatic failover, an HA extension for the specific Linux distribution is required.</span></span>

### <a name="disaster-recovery-considerations"></a><span data-ttu-id="1bc22-208">Considérations relatives à la récupération d’urgence</span><span class="sxs-lookup"><span data-stu-id="1bc22-208">Disaster recovery considerations</span></span>

<span data-ttu-id="1bc22-209">Chaque couche utilise une stratégie différente pour assurer une protection par récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="1bc22-209">Each tier uses a different strategy to provide disaster recovery (DR) protection.</span></span>

- <span data-ttu-id="1bc22-210">**Serveurs d’applications.**</span><span class="sxs-lookup"><span data-stu-id="1bc22-210">**Application servers.**</span></span> <span data-ttu-id="1bc22-211">Les serveurs d’applications SAP ne contiennent pas de données d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="1bc22-211">SAP application servers don't contain business data.</span></span> <span data-ttu-id="1bc22-212">Sur Azure, une stratégie de récupération d’urgence simple consiste à créer des serveurs d’applications SAP dans une autre région.</span><span class="sxs-lookup"><span data-stu-id="1bc22-212">On Azure, a simple DR strategy is to create SAP application servers in another region.</span></span> <span data-ttu-id="1bc22-213">En cas de modification de la configuration ou de mise à jour du noyau sur le serveur d’applications principal, les mêmes modifications doivent être copiées sur des machines virtuelles dans la zone de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="1bc22-213">Upon any configuration changes or kernel updates on the primary application server, the same changes must be copied to VMs in the DR region.</span></span> <span data-ttu-id="1bc22-214">Par exemple, les exécutables du noyau copié sur les machines virtuelles de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="1bc22-214">For example, the kernel executables copied to the DR VMs.</span></span>

- <span data-ttu-id="1bc22-215">**Services centraux SAP.**</span><span class="sxs-lookup"><span data-stu-id="1bc22-215">**SAP Central Services.**</span></span> <span data-ttu-id="1bc22-216">Ce composant de la pile d’applications SAP ne conserve également aucune donnée d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="1bc22-216">This component of the SAP application stack also doesn't persist business data.</span></span> <span data-ttu-id="1bc22-217">Vous pouvez créer une machine virtuelle dans la zone de récupération d’urgence pour exécuter le rôle SCS.</span><span class="sxs-lookup"><span data-stu-id="1bc22-217">You can build a VM in the DR region to run the SCS role.</span></span> <span data-ttu-id="1bc22-218">Le seul contenu du nœud SCS principal à synchroniser est le contenu de partage **/sapmnt**.</span><span class="sxs-lookup"><span data-stu-id="1bc22-218">The only content from the primary SCS node to synchronize is the **/sapmnt** share content.</span></span> <span data-ttu-id="1bc22-219">En outre, en cas de modification de la configuration ou de mise à jour du noyau sur les serveurs principaux SCS, celles-ci doivent être répétées sur le SCS de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="1bc22-219">Also, if configuration changes or kernel updates take place on the primary SCS servers, they must be repeated on the DR SCS.</span></span> <span data-ttu-id="1bc22-220">Pour synchroniser les deux serveurs, il suffit d’utiliser une copie planifiée régulièrement pour copier **/sapmnt** du côté de la récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="1bc22-220">To synchronize the two servers, simply use a regularly scheduled copy job to copy **/sapmnt** to the DR side.</span></span> <span data-ttu-id="1bc22-221">Pour plus d’informations sur le processus de génération, de copie et de basculement du test, téléchargez [SAP NetWeaver: Building a Hyper-V and Microsoft Azure–based Disaster Recovery Solution][sap-netweaver-dr] (SAP NetWeaver : créer une solution de récupération d’urgence basée sur Hyper-V et Microsoft Azure) et reportez-vous à la section 4.3.</span><span class="sxs-lookup"><span data-stu-id="1bc22-221">For details about the build, copy, and test failover process, download [SAP NetWeaver: Building a Hyper-V and Microsoft Azure–based Disaster Recovery Solution][sap-netweaver-dr], and refer to "4.3.</span></span> <span data-ttu-id="1bc22-222">Couche SAP SPOF (ASCS).</span><span class="sxs-lookup"><span data-stu-id="1bc22-222">SAP SPOF layer (ASCS)."</span></span>

- <span data-ttu-id="1bc22-223">**Couche de la base de données.**</span><span class="sxs-lookup"><span data-stu-id="1bc22-223">**Database tier.**</span></span> <span data-ttu-id="1bc22-224">Utilisez des solutions de réplication prises en charge par HANA, telles que la Réplication de système HANA ou la réplication du stockage.</span><span class="sxs-lookup"><span data-stu-id="1bc22-224">Use HANA-supported replication solutions such as HSR or Storage Replication.</span></span> 

## <a name="manageability-considerations"></a><span data-ttu-id="1bc22-225">Considérations relatives à la facilité de gestion</span><span class="sxs-lookup"><span data-stu-id="1bc22-225">Manageability considerations</span></span>

<span data-ttu-id="1bc22-226">SAP HANA comporte une fonctionnalité de sauvegarde qui utilise l’infrastructure Azure sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="1bc22-226">SAP HANA has a backup feature that uses the underlying Azure infrastructure.</span></span> <span data-ttu-id="1bc22-227">Lors de la sauvegarde de la base de données SAP HANA en cours d’exécution sur des machines virtuelles, les captures instantanées de SAP HANA et du stockage Azure sont utilisées pour garantir la cohérence des fichiers de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="1bc22-227">To back up the SAP HANA database running on Azure virtual machines, both the SAP HANA snapshot and Azure storage snapshot are used to ensure the consistency of backup files.</span></span> <span data-ttu-id="1bc22-228">Pour plus d’informations, consultez le [guide de sauvegarde pour SAP HANA sur les machines virtuelles Azure][hana-backup] et les [FAQ sur le service de sauvegarde Azure][backup-faq].</span><span class="sxs-lookup"><span data-stu-id="1bc22-228">For details, see [Backup guide for SAP HANA on Azure Virtual Machines][hana-backup] and the [Azure Backup service FAQ][backup-faq].</span></span>

<span data-ttu-id="1bc22-229">Azure propose plusieurs fonctions d’[analyse et de diagnostics] [ monitoring] de l’infrastructure globale.</span><span class="sxs-lookup"><span data-stu-id="1bc22-229">Azure provides several functions for [monitoring and diagnostics][monitoring] of the overall infrastructure.</span></span> <span data-ttu-id="1bc22-230">En outre, l’analyse avancée des machines virtuelles Azure (Windows ou Linux) est gérée par Azure Operations Management Suite (OMS).</span><span class="sxs-lookup"><span data-stu-id="1bc22-230">Also, enhanced monitoring of Azure virtual machines (Linux or Windows) is handled by Azure Operations Management Suite (OMS).</span></span>

<span data-ttu-id="1bc22-231">Pour assurer une analyse basée sur SAP des ressources et des performances des services de l’infrastructure SAP, utilisez l’extension d’analyse avancée SAP Azure.</span><span class="sxs-lookup"><span data-stu-id="1bc22-231">To provide SAP-based monitoring of resources and service performance of the SAP infrastructure, use the Azure SAP Enhanced Monitoring extension.</span></span> <span data-ttu-id="1bc22-232">Cette extension transmet les statistiques d’analyse Azure à l’application SAP pour les fonctions DBA Cockpit et de surveillance du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="1bc22-232">This extension feeds Azure monitoring statistics into the SAP application for operating system monitoring and DBA Cockpit functions.</span></span> 

## <a name="security-considerations"></a><span data-ttu-id="1bc22-233">Considérations relatives à la sécurité</span><span class="sxs-lookup"><span data-stu-id="1bc22-233">Security considerations</span></span>

<span data-ttu-id="1bc22-234">SAP possède son propre moteur de gestion des utilisateurs (UME) pour contrôler l’accès et l’autorisation en fonction du rôle dans l’application SAP.</span><span class="sxs-lookup"><span data-stu-id="1bc22-234">SAP has its own Users Management Engine (UME) to control role-based access and authorization within the SAP application.</span></span> <span data-ttu-id="1bc22-235">Pour plus d’informations, consultez [SAP HANA Security - An Overview][sap-security] (Sécurité SAP HANA - Présentation).</span><span class="sxs-lookup"><span data-stu-id="1bc22-235">For details, see [SAP HANA Security - An Overview][sap-security].</span></span> <span data-ttu-id="1bc22-236">(l’accès requiert un compte SAP Service Marketplace.)</span><span class="sxs-lookup"><span data-stu-id="1bc22-236">(A SAP Service Marketplace account is required for access.)</span></span>

<span data-ttu-id="1bc22-237">Les données sont sécurisées en transit et au repos à des fins de sécurité de l’infrastructure.</span><span class="sxs-lookup"><span data-stu-id="1bc22-237">For infrastructure security, data is safeguarded in transit and at rest.</span></span> <span data-ttu-id="1bc22-238">La section « Considérations de sécurité » de [SAP NetWeaver on Azure Virtual Machines (VMs) – Planning and Implementation Guide][netweaver-on-azure] (SAP NetWeaver sur les machines virtuelles Azure - Guide de planification et d’implémentation) commence à traiter la sécurité réseau.</span><span class="sxs-lookup"><span data-stu-id="1bc22-238">The “Security considerations” section of the [SAP NetWeaver on Azure Virtual Machines (VMs) – Planning and Implementation Guide][netweaver-on-azure] begins to address network security.</span></span> <span data-ttu-id="1bc22-239">Le guide spécifie également les ports réseau, que vous devez ouvrir sur les pare-feu pour autoriser la communication de l’application.</span><span class="sxs-lookup"><span data-stu-id="1bc22-239">The guide also specifies the network ports you must open on the firewalls to allow application communication.</span></span> 

<span data-ttu-id="1bc22-240">[Azure Disk Encryption][disk-encryption] permet de chiffrer des disques de machines virtuelles Windows et Linux IaaS.</span><span class="sxs-lookup"><span data-stu-id="1bc22-240">To encrypt Windows and Linux IaaS virtual machine disks, you can use [Azure Disk Encryption][disk-encryption].</span></span> <span data-ttu-id="1bc22-241">Azure Disk Encryption utilise la fonctionnalité BitLocker Windows et la fonctionnalité DM-Crypt de Linux pour fournir le chiffrement de volume du système d’exploitation et des disques de données.</span><span class="sxs-lookup"><span data-stu-id="1bc22-241">Azure Disk Encryption uses the BitLocker feature of Windows and the DM-Crypt feature of Linux to provide volume encryption for the operating system and the data disks.</span></span> <span data-ttu-id="1bc22-242">La solution fonctionne également avec Azure Key Vault, ce qui vous permet de contrôler et de gérer les clés et les secrets de chiffrement de disque dans votre abonnement Key Vault.</span><span class="sxs-lookup"><span data-stu-id="1bc22-242">The solution also works with Azure Key Vault to help you control and manage the disk-encryption keys and secrets in your Key Vault subscription.</span></span> <span data-ttu-id="1bc22-243">Les données sur les disques de vos machines virtuelles sont chiffrées au repos dans votre stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="1bc22-243">Data on the virtual machine disks are encrypted at rest in your Azure storage.</span></span>

<span data-ttu-id="1bc22-244">Pour le chiffrement des données SAP HANA au repos, nous recommandons l’utilisation de la technologie de chiffrement native SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="1bc22-244">For SAP HANA data-at-rest encryption, we recommend using the SAP HANA native encryption technology.</span></span>

> [!NOTE]
> <span data-ttu-id="1bc22-245">N’utilisez pas le chiffrement des données au repos HANA avec le chiffrement de disque Azure sur le même serveur.</span><span class="sxs-lookup"><span data-stu-id="1bc22-245">Don't use the HANA data-at-rest encryption with Azure disk encryption on the same server.</span></span>

<span data-ttu-id="1bc22-246">Envisagez d’utiliser des [groupes de sécurité réseau] [ nsg] (NSG) pour limiter le trafic entre les différents sous-réseaux du réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="1bc22-246">Consider using [network security groups][nsg] (NSGs) to restrict traffic between the various subnets in the VNet.</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="1bc22-247">Déployer la solution</span><span class="sxs-lookup"><span data-stu-id="1bc22-247">Deploy the solution</span></span> 

<span data-ttu-id="1bc22-248">Les scripts de déploiement pour cette architecture de référence sont disponibles sur [GitHub][github].</span><span class="sxs-lookup"><span data-stu-id="1bc22-248">The deployment scripts for this reference architecture are available on [GitHub][github].</span></span>


### <a name="prerequisites"></a><span data-ttu-id="1bc22-249">Prérequis
</span><span class="sxs-lookup"><span data-stu-id="1bc22-249">Prerequisites</span></span>

- <span data-ttu-id="1bc22-250">Vous devez avoir accès au centre de téléchargement de logiciels SAP pour terminer l’installation.</span><span class="sxs-lookup"><span data-stu-id="1bc22-250">You must have access to the SAP Software Download Center to complete the installation.</span></span>
 
- <span data-ttu-id="1bc22-251">Installez la dernière version d’[Azure PowerShell][azure-ps].</span><span class="sxs-lookup"><span data-stu-id="1bc22-251">Install the latest version of [Azure PowerShell][azure-ps].</span></span> 

- <span data-ttu-id="1bc22-252">Ce déploiement nécessite 51 cœurs.</span><span class="sxs-lookup"><span data-stu-id="1bc22-252">This deployment requires 51 cores.</span></span> <span data-ttu-id="1bc22-253">Avant de procéder au déploiement, vérifiez que votre abonnement dispose d’un quota suffisant pour les cœurs de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="1bc22-253">Before deploying, verify that your subscription has sufficient quota for VM cores.</span></span> <span data-ttu-id="1bc22-254">S’il est insuffisant, utilisez le portail Azure pour soumettre une demande de support afin d’obtenir un quota plus élevé.</span><span class="sxs-lookup"><span data-stu-id="1bc22-254">If not, use the Azure portal to submit a support request for more quota.</span></span>
 
- <span data-ttu-id="1bc22-255">Ce déploiement utilise une machine virtuelle de la série GS.</span><span class="sxs-lookup"><span data-stu-id="1bc22-255">This deployment uses a GS-series VM.</span></span> <span data-ttu-id="1bc22-256">Vérifiez la disponibilité de la série GS par région [ici][region-availability].</span><span class="sxs-lookup"><span data-stu-id="1bc22-256">Check the availability of the GS series per region [here][region-availability].</span></span>

- <span data-ttu-id="1bc22-257">Pour estimer le coût de ce déploiement, reportez-vous à [Calculatrice de prix Azure][azure-pricing].</span><span class="sxs-lookup"><span data-stu-id="1bc22-257">To estimate the cost of this deployment, see the [Azure Pricing Calculator][azure-pricing].</span></span> 
 
<span data-ttu-id="1bc22-258">Cette architecture de référence déploie les machines virtuelles suivantes :</span><span class="sxs-lookup"><span data-stu-id="1bc22-258">This reference architecture deploys the following VMs:</span></span>

| <span data-ttu-id="1bc22-259">Nom de la ressource</span><span class="sxs-lookup"><span data-stu-id="1bc22-259">Resource name</span></span> | <span data-ttu-id="1bc22-260">Taille de la machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="1bc22-260">VM Size</span></span> | <span data-ttu-id="1bc22-261">Objectif</span><span class="sxs-lookup"><span data-stu-id="1bc22-261">Purpose</span></span>  |
|---------------|---------|----------|
| <span data-ttu-id="1bc22-262">`ra-sapApps-scs-vm1` ... `ra-sapApps-scs-vmN`</span><span class="sxs-lookup"><span data-stu-id="1bc22-262">`ra-sapApps-scs-vm1` ... `ra-sapApps-scs-vmN`</span></span> | <span data-ttu-id="1bc22-263">DS11v2</span><span class="sxs-lookup"><span data-stu-id="1bc22-263">DS11v2</span></span> | <span data-ttu-id="1bc22-264">Services centraux SAP</span><span class="sxs-lookup"><span data-stu-id="1bc22-264">SAP Central Services</span></span> |
| <span data-ttu-id="1bc22-265">`ra-sapApps-vm1` ... `ra-sapApps-vmN`</span><span class="sxs-lookup"><span data-stu-id="1bc22-265">`ra-sapApps-vm1` ... `ra-sapApps-vmN`</span></span> | <span data-ttu-id="1bc22-266">DS11v2</span><span class="sxs-lookup"><span data-stu-id="1bc22-266">DS11v2</span></span> | <span data-ttu-id="1bc22-267">Application SAP NetWeaver</span><span class="sxs-lookup"><span data-stu-id="1bc22-267">SAP NetWeaver application</span></span> |
| <span data-ttu-id="1bc22-268">`ra-sap-wdp-vm1` ... `ra-sap-wdp-vmN`</span><span class="sxs-lookup"><span data-stu-id="1bc22-268">`ra-sap-wdp-vm1` ... `ra-sap-wdp-vmN`</span></span> | <span data-ttu-id="1bc22-269">DS11v2</span><span class="sxs-lookup"><span data-stu-id="1bc22-269">DS11v2</span></span> | <span data-ttu-id="1bc22-270">SAP Web Dispatcher</span><span class="sxs-lookup"><span data-stu-id="1bc22-270">SAP Web Dispatcher</span></span> |
| `ra-sap-data-vm1` | <span data-ttu-id="1bc22-271">GS5</span><span class="sxs-lookup"><span data-stu-id="1bc22-271">GS5</span></span> | <span data-ttu-id="1bc22-272">Instance de base de données SAP HANA</span><span class="sxs-lookup"><span data-stu-id="1bc22-272">SAP HANA database instance</span></span> |
| `ra-sap-jumpbox-vm1` | <span data-ttu-id="1bc22-273">DS1V2</span><span class="sxs-lookup"><span data-stu-id="1bc22-273">DS1V2</span></span> | <span data-ttu-id="1bc22-274">Serveur de rebond</span><span class="sxs-lookup"><span data-stu-id="1bc22-274">Jumpbox</span></span> |

<span data-ttu-id="1bc22-275">Une seule instance SAP HANA est déployée.</span><span class="sxs-lookup"><span data-stu-id="1bc22-275">A single SAP HANA instance is deployed.</span></span> <span data-ttu-id="1bc22-276">Pour les machines virtuelles de l’application, le nombre d’instances à déployer est spécifié dans les paramètres du modèle.</span><span class="sxs-lookup"><span data-stu-id="1bc22-276">For the application VMs, the number of instances to deploy is specified in the template parameters.</span></span>

### <a name="deploy-sap-infrastructure"></a><span data-ttu-id="1bc22-277">Déployer l’infrastructure SAP</span><span class="sxs-lookup"><span data-stu-id="1bc22-277">Deploy SAP infrastructure</span></span>

<span data-ttu-id="1bc22-278">Vous pouvez déployer cette architecture de manière incrémentielle ou en une seule fois.</span><span class="sxs-lookup"><span data-stu-id="1bc22-278">You can deploy this architecture incrementally or all at once.</span></span> <span data-ttu-id="1bc22-279">La première fois, nous vous recommandons un déploiement incrémentiel, afin que vous puissiez voir ce que fait chaque étape de déploiement.</span><span class="sxs-lookup"><span data-stu-id="1bc22-279">The first time, we recommend an incremental deployment, so that you can see what each deployment step does.</span></span> <span data-ttu-id="1bc22-280">Spécifiez l’incrément à l’aide d’un des paramètres de *mode* suivants.</span><span class="sxs-lookup"><span data-stu-id="1bc22-280">Specify the increment using one of the following *mode* parameters</span></span>

| <span data-ttu-id="1bc22-281">Mode</span><span class="sxs-lookup"><span data-stu-id="1bc22-281">Mode</span></span>           | <span data-ttu-id="1bc22-282">Résultat</span><span class="sxs-lookup"><span data-stu-id="1bc22-282">What it does</span></span>                                                                                                            |
|----------------|-----------------------------------------------------|
| <span data-ttu-id="1bc22-283">infrastructure</span><span class="sxs-lookup"><span data-stu-id="1bc22-283">infrastructure</span></span> | <span data-ttu-id="1bc22-284">Dépliez l’infrastructure réseau dans Azure.</span><span class="sxs-lookup"><span data-stu-id="1bc22-284">Deploys the network infrastructure in Azure.</span></span>        |
| <span data-ttu-id="1bc22-285">charge de travail</span><span class="sxs-lookup"><span data-stu-id="1bc22-285">workload</span></span>       | <span data-ttu-id="1bc22-286">Déploie les serveurs SAP sur le réseau.</span><span class="sxs-lookup"><span data-stu-id="1bc22-286">Deploys the SAP servers to the network.</span></span>             |
| <span data-ttu-id="1bc22-287">tout</span><span class="sxs-lookup"><span data-stu-id="1bc22-287">all</span></span>            | <span data-ttu-id="1bc22-288">Déploie tous les déploiements précédents.</span><span class="sxs-lookup"><span data-stu-id="1bc22-288">Deploys all the preceding deployments.</span></span>              |

<span data-ttu-id="1bc22-289">Pour déployer la solution, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="1bc22-289">To deploy the solution, perform the following steps:</span></span>

1. <span data-ttu-id="1bc22-290">Téléchargez ou clonez le [Référentiel GitHub][github] sur votre ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="1bc22-290">Download or clone the [GitHub repo][github] to your local computer.</span></span>

2. <span data-ttu-id="1bc22-291">Ouvrez une fenêtre PowerShell et accédez au dossier `/sap/sap-hana/`.</span><span class="sxs-lookup"><span data-stu-id="1bc22-291">Open a PowerShell window and navigate to the `/sap/sap-hana/` folder.</span></span>

3. <span data-ttu-id="1bc22-292">Exécutez l’applet de commande PowerShell suivant.</span><span class="sxs-lookup"><span data-stu-id="1bc22-292">Run the following PowerShell cmdlet.</span></span> <span data-ttu-id="1bc22-293">Pour `<subscription id>`, utilisez l’identifiant de votre abonnement Azure.</span><span class="sxs-lookup"><span data-stu-id="1bc22-293">For `<subscription id>`, use your Azure subscription ID.</span></span> <span data-ttu-id="1bc22-294">Pour `<location>`, spécifiez une région Azure, telle que `eastus` ou `westus`.</span><span class="sxs-lookup"><span data-stu-id="1bc22-294">For `<location>`, specify an Azure region, such as `eastus` or `westus`.</span></span> <span data-ttu-id="1bc22-295">Pour `<mode>`, spécifiez un des modes ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="1bc22-295">For `<mode>`, specify one of the modes listed above.</span></span>

    ```powershell
     .\Deploy-ReferenceArchitecture -SubscriptionId <subscription id> -Location <location> -ResourceGroupName <resource group> <mode>
    ```

4.  <span data-ttu-id="1bc22-296">Lorsque vous y êtes invité, connectez-vous à votre compte Azure.</span><span class="sxs-lookup"><span data-stu-id="1bc22-296">When prompted, log on to your Azure account.</span></span> 

<span data-ttu-id="1bc22-297">Remplir les scripts de déploiement peut prendre plusieurs heures, selon le mode que vous avez sélectionné.</span><span class="sxs-lookup"><span data-stu-id="1bc22-297">The deployment scripts can take up to several hours to complete, depending on the mode you selected.</span></span>

> [!WARNING]
> <span data-ttu-id="1bc22-298">Les fichiers de paramètres incluent un mot de passe codé en dur (`AweS0me@PW`) dans divers emplacements.</span><span class="sxs-lookup"><span data-stu-id="1bc22-298">The parameter files include a hard-coded password (`AweS0me@PW`) in various places.</span></span> <span data-ttu-id="1bc22-299">Modifiez ces valeurs avant de déployer.</span><span class="sxs-lookup"><span data-stu-id="1bc22-299">Change these values before you deploy.</span></span>
 
### <a name="configure-sap-applications-and-database"></a><span data-ttu-id="1bc22-300">Configurer la base de données et les applications SAP</span><span class="sxs-lookup"><span data-stu-id="1bc22-300">Configure SAP applications and database</span></span>

<span data-ttu-id="1bc22-301">Après avoir déployé l’infrastructure SAP, installez et configurez vos applications SAP et la base de données HANA sur les machines virtuelles comme suit.</span><span class="sxs-lookup"><span data-stu-id="1bc22-301">After deploying the SAP infrastructure, install and configure your SAP applications and HANA database on the virtual machines as follows.</span></span>

> [!NOTE]
> <span data-ttu-id="1bc22-302">Pour les instructions d’installation SAP, vous devez disposer d’un nom d’utilisateur pour le portail de support SAP et d’un mot de passe pour télécharger les [guides d’installation SAP][sap-guide].</span><span class="sxs-lookup"><span data-stu-id="1bc22-302">For SAP installation instructions, you must have a SAP Support Portal username and password to download the [SAP installation guides][sap-guide].</span></span>

1. <span data-ttu-id="1bc22-303">Connectez-vous au jumpbox (`ra-sap-jumpbox-vm1`).</span><span class="sxs-lookup"><span data-stu-id="1bc22-303">Log into the jumpbox (`ra-sap-jumpbox-vm1`).</span></span> <span data-ttu-id="1bc22-304">Vous allez utiliser le jumpbox pour vous connecter aux autres machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="1bc22-304">You will use the jumpbox to log into the other VMs.</span></span> 

2.  <span data-ttu-id="1bc22-305">Pour chaque machine virtuelle nommée `ra-sap-wdp-vm1` ... `ra-sap-wdp-vmN`, connectez-vous à la machine virtuelle, installez et configurez l’instance SAP Web Dispatcher en suivant la procédure décrite dans le wiki portant sur l’[installation du répartiteur web][sap-dispatcher-install].</span><span class="sxs-lookup"><span data-stu-id="1bc22-305">For each VM named `ra-sap-wdp-vm1` ... `ra-sap-wdp-vmN`, log into the VM, and install and configure the SAP Web Dispatcher instance using the steps described in the [Web Dispatcher Installation][sap-dispatcher-install] wiki.</span></span>

3.  <span data-ttu-id="1bc22-306">Connectez-vous à la machine virtuelle nommée `ra-sap-data-vm1`.</span><span class="sxs-lookup"><span data-stu-id="1bc22-306">Log into the VM named `ra-sap-data-vm1`.</span></span> <span data-ttu-id="1bc22-307">Installez et configurez l’instance de base de données SAP Hana à l’aide du [Guide de mise à jour et d’installation du serveur SAP HANA][hana-guide].</span><span class="sxs-lookup"><span data-stu-id="1bc22-307">Install and configure the SAP Hana Database instance using the [SAP HANA Server Installation and Update Guide][hana-guide].</span></span>

4. <span data-ttu-id="1bc22-308">Pour chaque machine virtuelle nommée `ra-sapApps-scs-vm1` ... `ra-sapApps-scs-vmN`, connectez-vous à la machine virtuelle et installez et configurez les Services centraux SAP (SCS) à l’aide des [guides d’installation SAP][sap-guide].</span><span class="sxs-lookup"><span data-stu-id="1bc22-308">For each VM named `ra-sapApps-scs-vm1` ... `ra-sapApps-scs-vmN`, log into the VM, and install and configure the SAP Central Services (SCS) using the [SAP installation guides][sap-guide].</span></span>

5.  <span data-ttu-id="1bc22-309">Pour chaque machine virtuelle nommée `ra-sapApps-vm1` ... `ra-sapApps-vmN`, connectez-vous à la machine virtuelle et installez et configurez l’application SAP NetWeaver à l’aide des [guides d’installation SAP][sap-guide].</span><span class="sxs-lookup"><span data-stu-id="1bc22-309">For each VM named `ra-sapApps-vm1` ... `ra-sapApps-vmN`, log into the VM, and install and configure the SAP NetWeaver application using the [SAP installation guides][sap-guide].</span></span>

<span data-ttu-id="1bc22-310">**_Les contributeurs de cette architecture de référence_**  &mdash; sont Rick Rainey, Ross Sponholtz et Ben Trinh</span><span class="sxs-lookup"><span data-stu-id="1bc22-310">**_Contributors to this reference architecture_** &mdash; Rick Rainey, Ross Sponholtz, Ben Trinh</span></span>

[azure-large-instances]: /azure/virtual-machines/workloads/sap/hana-overview-architecture
[azure-lb]: /azure/load-balancer/load-balancer-overview
[azure-pricing]: https://azure.microsoft.com/pricing/calculator/
[azure-ps]: /powershell/azure/overview
[backup-faq]: /azure/backup/backup-azure-backup-faq
[clustering]: https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/20/clustering-sap-ascs-instance-using-windows-server-failover-cluster-on-microsoft-azure-with-sios-datakeeper-and-azure-internal-load-balancer/
[cool-blob-storage]: /azure/storage/storage-blob-storage-tiers
[disk-encryption]: /azure/security/azure-security-disk-encryption
[github]: https://github.com/mspnp/reference-architectures/tree/master/sap/sap-hana
[hana-backup]: /azure/virtual-machines/workloads/sap/sap-hana-backup-guide
[hana-guide]: https://help.sap.com/viewer/2c1988d620e04368aa4103bf26f17727/2.0.01/en-US/7eb0167eb35e4e2885415205b8383584.html
[hybrid-networking]: ../hybrid-networking/index.md
[logon-groups]: https://wiki.scn.sap.com/wiki/display/SI/ABAP+Logon+Group+based+Load+Balancing
[managed-disks]: /azure/storage/storage-managed-disks-overview
[monitoring]: /azure/architecture/best-practices/monitoring
[multiple-vm-nics]: /azure/virtual-machines/windows/multiple-nics
[netweaver-on-azure]: /azure/virtual-machines/workloads/sap/planning-guide
[nsg]: /azure/virtual-network/virtual-networks-nsg
[region-availability]: https://azure.microsoft.com/regions/services/
[running-SAP]: https://blogs.msdn.microsoft.com/saponsqlserver/2016/06/07/sap-on-sql-general-update-for-customers-partners-june-2016/
[sap-1943937]: https://launchpad.support.sap.com/#/notes/1943937
[sap-1928533]: https://launchpad.support.sap.com/#/notes/1928533
[sap-dispatcher]: https://help.sap.com/doc/saphelp_nw73ehp1/7.31.19/en-US/48/8fe37933114e6fe10000000a421937/frameset.htm
[sap-dispatcher-ha]: https://help.sap.com/doc/saphelp_nw73ehp1/7.31.19/en-US/48/9a9a6b48c673e8e10000000a42189b/frameset.htm
[sap-dispatcher-install]: https://wiki.scn.sap.com/wiki/display/SI/Web+Dispatcher+Installation
[sap-guide]: https://service.sap.com/instguides
[sap-ha]: https://support.sap.com/content/dam/SAAP/SAP_Activate/AGS_70.pdf
[sap-hana-on-azure]: https://azure.microsoft.com/services/virtual-machines/sap-hana/
[sap-netweaver-dr]: http://download.microsoft.com/download/9/5/6/956FEDC3-702D-4EFB-A7D3-2DB7505566B6/SAP%20NetWeaver%20-%20Building%20an%20Azure%20based%20Disaster%20Recovery%20Solution%20V1_5%20.docx
[sap-security]: https://archive.sap.com/documents/docs/DOC-62943
[visio-download]: https://archcenter.blob.core.windows.net/cdn/SAP-HANA-architecture.vsdx
[vm-sizes-mem]: /azure/virtual-machines/windows/sizes-memory
[swd]: https://help.sap.com/doc/saphelp_nw70ehp2/7.02.16/en-us/48/8fe37933114e6fe10000000a421937/frameset.htm
[0]: ./images/sap-hana.png "Architecture SAP HANA à l’aide de Microsoft Azure"
