---
title: Intégration d’entreprise avec des files d’attente de messages et des événements
titleSuffix: Azure Reference Architectures
description: Architecture recommandée pour implémenter un modèle d’intégration d’entreprise avec Azure Logic Apps, Gestion des API Azure, Azure Service Bus et Azure Event Grid.
author: mattfarm
ms.reviewer: jonfan, estfan, LADocs
ms.topic: reference-architecture
ms.date: 12/03/2018
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: integration-services
ms.openlocfilehash: 4c9d2e201bcfc077990d746a1decd55ede2f220a
ms.sourcegitcommit: 1b50810208354577b00e89e5c031b774b02736e2
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/23/2019
ms.locfileid: "54480672"
---
# <a name="enterprise-integration-on-azure-using-message-queues-and-events"></a><span data-ttu-id="e9c25-103">Intégration d’entreprise sur Azure avec des files d’attente de messages et des événements</span><span class="sxs-lookup"><span data-stu-id="e9c25-103">Enterprise integration on Azure using message queues and events</span></span>

<span data-ttu-id="e9c25-104">Cette architecture de référence intègre des systèmes back-end d’entreprise, avec des files d’attente de messages et des événements, pour découpler les services et obtenir ainsi une scalabilité et une fiabilité supérieures.</span><span class="sxs-lookup"><span data-stu-id="e9c25-104">This reference architecture integrates enterprise backend systems, using message queues and events to decouple services for greater scalability and reliability.</span></span> <span data-ttu-id="e9c25-105">Les systèmes principaux peuvent inclure des systèmes SaaS (Logiciel en tant que service), des services Azure et des services web existants dans votre entreprise.</span><span class="sxs-lookup"><span data-stu-id="e9c25-105">The backend systems may include software as a service (SaaS) systems, Azure services, and existing web services in your enterprise.</span></span>

![Architecture de référence pour l’intégration d’entreprise avec des files d’attente et des événements](./_images/enterprise-integration-queues-events.png)

## <a name="architecture"></a><span data-ttu-id="e9c25-107">Architecture</span><span class="sxs-lookup"><span data-stu-id="e9c25-107">Architecture</span></span>

<span data-ttu-id="e9c25-108">L’architecture illustrée ici s’appuie sur une architecture plus simple, qui est illustrée dans [Intégration d’entreprise de base][basic-enterprise-integration].</span><span class="sxs-lookup"><span data-stu-id="e9c25-108">The architecture shown here builds on a simpler architecture that is shown in [Basic enterprise integration][basic-enterprise-integration].</span></span> <span data-ttu-id="e9c25-109">Cette architecture utilise [Logic Apps][logic-apps] pour orchestrer les workflows, et [Gestion des API][apim] pour créer des catalogues d’API.</span><span class="sxs-lookup"><span data-stu-id="e9c25-109">That architecture uses [Logic Apps][logic-apps] to orchestrate workflows and [API Management][apim] to create catalogs of APIs.</span></span>

<span data-ttu-id="e9c25-110">Cette version de l’architecture ajoute deux composants qui permettent de rendre le système plus fiable et plus scalable :</span><span class="sxs-lookup"><span data-stu-id="e9c25-110">This version of the architecture adds two components that help make the system more reliable and scalable:</span></span>

- <span data-ttu-id="e9c25-111">**[Azure Service Bus][service-bus]**.</span><span class="sxs-lookup"><span data-stu-id="e9c25-111">**[Azure Service Bus][service-bus]**.</span></span> <span data-ttu-id="e9c25-112">Service Bus est un courtier de messages sécurisé et fiable.</span><span class="sxs-lookup"><span data-stu-id="e9c25-112">Service Bus is a secure, reliable message broker.</span></span>

- <span data-ttu-id="e9c25-113">**[Azure Event Grid][event-grid]**.</span><span class="sxs-lookup"><span data-stu-id="e9c25-113">**[Azure Event Grid][event-grid]**.</span></span> <span data-ttu-id="e9c25-114">Event Grid est un service de routage d’événements.</span><span class="sxs-lookup"><span data-stu-id="e9c25-114">Event Grid is an event routing service.</span></span> <span data-ttu-id="e9c25-115">Il utilise un modèle de gestion des événements [publication/abonnement](../../patterns/publisher-subscriber.md) (pub/sub).</span><span class="sxs-lookup"><span data-stu-id="e9c25-115">It uses a [publish/subscribe](../../patterns/publisher-subscriber.md) (pub/sub) eventing model.</span></span>

<span data-ttu-id="e9c25-116">La communication asynchrone avec un courtier de messages offre plusieurs avantages par rapport aux appels synchrones, directs à des services back-end :</span><span class="sxs-lookup"><span data-stu-id="e9c25-116">Asynchronous communication using a message broker provides a number of advantages over making direct, synchronous calls to backend services:</span></span>

- <span data-ttu-id="e9c25-117">Fournit un nivellement de la charge pour gérer les pics des charges de travail avec le [Modèle de nivellement de charge basé sur une file d’attente](../../patterns/queue-based-load-leveling.md).</span><span class="sxs-lookup"><span data-stu-id="e9c25-117">Provides load-leveling to handle bursts in workloads, using the [Queue-Based Load Leveling pattern](../../patterns/queue-based-load-leveling.md).</span></span>
- <span data-ttu-id="e9c25-118">Effectue un suivi fiable de la progression des workflows à exécution longue qui impliquent plusieurs étapes ou plusieurs applications.</span><span class="sxs-lookup"><span data-stu-id="e9c25-118">Reliably tracks the progress of long-running workflows that involve multiple steps or multiple applications.</span></span>
- <span data-ttu-id="e9c25-119">Aide à découpler les applications.</span><span class="sxs-lookup"><span data-stu-id="e9c25-119">Helps to decouple applications.</span></span>
- <span data-ttu-id="e9c25-120">S’intègre à des systèmes existants basés sur les messages.</span><span class="sxs-lookup"><span data-stu-id="e9c25-120">Integrates with existing message-based systems.</span></span>
- <span data-ttu-id="e9c25-121">Permet la mise en file d’attente des travaux quand un système back-end n’est pas disponible.</span><span class="sxs-lookup"><span data-stu-id="e9c25-121">Allows work to be queued when a backend system is not available.</span></span>

<span data-ttu-id="e9c25-122">Event Grid permet aux différents composants du système de réagir aux événements au fur et à mesure qu’ils se produisent, au lieu de s’appuyer sur l’interrogation ou sur des tâches planifiées.</span><span class="sxs-lookup"><span data-stu-id="e9c25-122">Event Grid enables the various components in the system to react to events as they happen, rather than relying on polling or scheduled tasks.</span></span> <span data-ttu-id="e9c25-123">Comme avec une file d’attente de messages, il permet de découpler les applications et les services.</span><span class="sxs-lookup"><span data-stu-id="e9c25-123">As with a message queue, it helps decouple applications and services.</span></span> <span data-ttu-id="e9c25-124">Une application ou un service peut publier des événements : les abonnés intéressés en sont alors avertis.</span><span class="sxs-lookup"><span data-stu-id="e9c25-124">An application or service can publish events, and any interested subscribers will be notified.</span></span> <span data-ttu-id="e9c25-125">De nouveaux abonnés peuvent être ajoutés sans mettre à jour l’expéditeur.</span><span class="sxs-lookup"><span data-stu-id="e9c25-125">New subscribers can be added without updating the sender.</span></span>

<span data-ttu-id="e9c25-126">De nombreux services Azure prennent en charge l’envoi d’événements à Event Grid.</span><span class="sxs-lookup"><span data-stu-id="e9c25-126">Many Azure services support sending events to Event Grid.</span></span> <span data-ttu-id="e9c25-127">Par exemple, une application logique peut être à l’écoute d’un événement, par exemple quand de nouveaux fichiers sont ajoutés à un magasin d’objets blob.</span><span class="sxs-lookup"><span data-stu-id="e9c25-127">For example, a logic app can listen for an event when new files are added to a blob store.</span></span> <span data-ttu-id="e9c25-128">Ce modèle permet des workflows réactifs, où le chargement d’un fichier ou le placement d’un message dans une file d’attente lance une série de processus.</span><span class="sxs-lookup"><span data-stu-id="e9c25-128">This pattern enables reactive workflows, where uploading a file or putting a message on a queue kicks off a series of processes.</span></span> <span data-ttu-id="e9c25-129">Les processus peuvent être exécutés en parallèle ou dans une séquence spécifique.</span><span class="sxs-lookup"><span data-stu-id="e9c25-129">The processes might be executed in parallel or in a specific sequence.</span></span>

## <a name="recommendations"></a><span data-ttu-id="e9c25-130">Recommandations</span><span class="sxs-lookup"><span data-stu-id="e9c25-130">Recommendations</span></span>

<span data-ttu-id="e9c25-131">Les recommandations décrites dans [Intégration d’entreprise de base][basic-enterprise-integration] s’appliquent à cette architecture.</span><span class="sxs-lookup"><span data-stu-id="e9c25-131">The recommendations described in [Basic enterprise integration][basic-enterprise-integration] apply to this architecture.</span></span> <span data-ttu-id="e9c25-132">Les recommandations suivantes s’appliquent également :</span><span class="sxs-lookup"><span data-stu-id="e9c25-132">The following recommendations also apply:</span></span>

### <a name="service-bus"></a><span data-ttu-id="e9c25-133">Service Bus</span><span class="sxs-lookup"><span data-stu-id="e9c25-133">Service Bus</span></span>

<span data-ttu-id="e9c25-134">Service Bus a deux modes de remise, *extraction (pull)* et *envoi (push)*.</span><span class="sxs-lookup"><span data-stu-id="e9c25-134">Service Bus has two delivery modes, *pull* or *push*.</span></span> <span data-ttu-id="e9c25-135">Dans le modèle d’extraction, le récepteur interroge de façon continue pour déterminer s’il y a de nouveaux messages.</span><span class="sxs-lookup"><span data-stu-id="e9c25-135">In the pull model, the receiver continuously polls for new messages.</span></span> <span data-ttu-id="e9c25-136">L’interrogation peut être inefficace, surtout si vous avez de nombreuses files d’attente qui reçoivent chacune quelques messages, ou si l’intervalle de temps entre les messages est important.</span><span class="sxs-lookup"><span data-stu-id="e9c25-136">Polling can be inefficient, especially if you have many queues that each receive a few messages, or if there a lot of time between messages.</span></span> <span data-ttu-id="e9c25-137">Dans le modèle d’envoi, Service Bus envoie un événement via Event Grid quand il y a des nouveaux messages.</span><span class="sxs-lookup"><span data-stu-id="e9c25-137">In the push model, Service Bus sends an event through Event Grid when there are new messages.</span></span> <span data-ttu-id="e9c25-138">Le destinataire s’abonne à l’événement.</span><span class="sxs-lookup"><span data-stu-id="e9c25-138">The receiver subscribes to the event.</span></span> <span data-ttu-id="e9c25-139">Quand l’événement est déclenché, le destinataire extrait de Service Bus le lot de messages suivant.</span><span class="sxs-lookup"><span data-stu-id="e9c25-139">When the event is triggered, the receiver pulls the next batch of messages from Service Bus.</span></span>

<span data-ttu-id="e9c25-140">Quand vous créez une application logique pour consommer des messages Service Bus, nous recommandons d’utiliser le modèle d’envoi avec intégration d’Event Grid.</span><span class="sxs-lookup"><span data-stu-id="e9c25-140">When you create a logic app to consume Service Bus messages, we recommend using the push model with Event Grid integration.</span></span> <span data-ttu-id="e9c25-141">Il est souvent plus économique, car l’application logique n’a pas besoin d’interroger Service Bus.</span><span class="sxs-lookup"><span data-stu-id="e9c25-141">It's often more cost efficient, because the logic app doesn't need to poll Service Bus.</span></span> <span data-ttu-id="e9c25-142">Pour plus d’informations, consultez [Vue d’ensemble de l’intégration d’Azure Service Bus à Event Grid](/azure/service-bus-messaging/service-bus-to-event-grid-integration-concept).</span><span class="sxs-lookup"><span data-stu-id="e9c25-142">For more information, see [Azure Service Bus to Event Grid integration overview](/azure/service-bus-messaging/service-bus-to-event-grid-integration-concept).</span></span> <span data-ttu-id="e9c25-143">Actuellement, le [niveau Premium](https://azure.microsoft.com/pricing/details/service-bus/) de Service Bus est nécessaire pour les notifications Event Grid.</span><span class="sxs-lookup"><span data-stu-id="e9c25-143">Currently, Service Bus [Premium tier](https://azure.microsoft.com/pricing/details/service-bus/) is required for Event Grid notifications.</span></span>

<span data-ttu-id="e9c25-144">Utilisez [PeekLock](/azure/service-bus-messaging/service-bus-messaging-overview#queues) pour accéder à un groupe de messages.</span><span class="sxs-lookup"><span data-stu-id="e9c25-144">Use [PeekLock](/azure/service-bus-messaging/service-bus-messaging-overview#queues) for accessing a group of messages.</span></span> <span data-ttu-id="e9c25-145">Lorsque vous utilisez PeekLock, l’application logique peut suivre des étapes pour valider chaque message avant de terminer ou d’abandonner le message.</span><span class="sxs-lookup"><span data-stu-id="e9c25-145">When you use PeekLock, the logic app can perform steps to validate each message before completing or abandoning the message.</span></span> <span data-ttu-id="e9c25-146">Cette approche protège contre la perte accidentelle de messages.</span><span class="sxs-lookup"><span data-stu-id="e9c25-146">This approach protects against accidental message loss.</span></span>

### <a name="event-grid"></a><span data-ttu-id="e9c25-147">Event Grid</span><span class="sxs-lookup"><span data-stu-id="e9c25-147">Event Grid</span></span>

<span data-ttu-id="e9c25-148">Quand un déclencheur Event Grid est activé, cela signifie *qu’au moins un* événement s’est produit.</span><span class="sxs-lookup"><span data-stu-id="e9c25-148">When an Event Grid trigger fires, it means *at least one* event happened.</span></span> <span data-ttu-id="e9c25-149">Par exemple, quand une application logique reçoit un déclencheur Event Grid pour un message Service Bus, elle doit supposer que plusieurs messages peuvent être disponibles pour être traités.</span><span class="sxs-lookup"><span data-stu-id="e9c25-149">For example, when a logic app gets an Event Grid triggers for a Service Bus message, it should assume that several messages might be available to process.</span></span>

<span data-ttu-id="e9c25-150">Event Grid utilise un modèle serverless.</span><span class="sxs-lookup"><span data-stu-id="e9c25-150">Event Grid uses a serverless model.</span></span> <span data-ttu-id="e9c25-151">La facturation est calculée en fonction du nombre d’opérations (exécutions d’événement).</span><span class="sxs-lookup"><span data-stu-id="e9c25-151">Billing is calculated based on the number of operations (event executions).</span></span> <span data-ttu-id="e9c25-152">Pour plus d’informations, consultez [Prix d’Event Grid](https://azure.microsoft.com/pricing/details/event-grid/).</span><span class="sxs-lookup"><span data-stu-id="e9c25-152">For more information, see [Event Grid pricing](https://azure.microsoft.com/pricing/details/event-grid/).</span></span> <span data-ttu-id="e9c25-153">Actuellement, aucune considération relative aux niveaux ne s’applique à Event Grid.</span><span class="sxs-lookup"><span data-stu-id="e9c25-153">Currently, there are no tier considerations for Event Grid.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="e9c25-154">Considérations relatives à l’extensibilité</span><span class="sxs-lookup"><span data-stu-id="e9c25-154">Scalability considerations</span></span>

<span data-ttu-id="e9c25-155">Pour bénéficier d’une meilleure extensibilité, le niveau Premium de Service Bus peut augmenter le nombre d’unités de messagerie.</span><span class="sxs-lookup"><span data-stu-id="e9c25-155">To achieve higher scalability, the Service Bus Premium tier can scale out the number of messaging units.</span></span> <span data-ttu-id="e9c25-156">Les configurations de niveau Premium peuvent avoir une, deux ou quatre unités de messagerie.</span><span class="sxs-lookup"><span data-stu-id="e9c25-156">Premium tier configurations can have one, two, or four messaging units.</span></span> <span data-ttu-id="e9c25-157">Pour plus d’informations sur le dimensionnement de Service Bus, consultez [Bonnes pratiques relatives aux améliorations de performances à l’aide de la messagerie Service Bus](/azure/service-bus-messaging/service-bus-performance-improvements).</span><span class="sxs-lookup"><span data-stu-id="e9c25-157">For more information about scaling Service Bus, see [Best practices for performance improvements by using Service Bus Messaging](/azure/service-bus-messaging/service-bus-performance-improvements).</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="e9c25-158">Considérations relatives à la disponibilité</span><span class="sxs-lookup"><span data-stu-id="e9c25-158">Availability considerations</span></span>

<span data-ttu-id="e9c25-159">Passez en revue le contrat de niveau de service pour chaque service :</span><span class="sxs-lookup"><span data-stu-id="e9c25-159">Review the SLA for each service:</span></span>

- <span data-ttu-id="e9c25-160">[Contrat de niveau de service de Gestion des API][apim-sla]</span><span class="sxs-lookup"><span data-stu-id="e9c25-160">[API Management SLA][apim-sla]</span></span>
- <span data-ttu-id="e9c25-161">[Contrat SLA d’Event Grid][event-grid-sla]</span><span class="sxs-lookup"><span data-stu-id="e9c25-161">[Event Grid SLA][event-grid-sla]</span></span>
- <span data-ttu-id="e9c25-162">[Contrat de niveau de service de Logic Apps][logic-apps-sla]</span><span class="sxs-lookup"><span data-stu-id="e9c25-162">[Logic Apps SLA][logic-apps-sla]</span></span>
- <span data-ttu-id="e9c25-163">[Contrat SLA de Service Bus][sb-sla]</span><span class="sxs-lookup"><span data-stu-id="e9c25-163">[Service Bus SLA][sb-sla]</span></span>

<span data-ttu-id="e9c25-164">Pour permettre un basculement en cas de panne grave, envisagez d’implémenter la géo-reprise d'activité après sinistre dans Service Bus Premium.</span><span class="sxs-lookup"><span data-stu-id="e9c25-164">To enable failover if a serious outage occurs, consider implementing geo-disaster recovery in Service Bus Premium.</span></span> <span data-ttu-id="e9c25-165">Pour plus d’informations, consultez [Géo-reprise d'activité après sinistre avec Azure Service Bus](/azure/service-bus-messaging/service-bus-geo-dr).</span><span class="sxs-lookup"><span data-stu-id="e9c25-165">For more information, see [Azure Service Bus geo-disaster recovery](/azure/service-bus-messaging/service-bus-geo-dr).</span></span>

## <a name="security-considerations"></a><span data-ttu-id="e9c25-166">Considérations relatives à la sécurité</span><span class="sxs-lookup"><span data-stu-id="e9c25-166">Security considerations</span></span>

<span data-ttu-id="e9c25-167">Pour sécuriser Service Bus, utilisez une signature d’accès partagé.</span><span class="sxs-lookup"><span data-stu-id="e9c25-167">To secure Service Bus, use shared access signature (SAS).</span></span> <span data-ttu-id="e9c25-168">Par exemple, vous pouvez accorder à un utilisateur l’accès à des ressources Service Bus avec des droits spécifiques en utilisant l’[authentification SAS](/azure/service-bus-messaging/service-bus-sas).</span><span class="sxs-lookup"><span data-stu-id="e9c25-168">You can grant a user access to Service Bus resources with specific rights by using [SAS authentication](/azure/service-bus-messaging/service-bus-sas).</span></span> <span data-ttu-id="e9c25-169">Pour plus d’informations, consultez [Authentification et autorisation Service Bus](/azure/service-bus-messaging/service-bus-authentication-and-authorization).</span><span class="sxs-lookup"><span data-stu-id="e9c25-169">For more information, see [Service Bus authentication and authorization](/azure/service-bus-messaging/service-bus-authentication-and-authorization).</span></span>

<span data-ttu-id="e9c25-170">Si vous devez exposer une file d’attente Service Bus en tant que point de terminaison HTTP (pour la publication de nouveaux messages, par exemple), utilisez Gestion des API pour la sécuriser en exposant le point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="e9c25-170">If you need to expose a Service Bus queue as an HTTP endpoint, for example, to post new messages, use API Management to secure the queue by fronting the endpoint.</span></span> <span data-ttu-id="e9c25-171">Vous pouvez alors sécuriser le point de terminaison avec des certificats ou une authentification OAuth si besoin.</span><span class="sxs-lookup"><span data-stu-id="e9c25-171">You can then secure the endpoint with certificates or OAuth authentication as appropriate.</span></span> <span data-ttu-id="e9c25-172">Le moyen le plus simple de sécuriser un point de terminaison consiste à utiliser une application logique avec un déclencheur de requête/réponse HTTP comme intermédiaire.</span><span class="sxs-lookup"><span data-stu-id="e9c25-172">The easiest way to secure an endpoint is using a logic app with an HTTP request/response trigger as an intermediary.</span></span>

<span data-ttu-id="e9c25-173">Le service Event Grid sécurise la distribution des événements au moyen d’un code de validation.</span><span class="sxs-lookup"><span data-stu-id="e9c25-173">The Event Grid service secures event delivery through a validation code.</span></span> <span data-ttu-id="e9c25-174">Si vous utilisez Logic Apps pour consommer l’événement, la validation est automatiquement effectuée.</span><span class="sxs-lookup"><span data-stu-id="e9c25-174">If you use Logic Apps to consume the event, validation is automatically performed.</span></span> <span data-ttu-id="e9c25-175">Pour en savoir plus, consultez la page [Sécurité et authentification pour Event Grid](/azure/event-grid/security-authentication).</span><span class="sxs-lookup"><span data-stu-id="e9c25-175">For more information, see [Event Grid security and authentication](/azure/event-grid/security-authentication).</span></span>

[apim]: /azure/api-management
[apim-sla]: https://azure.microsoft.com/support/legal/sla/api-management/
[event-grid]: /azure/event-grid/
[event-grid-sla]: https://azure.microsoft.com/support/legal/sla/event-grid
[logic-apps]: /azure/logic-apps/logic-apps-overview
[logic-apps-sla]: https://azure.microsoft.com/support/legal/sla/logic-apps
[sb-sla]: https://azure.microsoft.com/support/legal/sla/service-bus/
[service-bus]: /azure/service-bus-messaging/
[basic-enterprise-integration]: ./basic-enterprise-integration.md
