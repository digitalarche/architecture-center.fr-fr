---
title: Style d’architecture basée sur les événements
description: Décrit les avantages, les inconvénients et les bonnes pratiques pour les architectures basées sur les événements et les architectures IoT sur Azure
author: MikeWasson
ms.date: 08/30/2018
ms.openlocfilehash: 67e823d72f1f66669a052f7ae05c13adc7e5c463
ms.sourcegitcommit: ae8a1de6f4af7a89a66a8339879843d945201f85
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/31/2018
ms.locfileid: "43326106"
---
# <a name="event-driven-architecture-style"></a><span data-ttu-id="8c1c5-103">Style d’architecture basée sur les événements</span><span class="sxs-lookup"><span data-stu-id="8c1c5-103">Event-driven architecture style</span></span>

<span data-ttu-id="8c1c5-104">Une architecture basée sur les événements est constituée de **producteurs d’événements** qui génèrent un flux d’événements et de **consommateurs d’événements** qui écoutent les événements.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-104">An event-driven architecture consists of **event producers** that generate a stream of events, and **event consumers** that listen for the events.</span></span> 

![](./images/event-driven.svg)

<span data-ttu-id="8c1c5-105">Les événements étant remis en quasi-temps réel, les consommateurs peuvent y répondre immédiatement à mesure qu’ils se produisent.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-105">Events are delivered in near real time, so consumers can respond immediately to events as they occur.</span></span> <span data-ttu-id="8c1c5-106">Les producteurs sont dissociés des consommateurs (un producteur ne peut pas identifier les consommateurs qui sont à l’écoute).</span><span class="sxs-lookup"><span data-stu-id="8c1c5-106">Producers are decoupled from consumers &mdash; a producer doesn't know which consumers are listening.</span></span> <span data-ttu-id="8c1c5-107">Les consommateurs sont aussi dissociés les uns des autres, et chaque consommateur voit tous les événements.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-107">Consumers are also decoupled from each other, and every consumer sees all of the events.</span></span> <span data-ttu-id="8c1c5-108">Il s’agit d’une différence notable par rapport au modèle des [consommateurs concurrents][competing-consumers], où les consommateurs extraient les messages d’une file d’attente et où un message est traité une seule fois (à condition qu’il n’y ait pas d’erreurs).</span><span class="sxs-lookup"><span data-stu-id="8c1c5-108">This differs from a [Competing Consumers][competing-consumers] pattern, where consumers pull messages from a queue and a message is processed just once (assuming no errors).</span></span> <span data-ttu-id="8c1c5-109">Dans certains systèmes, comme IoT, les événements doivent être ingérés dans de très gros volumes.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-109">In some systems, such as IoT, events must be ingested at very high volumes.</span></span>

<span data-ttu-id="8c1c5-110">Une architecture basée sur les événements peut utiliser un modèle de publication/abonnement ou un modèle de flux d’événements.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-110">An event driven architecture can use a pub/sub model or an event stream model.</span></span> 

- <span data-ttu-id="8c1c5-111">**Publication/abonnement** : l’infrastructure de messagerie assure le suivi des abonnements.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-111">**Pub/sub**: The messaging infrastructure keeps track of subscriptions.</span></span> <span data-ttu-id="8c1c5-112">Quand un événement est publié, elle communique l’événement à chaque abonné.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-112">When an event is published, it sends the event to each subscriber.</span></span> <span data-ttu-id="8c1c5-113">Une fois l’événement reçu, il ne peut pas être relu et les nouveaux abonnés ne le voient pas.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-113">After an event is received, it cannot be replayed, and new subscribers do not see the event.</span></span> 

- <span data-ttu-id="8c1c5-114">**Diffusion d’événements** : les événements sont écrits dans un journal.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-114">**Event streaming**: Events are written to a log.</span></span> <span data-ttu-id="8c1c5-115">Les événements sont classés dans un ordre strict (au sein d’une partition) et sont durables.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-115">Events are strictly ordered (within a partition) and durable.</span></span> <span data-ttu-id="8c1c5-116">Les clients ne s’abonnent pas au flux, mais ils peuvent lire n’importe quelle partie du flux.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-116">Clients don't subscribe to the stream, instead a client can read from any part of the stream.</span></span> <span data-ttu-id="8c1c5-117">Il revient au client d’avancer sa position dans le flux.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-117">The client is responsible for advancing its position in the stream.</span></span> <span data-ttu-id="8c1c5-118">Cela signifie qu’un client peut se joindre à tout moment et relire les événements.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-118">That means a client can join at any time, and can replay events.</span></span>

<span data-ttu-id="8c1c5-119">Du côté du consommateur, il existe quelques variantes courantes :</span><span class="sxs-lookup"><span data-stu-id="8c1c5-119">On the consumer side, there are some common variations:</span></span>

- <span data-ttu-id="8c1c5-120">**Traitement des événements simples** :</span><span class="sxs-lookup"><span data-stu-id="8c1c5-120">**Simple event processing**.</span></span> <span data-ttu-id="8c1c5-121">un événement déclenche immédiatement une action dans le consommateur.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-121">An event immediately triggers an action in the consumer.</span></span> <span data-ttu-id="8c1c5-122">Par exemple, vous pouvez utiliser Azure Functions avec un déclencheur Service Bus, de telle sorte qu’une fonction s’exécute chaque fois qu’un message est publié dans une rubrique Service Bus.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-122">For example, you could use Azure Functions with a Service Bus trigger, so that a function executes whenever a message is published to a Service Bus topic.</span></span>

- <span data-ttu-id="8c1c5-123">**Traitement des événements complexes** :</span><span class="sxs-lookup"><span data-stu-id="8c1c5-123">**Complex event processing**.</span></span> <span data-ttu-id="8c1c5-124">un consommateur traite une série d’événements, à la recherche de modèles dans les données d’événement, en s’appuyant sur une technologie telle qu’Azure Stream Analytics ou Apache Storm.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-124">A consumer processes a series of events, looking for patterns in the event data, using a technology such as Azure Stream Analytics or Apache Storm.</span></span> <span data-ttu-id="8c1c5-125">Par exemple, vous pouvez agréger les relevés d’un appareil intégré dans une fenêtre de temps et générer une notification si la moyenne mobile dépasse un certain seuil.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-125">For example, you could aggregate readings from an embedded device over a time window, and generate a notification if the moving average crosses a certain threshold.</span></span> 

- <span data-ttu-id="8c1c5-126">**Traitement des flux d’événements** :</span><span class="sxs-lookup"><span data-stu-id="8c1c5-126">**Event stream processing**.</span></span> <span data-ttu-id="8c1c5-127">utilisez une plateforme de diffusion de données, telle qu’Azure IoT Hub ou Apache Kafka, comme pipeline pour ingérer les événements et les transmettre aux processeurs de flux.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-127">Use a data streaming platform, such as Azure IoT Hub or Apache Kafka, as a pipeline to ingest events and feed them to stream processors.</span></span> <span data-ttu-id="8c1c5-128">Les processeurs de flux agissent de façon à traiter ou transformer le flux.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-128">The stream processors act to process or transform the stream.</span></span> <span data-ttu-id="8c1c5-129">Il peut exister plusieurs processeurs de flux pour différents sous-systèmes de l’application.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-129">There may be multiple stream processors for different subsystems of the application.</span></span> <span data-ttu-id="8c1c5-130">Cette approche est parfaitement adaptée aux charges de travail IoT.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-130">This approach is a good fit for IoT workloads.</span></span>

<span data-ttu-id="8c1c5-131">La source des événements peut être extérieure au système. Il peut s’agir par exemple des appareils physiques d’une solution IoT.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-131">The source of the events may be external to the system, such as physical devices in an IoT solution.</span></span> <span data-ttu-id="8c1c5-132">Dans ce cas, le système doit pouvoir ingérer les données selon le volume et le débit imposés par la source de données.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-132">In that case, the system must be able to ingest the data at the volume and throughput that is required by the data source.</span></span>

<span data-ttu-id="8c1c5-133">Dans le diagramme logique ci-dessus, chaque type de consommateur est représenté par un cadre unique.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-133">In the logical diagram above, each type of consumer is shown as a single box.</span></span> <span data-ttu-id="8c1c5-134">Dans la pratique, il est courant d’avoir plusieurs instances d’un même consommateur pour éviter que celui-ci devienne un point de défaillance unique dans le système.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-134">In practice, it's common to have multiple instances of a consumer, to avoid having the consumer become a single point of failure in system.</span></span> <span data-ttu-id="8c1c5-135">Plusieurs instances peuvent aussi s’avérer nécessaires pour gérer le volume et la fréquence des événements.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-135">Multiple instances might also be necessary to handle the volume and frequency of events.</span></span> <span data-ttu-id="8c1c5-136">De même, un même consommateur peut traiter les événements de plusieurs threads.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-136">Also, a single consumer might process events on multiple threads.</span></span> <span data-ttu-id="8c1c5-137">Cela peut être une source de problèmes si les événements doivent être traités dans l’ordre ou s’ils nécessitent une sémantique « exactly-once » (exactement une fois).</span><span class="sxs-lookup"><span data-stu-id="8c1c5-137">This can create challenges if events must be processed in order, or require exactly-once semantics.</span></span> <span data-ttu-id="8c1c5-138">Consultez [Minimiser la coordination][minimize-coordination].</span><span class="sxs-lookup"><span data-stu-id="8c1c5-138">See [Minimize Coordination][minimize-coordination].</span></span> 

## <a name="when-to-use-this-architecture"></a><span data-ttu-id="8c1c5-139">Quand utiliser cette architecture</span><span class="sxs-lookup"><span data-stu-id="8c1c5-139">When to use this architecture</span></span>

- <span data-ttu-id="8c1c5-140">Plusieurs sous-systèmes doivent traiter les mêmes événements.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-140">Multiple subsystems must process the same events.</span></span> 
- <span data-ttu-id="8c1c5-141">Traitement en temps réel avec un décalage dans le temps minimal.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-141">Real-time processing with minimum time lag.</span></span>
- <span data-ttu-id="8c1c5-142">Traitement des événements complexes, tel que les critères spéciaux ou l’agrégation dans des fenêtres de temps.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-142">Complex event processing, such as pattern matching or aggregation over time windows.</span></span>
- <span data-ttu-id="8c1c5-143">Volume et vélocité élevés des données, par exemple IoT.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-143">High volume and high velocity of data, such as IoT.</span></span>

## <a name="benefits"></a><span data-ttu-id="8c1c5-144">Avantages</span><span class="sxs-lookup"><span data-stu-id="8c1c5-144">Benefits</span></span>

- <span data-ttu-id="8c1c5-145">Les producteurs et les consommateurs sont dissociés.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-145">Producers and consumers are decoupled.</span></span>
- <span data-ttu-id="8c1c5-146">Absence d’intégrations point à point.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-146">No point-to point-integrations.</span></span> <span data-ttu-id="8c1c5-147">Simplicité d’ajout de nouveaux consommateurs au système.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-147">It's easy to add new consumers to the system.</span></span>
- <span data-ttu-id="8c1c5-148">Les consommateurs peuvent répondre immédiatement aux événements, dès leur arrivée.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-148">Consumers can respond to events immediately as they arrive.</span></span> 
- <span data-ttu-id="8c1c5-149">Architecture hautement scalable et distribuée.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-149">Highly scalable and distributed.</span></span> 
- <span data-ttu-id="8c1c5-150">Les sous-systèmes ont des vues indépendantes du flux d’événements.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-150">Subsystems have independent views of the event stream.</span></span>

## <a name="challenges"></a><span data-ttu-id="8c1c5-151">Défis</span><span class="sxs-lookup"><span data-stu-id="8c1c5-151">Challenges</span></span>

- <span data-ttu-id="8c1c5-152">Transmission non garantie.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-152">Guaranteed delivery.</span></span> <span data-ttu-id="8c1c5-153">Dans certains systèmes, surtout dans les scénarios IoT, il est essentiel de garantir la transmission des événements.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-153">In some systems, especially in IoT scenarios, it's crucial to guarantee that events are delivered.</span></span>
- <span data-ttu-id="8c1c5-154">Traitement des événements dans l’ordre ou une seule fois.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-154">Processing events in order or exactly once.</span></span> <span data-ttu-id="8c1c5-155">Chaque type de consommateur s’exécute généralement dans plusieurs instances à des fins de résilience et de scalabilité.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-155">Each consumer type typically runs in multiple instances, for resiliency and scalability.</span></span> <span data-ttu-id="8c1c5-156">Cela peut être une source de problèmes si les événements doivent être traités dans l’ordre (dans un type de consommateur) ou si la logique de traitement n’est pas idempotent.</span><span class="sxs-lookup"><span data-stu-id="8c1c5-156">This can create a challenge if the events must be processed in order (within a consumer type), or if the processing logic is not idempotent.</span></span>

 <!-- links -->

[competing-consumers]: ../../patterns/competing-consumers.md
[minimize-coordination]: ../design-principles/minimize-coordination.md


