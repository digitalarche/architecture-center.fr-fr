---
title: Identification des limites de microservice
description: Identification des limites de microservice
author: MikeWasson
ms.date: 12/08/2017
ms.openlocfilehash: e4f11da9f970724c55ad99824f808a10c4558971
ms.sourcegitcommit: 744ad1381e01bbda6a1a7eff4b25e1a337385553
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2018
---
# <a name="designing-microservices-identifying-microservice-boundaries"></a><span data-ttu-id="37ebf-103">Conception de microservices : identification des limites de microservice</span><span class="sxs-lookup"><span data-stu-id="37ebf-103">Designing microservices: Identifying microservice boundaries</span></span>

<span data-ttu-id="37ebf-104">Quelle est la taille adaptée pour un microservice ?</span><span class="sxs-lookup"><span data-stu-id="37ebf-104">What is the right size for a microservice?</span></span> <span data-ttu-id="37ebf-105">Vous entendez souvent « ni trop gros, ni trop petit » &mdash; et, bien que certainement correct, ce n’est pas très utile dans la pratique.</span><span class="sxs-lookup"><span data-stu-id="37ebf-105">You often hear something to the effect of, "not too big and not too small" &mdash; and while that's certainly correct, it's not very helpful in practice.</span></span> <span data-ttu-id="37ebf-106">Mais si vous partez d’un modèle de domaine bien conçu, il est beaucoup plus facile d’aborder les microservices.</span><span class="sxs-lookup"><span data-stu-id="37ebf-106">But if you start from a carefully designed domain model, it's much easier to reason about microservices.</span></span>

![](./images/bounded-contexts.png)

## <a name="from-domain-model-to-microservices"></a><span data-ttu-id="37ebf-107">Du modèle de domaine aux microservices</span><span class="sxs-lookup"><span data-stu-id="37ebf-107">From domain model to microservices</span></span>

<span data-ttu-id="37ebf-108">Dans le [chapitre précédent](./domain-analysis.md), nous avons défini un ensemble de contextes limités pour l’application de livraison par drone, Drone Delivery.</span><span class="sxs-lookup"><span data-stu-id="37ebf-108">In the [previous chapter](./domain-analysis.md), we defined a set of bounded contexts for the Drone Delivery application.</span></span> <span data-ttu-id="37ebf-109">Ensuite, nous avons examiné plus en détail un de ces contextes limités (celui de l’expédition) et identifié un ensemble d’entités, d’agrégats et de services de domaine pour ce contexte limité.</span><span class="sxs-lookup"><span data-stu-id="37ebf-109">Then we looked more closely at one of these bounded contexts, the Shipping bounded context, and identified a set of entities, aggregates, and domain services for that bounded context.</span></span>

<span data-ttu-id="37ebf-110">Nous sommes maintenant prêts à passer du modèle de domaine à la conception de l’application.</span><span class="sxs-lookup"><span data-stu-id="37ebf-110">Now we're ready to go from domain model to application design.</span></span> <span data-ttu-id="37ebf-111">Il s’agit d’une approche que vous pouvez utiliser pour dériver des microservices à partir du modèle de domaine.</span><span class="sxs-lookup"><span data-stu-id="37ebf-111">Here's an approach that you can use to derive microservices from the domain model.</span></span>

1. <span data-ttu-id="37ebf-112">Commencez avec un contexte limité.</span><span class="sxs-lookup"><span data-stu-id="37ebf-112">Start with a bounded context.</span></span> <span data-ttu-id="37ebf-113">En général, la fonctionnalité dans un microservice ne doit pas s’étendre à plusieurs contextes limités.</span><span class="sxs-lookup"><span data-stu-id="37ebf-113">In general, the functionality in a microservice should not span more than one bounded context.</span></span> <span data-ttu-id="37ebf-114">Par définition, un contexte limité marque la limite d’un modèle de domaine particulier.</span><span class="sxs-lookup"><span data-stu-id="37ebf-114">By definition, a bounded context marks the boundary of a particular domain model.</span></span> <span data-ttu-id="37ebf-115">S’il s’avère qu’un microservice associe des modèles de domaines différents, vous devrez peut-être revenir en arrière et affiner votre analyse de domaine.</span><span class="sxs-lookup"><span data-stu-id="37ebf-115">If you find that a microservice mixes different domain models together, that's a sign that you may need to go back and refine your domain analysis.</span></span>

2. <span data-ttu-id="37ebf-116">Ensuite, examinez les agrégats dans votre modèle de domaine.</span><span class="sxs-lookup"><span data-stu-id="37ebf-116">Next, look at the aggregates in your domain model.</span></span> <span data-ttu-id="37ebf-117">Les agrégats font souvent de bons candidats pour les microservices.</span><span class="sxs-lookup"><span data-stu-id="37ebf-117">Aggregates are often good candidates for microservices.</span></span> <span data-ttu-id="37ebf-118">Un agrégat bien conçu présente de nombreuses caractéristiques d’un microservice bien conçu. Entre autres :</span><span class="sxs-lookup"><span data-stu-id="37ebf-118">A well-designed aggregate exhibits many of the characteristics of a well-designed microservice, such as:</span></span>

    - <span data-ttu-id="37ebf-119">Un agrégat est dérivé des besoins de l’entreprise, plutôt que des problèmes techniques, tels que les accès aux données ou la messagerie.</span><span class="sxs-lookup"><span data-stu-id="37ebf-119">An aggregates is derived from business requirements, rather than technical concerns such as data access or messaging.</span></span>  
    - <span data-ttu-id="37ebf-120">Un agrégat doit avoir une cohésion fonctionnelle élevée.</span><span class="sxs-lookup"><span data-stu-id="37ebf-120">An aggregate should have high functional cohesion.</span></span>
    - <span data-ttu-id="37ebf-121">Un agrégat est une limite de persistance.</span><span class="sxs-lookup"><span data-stu-id="37ebf-121">An aggregate is a boundary of persistence.</span></span>
    - <span data-ttu-id="37ebf-122">Les agrégats doivent être couplés en laissant une marge de manœuvre.</span><span class="sxs-lookup"><span data-stu-id="37ebf-122">Aggregates should be loosely coupled.</span></span> 
    
3. <span data-ttu-id="37ebf-123">Les services de domaine font également de bons candidats pour les microservices.</span><span class="sxs-lookup"><span data-stu-id="37ebf-123">Domain services are also good candidates for microservices.</span></span> <span data-ttu-id="37ebf-124">Les services de domaine sont des opérations sans état entre plusieurs agrégats.</span><span class="sxs-lookup"><span data-stu-id="37ebf-124">Domain services are stateless operations across multiple aggregates.</span></span> <span data-ttu-id="37ebf-125">Un workflow impliquant plusieurs microservices en est un exemple type.</span><span class="sxs-lookup"><span data-stu-id="37ebf-125">A typical example is a workflow that involves several microservices.</span></span> <span data-ttu-id="37ebf-126">Nous en verrons un exemple dans l’application Drone Delivery.</span><span class="sxs-lookup"><span data-stu-id="37ebf-126">We'll see an example of this in the Drone Delivery application.</span></span>

4. <span data-ttu-id="37ebf-127">Enfin, tenez compte des exigences non fonctionnelles.</span><span class="sxs-lookup"><span data-stu-id="37ebf-127">Finally, consider non-functional requirements.</span></span> <span data-ttu-id="37ebf-128">Examinez les facteurs tels que la taille de l’équipe, les types de données, les technologies, ainsi que les exigences d’extensibilité, de disponibilité et de sécurité.</span><span class="sxs-lookup"><span data-stu-id="37ebf-128">Look at factors such as team size, data types, technologies, scalability requirements, availability requirements, and security requirements.</span></span> <span data-ttu-id="37ebf-129">Ces facteurs peuvent vous amener à décomposer un microservice en plusieurs services plus petits ou, à l’inverse, à combiner plusieurs microservices en un seul.</span><span class="sxs-lookup"><span data-stu-id="37ebf-129">These factors may lead you to further decompose a microservice into two or more smaller services, or do the opposite and combine several microservices into one.</span></span> 

<span data-ttu-id="37ebf-130">Après avoir identifié le microservices dans votre application, vérifiez la conception en vous aidant des critères suivants :</span><span class="sxs-lookup"><span data-stu-id="37ebf-130">After you identify the microservices in your application, validate your design against the following criteria:</span></span>

- <span data-ttu-id="37ebf-131">Chaque service a une seule responsabilité.</span><span class="sxs-lookup"><span data-stu-id="37ebf-131">Each service has a single responsibility.</span></span>
- <span data-ttu-id="37ebf-132">Il n’existe aucun appel bavard entre les services.</span><span class="sxs-lookup"><span data-stu-id="37ebf-132">There are no chatty calls between services.</span></span> <span data-ttu-id="37ebf-133">Si le fractionnement des fonctionnalités entre deux services entraîne trop de bavardage, cela peut indiquer que ces fonctions appartiennent au même service.</span><span class="sxs-lookup"><span data-stu-id="37ebf-133">If splitting functionality into two services causes them to be overly chatty, it may be a symptom that these functions belong in the same service.</span></span>
- <span data-ttu-id="37ebf-134">Chaque service est assez petit pour permettre à une petite équipe travaillant indépendamment de le générer.</span><span class="sxs-lookup"><span data-stu-id="37ebf-134">Each service is small enough that it can be built by a small team working independently.</span></span>
- <span data-ttu-id="37ebf-135">Il n’existe aucune interdépendance qui nécessite le déploiement de plusieurs services avec un verrouillage.</span><span class="sxs-lookup"><span data-stu-id="37ebf-135">There are no inter-dependencies that will require two or more services to be deployed in lock-step.</span></span> <span data-ttu-id="37ebf-136">Il doit toujours être possible de déployer un service sans avoir à redéployer les autres services.</span><span class="sxs-lookup"><span data-stu-id="37ebf-136">It should always be possible to deploy a service without redeploying any other services.</span></span>
- <span data-ttu-id="37ebf-137">Les services ne sont pas strictement couplés et peuvent évoluer indépendamment.</span><span class="sxs-lookup"><span data-stu-id="37ebf-137">Services are not tightly coupled, and can evolve independently.</span></span>
- <span data-ttu-id="37ebf-138">Les limites de service ne créeront pas de problèmes liés à l’intégrité ou à la cohérence des données.</span><span class="sxs-lookup"><span data-stu-id="37ebf-138">Your service boundaries will not create problems with data consistency or integrity.</span></span> <span data-ttu-id="37ebf-139">Parfois, il est important de maintenir la cohérence des données en plaçant des fonctionnalités dans un seul microservice.</span><span class="sxs-lookup"><span data-stu-id="37ebf-139">Sometimes it's important to maintain data consistency by putting functionality into a single microservice.</span></span> <span data-ttu-id="37ebf-140">Ceci dit, déterminez si vous avez vraiment besoin d’une forte cohérence.</span><span class="sxs-lookup"><span data-stu-id="37ebf-140">That said, consider whether you really need strong consistency.</span></span> <span data-ttu-id="37ebf-141">Il existe des stratégies de résolution de la cohérence éventuelle dans un système distribué, et les avantages de la décomposition des services l’emportent souvent sur les défis de gestion de la cohérence éventuelle.</span><span class="sxs-lookup"><span data-stu-id="37ebf-141">There are strategies for addressing eventual consistency in a distributed system, and the benefits of decomposing services often outweigh the challenges of managing eventual consistency.</span></span>

<span data-ttu-id="37ebf-142">Avant tout, il est important d’être pragmatique et de ne pas oublier que la conception orientée domaine est un processus itératif.</span><span class="sxs-lookup"><span data-stu-id="37ebf-142">Above all, it's important to be pragmatic, and remember that domain-driven design is an iterative process.</span></span> <span data-ttu-id="37ebf-143">En cas de doute, commencez avec des microservices généraux.</span><span class="sxs-lookup"><span data-stu-id="37ebf-143">When in doubt, start with more coarse-grained microservices.</span></span> <span data-ttu-id="37ebf-144">Il est plus facile de fractionner un microservice en deux services plus petits que de refactoriser une fonctionnalité entre plusieurs microservices existants.</span><span class="sxs-lookup"><span data-stu-id="37ebf-144">Splitting a microservice into two smaller services is easier than refactoring functionality across several existing microservices.</span></span>
  
## <a name="drone-delivery-defining-the-microservices"></a><span data-ttu-id="37ebf-145">Drone Delivery : définition des microservices</span><span class="sxs-lookup"><span data-stu-id="37ebf-145">Drone Delivery: Defining the microservices</span></span>

<span data-ttu-id="37ebf-146">Rappelez-vous que l’équipe de développement a identifié les quatre agrégats &mdash; Livraison, Colis, Drone et Compte &mdash; et deux services de domaine (le planificateur et le superviseur).</span><span class="sxs-lookup"><span data-stu-id="37ebf-146">Recall that the development team had identified the four aggregates &mdash; Delivery, Package, Drone, and Account &mdash; and two domain services, Scheduler and Supervisor.</span></span> 

<span data-ttu-id="37ebf-147">Les agrégats Livraison et Colis sont des candidats évidents pour les microservices.</span><span class="sxs-lookup"><span data-stu-id="37ebf-147">Delivery and Package are obvious candidates for microservices.</span></span> <span data-ttu-id="37ebf-148">Le planificateur et le superviseur coordonnent les activités effectuées par les autres microservices. Il est donc judicieux de mettre en œuvre ces services de domaine en tant que microservices.</span><span class="sxs-lookup"><span data-stu-id="37ebf-148">The Scheduler and Supervisor coordinate the activities performed by other microservices, so it makes sense to implement these domain services as microservices.</span></span>  

<span data-ttu-id="37ebf-149">Les agrégats Drone et Compte sont intéressants, car ils appartiennent à d’autres contextes limités.</span><span class="sxs-lookup"><span data-stu-id="37ebf-149">Drone and Account are interesting because they belong to other bounded contexts.</span></span> <span data-ttu-id="37ebf-150">Première option : le planificateur appelle directement les contextes limités Drone et Compte.</span><span class="sxs-lookup"><span data-stu-id="37ebf-150">One option is for the Scheduler to call the Drone and Account bounded contexts directly.</span></span> <span data-ttu-id="37ebf-151">Seconde option : créer des microservices Drone et Compte dans le contexte limité Expédition.</span><span class="sxs-lookup"><span data-stu-id="37ebf-151">Another option is to create Drone and Account microservices inside the Shipping bounded context.</span></span> <span data-ttu-id="37ebf-152">Ces microservices serviraient de médiateurs entre les contextes limités, en exposant des API ou des schémas de données plus adaptés au contexte Expédition.</span><span class="sxs-lookup"><span data-stu-id="37ebf-152">These microservices would mediate between the bounded contexts, by exposing APIs or data schemas that are more suited to the Shipping context.</span></span>

<span data-ttu-id="37ebf-153">Les détails des contextes limités Drone et Compte dépassent le cadre de ce guide. Nous avons donc créé des services fictifs pour eux dans notre implémentation de référence.</span><span class="sxs-lookup"><span data-stu-id="37ebf-153">The details of the Drone and Account bounded contexts are beyond the scope of this guidance, so we created mock services for them in our reference implementation.</span></span> <span data-ttu-id="37ebf-154">Mais voici quelques facteurs à prendre en compte dans cette situation :</span><span class="sxs-lookup"><span data-stu-id="37ebf-154">But here are some factors to consider in this situation:</span></span>

- <span data-ttu-id="37ebf-155">Quelle charge réseau représente un appel direct dans l’autre contexte limité ?</span><span class="sxs-lookup"><span data-stu-id="37ebf-155">What is the network overhead of calling directly into the other bounded context?</span></span> 

- <span data-ttu-id="37ebf-156">Le schéma de données pour l’autre contexte limité est-il approprié pour ce contexte, ou vaut-il mieux avoir un schéma sur mesure pour ce contexte limité ?</span><span class="sxs-lookup"><span data-stu-id="37ebf-156">Is the data schema for the other bounded context suitable for this context, or is it better to have a schema that's tailored to this bounded context?</span></span> 

- <span data-ttu-id="37ebf-157">L’autre contexte limité est-il un système hérité ?</span><span class="sxs-lookup"><span data-stu-id="37ebf-157">Is the other bounded context a legacy system?</span></span> <span data-ttu-id="37ebf-158">Dans ce cas, vous pouvez créer un service qui agit comme une [couche anti-corruption](../patterns/anti-corruption-layer.md) pour traduire entre le système hérité et l’application moderne.</span><span class="sxs-lookup"><span data-stu-id="37ebf-158">If so, you might create a service that acts as an [anti-corruption layer](../patterns/anti-corruption-layer.md) to translate between the legacy system and the modern application.</span></span> 

- <span data-ttu-id="37ebf-159">Quelle est la structure de l’équipe ?</span><span class="sxs-lookup"><span data-stu-id="37ebf-159">What is the team structure?</span></span> <span data-ttu-id="37ebf-160">Est-il facile de communiquer avec l’équipe responsable de l’autre contexte limité ?</span><span class="sxs-lookup"><span data-stu-id="37ebf-160">Is it easy to communicate with the team that's responsible for the other bounded context?</span></span> <span data-ttu-id="37ebf-161">Si ce n’est pas le cas, créez un service qui sert d’intermédiaire entre les deux contextes pour les frais de communication entre les équipes.</span><span class="sxs-lookup"><span data-stu-id="37ebf-161">If not, creating a service that mediates between the two contexts can help to mitigate the cost of cross-team communication.</span></span>

<span data-ttu-id="37ebf-162">Jusqu'à présent, nous n’avons pas considéré les exigences non fonctionnelles.</span><span class="sxs-lookup"><span data-stu-id="37ebf-162">So far, we haven't considered any non-functional requirements.</span></span> <span data-ttu-id="37ebf-163">Avec à l’esprit les exigences de débit de l’application, l’équipe de développement décidé créer un microservice Ingestion distinct qui est chargé d’ingérer les requêtes des clients.</span><span class="sxs-lookup"><span data-stu-id="37ebf-163">Thinking about the application's throughput requirements, the development team decided to create a separate Ingestion microservice that is responsible for ingesting client requests.</span></span> <span data-ttu-id="37ebf-164">Ce microservice implémentera le [nivellement de charge](../patterns/queue-based-load-leveling.md) en plaçant les requêtes entrantes dans une mémoire tampon en vue de leur traitement.</span><span class="sxs-lookup"><span data-stu-id="37ebf-164">This microservice will implement [load leveling](../patterns/queue-based-load-leveling.md) by putting incoming requests into a buffer for processing.</span></span> <span data-ttu-id="37ebf-165">Le planificateur lira les requêtes à partir de la mémoire tampon et exécutera le workflow.</span><span class="sxs-lookup"><span data-stu-id="37ebf-165">The Scheduler will read the requests from the buffer and execute the workflow.</span></span> 

<span data-ttu-id="37ebf-166">Les exigences non fonctionnelles ont conduit l’équipe à créer un service supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="37ebf-166">Non-functional requirements led the team to create one additional service.</span></span> <span data-ttu-id="37ebf-167">À ce stade, tous les services concernent le processus de planification et de livraison des colis en temps réel.</span><span class="sxs-lookup"><span data-stu-id="37ebf-167">All of the services so far have been about the process of scheduling and delivering packages in real time.</span></span> <span data-ttu-id="37ebf-168">Mais le système doit stocker l’historique de chaque livraison dans un emplacement de stockage à long terme pour l’analyse de données.</span><span class="sxs-lookup"><span data-stu-id="37ebf-168">But the system also needs to store the history of every delivery in long-term storage for data analysis.</span></span> <span data-ttu-id="37ebf-169">L’équipe a envisagé d’en donner la responsabilité au service Livraison.</span><span class="sxs-lookup"><span data-stu-id="37ebf-169">The team considered making this the responsibility of the Delivery service.</span></span> <span data-ttu-id="37ebf-170">Toutefois, les exigences de stockage de données sont très différentes pour une analyse d’historique et des opérations en cours (voir [Considérations relatives aux données](./data-considerations.md)).</span><span class="sxs-lookup"><span data-stu-id="37ebf-170">However, the data storage requirements are quite different for historical analysis versus in-flight operations (see [Data considerations](./data-considerations.md)).</span></span> <span data-ttu-id="37ebf-171">Par conséquent, l’équipe a décidé de créer un service Historique des livraisons distinct, qui écoute les événements DeliveryTracking à partir du service Livraison et les écrit dans l’emplacement de stockage à long terme.</span><span class="sxs-lookup"><span data-stu-id="37ebf-171">Therefore, the team decided to create a separate Delivery History service, which will listen for DeliveryTracking events from the Delivery service and write the events into long-term storage.</span></span>

<span data-ttu-id="37ebf-172">Le schéma suivant présente la conception à ce stade :</span><span class="sxs-lookup"><span data-stu-id="37ebf-172">The following diagram shows the design at this point:</span></span>
 
![](./images/microservices.png)

## <a name="choosing-a-compute-option"></a><span data-ttu-id="37ebf-173">Choix d'une option de calcul</span><span class="sxs-lookup"><span data-stu-id="37ebf-173">Choosing a compute option</span></span>

<span data-ttu-id="37ebf-174">Le terme *calcul* fait référence au modèle d’hébergement des ressources de calcul utilisées par votre application.</span><span class="sxs-lookup"><span data-stu-id="37ebf-174">The term *compute* refers to the hosting model for the computing resources that your application runs on.</span></span> <span data-ttu-id="37ebf-175">Pour une architecture de microservices, deux approches sont particulièrement prisées :</span><span class="sxs-lookup"><span data-stu-id="37ebf-175">For a microservices architecture, two approaches are especially popular:</span></span>

- <span data-ttu-id="37ebf-176">Orchestrateur de service qui gère les services s’exécutant sur des nœuds dédiés (machines virtuelles).</span><span class="sxs-lookup"><span data-stu-id="37ebf-176">A service orchestrator that manages services running on dedicated nodes (VMs).</span></span>
- <span data-ttu-id="37ebf-177">Architecture sans serveur utilisant des fonctions en tant que service (FaaS).</span><span class="sxs-lookup"><span data-stu-id="37ebf-177">A serverless architecture using functions as a service (FaaS).</span></span> 

<span data-ttu-id="37ebf-178">Bien qu’il ne s’agisse pas des seules options, ce sont deux approches éprouvées pour créer des microservices.</span><span class="sxs-lookup"><span data-stu-id="37ebf-178">While these aren't the only options, they are both proven approaches to building microservices.</span></span> <span data-ttu-id="37ebf-179">Une application peut inclure les deux approches.</span><span class="sxs-lookup"><span data-stu-id="37ebf-179">An application might include both approaches.</span></span>

### <a name="service-orchestrators"></a><span data-ttu-id="37ebf-180">Orchestrateurs de services</span><span class="sxs-lookup"><span data-stu-id="37ebf-180">Service orchestrators</span></span>

<span data-ttu-id="37ebf-181">Un orchestrateur gère les tâches liées au déploiement et à la gestion d’un ensemble de services.</span><span class="sxs-lookup"><span data-stu-id="37ebf-181">An orchestrator handles tasks related to deploying and managing a set of services.</span></span> <span data-ttu-id="37ebf-182">Ces tâches incluent le placement des services sur des nœuds, la surveillance de l’intégrité des services, le redémarrage des services non intègres, l’équilibrage de charge du trafic réseau entre les instances de service, la détection des services, la mise à l’échelle du nombre d’instances d’un service et l’application des mises à jour de configuration.</span><span class="sxs-lookup"><span data-stu-id="37ebf-182">These tasks include placing services on nodes, monitoring the health of services, restarting unhealthy services, load balancing network traffic across service instances, service discovery, scaling the number of instances of a service, and applying configuration updates.</span></span> <span data-ttu-id="37ebf-183">Les orchestrateurs les plus courants sont Kubernetes, DC/OS, Docker Swarm et Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="37ebf-183">Popular orchestrators include Kubernetes, DC/OS, Docker Swarm, and Service Fabric.</span></span> 

- <span data-ttu-id="37ebf-184">[Azure Container Service](/azure/container-service/) (ACS) est un service Azure qui permet de déployer un cluster Kubernetes, DC/OS ou Docker Swarm prêt pour la production.</span><span class="sxs-lookup"><span data-stu-id="37ebf-184">[Azure Container Service](/azure/container-service/) (ACS) is an Azure service that lets you deploy a production-ready Kubernetes, DC/OS, or Docker Swarm cluster.</span></span>

- <span data-ttu-id="37ebf-185">[AKS (Azure Container Service)](/azure/aks/) est un service managé Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="37ebf-185">[AKS (Azure Container Service)](/azure/aks/) is a managed Kubernetes service.</span></span> <span data-ttu-id="37ebf-186">AKS configure Kubernetes et expose les points de terminaison d’API Kubernetes, mais il héberge et gère le plan de contrôle Kubernetes, en exécutant les mises à niveau automatisées, l’application automatisée de correctifs, la mise à l’échelle automatique et d’autres tâches de gestion.</span><span class="sxs-lookup"><span data-stu-id="37ebf-186">AKS provisions Kubernetes and exposes the Kubernetes API endpoints, but hosts and manages the Kubernetes control plane, performing automated upgrades, automated patching, autoscaling, and other management tasks.</span></span> <span data-ttu-id="37ebf-187">Vous pouvez considérer AKS comme « des API Kubernetes en tant que service ».</span><span class="sxs-lookup"><span data-stu-id="37ebf-187">You can think of AKS as being "Kubernetes APIs as a service."</span></span> <span data-ttu-id="37ebf-188">Au moment de la rédaction de ce document, AKS est toujours en version préliminaire.</span><span class="sxs-lookup"><span data-stu-id="37ebf-188">At the time of writing, AKS is still in preview.</span></span> <span data-ttu-id="37ebf-189">Toutefois, AKS devrait devenir la méthode à privilégier pour exécuter Kubernetes dans Azure.</span><span class="sxs-lookup"><span data-stu-id="37ebf-189">However, it's expected that AKS will become the preferred way to run Kubernetes in Azure.</span></span> 

- <span data-ttu-id="37ebf-190">[Service Fabric](/azure/service-fabric/) est une plateforme de systèmes distribués pour le packaging, le déploiement et la gestion de microservices.</span><span class="sxs-lookup"><span data-stu-id="37ebf-190">[Service Fabric](/azure/service-fabric/) is a distributed systems platform for packaging, deploying, and managing microservices.</span></span> <span data-ttu-id="37ebf-191">Les microservices peuvent être déployés vers Service Fabric comme des conteneurs, des exécutables binaires ou des [Reliable Services](/azure/service-fabric/service-fabric-reliable-services-introduction).</span><span class="sxs-lookup"><span data-stu-id="37ebf-191">Microservices can be deployed to Service Fabric as containers, as binary executables, or as [Reliable Services](/azure/service-fabric/service-fabric-reliable-services-introduction).</span></span> <span data-ttu-id="37ebf-192">À l’aide du modèle de programmation des Reliable Services, les services peuvent directement utiliser les API de programmation Service Fabric pour interroger le système, vérifier l’intégrité, recevoir des notifications sur la configuration et les modifications de code, et détecter d’autres services.</span><span class="sxs-lookup"><span data-stu-id="37ebf-192">Using the Reliable Services programming model, services can directly use Service Fabric programming APIs to query the system, report health, receive notifications about configuration and code changes, and discover other services.</span></span> <span data-ttu-id="37ebf-193">La singularité de Service Fabric tient au fait qu’il est axé sur la création de services avec état à l’aide de [Reliable Collections](/azure/service-fabric/service-fabric-reliable-services-reliable-collections).</span><span class="sxs-lookup"><span data-stu-id="37ebf-193">A key differentiation with Service Fabric is its strong focus on building stateful services using [Reliable Collections](/azure/service-fabric/service-fabric-reliable-services-reliable-collections).</span></span>

### <a name="containers"></a><span data-ttu-id="37ebf-194">Conteneurs</span><span class="sxs-lookup"><span data-stu-id="37ebf-194">Containers</span></span>

<span data-ttu-id="37ebf-195">On fait parfois l’amalgame entre conteneurs et microservices.</span><span class="sxs-lookup"><span data-stu-id="37ebf-195">Sometimes people talk about containers and microservices as if they were the same thing.</span></span> <span data-ttu-id="37ebf-196">Or, il s’agit de deux choses différentes &mdash; vous n’avez pas besoin de conteneurs pour générer des microservices &mdash; et les conteneurs ont des avantages particulièrement intéressants pour les microservices, tels que :</span><span class="sxs-lookup"><span data-stu-id="37ebf-196">While that's not true &mdash; you don't need containers to build microservices &mdash; containers do have some benefits that are particularly relevant to microservices, such as:</span></span>

- <span data-ttu-id="37ebf-197">**Portabilité** :</span><span class="sxs-lookup"><span data-stu-id="37ebf-197">**Portability**.</span></span> <span data-ttu-id="37ebf-198">Une image de conteneur est un package autonome qui s’exécute sans nécessiter l’installation des bibliothèques ou autres dépendances.</span><span class="sxs-lookup"><span data-stu-id="37ebf-198">A container image is a standalone package that runs without needing to install libraries or other dependencies.</span></span> <span data-ttu-id="37ebf-199">Cela la rend facile à déployer.</span><span class="sxs-lookup"><span data-stu-id="37ebf-199">That makes them easy to deploy.</span></span> <span data-ttu-id="37ebf-200">Les conteneurs peuvent être démarrés et arrêtés rapidement, afin de lancer des instances pour gérer plus de charge ou pour effectuer une récupération après la défaillance d’un nœud.</span><span class="sxs-lookup"><span data-stu-id="37ebf-200">Containers can be started and stopped quickly, so you can spin up new instances to handle more load or to recover from node failures.</span></span> 

- <span data-ttu-id="37ebf-201">**Densité**.</span><span class="sxs-lookup"><span data-stu-id="37ebf-201">**Density**.</span></span> <span data-ttu-id="37ebf-202">Les conteneurs sont légers par rapport à l’exécution d’une machine virtuelle, car ils partagent les ressources du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="37ebf-202">Containers are lightweight compared with running a virtual machine, because they share OS resources.</span></span> <span data-ttu-id="37ebf-203">Cela permet de packager plusieurs conteneurs sur un seul nœud, ce qui est particulièrement utile lorsque l’application se compose de nombreux petits services.</span><span class="sxs-lookup"><span data-stu-id="37ebf-203">That makes it possible to pack multiple containers onto a single node, which is especially useful when the application consists of many small services.</span></span>

- <span data-ttu-id="37ebf-204">**Isolation des ressources**.</span><span class="sxs-lookup"><span data-stu-id="37ebf-204">**Resource isolation**.</span></span> <span data-ttu-id="37ebf-205">Vous pouvez limiter la quantité de mémoire et d’UC disponible pour un conteneur, ce qui contribue à garantir qu’un processus de perte de contrôle n’épuise pas les ressources de l’hôte.</span><span class="sxs-lookup"><span data-stu-id="37ebf-205">You can limit the amount of memory and CPU that is available to a container, which can help to ensure that a runaway process doesn't exhaust the host resources.</span></span> <span data-ttu-id="37ebf-206">Pour plus d’informations, consultez le [modèle de cloisonnement](../patterns/bulkhead.md).</span><span class="sxs-lookup"><span data-stu-id="37ebf-206">See the [Bulkhead Pattern](../patterns/bulkhead.md) for more information.</span></span>

### <a name="serverless-functions-as-a-service"></a><span data-ttu-id="37ebf-207">Sans serveur (fonctions en tant que service)</span><span class="sxs-lookup"><span data-stu-id="37ebf-207">Serverless (Functions as a Service)</span></span>

<span data-ttu-id="37ebf-208">Avec une architecture sans serveur, vous ne gérez ni les machines virtuelles, ni l’infrastructure de réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="37ebf-208">With a serverless architecture, you don't manage the VMs or the virtual network infrastructure.</span></span> <span data-ttu-id="37ebf-209">Par contre, vous déployez le code et le service d’hébergement se charge de placer ce code sur une machine virtuelle et de l’exécuter.</span><span class="sxs-lookup"><span data-stu-id="37ebf-209">Instead, you deploy code and the hosting service handles putting that code onto a VM and executing it.</span></span> <span data-ttu-id="37ebf-210">Cette approche a tendance à favoriser les petites fonctions granulaires coordonnées à l’aide de déclencheurs d’événements.</span><span class="sxs-lookup"><span data-stu-id="37ebf-210">This approach tends to favor small granular functions that are coordinated using event-based triggers.</span></span> <span data-ttu-id="37ebf-211">Par exemple, un message placé dans une file d’attente peut déclencher une fonction qui lit le contenu de la file d’attente et traite le message.</span><span class="sxs-lookup"><span data-stu-id="37ebf-211">For example, a message being placed onto a queue might trigger a function that reads from the queue and processes the message.</span></span>

<span data-ttu-id="37ebf-212">[Azure Functions][functions] est un service de calcul sans serveur qui prend en charge plusieurs déclencheurs de fonction, y compris les requêtes HTTP, les files d’attente Service Bus et les événements Event Hubs.</span><span class="sxs-lookup"><span data-stu-id="37ebf-212">[Azure Functions][functions] is a serverless compute service that supports various function triggers, including HTTP requests, Service Bus queues, and Event Hubs events.</span></span> <span data-ttu-id="37ebf-213">Pour obtenir la liste complète, voir [Concepts des déclencheurs et liaisons Azure Functions][functions-triggers].</span><span class="sxs-lookup"><span data-stu-id="37ebf-213">For a complete list, see [Azure Functions triggers and bindings concepts][functions-triggers].</span></span> <span data-ttu-id="37ebf-214">Envisagez également [Azure Event Grid][event-grid], un service de routage d’événement managé dans Azure.</span><span class="sxs-lookup"><span data-stu-id="37ebf-214">Also consider [Azure Event Grid][event-grid], which is a managed event routing service in Azure.</span></span>

### <a name="orchestrator-or-serverless"></a><span data-ttu-id="37ebf-215">Orchestrateur ou sans serveur ?</span><span class="sxs-lookup"><span data-stu-id="37ebf-215">Orchestrator or serverless?</span></span>

<span data-ttu-id="37ebf-216">Voici quelques éléments à prendre en compte lors du choix entre une approche d’orchestrateur et une approche sans serveur.</span><span class="sxs-lookup"><span data-stu-id="37ebf-216">Here are some factors to consider when choosing between an orchestrator approach and a serverless approach.</span></span>

<span data-ttu-id="37ebf-217">**Facilité de gestion** : une application sans serveur est facile à gérer, car la plate-forme gère toutes les ressources de calcul à votre place.</span><span class="sxs-lookup"><span data-stu-id="37ebf-217">**Manageability** A serverless application is easy to manage, because the platform manages all the of compute resources for you.</span></span> <span data-ttu-id="37ebf-218">Alors qu’un orchestrateur rend abstraits certains aspects de la gestion et de la configuration d’un cluster, il ne masque pas complètement les machines virtuelles sous-jacentes.</span><span class="sxs-lookup"><span data-stu-id="37ebf-218">While an orchestrator abstracts some aspects of managing and configuring a cluster, it does not completely hide the underlying VMs.</span></span> <span data-ttu-id="37ebf-219">Avec un orchestrateur, vous devez envisager des problèmes tels que l’équilibrage de charge, l’utilisation de l’UC et de la mémoire, et la mise en réseau.</span><span class="sxs-lookup"><span data-stu-id="37ebf-219">With an orchestrator, you will need to think about issues such as load balancing, CPU and memory usage, and networking.</span></span>

<span data-ttu-id="37ebf-220">**Flexibilité et contrôle** :</span><span class="sxs-lookup"><span data-stu-id="37ebf-220">**Flexibility and control**.</span></span> <span data-ttu-id="37ebf-221">un orchestrateur vous donne un grand contrôle sur la configuration et la gestion de vos services et du cluster.</span><span class="sxs-lookup"><span data-stu-id="37ebf-221">An orchestrator gives you a great deal of control over configuring and managing your services and the cluster.</span></span> <span data-ttu-id="37ebf-222">L’inconvénient est la complexité accrue.</span><span class="sxs-lookup"><span data-stu-id="37ebf-222">The tradeoff is additional complexity.</span></span> <span data-ttu-id="37ebf-223">Avec une architecture sans serveur, vous perdez en contrôle, car ces détails sont rendus abstraits.</span><span class="sxs-lookup"><span data-stu-id="37ebf-223">With a serverless architecture, you give up some degree of control because these details are abstracted.</span></span>

<span data-ttu-id="37ebf-224">**Portabilité** :</span><span class="sxs-lookup"><span data-stu-id="37ebf-224">**Portability**.</span></span> <span data-ttu-id="37ebf-225">tous les orchestrateurs répertoriés ici (Kubernetes, DC/OS, Docker Swarm et Service Fabric) peuvent s’exécuter localement ou dans plusieurs clouds publics.</span><span class="sxs-lookup"><span data-stu-id="37ebf-225">All of the orchestrators listed here (Kubernetes, DC/OS, Docker Swarm, and Service Fabric) can run on-premises or in multiple public clouds.</span></span> 

<span data-ttu-id="37ebf-226">**Intégration d’application** :</span><span class="sxs-lookup"><span data-stu-id="37ebf-226">**Application integration**.</span></span> <span data-ttu-id="37ebf-227">il peut être difficile de créer une application complexe à l’aide d’une architecture sans serveur.</span><span class="sxs-lookup"><span data-stu-id="37ebf-227">It can be challenging to build a complex application using a serverless architecture.</span></span> <span data-ttu-id="37ebf-228">Une option dans Azure consiste à utiliser [Azure Logic Apps](/azure/logic-apps/) pour coordonner un ensemble de fonctions Azure.</span><span class="sxs-lookup"><span data-stu-id="37ebf-228">One option in Azure is to use [Azure Logic Apps](/azure/logic-apps/) to coordinate a set of Azure Functions.</span></span> <span data-ttu-id="37ebf-229">Pour obtenir un exemple de cette approche, consultez [Créer une fonction qui s’intègre avec Azure Logic Apps](/azure/azure-functions/functions-twitter-email).</span><span class="sxs-lookup"><span data-stu-id="37ebf-229">For an example of this approach, see [Create a function that integrates with Azure Logic Apps](/azure/azure-functions/functions-twitter-email).</span></span>

<span data-ttu-id="37ebf-230">**Coût** :</span><span class="sxs-lookup"><span data-stu-id="37ebf-230">**Cost**.</span></span> <span data-ttu-id="37ebf-231">avec un orchestrateur, vous payez pour les machines virtuelles qui s’exécutent dans le cluster.</span><span class="sxs-lookup"><span data-stu-id="37ebf-231">With an orchestrator, you pay for the VMs that are running in the cluster.</span></span> <span data-ttu-id="37ebf-232">Avec une application sans serveur, vous payez uniquement pour les ressources de calcul réellement consommées.</span><span class="sxs-lookup"><span data-stu-id="37ebf-232">With a serverless application, you pay only for the actual compute resources consumed.</span></span> <span data-ttu-id="37ebf-233">Dans les deux cas, vous devez tenir compte du coût des services supplémentaires, tels que le stockage, les bases de données et les services de messagerie.</span><span class="sxs-lookup"><span data-stu-id="37ebf-233">In both cases, you need to factor in the cost of any additional services, such as storage, databases, and messaging services.</span></span>

<span data-ttu-id="37ebf-234">**Extensibilité**.</span><span class="sxs-lookup"><span data-stu-id="37ebf-234">**Scalability**.</span></span> <span data-ttu-id="37ebf-235">Azure Functions est automatiquement mis à l’échelle afin de répondre à la demande, en fonction du nombre d’événements entrants.</span><span class="sxs-lookup"><span data-stu-id="37ebf-235">Azure Functions scales automatically to meet demand, based on the number of incoming events.</span></span> <span data-ttu-id="37ebf-236">Avec un orchestrateur, vous pouvez augmenter le nombre d’instances de service en cours d’exécution dans le cluster.</span><span class="sxs-lookup"><span data-stu-id="37ebf-236">With an orchestrator, you can scale out by increasing the number of service instances running in the cluster.</span></span> <span data-ttu-id="37ebf-237">Vous pouvez également effectuer une mise à l’échelle en ajoutant des machines virtuelles au cluster.</span><span class="sxs-lookup"><span data-stu-id="37ebf-237">You can also scale by adding additional VMs to the cluster.</span></span>

<span data-ttu-id="37ebf-238">Notre implémentation de référence utilise principalement Kubernetes, mais nous avons utilisé Azure Functions pour un service, à savoir le service Historique des livraisons.</span><span class="sxs-lookup"><span data-stu-id="37ebf-238">Our reference implementation primarily uses Kubernetes, but we did use Azure Functions for one service, namely the Delivery History service.</span></span> <span data-ttu-id="37ebf-239">Azure Functions est bien adapté à ce service particulier, car il s’agit d’une charge de travail pilotée par des événements.</span><span class="sxs-lookup"><span data-stu-id="37ebf-239">Azure Functions was a good fit for this particular service, because it's is an event-driven workload.</span></span> <span data-ttu-id="37ebf-240">En utilisant un déclencheur Event Hubs pour appeler la fonction, le service avait besoin d’une quantité minimale de code.</span><span class="sxs-lookup"><span data-stu-id="37ebf-240">By using an Event Hubs trigger to invoke the function, the service needed a minimal amount of code.</span></span> <span data-ttu-id="37ebf-241">En outre, le service Historique des livraisons ne fait pas partie du workflow principal. Son exécution en dehors du cluster Kubernetes n’a donc aucune incidence sur la latence de bout en bout des opérations initiées par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="37ebf-241">Also, the Delivery History service is not part of the main workflow, so running it outside of the Kubernetes cluster doesn't affect the end-to-end latency of user-initiated operations.</span></span> 

> [!div class="nextstepaction"]
> [<span data-ttu-id="37ebf-242">Considérations sur les données</span><span class="sxs-lookup"><span data-stu-id="37ebf-242">Data considerations</span></span>](./data-considerations.md)

<!-- links -->

[acs-engine]: https://github.com/Azure/acs-engine
[acs-faq]: /azure/container-service/dcos-swarm/container-service-faq
[event-grid]: /azure/event-grid/
[functions]: /azure/azure-functions/functions-overview
[functions-triggers]: /azure/azure-functions/functions-triggers-bindings
