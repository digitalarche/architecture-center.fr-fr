---
title: Exécuter une batterie de serveurs SharePoint Server 2016 hautement disponible dans Azure
titleSuffix: Azure Reference Architectures
description: Architecture recommandée pour déployer une batterie de serveurs SharePoint Server 2016 à haute disponibilité sur Azure.
author: njray
ms.date: 07/26/2018
ms.topic: reference-architecture
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: seodec18
ms.openlocfilehash: 0cce207dedd0eb42e29a152b3bb84acc2dca323a
ms.sourcegitcommit: c053e6edb429299a0ad9b327888d596c48859d4a
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/20/2019
ms.locfileid: "58344986"
---
# <a name="run-a-highly-available-sharepoint-server-2016-farm-in-azure"></a><span data-ttu-id="d0b47-103">Exécuter une batterie de serveurs SharePoint Server 2016 hautement disponible dans Azure</span><span class="sxs-lookup"><span data-stu-id="d0b47-103">Run a highly available SharePoint Server 2016 farm in Azure</span></span>

<span data-ttu-id="d0b47-104">Cette architecture de référence présente des pratiques éprouvées pour déployer une batterie de serveurs SharePoint Server 2016 hautement disponible sur Azure à l’aide de la topologie MinRole et de groupes de disponibilité Always On SQL Server.</span><span class="sxs-lookup"><span data-stu-id="d0b47-104">This reference architecture shows proven practices for deploying a highly available SharePoint Server 2016 farm on Azure, using MinRole topology and SQL Server Always On availability groups.</span></span> <span data-ttu-id="d0b47-105">La batterie de serveurs SharePoint est déployée dans un réseau virtuel sécurisé sans aucun point de terminaison ou présence exposé à Internet.</span><span class="sxs-lookup"><span data-stu-id="d0b47-105">The SharePoint farm is deployed in a secured virtual network with no Internet-facing endpoint or presence.</span></span> <span data-ttu-id="d0b47-106">[**Déployez cette solution**](#deploy-the-solution).</span><span class="sxs-lookup"><span data-stu-id="d0b47-106">[**Deploy this solution**](#deploy-the-solution).</span></span>

![Architecture de référence d’une batterie de serveurs SharePoint Server 2016 hautement disponible dans Azure](./images/sharepoint-ha.png)

<span data-ttu-id="d0b47-108">*Téléchargez un [fichier Visio][visio-download] de cette architecture.*</span><span class="sxs-lookup"><span data-stu-id="d0b47-108">*Download a [Visio file][visio-download] of this architecture.*</span></span>

## <a name="architecture"></a><span data-ttu-id="d0b47-109">Architecture</span><span class="sxs-lookup"><span data-stu-id="d0b47-109">Architecture</span></span>

<span data-ttu-id="d0b47-110">Cette architecture repose sur celle décrite dans l’article [Exécuter des machines virtuelles Windows pour une application multiniveau][windows-n-tier].</span><span class="sxs-lookup"><span data-stu-id="d0b47-110">This architecture builds on the one shown in [Run Windows VMs for an N-tier application][windows-n-tier].</span></span> <span data-ttu-id="d0b47-111">Elle déploie une batterie de serveurs SharePoint Server 2016 à haute disponibilité dans un réseau virtuel Azure (VNet).</span><span class="sxs-lookup"><span data-stu-id="d0b47-111">It deploys a SharePoint Server 2016 farm with high availability inside an Azure virtual network (VNet).</span></span> <span data-ttu-id="d0b47-112">Cette architecture est adaptée à un environnement de test ou de production, une infrastructure hybride de SharePoint avec Office 365, ou comme base pour un scénario de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="d0b47-112">This architecture is suitable for a test or production environment, a SharePoint hybrid infrastructure with Office 365, or as the basis for a disaster recovery scenario.</span></span>

<span data-ttu-id="d0b47-113">L’architecture est constituée des composants suivants :</span><span class="sxs-lookup"><span data-stu-id="d0b47-113">The architecture consists of the following components:</span></span>

- <span data-ttu-id="d0b47-114">**Groupe de ressources**.</span><span class="sxs-lookup"><span data-stu-id="d0b47-114">**Resource groups**.</span></span> <span data-ttu-id="d0b47-115">Un [groupe de ressources][resource-group] est un conteneur qui héberge les ressources Azure associées.</span><span class="sxs-lookup"><span data-stu-id="d0b47-115">A [resource group][resource-group] is a container that holds related Azure resources.</span></span> <span data-ttu-id="d0b47-116">Un groupe de ressources est utilisé pour les serveurs SharePoint et un autre groupe de ressources est utilisé pour les composants d’infrastructure qui sont indépendants des machines virtuelles, tels que le réseau virtuel et les équilibreurs de charge.</span><span class="sxs-lookup"><span data-stu-id="d0b47-116">One resource group is used for the SharePoint servers, and another resource group is used for infrastructure components that are independent of VMs, such as the virtual network and load balancers.</span></span>

- <span data-ttu-id="d0b47-117">**Réseau virtuel**.</span><span class="sxs-lookup"><span data-stu-id="d0b47-117">**Virtual network (VNet)**.</span></span> <span data-ttu-id="d0b47-118">Les ordinateurs virtuels sont déployés dans un réseau virtuel avec un espace d’adressage intranet unique.</span><span class="sxs-lookup"><span data-stu-id="d0b47-118">The VMs are deployed in a VNet with a unique intranet address space.</span></span> <span data-ttu-id="d0b47-119">Le réseau virtuel est en outre subdivisé en sous-réseaux.</span><span class="sxs-lookup"><span data-stu-id="d0b47-119">The VNet is further subdivided into subnets.</span></span>

- <span data-ttu-id="d0b47-120">**Machines virtuelles (VM)**.</span><span class="sxs-lookup"><span data-stu-id="d0b47-120">**Virtual machines (VMs)**.</span></span> <span data-ttu-id="d0b47-121">Les machines virtuelles sont déployées dans le réseau virtuel, les adresses IP statiques privées sont affectées à toutes les machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="d0b47-121">The VMs are deployed into the VNet, and private static IP addresses are assigned to all of the VMs.</span></span> <span data-ttu-id="d0b47-122">Les adresses IP statiques sont recommandées pour les machines virtuelles exécutant SQL Server et SharePoint Server 2016, afin d’éviter les problèmes liés à la mise en cache des adresses IP et les changements d’adresses après un redémarrage.</span><span class="sxs-lookup"><span data-stu-id="d0b47-122">Static IP addresses are recommended for the VMs running SQL Server and SharePoint Server 2016, to avoid issues with IP address caching and changes of addresses after a restart.</span></span>

- <span data-ttu-id="d0b47-123">**Groupes à haute disponibilité**.</span><span class="sxs-lookup"><span data-stu-id="d0b47-123">**Availability sets**.</span></span> <span data-ttu-id="d0b47-124">Placez les machines virtuelles pour chaque rôle SharePoint dans différents [groupes à haute disponibilité][availability-set] et configurez au moins deux machines virtuelles (VM) pour chaque rôle.</span><span class="sxs-lookup"><span data-stu-id="d0b47-124">Place the VMs for each SharePoint role into separate [availability sets][availability-set], and provision at least two virtual machines (VMs) for each role.</span></span> <span data-ttu-id="d0b47-125">Cela rend les machines virtuelles éligibles à un contrat de niveau de service (SLA) plus élevé.</span><span class="sxs-lookup"><span data-stu-id="d0b47-125">This makes the VMs eligible for a higher service level agreement (SLA).</span></span>

- <span data-ttu-id="d0b47-126">**Équilibreur de charge interne**.</span><span class="sxs-lookup"><span data-stu-id="d0b47-126">**Internal load balancer**.</span></span> <span data-ttu-id="d0b47-127">L’[équilibrage de charge][load-balancer] distribue le trafic de requête SharePoint du réseau local aux serveurs web frontaux de la batterie de serveurs SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d0b47-127">The [load balancer][load-balancer] distributes SharePoint request traffic from the on-premises network to the front-end web servers of the SharePoint farm.</span></span>

- <span data-ttu-id="d0b47-128">**Groupes de sécurité réseau (NSG)**.</span><span class="sxs-lookup"><span data-stu-id="d0b47-128">**Network security groups (NSGs)**.</span></span> <span data-ttu-id="d0b47-129">Pour chaque sous-réseau contenant des ordinateurs virtuels, un [groupe de sécurité réseau][nsg] est créé.</span><span class="sxs-lookup"><span data-stu-id="d0b47-129">For each subnet that contains virtual machines, a [network security group][nsg] is created.</span></span> <span data-ttu-id="d0b47-130">Utilisez les groupes de sécurité réseau pour limiter le trafic au sein du réseau virtuel, afin d’isoler les sous-réseaux.</span><span class="sxs-lookup"><span data-stu-id="d0b47-130">Use NSGs to restrict network traffic within the VNet, in order to isolate subnets.</span></span>

- <span data-ttu-id="d0b47-131">**Passerelle**.</span><span class="sxs-lookup"><span data-stu-id="d0b47-131">**Gateway**.</span></span> <span data-ttu-id="d0b47-132">La passerelle fournit une connexion entre votre réseau local et le réseau virtuel Azure.</span><span class="sxs-lookup"><span data-stu-id="d0b47-132">The gateway provides a connection between your on-premises network and the Azure virtual network.</span></span> <span data-ttu-id="d0b47-133">Votre connexion peut utiliser une passerelle ExpressRoute ou VPN de site à site.</span><span class="sxs-lookup"><span data-stu-id="d0b47-133">Your connection can use ExpressRoute or site-to-site VPN.</span></span> <span data-ttu-id="d0b47-134">Pour plus d’informations, consultez la section [Connecter un réseau local à Azure][hybrid-ra].</span><span class="sxs-lookup"><span data-stu-id="d0b47-134">For more information, see [Connect an on-premises network to Azure][hybrid-ra].</span></span>

- <span data-ttu-id="d0b47-135">**Contrôleurs de domaine Windows Server Active Directory (AD)**.</span><span class="sxs-lookup"><span data-stu-id="d0b47-135">**Windows Server Active Directory (AD) domain controllers**.</span></span> <span data-ttu-id="d0b47-136">Cette architecture de référence déploie des contrôleurs de domaine Windows Server AD.</span><span class="sxs-lookup"><span data-stu-id="d0b47-136">This reference architecture deploys Windows Server AD domain controllers.</span></span> <span data-ttu-id="d0b47-137">Ces contrôleurs de domaine s’exécutent dans le réseau virtuel Azure et ont une relation d’approbation avec la forêt locale Windows Server Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d0b47-137">These domain controllers run in the Azure VNet and have a trust relationship with the on-premises Windows Server AD forest.</span></span> <span data-ttu-id="d0b47-138">Les requêtes web des clients pour les ressources de la batterie de serveurs SharePoint sont authentifiées sur le réseau virtuel, au lieu d’envoyer le trafic d’authentification via la connexion de passerelle vers le réseau local.</span><span class="sxs-lookup"><span data-stu-id="d0b47-138">Client web requests for SharePoint farm resources are authenticated in the VNet rather than sending that authentication traffic across the gateway connection to the on-premises network.</span></span> <span data-ttu-id="d0b47-139">Des enregistrements sont créés dans DNS, intranet A ou CNAME, afin que les utilisateurs de l’intranet puissent résoudre le nom de la batterie de serveurs SharePoint à l’adresse IP privée de l’équilibreur de charge interne.</span><span class="sxs-lookup"><span data-stu-id="d0b47-139">In DNS, intranet A or CNAME records are created so that intranet users can resolve the name of the SharePoint farm to the private IP address of the internal load balancer.</span></span>

  <span data-ttu-id="d0b47-140">SharePoint Server 2016 prend également en charge l’utilisation de [Microsoft Azure Active Directory Domain Services](/azure/active-directory-domain-services/).</span><span class="sxs-lookup"><span data-stu-id="d0b47-140">SharePoint Server 2016 also supports using [Azure Active Directory Domain Services](/azure/active-directory-domain-services/).</span></span> <span data-ttu-id="d0b47-141">Microsoft Azure AD Domain Services fournit des services de domaine managé, afin que vous n’ayez pas besoin de déployer et de gérer les contrôleurs de domaine dans Azure.</span><span class="sxs-lookup"><span data-stu-id="d0b47-141">Azure AD Domain Services provides managed domain services, so that you don't need to deploy and manage domain controllers in Azure.</span></span>

- <span data-ttu-id="d0b47-142">**Groupe de disponibilité SQL Server Always On**.</span><span class="sxs-lookup"><span data-stu-id="d0b47-142">**SQL Server Always On Availability Group**.</span></span> <span data-ttu-id="d0b47-143">Pour obtenir une haute disponibilité de la base de données SQL Server, nous vous recommandons les [groupes de disponibilité SQL Server Always On][sql-always-on].</span><span class="sxs-lookup"><span data-stu-id="d0b47-143">For high availability of the SQL Server database, we recommend [SQL Server Always On Availability Groups][sql-always-on].</span></span> <span data-ttu-id="d0b47-144">Deux machines virtuelles sont utilisées pour SQL Server.</span><span class="sxs-lookup"><span data-stu-id="d0b47-144">Two virtual machines are used for SQL Server.</span></span> <span data-ttu-id="d0b47-145">L’une contient le réplica de base de données primaire et l’autre le réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="d0b47-145">One contains the primary database replica and the other contains the secondary replica.</span></span>

- <span data-ttu-id="d0b47-146">**Machine virtuelle du nœud majoritaire**.</span><span class="sxs-lookup"><span data-stu-id="d0b47-146">**Majority node VM**.</span></span> <span data-ttu-id="d0b47-147">Cette machine virtuelle permet au cluster de basculement d’établir le quorum.</span><span class="sxs-lookup"><span data-stu-id="d0b47-147">This VM allows the failover cluster to establish quorum.</span></span> <span data-ttu-id="d0b47-148">Pour plus d’informations, consultez l’article [Présentation des configurations de quorum dans un cluster de basculement][sql-quorum].</span><span class="sxs-lookup"><span data-stu-id="d0b47-148">For more information, see [Understanding Quorum Configurations in a Failover Cluster][sql-quorum].</span></span>

- <span data-ttu-id="d0b47-149">**Serveurs SharePoint**.</span><span class="sxs-lookup"><span data-stu-id="d0b47-149">**SharePoint servers**.</span></span> <span data-ttu-id="d0b47-150">Les serveurs SharePoint effectuent le service web frontal, la mise en cache, l’application et la recherche des rôles.</span><span class="sxs-lookup"><span data-stu-id="d0b47-150">The SharePoint servers perform the web front-end, caching, application, and search roles.</span></span>

- <span data-ttu-id="d0b47-151">**Jumpbox**.</span><span class="sxs-lookup"><span data-stu-id="d0b47-151">**Jumpbox**.</span></span> <span data-ttu-id="d0b47-152">Également appelée [hôte bastion][bastion-host].</span><span class="sxs-lookup"><span data-stu-id="d0b47-152">Also called a [bastion host][bastion-host].</span></span> <span data-ttu-id="d0b47-153">Il s’agit d’une machine virtuelle sécurisée sur le réseau, utilisée par les administrateurs pour se connecter aux autres machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="d0b47-153">This is a secure VM on the network that administrators use to connect to the other VMs.</span></span> <span data-ttu-id="d0b47-154">La jumpbox a un groupe de sécurité réseau qui autorise le trafic distant provenant uniquement d’adresses IP publiques figurant sur une liste verte.</span><span class="sxs-lookup"><span data-stu-id="d0b47-154">The jumpbox has an NSG that allows remote traffic only from public IP addresses on a safe list.</span></span> <span data-ttu-id="d0b47-155">Le groupe de sécurité réseau doit autoriser le trafic RDP (Bureau à distance).</span><span class="sxs-lookup"><span data-stu-id="d0b47-155">The NSG should permit remote desktop (RDP) traffic.</span></span>

## <a name="recommendations"></a><span data-ttu-id="d0b47-156">Recommandations</span><span class="sxs-lookup"><span data-stu-id="d0b47-156">Recommendations</span></span>

<span data-ttu-id="d0b47-157">Vos exigences peuvent différer de celles de l’architecture décrite ici.</span><span class="sxs-lookup"><span data-stu-id="d0b47-157">Your requirements might differ from the architecture described here.</span></span> <span data-ttu-id="d0b47-158">Utilisez ces recommandations comme point de départ.</span><span class="sxs-lookup"><span data-stu-id="d0b47-158">Use these recommendations as a starting point.</span></span>

### <a name="resource-group-recommendations"></a><span data-ttu-id="d0b47-159">Recommandations pour les groupes de ressources</span><span class="sxs-lookup"><span data-stu-id="d0b47-159">Resource group recommendations</span></span>

<span data-ttu-id="d0b47-160">Nous vous recommandons de séparer les groupes de ressources en fonction du rôle de serveur et d’avoir un groupe de ressources distinct pour les composants d’infrastructure qui sont des ressources globales.</span><span class="sxs-lookup"><span data-stu-id="d0b47-160">We recommend separating resource groups according to the server role, and having a separate resource group for infrastructure components that are global resources.</span></span> <span data-ttu-id="d0b47-161">Dans cette architecture, les ressources SharePoint forment un groupe, alors que le serveur SQL Server et les autres composants de l’utilitaire en forment un autre.</span><span class="sxs-lookup"><span data-stu-id="d0b47-161">In this architecture, the SharePoint resources form one group, while the SQL Server and other utility assets form another.</span></span>

### <a name="virtual-network-and-subnet-recommendations"></a><span data-ttu-id="d0b47-162">Recommandations pour les réseaux virtuels et les sous-réseaux</span><span class="sxs-lookup"><span data-stu-id="d0b47-162">Virtual network and subnet recommendations</span></span>

<span data-ttu-id="d0b47-163">Utilisez un sous-réseau pour chaque rôle SharePoint, ainsi qu’un sous-réseau pour la passerelle et un autre pour la jumpbox.</span><span class="sxs-lookup"><span data-stu-id="d0b47-163">Use one subnet for each SharePoint role, plus a subnet for the gateway and one for the jumpbox.</span></span>

<span data-ttu-id="d0b47-164">Le sous-réseau de passerelle doit être nommé *GatewaySubnet*.</span><span class="sxs-lookup"><span data-stu-id="d0b47-164">The gateway subnet must be named *GatewaySubnet*.</span></span> <span data-ttu-id="d0b47-165">Attribuez l’espace d’adressage du sous-réseau passerelle à partir de la dernière partie de l’espace d’adressage du réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="d0b47-165">Assign the gateway subnet address space from the last part of the virtual network address space.</span></span> <span data-ttu-id="d0b47-166">Pour plus d’informations, consultez l’article [Connect an on-premises network to Azure using a VPN gateway][hybrid-vpn-ra] (Connecter un réseau local à Azure à l’aide d’une passerelle VPN).</span><span class="sxs-lookup"><span data-stu-id="d0b47-166">For more information, see [Connect an on-premises network to Azure using a VPN gateway][hybrid-vpn-ra].</span></span>

### <a name="vm-recommendations"></a><span data-ttu-id="d0b47-167">Recommandations pour les machines virtuelles</span><span class="sxs-lookup"><span data-stu-id="d0b47-167">VM recommendations</span></span>

<span data-ttu-id="d0b47-168">Cette architecture nécessite au moins 44 cœurs :</span><span class="sxs-lookup"><span data-stu-id="d0b47-168">This architecture requires a minimum of 44 cores:</span></span>

- <span data-ttu-id="d0b47-169">8 serveurs SharePoint sur Standard_DS3_v2 (4 cœurs chacun) = 32 cœurs</span><span class="sxs-lookup"><span data-stu-id="d0b47-169">8 SharePoint servers on Standard_DS3_v2 (4 cores each) = 32 cores</span></span>
- <span data-ttu-id="d0b47-170">2 contrôleurs de domaine Active Directory sur Standard_DS1_v2 (1 cœur chacun) = 2 cœurs</span><span class="sxs-lookup"><span data-stu-id="d0b47-170">2 Active Directory domain controllers on Standard_DS1_v2 (1 core each) = 2 cores</span></span>
- <span data-ttu-id="d0b47-171">2 machines virtuelles SQL Server sur Standard_DS3_v2 = 8 cœurs</span><span class="sxs-lookup"><span data-stu-id="d0b47-171">2 SQL Server VMs on Standard_DS3_v2 = 8 cores</span></span>
- <span data-ttu-id="d0b47-172">1 nœud majoritaire sur Standard_DS1_v2 = 1 noyau</span><span class="sxs-lookup"><span data-stu-id="d0b47-172">1 majority node on Standard_DS1_v2 = 1 core</span></span>
- <span data-ttu-id="d0b47-173">1 serveur d’administration sur Standard_DS1_v2 = 1 noyau</span><span class="sxs-lookup"><span data-stu-id="d0b47-173">1 management server on Standard_DS1_v2 = 1 core</span></span>

<span data-ttu-id="d0b47-174">Assurez-vous que votre abonnement Azure dispose d’un quota de cœurs de machines virtuelles suffisamment important pour le déploiement ou le déploiement échouera.</span><span class="sxs-lookup"><span data-stu-id="d0b47-174">Make sure your Azure subscription has enough VM core quota for the deployment, or the deployment will fail.</span></span> <span data-ttu-id="d0b47-175">Consultez l’article [Abonnement Azure et limites, quotas et contraintes de service][quotas].</span><span class="sxs-lookup"><span data-stu-id="d0b47-175">See [Azure subscription and service limits, quotas, and constraints][quotas].</span></span>

<span data-ttu-id="d0b47-176">Pour tous les rôles SharePoint, à l’exception de l’indexeur de recherche, l’utilisation de la taille de machine virtuelle [Standard_DS3_v2][vm-sizes-general] est recommandée.</span><span class="sxs-lookup"><span data-stu-id="d0b47-176">For all SharePoint roles except the Search Indexer, we recommended using the [Standard_DS3_v2][vm-sizes-general] VM size.</span></span> <span data-ttu-id="d0b47-177">L’indexeur de recherche doit être de taille [Standard_DS13_v2][vm-sizes-memory] au minimum.</span><span class="sxs-lookup"><span data-stu-id="d0b47-177">The Search Indexer should be at least the [Standard_DS13_v2][vm-sizes-memory] size.</span></span> <span data-ttu-id="d0b47-178">À des fins de test, les fichiers de paramètres pour cette architecture de référence spécifient la plus petite taille DS3_v2 pour le rôle de l’indexeur de recherche.</span><span class="sxs-lookup"><span data-stu-id="d0b47-178">For testing, the parameter files for this reference architecture specify the smaller DS3_v2 size for the Search Indexer role.</span></span> <span data-ttu-id="d0b47-179">Pour un déploiement de production, mettez à jour les fichiers de paramètres pour utiliser la taille DS13 ou une taille supérieure.</span><span class="sxs-lookup"><span data-stu-id="d0b47-179">For a production deployment, update the parameter files to use the DS13 size or larger.</span></span> <span data-ttu-id="d0b47-180">Pour plus d’informations, consultez l’article [Configuration matérielle et logicielle requise pour une solution SharePoint Server 2016][sharepoint-reqs].</span><span class="sxs-lookup"><span data-stu-id="d0b47-180">For more information, see [Hardware and software requirements for SharePoint Server 2016][sharepoint-reqs].</span></span>

<span data-ttu-id="d0b47-181">Pour les machines virtuelles SQL Server, nous vous recommandons un minimum de 4 cœurs et 8 Go de RAM.</span><span class="sxs-lookup"><span data-stu-id="d0b47-181">For the SQL Server VMs, we recommend a minimum of 4 cores and 8 GB RAM.</span></span> <span data-ttu-id="d0b47-182">Les fichiers de paramètres pour cette architecture de référence spécifient la taille de DS3_v2.</span><span class="sxs-lookup"><span data-stu-id="d0b47-182">The parameter files for this reference architecture specify the DS3_v2 size.</span></span> <span data-ttu-id="d0b47-183">Pour un déploiement de production, vous devrez peut-être spécifier une plus grande taille de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="d0b47-183">For a production deployment, you might need to specify a larger VM size.</span></span> <span data-ttu-id="d0b47-184">Pour plus d’informations, consultez l’article [Planification et configuration de la capacité de SQL Server et du stockage (SharePoint Server)](/sharepoint/administration/storage-and-sql-server-capacity-planning-and-configuration#estimate-memory-requirements).</span><span class="sxs-lookup"><span data-stu-id="d0b47-184">For more information, see [Storage and SQL Server capacity planning and configuration (SharePoint Server)](/sharepoint/administration/storage-and-sql-server-capacity-planning-and-configuration#estimate-memory-requirements).</span></span>

### <a name="nsg-recommendations"></a><span data-ttu-id="d0b47-185">Recommandations en matière de groupes de sécurité réseau</span><span class="sxs-lookup"><span data-stu-id="d0b47-185">NSG recommendations</span></span>

<span data-ttu-id="d0b47-186">Nous vous recommandons d’avoir un groupe de sécurité réseau pour chaque sous-réseau contenant des machines virtuelles, cela permet d’activer l’isolation des sous-réseaux.</span><span class="sxs-lookup"><span data-stu-id="d0b47-186">We recommend having one NSG for each subnet that contains VMs, to enable subnet isolation.</span></span> <span data-ttu-id="d0b47-187">Si vous souhaitez configurer l’isolation de sous-réseaux, ajoutez des règles de groupe de sécurité réseau qui définissent le trafic entrant ou sortant autorisé ou refusé pour chaque sous-réseau.</span><span class="sxs-lookup"><span data-stu-id="d0b47-187">If you want to configure subnet isolation, add NSG rules that define the allowed or denied inbound or outbound traffic for each subnet.</span></span> <span data-ttu-id="d0b47-188">Pour plus d’informations, consultez l’article [Filtrer le trafic réseau avec les groupes de sécurité réseau][virtual-networks-nsg].</span><span class="sxs-lookup"><span data-stu-id="d0b47-188">For more information, see [Filter network traffic with network security groups][virtual-networks-nsg].</span></span>

<span data-ttu-id="d0b47-189">N’affectez pas un groupe de sécurité réseau au sous-réseau de passerelle, ou la passerelle cessera de fonctionner.</span><span class="sxs-lookup"><span data-stu-id="d0b47-189">Do not assign an NSG to the gateway subnet, or the gateway will stop functioning.</span></span>

### <a name="storage-recommendations"></a><span data-ttu-id="d0b47-190">Recommandations de stockage</span><span class="sxs-lookup"><span data-stu-id="d0b47-190">Storage recommendations</span></span>

<span data-ttu-id="d0b47-191">La configuration du stockage des machines virtuelles dans la batterie de serveurs doit correspondre aux meilleures pratiques appropriées, utilisées pour les déploiements locaux.</span><span class="sxs-lookup"><span data-stu-id="d0b47-191">The storage configuration of the VMs in the farm should match the appropriate best practices used for on-premises deployments.</span></span> <span data-ttu-id="d0b47-192">Les serveurs SharePoint doivent avoir un disque distinct pour les journaux.</span><span class="sxs-lookup"><span data-stu-id="d0b47-192">SharePoint servers should have a separate disk for logs.</span></span> <span data-ttu-id="d0b47-193">Les serveurs SharePoint hébergeant les rôles des index de recherche nécessitent un espace disque supplémentaire pour stocker l’index de recherche.</span><span class="sxs-lookup"><span data-stu-id="d0b47-193">SharePoint servers hosting search index roles require additional disk space for the search index to be stored.</span></span> <span data-ttu-id="d0b47-194">Pour SQL Server, la pratique courante consiste à séparer les données et les journaux.</span><span class="sxs-lookup"><span data-stu-id="d0b47-194">For SQL Server, the standard practice is to separate data and logs.</span></span> <span data-ttu-id="d0b47-195">Ajoutez davantage de disques pour le stockage de sauvegarde de base de données et utilisez un disque distinct pour [tempdb][tempdb].</span><span class="sxs-lookup"><span data-stu-id="d0b47-195">Add more disks for database backup storage, and use a separate disk for [tempdb][tempdb].</span></span>

<span data-ttu-id="d0b47-196">Pour une meilleure fiabilité, nous recommandons l’utilisation d’[Azure Managed Disks][managed-disks].</span><span class="sxs-lookup"><span data-stu-id="d0b47-196">For best reliability, we recommend using [Azure Managed Disks][managed-disks].</span></span> <span data-ttu-id="d0b47-197">Les disques gérés assurent que les disques des machines virtuelles au sein d’un groupe à haute disponibilité sont isolés afin d’éviter des points de défaillance uniques.</span><span class="sxs-lookup"><span data-stu-id="d0b47-197">Managed disks ensure that the disks for VMs within an availability set are isolated to avoid single points of failure.</span></span>

> [!NOTE]
> <span data-ttu-id="d0b47-198">Actuellement, le modèle Resource Manager de cette architecture de référence n’utilise pas de disques gérés.</span><span class="sxs-lookup"><span data-stu-id="d0b47-198">Currently the Resource Manager template for this reference architecture does not use managed disks.</span></span> <span data-ttu-id="d0b47-199">Nous avons l’intention de mettre à jour le modèle pour utiliser des disques gérés.</span><span class="sxs-lookup"><span data-stu-id="d0b47-199">We are planning to update the template to use managed disks.</span></span>

<span data-ttu-id="d0b47-200">Utilisez des disques gérés Premium pour toutes les machines virtuelles SQL Server et SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d0b47-200">Use Premium managed disks for all SharePoint and SQL Server VMs.</span></span> <span data-ttu-id="d0b47-201">Vous pouvez utiliser des disques gérés standard pour le serveur de nœud majoritaire, les contrôleurs de domaine et le serveur d’administration.</span><span class="sxs-lookup"><span data-stu-id="d0b47-201">You can use Standard managed disks for the majority node server, the domain controllers, and the management server.</span></span>

### <a name="sharepoint-server-recommendations"></a><span data-ttu-id="d0b47-202">Recommandations relatives à SharePoint Server</span><span class="sxs-lookup"><span data-stu-id="d0b47-202">SharePoint Server recommendations</span></span>

<span data-ttu-id="d0b47-203">Avant de configurer la batterie de serveurs SharePoint, assurez-vous que vous avez un compte de service Windows Server Active Directory par service.</span><span class="sxs-lookup"><span data-stu-id="d0b47-203">Before configuring the SharePoint farm, make sure you have one Windows Server Active Directory service account per service.</span></span> <span data-ttu-id="d0b47-204">Pour cette architecture, vous devez au minimum disposer des comptes au niveau du domaine suivants pour isoler les privilèges par rôle :</span><span class="sxs-lookup"><span data-stu-id="d0b47-204">For this architecture, you need at a minimum the following domain-level accounts to isolate privilege per role:</span></span>

- <span data-ttu-id="d0b47-205">Compte de service SQL Server</span><span class="sxs-lookup"><span data-stu-id="d0b47-205">SQL Server Service account</span></span>
- <span data-ttu-id="d0b47-206">Compte de configuration d’utilisateur</span><span class="sxs-lookup"><span data-stu-id="d0b47-206">Setup User account</span></span>
- <span data-ttu-id="d0b47-207">Compte de batterie de serveurs</span><span class="sxs-lookup"><span data-stu-id="d0b47-207">Server Farm account</span></span>
- <span data-ttu-id="d0b47-208">Compte Search Service</span><span class="sxs-lookup"><span data-stu-id="d0b47-208">Search Service account</span></span>
- <span data-ttu-id="d0b47-209">Compte d’accès au contenu</span><span class="sxs-lookup"><span data-stu-id="d0b47-209">Content Access account</span></span>
- <span data-ttu-id="d0b47-210">Comptes de Pool d’applications web</span><span class="sxs-lookup"><span data-stu-id="d0b47-210">Web App Pool accounts</span></span>
- <span data-ttu-id="d0b47-211">Comptes de Pool d’applications de service</span><span class="sxs-lookup"><span data-stu-id="d0b47-211">Service App Pool accounts</span></span>
- <span data-ttu-id="d0b47-212">Compte de super utilisateur de cache</span><span class="sxs-lookup"><span data-stu-id="d0b47-212">Cache Super User account</span></span>
- <span data-ttu-id="d0b47-213">Compte de super lecteur de cache</span><span class="sxs-lookup"><span data-stu-id="d0b47-213">Cache Super Reader account</span></span>

<span data-ttu-id="d0b47-214">Pour satisfaire à l’exigence de prise en charge pour un débit de disque de 200 Mo par seconde au minimum, assurez-vous de planifier l’architecture de recherche.</span><span class="sxs-lookup"><span data-stu-id="d0b47-214">To meet the support requirement for disk throughput of 200 MB per second minimum, make sure to plan the Search architecture.</span></span> <span data-ttu-id="d0b47-215">Consultez l’article [Planifier l’architecture de recherche d’entreprise dans SharePoint Server 2013][sharepoint-search].</span><span class="sxs-lookup"><span data-stu-id="d0b47-215">See [Plan enterprise search architecture in SharePoint Server 2013][sharepoint-search].</span></span> <span data-ttu-id="d0b47-216">Suivez également les instructions contenues dans l’article [Best practices for crawling in SharePoint Server 2016][sharepoint-crawling] (Meilleures pratiques pour l’analyse dans SharePoint Server 2016).</span><span class="sxs-lookup"><span data-stu-id="d0b47-216">Also follow the guidelines in [Best practices for crawling in SharePoint Server 2016][sharepoint-crawling].</span></span>

<span data-ttu-id="d0b47-217">De plus, stockez les données de composant de recherche sur un volume de stockage distinct ou sur une partition avec des performances élevées.</span><span class="sxs-lookup"><span data-stu-id="d0b47-217">In addition, store the search component data on a separate storage volume or partition with high performance.</span></span> <span data-ttu-id="d0b47-218">Pour réduire la charge et améliorer le débit, configurez les comptes d’utilisateur de cache d’objets, qui sont requis dans cette architecture.</span><span class="sxs-lookup"><span data-stu-id="d0b47-218">To reduce load and improve throughput, configure the object cache user accounts, which are required in this architecture.</span></span> <span data-ttu-id="d0b47-219">Fractionnez les fichiers de système d’exploitation Windows Server, les fichiers programme SharePoint Server 2016 et les journaux de diagnostic sur trois volumes de stockage distincts ou sur des partitions avec des performances normales.</span><span class="sxs-lookup"><span data-stu-id="d0b47-219">Split the Windows Server operating system files, the SharePoint Server 2016 program files, and diagnostics logs across three separate storage volumes or partitions with normal performance.</span></span>

<span data-ttu-id="d0b47-220">Pour plus d’informations sur ces recommandations, consultez l’article [Comptes d’administration et de service de déploiement initial dans SharePoint Server 2016][sharepoint-accounts].</span><span class="sxs-lookup"><span data-stu-id="d0b47-220">For more information about these recommendations, see [Initial deployment administrative and service accounts in SharePoint Server 2016][sharepoint-accounts].</span></span>

### <a name="hybrid-workloads"></a><span data-ttu-id="d0b47-221">Charges de travail hybrides</span><span class="sxs-lookup"><span data-stu-id="d0b47-221">Hybrid workloads</span></span>

<span data-ttu-id="d0b47-222">Cette architecture de référence déploie une batterie de serveurs SharePoint Server 2016 qui peut être utilisée comme un [environnement hybride de SharePoint][sharepoint-hybrid] &mdash;, en étendant SharePoint Server 2016 à Office 365 SharePoint Online.</span><span class="sxs-lookup"><span data-stu-id="d0b47-222">This reference architecture deploys a SharePoint Server 2016 farm that can be used as a [SharePoint hybrid environment][sharepoint-hybrid] &mdash; that is, extending SharePoint Server 2016 to Office 365 SharePoint Online.</span></span> <span data-ttu-id="d0b47-223">Si vous avez Office Online Server, consultez l’article [Prise en charge de Microsoft Office Web Apps et Office Online Server dans Azure][office-web-apps].</span><span class="sxs-lookup"><span data-stu-id="d0b47-223">If you have Office Online Server, see [Office Web Apps and Office Online Server supportability in Azure][office-web-apps].</span></span>

<span data-ttu-id="d0b47-224">Les applications de service par défaut de ce déploiement sont conçues pour prendre en charge les charges de travail hybrides.</span><span class="sxs-lookup"><span data-stu-id="d0b47-224">The default service applications in this deployment are designed to support hybrid workloads.</span></span> <span data-ttu-id="d0b47-225">Vous pouvez déployer toutes les charges de travail hybrides SharePoint Server 2016 et Office 365 sur cette batterie de serveurs sans changer l’infrastructure SharePoint, à une exception près : L’application du service de recherche hybride cloud ne doit pas être déployée sur les serveurs hébergeant une topologie de recherche existante.</span><span class="sxs-lookup"><span data-stu-id="d0b47-225">All SharePoint Server 2016 and Office 365 hybrid workloads can be deployed to this farm without changes to the SharePoint infrastructure, with one exception: The Cloud Hybrid Search Service Application must not be deployed onto servers hosting an existing search topology.</span></span> <span data-ttu-id="d0b47-226">Par conséquent, une ou plusieurs machines virtuelles en fonction du rôle de recherche doivent être ajoutées à la batterie de serveurs pour prendre en charge ce scénario hybride.</span><span class="sxs-lookup"><span data-stu-id="d0b47-226">Therefore, one or more search-role-based VMs must be added to the farm to support this hybrid scenario.</span></span>

### <a name="sql-server-always-on-availability-groups"></a><span data-ttu-id="d0b47-227">Groupes de disponibilité SQL Server Always On</span><span class="sxs-lookup"><span data-stu-id="d0b47-227">SQL Server Always On Availability Groups</span></span>

<span data-ttu-id="d0b47-228">Cette architecture utilise des ordinateurs virtuels SQL Server, car SharePoint Server 2016 ne peut pas utiliser les bases de données SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="d0b47-228">This architecture uses SQL Server virtual machines because SharePoint Server 2016 cannot use Azure SQL Database.</span></span> <span data-ttu-id="d0b47-229">Pour prendre en charge la haute disponibilité dans SQL Server, nous recommandons d’utiliser des groupes de disponibilité Always On, qui spécifient un ensemble de bases de données qui basculent ensemble, ce qui les rend hautement disponibles et récupérables.</span><span class="sxs-lookup"><span data-stu-id="d0b47-229">To support high availability in SQL Server, we recommend using Always On Availability Groups, which specify a set of databases that fail over together, making them highly-available and recoverable.</span></span> <span data-ttu-id="d0b47-230">Dans cette architecture de référence, les bases de données sont créés au cours du déploiement, mais vous devez manuellement activer les groupes de disponibilité Always On et ajouter les bases de données SharePoint à un groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="d0b47-230">In this reference architecture, the databases are created during deployment, but you must manually enable Always On Availability Groups and add the SharePoint databases to an availability group.</span></span> <span data-ttu-id="d0b47-231">Pour plus d’informations, consultez l’article [Créer le groupe de disponibilité et ajouter les bases de données SharePoint][create-availability-group].</span><span class="sxs-lookup"><span data-stu-id="d0b47-231">For more information, see [Create the availability group and add the SharePoint databases][create-availability-group].</span></span>

<span data-ttu-id="d0b47-232">Nous recommandons également l’ajout d’une adresse IP d’écouteur au cluster, il s’agit de l’adresse IP privée de l’équilibreur de charge interne pour les machines virtuelles SQL Server.</span><span class="sxs-lookup"><span data-stu-id="d0b47-232">We also recommend adding a listener IP address to the cluster, which is the private IP address of the internal load balancer for the SQL Server virtual machines.</span></span>

<span data-ttu-id="d0b47-233">Pour les tailles de machine virtuelle recommandées et d’autres recommandations relatives aux performances pour SQL Server s’exécutant dans Azure, consultez l’article [Meilleures pratiques relatives aux performances de SQL Server dans les machines virtuelles Azure][sql-performance].</span><span class="sxs-lookup"><span data-stu-id="d0b47-233">For recommended VM sizes and other performance recommendations for SQL Server running in Azure, see [Performance best practices for SQL Server in Azure Virtual Machines][sql-performance].</span></span> <span data-ttu-id="d0b47-234">Suivez également les recommandations de l’article [Meilleures pratiques pour SQL Server dans une batterie de serveurs SharePoint Server 2016][sql-sharepoint-best-practices].</span><span class="sxs-lookup"><span data-stu-id="d0b47-234">Also follow the recommendations in [Best practices for SQL Server in a SharePoint Server 2016 farm][sql-sharepoint-best-practices].</span></span>

<span data-ttu-id="d0b47-235">Le serveur de nœud majoritaire devrait se trouver sur un ordinateur distinct des partenaires de réplication.</span><span class="sxs-lookup"><span data-stu-id="d0b47-235">We recommend that the majority node server reside on a separate computer from the replication partners.</span></span> <span data-ttu-id="d0b47-236">Le serveur permet au serveur du partenaire de réplication secondaire dans une session de mode haute sécurité, de déterminer s’il faut initier un basculement automatique.</span><span class="sxs-lookup"><span data-stu-id="d0b47-236">The server enables the secondary replication partner server in a high-safety mode session to recognize whether to initiate an automatic failover.</span></span> <span data-ttu-id="d0b47-237">Contrairement aux deux partenaires, le serveur de nœud majoritaire ne sert pas la base de données, mais au lieu de cela, il prend en charge le basculement automatique.</span><span class="sxs-lookup"><span data-stu-id="d0b47-237">Unlike the two partners, the majority node server doesn't serve the database but rather supports automatic failover.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="d0b47-238">Considérations relatives à l’extensibilité</span><span class="sxs-lookup"><span data-stu-id="d0b47-238">Scalability considerations</span></span>

<span data-ttu-id="d0b47-239">Pour mettre à l’échelle les serveurs existants, modifiez simplement la taille de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="d0b47-239">To scale up the existing servers, simply change the VM size.</span></span>

<span data-ttu-id="d0b47-240">Avec la fonctionnalité [MinRoles][minroles] dans SharePoint Server 2016, vous pouvez mettre à niveau les serveurs basés sur le rôle de serveur et supprimer des serveurs à partir d’un rôle.</span><span class="sxs-lookup"><span data-stu-id="d0b47-240">With the [MinRoles][minroles] capability in SharePoint Server 2016, you can scale out servers based on the server's role and also remove servers from a role.</span></span> <span data-ttu-id="d0b47-241">Lorsque vous ajoutez des serveurs à un rôle, vous pouvez spécifier les rôles uniques ou l’un des rôles combinés.</span><span class="sxs-lookup"><span data-stu-id="d0b47-241">When you add servers to a role, you can specify any of the single roles or one of the combined roles.</span></span> <span data-ttu-id="d0b47-242">Si vous ajoutez des serveurs au rôle de recherche, toutefois, vous devez également reconfigurer la topologie de recherche à l’aide de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="d0b47-242">If you add servers to the Search role, however, you must also reconfigure the search topology using PowerShell.</span></span> <span data-ttu-id="d0b47-243">Vous pouvez également convertir des rôles à l’aide de MinRoles.</span><span class="sxs-lookup"><span data-stu-id="d0b47-243">You can also convert roles using MinRoles.</span></span> <span data-ttu-id="d0b47-244">Pour plus d’informations, consultez l’article [Gestion d’une batterie de serveurs MinRole dans SharePoint Server 2016][sharepoint-minrole].</span><span class="sxs-lookup"><span data-stu-id="d0b47-244">For more information, see [Managing a MinRole Server Farm in SharePoint Server 2016][sharepoint-minrole].</span></span>

<span data-ttu-id="d0b47-245">Notez que SharePoint Server 2016 ne prend pas en charge l’utilisation de groupes de machines virtuelles identiques pour la mise à l’échelle automatique.</span><span class="sxs-lookup"><span data-stu-id="d0b47-245">Note that SharePoint Server 2016 doesn't support using virtual machine scale sets for auto-scaling.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="d0b47-246">Considérations relatives à la disponibilité</span><span class="sxs-lookup"><span data-stu-id="d0b47-246">Availability considerations</span></span>

<span data-ttu-id="d0b47-247">Cette architecture de référence prend en charge la haute disponibilité dans une région Azure, étant donné que chaque rôle dispose d’au moins deux ordinateurs virtuels déployés dans un groupe à haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="d0b47-247">This reference architecture supports high availability within an Azure region, because each role has at least two VMs deployed in an availability set.</span></span>

<span data-ttu-id="d0b47-248">Pour vous protéger contre une panne régionale, créez une batterie de serveurs de récupération d’urgence distincte dans une région Azure différente.</span><span class="sxs-lookup"><span data-stu-id="d0b47-248">To protect against a regional failure, create a separate disaster recovery farm in a different Azure region.</span></span> <span data-ttu-id="d0b47-249">Vos objectifs de délai de récupération (RTO) et les objectifs de point de récupération (RPO) déterminent la configuration requise.</span><span class="sxs-lookup"><span data-stu-id="d0b47-249">Your recovery time objectives (RTOs) and recovery point objectives (RPOs) will determine the setup requirements.</span></span> <span data-ttu-id="d0b47-250">Pour plus d’informations, consultez l’article [Choisir une stratégie de récupération d’urgence pour SharePoint Server 2016][sharepoint-dr].</span><span class="sxs-lookup"><span data-stu-id="d0b47-250">For details, see [Choose a disaster recovery strategy for SharePoint 2016][sharepoint-dr].</span></span> <span data-ttu-id="d0b47-251">La région secondaire doit être une *région jumelée* avec la région primaire.</span><span class="sxs-lookup"><span data-stu-id="d0b47-251">The secondary region should be a *paired region* with the primary region.</span></span> <span data-ttu-id="d0b47-252">En cas de panne étendue, la récupération d’une région est hiérarchisée pour chaque paire.</span><span class="sxs-lookup"><span data-stu-id="d0b47-252">In the event of a broad outage, recovery of one region is prioritized out of every pair.</span></span> <span data-ttu-id="d0b47-253">Pour plus d’informations, consultez l’article [Continuité des activités et récupération d’urgence (BCDR) : régions jumelées Azure][paired-regions].</span><span class="sxs-lookup"><span data-stu-id="d0b47-253">For more information, see [Business continuity and disaster recovery (BCDR): Azure Paired Regions][paired-regions].</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="d0b47-254">Considérations relatives à la facilité de gestion</span><span class="sxs-lookup"><span data-stu-id="d0b47-254">Manageability considerations</span></span>

<span data-ttu-id="d0b47-255">Pour exploiter et maintenir les serveurs, les batteries de serveurs et les sites, suivez les pratiques recommandées pour les opérations SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d0b47-255">To operate and maintain servers, server farms, and sites, follow the recommended practices for SharePoint operations.</span></span> <span data-ttu-id="d0b47-256">Pour plus d’informations, consultez l’article [Opérations pour SharePoint Server 2016][sharepoint-ops].</span><span class="sxs-lookup"><span data-stu-id="d0b47-256">For more information, see [Operations for SharePoint Server 2016][sharepoint-ops].</span></span>

<span data-ttu-id="d0b47-257">Les tâches à prendre en compte lors de la gestion de SQL Server dans un environnement SharePoint peuvent différer de celles généralement prises en compte pour une application de base de données.</span><span class="sxs-lookup"><span data-stu-id="d0b47-257">The tasks to consider when managing SQL Server in a SharePoint environment may differ from the ones typically considered for a database application.</span></span> <span data-ttu-id="d0b47-258">Une bonne pratique consiste à sauvegarder toutes les bases de données SQL chaque semaine avec des sauvegardes incrémentielles nocturnes.</span><span class="sxs-lookup"><span data-stu-id="d0b47-258">A best practice is to fully back up all SQL databases weekly with incremental nightly backups.</span></span> <span data-ttu-id="d0b47-259">Sauvegardez les journaux des transactions toutes les 15 minutes.</span><span class="sxs-lookup"><span data-stu-id="d0b47-259">Back up transaction logs every 15 minutes.</span></span> <span data-ttu-id="d0b47-260">Une autre pratique consiste à implémenter des tâches de maintenance de SQL Server sur les bases de données lors de la désactivation de celles intégrées à SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d0b47-260">Another practice is to implement SQL Server maintenance tasks on the databases while disabling the built-in SharePoint ones.</span></span> <span data-ttu-id="d0b47-261">Pour plus d’informations, consultez l’article [Planification et configuration de la capacité de SQL Server et du stockage][sql-server-capacity-planning].</span><span class="sxs-lookup"><span data-stu-id="d0b47-261">For more information, see [Storage and SQL Server capacity planning and configuration][sql-server-capacity-planning].</span></span>

## <a name="security-considerations"></a><span data-ttu-id="d0b47-262">Considérations relatives à la sécurité</span><span class="sxs-lookup"><span data-stu-id="d0b47-262">Security considerations</span></span>

<span data-ttu-id="d0b47-263">Les comptes de service au niveau du domaine utilisés pour exécuter un serveur SharePoint 2016 nécessitent des contrôleurs de domaine Windows Server Active Directory pour les processus de jonction de domaine et d’authentification.</span><span class="sxs-lookup"><span data-stu-id="d0b47-263">The domain-level service accounts used to run SharePoint Server 2016 require Windows Server AD domain controllers for domain-join and authentication processes.</span></span> <span data-ttu-id="d0b47-264">Azure Active Directory Domain Services ne peut pas être utilisé à cet effet.</span><span class="sxs-lookup"><span data-stu-id="d0b47-264">Azure Active Directory Domain Services can't be used for this purpose.</span></span> <span data-ttu-id="d0b47-265">Pour étendre l’infrastructure d’identité Windows Server Active Directory déjà en place dans l’intranet, cette architecture utilise deux contrôleurs de domaine réplica Windows Server Active Directory d’une forêt locale existante Windows Server Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d0b47-265">To extend the Windows Server AD identity infrastructure already in place in the intranet, this architecture uses two Windows Server AD replica domain controllers of an existing on-premises Windows Server AD forest.</span></span>

<span data-ttu-id="d0b47-266">En outre, il est toujours conseillé de planifier le renforcement de la sécurité.</span><span class="sxs-lookup"><span data-stu-id="d0b47-266">In addition, it's always wise to plan for security hardening.</span></span> <span data-ttu-id="d0b47-267">Les autres recommandations sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="d0b47-267">Other recommendations include:</span></span>

- <span data-ttu-id="d0b47-268">Ajouter des règles pour les groupes de sécurité réseau pour isoler les sous-réseaux et les rôles.</span><span class="sxs-lookup"><span data-stu-id="d0b47-268">Add rules to NSGs to isolate subnets and roles.</span></span>
- <span data-ttu-id="d0b47-269">N’affectez pas les adresses IP publiques aux machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="d0b47-269">Don't assign public IP addresses to VMs.</span></span>
- <span data-ttu-id="d0b47-270">Pour la détection d’intrusion et l’analyse des charges utiles, envisagez d’utiliser une appliance virtuelle réseau devant les serveurs web frontaux à la place d’un équilibreur de charge interne Azure.</span><span class="sxs-lookup"><span data-stu-id="d0b47-270">For intrusion detection and analysis of payloads, consider using a network virtual appliance in front of the front-end web servers instead of an internal Azure load balancer.</span></span>
- <span data-ttu-id="d0b47-271">En option, utilisez les stratégies IPsec pour le chiffrement du trafic de texte en clair entre les serveurs.</span><span class="sxs-lookup"><span data-stu-id="d0b47-271">As an option, use IPsec policies for encryption of cleartext traffic between servers.</span></span> <span data-ttu-id="d0b47-272">Si vous effectuez également l’isolation des sous-réseaux, mettez à jour vos règles de groupe de sécurité réseau pour autoriser le trafic IPsec.</span><span class="sxs-lookup"><span data-stu-id="d0b47-272">If you are also doing subnet isolation, update your network security group rules to allow IPsec traffic.</span></span>
- <span data-ttu-id="d0b47-273">Installez des agents de logiciels anti-programmes malveillants pour les machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="d0b47-273">Install anti-malware agents for the VMs.</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="d0b47-274">Déployer la solution</span><span class="sxs-lookup"><span data-stu-id="d0b47-274">Deploy the solution</span></span>

<span data-ttu-id="d0b47-275">Un déploiement pour cette architecture de référence est disponible sur [GitHub][github].</span><span class="sxs-lookup"><span data-stu-id="d0b47-275">A deployment for this reference architecture is available on [GitHub][github].</span></span> <span data-ttu-id="d0b47-276">La totalité du déploiement peut durer plusieurs heures.</span><span class="sxs-lookup"><span data-stu-id="d0b47-276">The entire deployment can take several hours to complete.</span></span>

<span data-ttu-id="d0b47-277">Le déploiement crée les groupes de ressources suivants dans votre abonnement :</span><span class="sxs-lookup"><span data-stu-id="d0b47-277">The deployment creates the following resource groups in your subscription:</span></span>

- <span data-ttu-id="d0b47-278">ra-onprem-sp2016-rg</span><span class="sxs-lookup"><span data-stu-id="d0b47-278">ra-onprem-sp2016-rg</span></span>
- <span data-ttu-id="d0b47-279">ra-sp2016-network-rg</span><span class="sxs-lookup"><span data-stu-id="d0b47-279">ra-sp2016-network-rg</span></span>

<span data-ttu-id="d0b47-280">Les fichiers de paramètre modèle font référence à ces noms. Si vous les modifiez, mettez à jour les fichiers de paramètres afin qu’ils correspondent.</span><span class="sxs-lookup"><span data-stu-id="d0b47-280">The template parameter files refer to these names, so if you change them, update the parameter files to match.</span></span>

<span data-ttu-id="d0b47-281">Les fichiers de paramètres incluent un mot de passe codé en dur dans divers emplacements.</span><span class="sxs-lookup"><span data-stu-id="d0b47-281">The parameter files include a hard-coded password in various places.</span></span> <span data-ttu-id="d0b47-282">Modifiez ces valeurs avant de déployer.</span><span class="sxs-lookup"><span data-stu-id="d0b47-282">Change these values before you deploy.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="d0b47-283">Prérequis</span><span class="sxs-lookup"><span data-stu-id="d0b47-283">Prerequisites</span></span>

[!INCLUDE [ref-arch-prerequisites.md](../../../includes/ref-arch-prerequisites.md)]

### <a name="deployment-steps"></a><span data-ttu-id="d0b47-284">Étapes du déploiement</span><span class="sxs-lookup"><span data-stu-id="d0b47-284">Deployment steps</span></span>

1. <span data-ttu-id="d0b47-285">Exécutez la commande suivante pour déployer un réseau simulé local.</span><span class="sxs-lookup"><span data-stu-id="d0b47-285">Run the following command to deploy a simulated on-premises network.</span></span>

    ```bash
    azbb -s <subscription_id> -g ra-onprem-sp2016-rg -l <location> -p onprem.json --deploy
    ```

2. <span data-ttu-id="d0b47-286">Exécutez la commande suivante pour déployer le réseau virtuel et la passerelle VPN Azure.</span><span class="sxs-lookup"><span data-stu-id="d0b47-286">Run the following command to deploy the Azure VNet and the VPN gateway.</span></span>

    ```bash
    azbb -s <subscription_id> -g ra-onprem-sp2016-rg -l <location> -p connections.json --deploy
    ```

3. <span data-ttu-id="d0b47-287">Exécutez la commande suivante pour déployer la jumpbox, les contrôleurs de domaine AD et les machines virtuelles SQL Serveur.</span><span class="sxs-lookup"><span data-stu-id="d0b47-287">Run the following command to deploy the jumpbox, AD domain controllers, and SQL Server VMs.</span></span>

    ```bash
    azbb -s <subscription_id> -g ra-onprem-sp2016-rg -l <location> -p azure1.json --deploy
    ```

4. <span data-ttu-id="d0b47-288">Exécutez la commande suivante pour créer le cluster de basculement et le groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="d0b47-288">Run the following command to create the failover cluster and the availability group.</span></span>

    ```bash
    azbb -s <subscription_id> -g ra-onprem-sp2016-rg -l <location> -p azure2-cluster.json --deploy
    ```

5. <span data-ttu-id="d0b47-289">Exécutez la commande suivante pour déployer les machines virtuelles restantes.</span><span class="sxs-lookup"><span data-stu-id="d0b47-289">Run the following command to deploy the remaining VMs.</span></span>

    ```bash
    azbb -s <subscription_id> -g ra-onprem-sp2016-rg -l <location> -p azure3.json --deploy
    ```

<span data-ttu-id="d0b47-290">À ce stade, vérifiez que vous pouvez établir une connexion TCP du serveur web frontal à l’équilibreur de charge pour le groupes de disponibilité AlwaysOn SQL Server.</span><span class="sxs-lookup"><span data-stu-id="d0b47-290">At this point, verify that you can make a TCP connection from the web front end to the load balancer for the SQL Server Always On availability group.</span></span> <span data-ttu-id="d0b47-291">Pour ce faire, suivez les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="d0b47-291">To do so, perform the following steps:</span></span>

1. <span data-ttu-id="d0b47-292">Utilisez le portail Azure pour trouver la machine virtuelle appelée `ra-sp-jb-vm1` dans le groupe de ressources `ra-sp2016-network-rg`.</span><span class="sxs-lookup"><span data-stu-id="d0b47-292">Use the Azure portal to find the VM named `ra-sp-jb-vm1` in the `ra-sp2016-network-rg` resource group.</span></span> <span data-ttu-id="d0b47-293">Il s’agit de la machine virtuelle de la jumpbox.</span><span class="sxs-lookup"><span data-stu-id="d0b47-293">This is the jumpbox VM.</span></span>

2. <span data-ttu-id="d0b47-294">Cliquez sur `Connect` pour ouvrir une session Bureau à distance vers la machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="d0b47-294">Click `Connect` to open a remote desktop session to the VM.</span></span> <span data-ttu-id="d0b47-295">Utilisez le mot de passe spécifié dans le fichier de paramètre `azure1.json`.</span><span class="sxs-lookup"><span data-stu-id="d0b47-295">Use the password that you specified in the `azure1.json` parameter file.</span></span>

3. <span data-ttu-id="d0b47-296">Depuis la session Bureau à distance, connectez-vous à 10.0.5.4.</span><span class="sxs-lookup"><span data-stu-id="d0b47-296">From the Remote Desktop session, log into 10.0.5.4.</span></span> <span data-ttu-id="d0b47-297">Il s’agit de l’adresse IP de la machine virtuelle nommée `ra-sp-app-vm1`.</span><span class="sxs-lookup"><span data-stu-id="d0b47-297">This is the IP address of the VM named `ra-sp-app-vm1`.</span></span>

4. <span data-ttu-id="d0b47-298">Ouvrez une console PowerShell dans la machine virtuelle et utilisez la cmdlet `Test-NetConnection` pour vérifier que vous pouvez vous connecter à l’équilibreur de charge.</span><span class="sxs-lookup"><span data-stu-id="d0b47-298">Open a PowerShell console in the VM, and use the `Test-NetConnection` cmdlet to verify that you can connect to the load balancer.</span></span>

    ```powershell
    Test-NetConnection 10.0.3.100 -Port 1433
    ```

<span data-ttu-id="d0b47-299">Le résultat doit être semblable à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="d0b47-299">The output should look similar to the following:</span></span>

```console
ComputerName     : 10.0.3.100
RemoteAddress    : 10.0.3.100
RemotePort       : 1433
InterfaceAlias   : Ethernet 3
SourceAddress    : 10.0.0.132
TcpTestSucceeded : True
```

<span data-ttu-id="d0b47-300">S’il échoue, utilisez le portail Azure pour redémarrer la machine virtuelle nommée `ra-sp-sql-vm2`.</span><span class="sxs-lookup"><span data-stu-id="d0b47-300">If it fails, use the Azure Portal to restart the VM named `ra-sp-sql-vm2`.</span></span> <span data-ttu-id="d0b47-301">Après son redémarrage, exécutez de nouveau la commande `Test-NetConnection`.</span><span class="sxs-lookup"><span data-stu-id="d0b47-301">After the VM restarts, run the `Test-NetConnection` command again.</span></span> <span data-ttu-id="d0b47-302">Vous devrez peut-être patienter environ une minute après le redémarrage pour que la connexion soit établie.</span><span class="sxs-lookup"><span data-stu-id="d0b47-302">You may need to wait about a minute after the VM restarts for the connection to succeed.</span></span>

<span data-ttu-id="d0b47-303">Effectuez le déploiement comme suit.</span><span class="sxs-lookup"><span data-stu-id="d0b47-303">Now complete the deployment as follows.</span></span>

1. <span data-ttu-id="d0b47-304">Exécutez la commande suivante pour déployer le nœud principal de la batterie de serveurs SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d0b47-304">Run the following command to deploy the SharePoint farm primary node.</span></span>

    ```bash
    azbb -s <subscription_id> -g ra-onprem-sp2016-rg -l <location> -p azure4-sharepoint-server.json --deploy
    ```

2. <span data-ttu-id="d0b47-305">Exécutez la commande suivante pour déployer le cache, la recherche et le serveur web SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d0b47-305">Run the following command to deploy the SharePoint cache, search, and web.</span></span>

    ```bash
    azbb -s <subscription_id> -g ra-onprem-sp2016-rg -l <location> -p azure5-sharepoint-farm.json --deploy
    ```

3. <span data-ttu-id="d0b47-306">Exécutez la commande suivante pour créer les règles du groupe de sécurité réseau.</span><span class="sxs-lookup"><span data-stu-id="d0b47-306">Run the following command to create the NSG rules.</span></span>

    ```bash
    azbb -s <subscription_id> -g ra-onprem-sp2016-rg -l <location> -p azure6-security.json --deploy
    ```

### <a name="validate-the-deployment"></a><span data-ttu-id="d0b47-307">Valider le déploiement</span><span class="sxs-lookup"><span data-stu-id="d0b47-307">Validate the deployment</span></span>

1. <span data-ttu-id="d0b47-308">Dans le [portail Azure][azure-portal], accédez au groupe de ressources `ra-onprem-sp2016-rg`.</span><span class="sxs-lookup"><span data-stu-id="d0b47-308">In the [Azure portal][azure-portal], navigate to the `ra-onprem-sp2016-rg` resource group.</span></span>

2. <span data-ttu-id="d0b47-309">Dans la liste des ressources, sélectionnez la ressource de machine virtuelle nommée `ra-onpr-u-vm1`.</span><span class="sxs-lookup"><span data-stu-id="d0b47-309">In the list of resources, select the VM resource named `ra-onpr-u-vm1`.</span></span>

3. <span data-ttu-id="d0b47-310">Connectez-vous à la machine virtuelle, comme décrit dans la section [Connexion à la machine virtuelle][connect-to-vm].</span><span class="sxs-lookup"><span data-stu-id="d0b47-310">Connect to the VM, as described in [Connect to virtual machine][connect-to-vm].</span></span> <span data-ttu-id="d0b47-311">Le nom d’utilisateur est `\onpremuser`.</span><span class="sxs-lookup"><span data-stu-id="d0b47-311">The user name is `\onpremuser`.</span></span>

4. <span data-ttu-id="d0b47-312">Lorsque la connexion à distance à la machine virtuelle est établie, ouvrez un navigateur sur l’ordinateur virtuel et accédez à `http://portal.contoso.local`.</span><span class="sxs-lookup"><span data-stu-id="d0b47-312">When the remote connection to the VM is established, open a browser in the VM and navigate to `http://portal.contoso.local`.</span></span>

5. <span data-ttu-id="d0b47-313">Dans la zone **Sécurité Windows**, connectez-vous au portail SharePoint en utilisant `contoso.local\testuser` pour le nom d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="d0b47-313">In the **Windows Security** box, log on to the SharePoint portal using `contoso.local\testuser` for the user name.</span></span>

<span data-ttu-id="d0b47-314">Cette ouverture de session« tunnèle » du domaine Fabrikam.com utilisé par le réseau local au domaine contoso.local utilisé par le portail SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d0b47-314">This logon tunnels from the Fabrikam.com domain used by the on-premises network to the contoso.local domain used by the SharePoint portal.</span></span> <span data-ttu-id="d0b47-315">Lorsque le site SharePoint s’ouvre, le site de démonstration racine s’affiche.</span><span class="sxs-lookup"><span data-stu-id="d0b47-315">When the SharePoint site opens, you'll see the root demo site.</span></span>

<span data-ttu-id="d0b47-316">**_Contributeurs à cette architecture de référence_** &mdash; Joe Davies, Bob Fox, Neil Hodgkinson, Paul Stork</span><span class="sxs-lookup"><span data-stu-id="d0b47-316">**_Contributors to this reference architecture_** &mdash; Joe Davies, Bob Fox, Neil Hodgkinson, Paul Stork</span></span>

<!-- links -->

[availability-set]: /azure/virtual-machines/windows/manage-availability
[azure-portal]: https://portal.azure.com
[azure-ps]: /powershell/azure/overview
[azure-pricing]: https://azure.microsoft.com/pricing/calculator/
[bastion-host]: https://en.wikipedia.org/wiki/Bastion_host
[create-availability-group]: /SharePoint/administration/sharepoint-intranet-farm-in-azure-phase-5-create-the-availability-group-and-add
[connect-to-vm]: /azure/virtual-machines/windows/quick-create-portal#connect-to-virtual-machine
[github]: https://github.com/mspnp/reference-architectures
[hybrid-ra]: ../hybrid-networking/index.md
[hybrid-vpn-ra]: ../hybrid-networking/vpn.md
[load-balancer]: /azure/load-balancer/load-balancer-internal-overview
[managed-disks]: /azure/storage/storage-managed-disks-overview
[minroles]: https://technet.microsoft.com/library/mt346114(v=office.16).aspx
[nsg]: /azure/virtual-network/virtual-networks-nsg
[office-web-apps]: https://support.microsoft.com/help/3199955/office-web-apps-and-office-online-server-supportability-in-azure
[paired-regions]: /azure/best-practices-availability-paired-regions
[readme]: https://github.com/mspnp/reference-architectures/tree/master/sharepoint/sharepoint-2016
[resource-group]: /azure/azure-resource-manager/resource-group-overview
[quotas]: /azure/azure-subscription-service-limits
[sharepoint-accounts]: https://technet.microsoft.com/library/ee662513(v=office.16).aspx
[sharepoint-crawling]: https://technet.microsoft.com/library/dn535606(v=office.16).aspx
[sharepoint-dr]: https://technet.microsoft.com/library/ff628971(v=office.16).aspx
[sharepoint-hybrid]: https://aka.ms/sphybrid
[sharepoint-minrole]: https://technet.microsoft.com/library/mt743705(v=office.16).aspx
[sharepoint-ops]: https://technet.microsoft.com/library/cc262289(v=office.16).aspx
[sharepoint-reqs]: https://technet.microsoft.com/library/cc262485(v=office.16).aspx
[sharepoint-search]: https://technet.microsoft.com/library/dn342836.aspx
[sql-always-on]: /sql/database-engine/availability-groups/windows/always-on-availability-groups-sql-server
[sql-performance]: /azure/virtual-machines/windows/sql/virtual-machines-windows-sql-performance
[sql-server-capacity-planning]: https://technet.microsoft.com/library/cc298801(v=office.16).aspx
[sql-quorum]: https://technet.microsoft.com/library/cc731739(v=ws.11).aspx
[sql-sharepoint-best-practices]: https://technet.microsoft.com/library/hh292622(v=office.16).aspx
[tempdb]: /sql/relational-databases/databases/tempdb-database
[virtual-networks-nsg]: /azure/virtual-network/virtual-networks-nsg
[visio-download]: https://archcenter.blob.core.windows.net/cdn/Sharepoint-2016.vsdx
[vm-sizes-general]: /azure/virtual-machines/windows/sizes-general
[vm-sizes-memory]: /azure/virtual-machines/windows/sizes-memory
[windows-n-tier]: ../virtual-machines-windows/n-tier.md
