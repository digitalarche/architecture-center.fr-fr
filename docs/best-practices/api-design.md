---
title: Guide de conception d’API
description: Conseils sur la création et la conception efficace d’une API web.
author: dragon119
ms.date: 01/12/2018
pnp.series.title: Best Practices
ms.openlocfilehash: 1bd53a7ccc54d086978891f1df5fdc2e25a5d638
ms.sourcegitcommit: 94d50043db63416c4d00cebe927a0c88f78c3219
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/28/2018
ms.locfileid: "47429370"
---
# <a name="api-design"></a><span data-ttu-id="5ab94-103">Conception d’API</span><span class="sxs-lookup"><span data-stu-id="5ab94-103">API design</span></span>

<span data-ttu-id="5ab94-104">Les applications web plus modernes exposent les API que les clients peuvent utiliser pour interagir avec l’application.</span><span class="sxs-lookup"><span data-stu-id="5ab94-104">Most modern web applications expose APIs that clients can use to interact with the application.</span></span> <span data-ttu-id="5ab94-105">Une API web bien conçue doit prendre en charge les capacités suivantes :</span><span class="sxs-lookup"><span data-stu-id="5ab94-105">A well-designed web API should aim to support:</span></span>

* <span data-ttu-id="5ab94-106">**Indépendance de la plateforme**.</span><span class="sxs-lookup"><span data-stu-id="5ab94-106">**Platform independence**.</span></span> <span data-ttu-id="5ab94-107">Tous les clients doivent être en mesure d’appeler l’API, quelle que soit la façon dont l’API est implémentée en interne.</span><span class="sxs-lookup"><span data-stu-id="5ab94-107">Any client should be able to call the API, regardless of how the API is implemented internally.</span></span> <span data-ttu-id="5ab94-108">Cela requiert l’utilisation de protocoles standard et un mécanisme où le client et le service web peuvent convenir du format des données à échanger.</span><span class="sxs-lookup"><span data-stu-id="5ab94-108">This requires using standard protocols, and having a mechanism whereby the client and the web service can agree on the format of the data to exchange.</span></span>

* <span data-ttu-id="5ab94-109">**Évolution des services**.</span><span class="sxs-lookup"><span data-stu-id="5ab94-109">**Service evolution**.</span></span> <span data-ttu-id="5ab94-110">L’API web doit être en mesure d’évoluer et ses fonctionnalités doivent pouvoir être ajoutées indépendamment des applications clientes.</span><span class="sxs-lookup"><span data-stu-id="5ab94-110">The web API should be able to evolve and add functionality independently from client applications.</span></span> <span data-ttu-id="5ab94-111">À mesure que l’API évolue, les applications clientes existantes doivent continuer de fonctionner sans modifications.</span><span class="sxs-lookup"><span data-stu-id="5ab94-111">As the API evolves, existing client applications should continue to function without modification.</span></span> <span data-ttu-id="5ab94-112">Toutes les fonctionnalités doivent être détectables, de sorte que les applications clientes puissent les utiliser pleinement.</span><span class="sxs-lookup"><span data-stu-id="5ab94-112">All functionality should be discoverable, so that client applications can fully utilize it.</span></span>

<span data-ttu-id="5ab94-113">Ce guide décrit les problèmes à prendre en compte lorsque vous concevez une API web.</span><span class="sxs-lookup"><span data-stu-id="5ab94-113">This guidance describes issues that you should consider when designing a web API.</span></span>

## <a name="introduction-to-rest"></a><span data-ttu-id="5ab94-114">Présentation de REST</span><span class="sxs-lookup"><span data-stu-id="5ab94-114">Introduction to REST</span></span>

<span data-ttu-id="5ab94-115">En 2000, Roy Fielding a présenté Representational State Transfer (REST) en tant qu’approche d’architecture pour concevoir des services web.</span><span class="sxs-lookup"><span data-stu-id="5ab94-115">In 2000, Roy Fielding proposed Representational State Transfer (REST) as an architectural approach to designing web services.</span></span> <span data-ttu-id="5ab94-116">REST est un style d’architecture pour la création de systèmes distribués basés sur l’hypermédia.</span><span class="sxs-lookup"><span data-stu-id="5ab94-116">REST is an architectural style for building distributed systems based on hypermedia.</span></span> <span data-ttu-id="5ab94-117">REST est indépendant de tout protocole sous-jacent et n’est pas nécessairement lié à HTTP.</span><span class="sxs-lookup"><span data-stu-id="5ab94-117">REST is independent of any underlying protocol and is not necessarily tied to HTTP.</span></span> <span data-ttu-id="5ab94-118">Toutefois, les implémentations REST les plus courantes utilisent HTTP comme protocole d’application, et ce guide s’intéresse à la conception d’API REST pour HTTP.</span><span class="sxs-lookup"><span data-stu-id="5ab94-118">However, most common REST implementations use HTTP as the application protocol, and this guide focuses on designing REST APIs for HTTP.</span></span>

<span data-ttu-id="5ab94-119">L’un des principaux avantages de REST par rapport à HTTP est qu’il utilise des normes ouvertes et qu’il ne lie pas l’implémentation de l’API ou des applications clientes à une implémentation spécifique.</span><span class="sxs-lookup"><span data-stu-id="5ab94-119">A primary advantage of REST over HTTP is that it uses open standards, and does not bind the implementation of the API or the client applications to any specific implementation.</span></span> <span data-ttu-id="5ab94-120">Par exemple, un service web REST peut être écrit dans ASP.NET, et les applications clientes peuvent utiliser n’importe quel langage ou ensemble d’outils qui peut générer des requêtes HTTP et analyser des réponses HTTP.</span><span class="sxs-lookup"><span data-stu-id="5ab94-120">For example, a REST web service could be written in ASP.NET, and client applications can use any language or toolset that can generate HTTP requests and parse HTTP responses.</span></span>

<span data-ttu-id="5ab94-121">Voici quelques-uns des principes de conception clés d’API RESTful à l’aide de HTTP :</span><span class="sxs-lookup"><span data-stu-id="5ab94-121">Here are some of the main design principles of RESTful APIs using HTTP:</span></span>

- <span data-ttu-id="5ab94-122">Les API REST sont conçues autour de *ressources*, qui peuvent être tout type d’objet, de données ou de service accessibles par le client.</span><span class="sxs-lookup"><span data-stu-id="5ab94-122">REST APIs are designed around *resources*, which are any kind of object, data, or service that can be accessed by the client.</span></span> 

- <span data-ttu-id="5ab94-123">Une ressource possède un *identificateur*, qui est un URI qui identifie de façon unique cette ressource.</span><span class="sxs-lookup"><span data-stu-id="5ab94-123">A resource has an *identifier*, which is a URI that uniquely identifies that resource.</span></span> <span data-ttu-id="5ab94-124">Par exemple, l’URI d’une commande client spécifique peut être :</span><span class="sxs-lookup"><span data-stu-id="5ab94-124">For example, the URI for a particular customer order might be:</span></span> 
 
    ```http
    https://adventure-works.com/orders/1
    ```
 
- <span data-ttu-id="5ab94-125">Les clients interagissent avec un service en échangeant des *représentations* de ressources.</span><span class="sxs-lookup"><span data-stu-id="5ab94-125">Clients interact with a service by exchanging *representations* of resources.</span></span> <span data-ttu-id="5ab94-126">De nombreuses API web utilisent JSON comme format d’échange.</span><span class="sxs-lookup"><span data-stu-id="5ab94-126">Many web APIs use JSON as the exchange format.</span></span> <span data-ttu-id="5ab94-127">Par exemple, une requête GET envoyée à l’URI ci-dessus peut renvoyer ce corps de réponse :</span><span class="sxs-lookup"><span data-stu-id="5ab94-127">For example, a GET request to the URI listed above might return this response body:</span></span>

    ```json
    {"orderId":1,"orderValue":99.90,"productId":1,"quantity":1}
    ```

- <span data-ttu-id="5ab94-128">Les API REST utilisent une interface uniforme, ce qui vous permet de séparer les implémentations du client et du service.</span><span class="sxs-lookup"><span data-stu-id="5ab94-128">REST APIs use a uniform interface, which helps to decouple the client and service implementations.</span></span> <span data-ttu-id="5ab94-129">Pour les API REST qui reposent sur HTTP, l’interface uniforme inclut l’utilisation de verbes HTTP standard pour effectuer des opérations sur les ressources.</span><span class="sxs-lookup"><span data-stu-id="5ab94-129">For REST APIs built on HTTP, the uniform interface includes using standard HTTP verbs to perform operations on resources.</span></span> <span data-ttu-id="5ab94-130">Les opérations les plus courantes sont GET, POST, PUT, PATCH et DELETE.</span><span class="sxs-lookup"><span data-stu-id="5ab94-130">The most common operations are GET, POST, PUT, PATCH, and DELETE.</span></span> 

- <span data-ttu-id="5ab94-131">Les API REST utilisent un modèle de requête sans état.</span><span class="sxs-lookup"><span data-stu-id="5ab94-131">REST APIs use a stateless request model.</span></span> <span data-ttu-id="5ab94-132">Les requêtes HTTP doivent être indépendantes et peuvent être générées dans n’importe quel ordre. Par conséquent, les informations d’état temporaires entre les requêtes ne peuvent pas être conservées.</span><span class="sxs-lookup"><span data-stu-id="5ab94-132">HTTP requests should be independent and may occur in any order, so keeping transient state information between requests is not feasible.</span></span> <span data-ttu-id="5ab94-133">Les ressources elles-mêmes représentent l’unique emplacement de stockage de ces informations. Chaque requête doit être une opération atomique.</span><span class="sxs-lookup"><span data-stu-id="5ab94-133">The only place where information is stored is in the resources themselves, and each request should be an atomic operation.</span></span> <span data-ttu-id="5ab94-134">Cette contrainte permet aux services web d’être extrêmement évolutifs, car il est inutile de conserver des affinités entre les clients et les serveurs spécifiques.</span><span class="sxs-lookup"><span data-stu-id="5ab94-134">This constraint enables web services to be highly scalable, because there is no need to retain any affinity between clients and specific servers.</span></span> <span data-ttu-id="5ab94-135">Tous les serveurs peuvent gérer des demandes provenant de n’importe quel client.</span><span class="sxs-lookup"><span data-stu-id="5ab94-135">Any server can handle any request from any client.</span></span> <span data-ttu-id="5ab94-136">Cela étant dit, d’autres facteurs peuvent limiter l’extensibilité.</span><span class="sxs-lookup"><span data-stu-id="5ab94-136">That said, other factors can limit scalability.</span></span> <span data-ttu-id="5ab94-137">Par exemple, de nombreux services web écrivent dans un magasin de données principal, dont vous pouvez difficilement augmenter la taille des instances. (L’article [Partitionnement des données](./data-partitioning.md) décrit les stratégies d’augmentation de la taille des instances d’un magasin de données.)</span><span class="sxs-lookup"><span data-stu-id="5ab94-137">For example, many web services write to a backend data store, which may be hard to scale out. (The article [Data Partitioning](./data-partitioning.md) describes strategies to scale out a data store.)</span></span>

- <span data-ttu-id="5ab94-138">Les API REST sont pilotées par des liens hypermédias qui figurent dans la représentation.</span><span class="sxs-lookup"><span data-stu-id="5ab94-138">REST APIs are driven by hypermedia links that are contained in the representation.</span></span> <span data-ttu-id="5ab94-139">L’exemple suivant montre une représentation JSON d’une commande.</span><span class="sxs-lookup"><span data-stu-id="5ab94-139">For example, the following shows a JSON representation of an order.</span></span> <span data-ttu-id="5ab94-140">Il contient des liens permettant d’obtenir ou de mettre à jour le client associé à la commande.</span><span class="sxs-lookup"><span data-stu-id="5ab94-140">It contains links to get or update the customer associated with the order.</span></span> 
 
    ```json
    {
        "orderID":3,
        "productID":2,
        "quantity":4,
        "orderValue":16.60,
        "links": [
            {"rel":"product","href":"https://adventure-works.com/customers/3", "action":"GET" },
            {"rel":"product","href":"https://adventure-works.com/customers/3", "action":"PUT" } 
        ]
    } 
    ```


<span data-ttu-id="5ab94-141">C’est en 2008 que Leonard Richardson a proposé le [ modèle de maturité](https://martinfowler.com/articles/richardsonMaturityModel.html) suivant pour les API web :</span><span class="sxs-lookup"><span data-stu-id="5ab94-141">In 2008, Leonard Richardson proposed the following [maturity model](https://martinfowler.com/articles/richardsonMaturityModel.html) for web APIs:</span></span>

- <span data-ttu-id="5ab94-142">Niveau 0 : Définir un URI, et toutes les opérations sont des requêtes POST envoyées à cet URI.</span><span class="sxs-lookup"><span data-stu-id="5ab94-142">Level 0: Define one URI, and all operations are POST requests to this URI.</span></span>
- <span data-ttu-id="5ab94-143">Niveau 1 : Créer des URI distincts pour des ressources individuelles.</span><span class="sxs-lookup"><span data-stu-id="5ab94-143">Level 1: Create separate URIs for individual resources.</span></span>
- <span data-ttu-id="5ab94-144">Niveau 2 : Utiliser des méthodes HTTP pour définir des opérations sur des ressources.</span><span class="sxs-lookup"><span data-stu-id="5ab94-144">Level 2: Use HTTP methods to define operations on resources.</span></span>
- <span data-ttu-id="5ab94-145">Niveau 3 : Utiliser l’hypermédia (HATEOAS, décrit ci-dessous).</span><span class="sxs-lookup"><span data-stu-id="5ab94-145">Level 3: Use hypermedia (HATEOAS, described below).</span></span>

<span data-ttu-id="5ab94-146">Le niveau 3 correspond à une véritable API RESTful, telle que définie par Roy Fielding.</span><span class="sxs-lookup"><span data-stu-id="5ab94-146">Level 3 corresponds to a truly RESTful API according to Fielding's definition.</span></span> <span data-ttu-id="5ab94-147">Dans la pratique, un grand nombre d’API web publiées se trouvent quelque part autour du niveau 2.</span><span class="sxs-lookup"><span data-stu-id="5ab94-147">In practice, many  published web APIs fall somewhere around level 2.</span></span>  

## <a name="organize-the-api-around-resources"></a><span data-ttu-id="5ab94-148">Organiser l’API autour des ressources</span><span class="sxs-lookup"><span data-stu-id="5ab94-148">Organize the API around resources</span></span>

<span data-ttu-id="5ab94-149">Concentrez-vous sur les entités métier exposées par l’API web.</span><span class="sxs-lookup"><span data-stu-id="5ab94-149">Focus on the business entities that the web API exposes.</span></span> <span data-ttu-id="5ab94-150">Par exemple, dans un système d’e-commerce, les entités principales peuvent être des clients et des commandes.</span><span class="sxs-lookup"><span data-stu-id="5ab94-150">For example, in an e-commerce system, the primary entities might be customers and orders.</span></span> <span data-ttu-id="5ab94-151">La création d’une commande peut être obtenue en envoyant une requête POST HTTP qui contient les informations de la commande.</span><span class="sxs-lookup"><span data-stu-id="5ab94-151">Creating an order can be achieved by sending an HTTP POST request that contains the order information.</span></span> <span data-ttu-id="5ab94-152">La réponse HTTP indique si la commande a été passée avec succès ou non.</span><span class="sxs-lookup"><span data-stu-id="5ab94-152">The HTTP response indicates whether the order was placed successfully or not.</span></span> <span data-ttu-id="5ab94-153">Lorsque cela est possible, les URI de ressource doivent être basées sur des noms (la ressource) et non sur des verbes (les opérations sur la ressource).</span><span class="sxs-lookup"><span data-stu-id="5ab94-153">When possible, resource URIs should be based on nouns (the resource) and not verbs (the operations on the resource).</span></span> 

```HTTP
https://adventure-works.com/orders // Good

https://adventure-works.com/create-order // Avoid
```

<span data-ttu-id="5ab94-154">Une ressource ne doit pas nécessairement être basée sur un élément de données physique unique.</span><span class="sxs-lookup"><span data-stu-id="5ab94-154">A resource does not have to be based on a single physical data item.</span></span> <span data-ttu-id="5ab94-155">Par exemple, une ressource de commande peut être implémentée en interne sous la forme de plusieurs tables d’une base de données relationnelle, mais présentée au client comme une entité unique.</span><span class="sxs-lookup"><span data-stu-id="5ab94-155">For example, an order resource might be implemented internally as several tables in a relational database, but presented to the client as a single entity.</span></span> <span data-ttu-id="5ab94-156">Évitez de créer des API qui reflètent simplement la structure interne d’une base de données.</span><span class="sxs-lookup"><span data-stu-id="5ab94-156">Avoid creating APIs that simply mirror the internal structure of a database.</span></span> <span data-ttu-id="5ab94-157">L’objectif de REST est de modéliser des entités et les opérations qu’une application peut effectuer sur ces entités.</span><span class="sxs-lookup"><span data-stu-id="5ab94-157">The purpose of REST is to model entities and the operations that an application can perform on those entities.</span></span> <span data-ttu-id="5ab94-158">Un client ne doit pas être exposé à l’implémentation interne.</span><span class="sxs-lookup"><span data-stu-id="5ab94-158">A client should not be exposed to the internal implementation.</span></span>

<span data-ttu-id="5ab94-159">Les entités sont souvent regroupées dans des collections (commandes, clients).</span><span class="sxs-lookup"><span data-stu-id="5ab94-159">Entities are often grouped together into collections (orders, customers).</span></span> <span data-ttu-id="5ab94-160">Une collection est une ressource distincte de l’élément dans la collection et doit avoir son propre URI.</span><span class="sxs-lookup"><span data-stu-id="5ab94-160">A collection is a separate resource from the item within the collection, and should have its own URI.</span></span> <span data-ttu-id="5ab94-161">Par exemple, l’URI suivant peut représenter la collection de commandes :</span><span class="sxs-lookup"><span data-stu-id="5ab94-161">For example, the following URI might represent the collection of orders:</span></span> 

```HTTP
https://adventure-works.com/orders
```

<span data-ttu-id="5ab94-162">L’envoi d’une requête GET HTTP à l’URI de la collection récupère une liste d’éléments dans la collection.</span><span class="sxs-lookup"><span data-stu-id="5ab94-162">Sending an HTTP GET request to the collection URI retrieves a list of items in the collection.</span></span> <span data-ttu-id="5ab94-163">Chaque élément de la collection possède également son propre URI unique.</span><span class="sxs-lookup"><span data-stu-id="5ab94-163">Each item in the collection also has its own unique URI.</span></span> <span data-ttu-id="5ab94-164">Une requête GET HTTP envoyée à l’URI de l’élément renvoie les détails de cet élément.</span><span class="sxs-lookup"><span data-stu-id="5ab94-164">An HTTP GET request to the item's URI returns the details of that item.</span></span> 

<span data-ttu-id="5ab94-165">Adoptez une convention d’affectation de noms cohérente pour les URI.</span><span class="sxs-lookup"><span data-stu-id="5ab94-165">Adopt a consistent naming convention in URIs.</span></span> <span data-ttu-id="5ab94-166">En général, il est recommandé d’utiliser des noms au pluriel pour les URI qui référencent des collections.</span><span class="sxs-lookup"><span data-stu-id="5ab94-166">In general, it helps to use plural nouns for URIs that reference collections.</span></span> <span data-ttu-id="5ab94-167">Il est judicieux d’organiser les URI pour les collections et les éléments dans une hiérarchie.</span><span class="sxs-lookup"><span data-stu-id="5ab94-167">It's a good practice to organize URIs for collections and items into a hierarchy.</span></span> <span data-ttu-id="5ab94-168">Par exemple, `/customers` est le chemin d’accès à la collection des clients, et `/customers/5` est le chemin d’accès au client avec un ID égal à 5.</span><span class="sxs-lookup"><span data-stu-id="5ab94-168">For example, `/customers` is the path to the customers collection, and `/customers/5` is the path to the customer with ID equal to 5.</span></span> <span data-ttu-id="5ab94-169">Cette approche contribue à préserver l’intuitivité de l’API web.</span><span class="sxs-lookup"><span data-stu-id="5ab94-169">This approach helps to keep the web API intuitive.</span></span> <span data-ttu-id="5ab94-170">En outre, plusieurs infrastructures d’API web peuvent acheminer les requêtes en fonction de chemins d’accès paramétrables pour que vous puissiez définir un itinéraire pour le chemin d’accès `/customers/{id}`.</span><span class="sxs-lookup"><span data-stu-id="5ab94-170">Also, many web API frameworks can route requests based on parameterized URI paths, so you could define a route for the path `/customers/{id}`.</span></span>

<span data-ttu-id="5ab94-171">Prenez également en compte les relations entre les différents types de ressources et la façon dont vous pouvez exposer ces associations.</span><span class="sxs-lookup"><span data-stu-id="5ab94-171">Also consider the relationships between different types of resources and how you might expose these associations.</span></span> <span data-ttu-id="5ab94-172">Par exemple, le `/customers/5/orders` peut représenter toutes les commandes du client 5.</span><span class="sxs-lookup"><span data-stu-id="5ab94-172">For example, the `/customers/5/orders` might represent all of the orders for customer 5.</span></span> <span data-ttu-id="5ab94-173">Vous pouvez également aller dans l’autre sens et représenter l’association d’une commande vers un client avec un URI tel que `/orders/99/customer`.</span><span class="sxs-lookup"><span data-stu-id="5ab94-173">You could also go in the other direction, and represent the association from an order back to a customer with a URI such as `/orders/99/customer`.</span></span> <span data-ttu-id="5ab94-174">Cependant, développer ce modèle de façon trop poussée peut complexifier son implémentation.</span><span class="sxs-lookup"><span data-stu-id="5ab94-174">However, extending this model too far can become cumbersome to implement.</span></span> <span data-ttu-id="5ab94-175">Une meilleure solution consiste à fournir des liens navigables vers des ressources associées dans le corps du message de réponse HTTP.</span><span class="sxs-lookup"><span data-stu-id="5ab94-175">A better solution is to provide navigable links to associated resources in the body of the HTTP response message.</span></span> <span data-ttu-id="5ab94-176">Ce mécanisme est décrit plus en détail dans la section [Utilisation de l’approche HATEOAS pour autoriser la navigation vers des ressources associées](#using-the-hateoas-approach-to-enable-navigation-to-related-resources) plus loin dans cet article.</span><span class="sxs-lookup"><span data-stu-id="5ab94-176">This mechanism is described in more detail in the section [Using the HATEOAS Approach to Enable Navigation To Related Resources later](#using-the-hateoas-approach-to-enable-navigation-to-related-resources).</span></span>

<span data-ttu-id="5ab94-177">Dans les systèmes plus complexes, il peut être tentant de fournir des URI qui permettent à un client de naviguer parmi différents niveaux de relations, tels que `/customers/1/orders/99/products`.</span><span class="sxs-lookup"><span data-stu-id="5ab94-177">In more complex systems, it can be tempting to provide URIs that enable a client to navigate through several levels of relationships, such as `/customers/1/orders/99/products`.</span></span> <span data-ttu-id="5ab94-178">Toutefois, ce niveau de complexité peut être difficile à gérer et n’offre aucune flexibilité si les relations entre les ressources changent ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="5ab94-178">However, this level of complexity can be difficult to maintain and is inflexible if the relationships between resources change in the future.</span></span> <span data-ttu-id="5ab94-179">Au lieu de cela, optez pour des URI aussi simples que possible.</span><span class="sxs-lookup"><span data-stu-id="5ab94-179">Instead, try to keep URIs relatively simple.</span></span> <span data-ttu-id="5ab94-180">Une fois qu’une application a une référence à une ressource, il doit être possible d’utiliser cette référence pour rechercher des éléments liés à cette ressource.</span><span class="sxs-lookup"><span data-stu-id="5ab94-180">Once an application has a reference to a resource, it should be possible to use this reference to find items related to that resource.</span></span> <span data-ttu-id="5ab94-181">La requête précédente peut être remplacée par l’URI `/customers/1/orders` pour rechercher toutes les commandes pour le client 1, puis par `/orders/99/products` pour rechercher les produits dans cette commande.</span><span class="sxs-lookup"><span data-stu-id="5ab94-181">The preceding query can be replaced with the URI `/customers/1/orders` to find all the orders for customer 1, and then `/orders/99/products` to find the products in this order.</span></span>

> [!TIP]
> <span data-ttu-id="5ab94-182">Évitez d’imposer des URI de ressource plus complexes que *collection/item/collection*.</span><span class="sxs-lookup"><span data-stu-id="5ab94-182">Avoid requiring resource URIs more complex than *collection/item/collection*.</span></span>

<span data-ttu-id="5ab94-183">Vous devez également garder à l’esprit que toutes les requêtes web imposent une charge sur le serveur web.</span><span class="sxs-lookup"><span data-stu-id="5ab94-183">Another factor is that all web requests impose a load on the web server.</span></span> <span data-ttu-id="5ab94-184">Plus le nombre de requêtes est important, plus la charge est élevée.</span><span class="sxs-lookup"><span data-stu-id="5ab94-184">The more requests, the bigger the load.</span></span> <span data-ttu-id="5ab94-185">Par conséquent, essayez d’éviter les API web effectuant de nombreux échanges et qui exposent un grand nombre de ressources de petite taille.</span><span class="sxs-lookup"><span data-stu-id="5ab94-185">Therefore, try to avoid "chatty" web APIs that expose a large number of small resources.</span></span> <span data-ttu-id="5ab94-186">Une telle API peut nécessiter l’envoi de plusieurs requêtes par une application cliente pour rechercher toutes les données requises.</span><span class="sxs-lookup"><span data-stu-id="5ab94-186">Such an API may require a client application to send multiple requests to find all of the data that it requires.</span></span> <span data-ttu-id="5ab94-187">À la place, vous souhaitez peut-être dénormaliser les données et combiner des informations connexes en ressources plus volumineuses, qui peuvent être récupérées à l’aide d’une seule requête.</span><span class="sxs-lookup"><span data-stu-id="5ab94-187">Instead, you might want to denormalize the data and combine related information into bigger resources that can be retrieved with a single request.</span></span> <span data-ttu-id="5ab94-188">Toutefois, vous devez mesurer cette approche par rapport à la surcharge imposée par l’extraction de données inutiles pour le client.</span><span class="sxs-lookup"><span data-stu-id="5ab94-188">However, you need to balance this approach against the overhead of fetching data that the client doesn't need.</span></span> <span data-ttu-id="5ab94-189">La récupération d’objets volumineux peut augmenter la latence d’une requête et entraîner des coûts supplémentaires liés à la bande passante.</span><span class="sxs-lookup"><span data-stu-id="5ab94-189">Retrieving large objects can increase the latency of a request and incur additional bandwidth costs.</span></span> <span data-ttu-id="5ab94-190">Pour plus d’informations sur ces antimodèles de performance, consultez [Antimodèle E/S bavardes](../antipatterns/chatty-io/index.md) et [Antimodèle de récupération superflue](../antipatterns/extraneous-fetching/index.md).</span><span class="sxs-lookup"><span data-stu-id="5ab94-190">For more information about these performance antipatterns, see [Chatty I/O](../antipatterns/chatty-io/index.md) and [Extraneous Fetching](../antipatterns/extraneous-fetching/index.md).</span></span>

<span data-ttu-id="5ab94-191">Évitez d’introduire des dépendances entre l’API web et les sources de données sous-jacentes.</span><span class="sxs-lookup"><span data-stu-id="5ab94-191">Avoid introducing dependencies between the web API and the underlying data sources.</span></span> <span data-ttu-id="5ab94-192">Par exemple, si vos données sont stockées dans une base de données relationnelle, l’API web n’a pas besoin d’exposer chaque table comme une collection de ressources.</span><span class="sxs-lookup"><span data-stu-id="5ab94-192">For example, if your data is stored in a relational database, the web API doesn't need to expose each table as a collection of resources.</span></span> <span data-ttu-id="5ab94-193">En fait, il s’agit probablement d’une conception médiocre.</span><span class="sxs-lookup"><span data-stu-id="5ab94-193">In fact, that's probably a poor design.</span></span> <span data-ttu-id="5ab94-194">Au lieu de cela, considérez l’API web comme une abstraction de la base de données.</span><span class="sxs-lookup"><span data-stu-id="5ab94-194">Instead, think of the web API as an abstraction of the database.</span></span> <span data-ttu-id="5ab94-195">Si nécessaire, ajoutez une couche de mappage entre la base de données et l’API web.</span><span class="sxs-lookup"><span data-stu-id="5ab94-195">If necessary, introduce a mapping layer between the database and the web API.</span></span> <span data-ttu-id="5ab94-196">De cette façon, les applications clientes sont isolées des modifications apportées au schéma de base de données sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="5ab94-196">That way, client applications are isolated from changes to the underlying database scheme.</span></span>

<span data-ttu-id="5ab94-197">Enfin, il n’est pas toujours possible de mapper chaque opération implémentée par une API web à une ressource spécifique.</span><span class="sxs-lookup"><span data-stu-id="5ab94-197">Finally, it might not be possible to map every operation implemented by a web API to a specific resource.</span></span> <span data-ttu-id="5ab94-198">Vous pouvez gérer ces scénarios *sans ressource* par le biais de requêtes HTTP qui appellent une fonction et renvoient les résultats dans un message de réponse HTTP.</span><span class="sxs-lookup"><span data-stu-id="5ab94-198">You can handle such *non-resource* scenarios through HTTP requests that invoke a function and return the results as an HTTP response message.</span></span> <span data-ttu-id="5ab94-199">Par exemple, une API web qui implémente des opérations de calcul simples, comme une addition ou une soustraction, peut fournir des URI qui exposent ces opérations en tant que pseudo-ressources et utilisent la chaîne de requête pour spécifier les paramètres requis.</span><span class="sxs-lookup"><span data-stu-id="5ab94-199">For example, a web API that implements simple calculator operations such as add and subtract could provide URIs that expose these operations as pseudo resources and use the query string to specify the parameters required.</span></span> <span data-ttu-id="5ab94-200">Par exemple, une requête GET envoyée à l’URI */add?operand1=99&operand2=1* renvoie un message de réponse dont le corps contient la valeur 100.</span><span class="sxs-lookup"><span data-stu-id="5ab94-200">For example a GET request to the URI */add?operand1=99&operand2=1* would return a response message with the body containing the value 100.</span></span> <span data-ttu-id="5ab94-201">Toutefois, utilisez ces formes d’URI avec parcimonie.</span><span class="sxs-lookup"><span data-stu-id="5ab94-201">However, only use these forms of URIs sparingly.</span></span>

## <a name="define-operations-in-terms-of-http-methods"></a><span data-ttu-id="5ab94-202">Définir des opérations en termes de méthodes HTTP</span><span class="sxs-lookup"><span data-stu-id="5ab94-202">Define operations in terms of HTTP methods</span></span>

<span data-ttu-id="5ab94-203">Le protocole HTTP définit un certain nombre de méthodes qui affectent une signification sémantique à une requête.</span><span class="sxs-lookup"><span data-stu-id="5ab94-203">The HTTP protocol defines a number of methods that assign semantic meaning to a request.</span></span> <span data-ttu-id="5ab94-204">Les méthodes HTTP utilisées par la plupart des API web RESTful sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="5ab94-204">The common HTTP methods used by most RESTful web APIs are:</span></span>

* <span data-ttu-id="5ab94-205">**GET** récupère une représentation de la ressource à l’URI spécifié.</span><span class="sxs-lookup"><span data-stu-id="5ab94-205">**GET** retrieves a representation of the resource at the specified URI.</span></span> <span data-ttu-id="5ab94-206">Le corps du message de réponse contient les détails de la ressource demandée.</span><span class="sxs-lookup"><span data-stu-id="5ab94-206">The body of the response message contains the details of the requested resource.</span></span>
* <span data-ttu-id="5ab94-207">**POST** crée une ressource à l’URI spécifié.</span><span class="sxs-lookup"><span data-stu-id="5ab94-207">**POST** creates a new resource at the specified URI.</span></span> <span data-ttu-id="5ab94-208">Le corps du message de requête fournit les détails de la nouvelle ressource.</span><span class="sxs-lookup"><span data-stu-id="5ab94-208">The body of the request message provides the details of the new resource.</span></span> <span data-ttu-id="5ab94-209">Notez que POST permet également de déclencher des opérations qui ne créent pas réellement de ressources.</span><span class="sxs-lookup"><span data-stu-id="5ab94-209">Note that POST can also be used to trigger operations that don't actually create resources.</span></span>
* <span data-ttu-id="5ab94-210">**PUT** crée ou remplace la ressource à l’URI spécifié.</span><span class="sxs-lookup"><span data-stu-id="5ab94-210">**PUT** either creates or replaces the resource at the specified URI.</span></span> <span data-ttu-id="5ab94-211">Le corps du message de requête spécifie la ressource à créer ou mettre à jour.</span><span class="sxs-lookup"><span data-stu-id="5ab94-211">The body of the request message specifies the resource to be created or updated.</span></span>
* <span data-ttu-id="5ab94-212">**PATCH** effectue une mise à jour partielle d’une ressource.</span><span class="sxs-lookup"><span data-stu-id="5ab94-212">**PATCH** performs a partial update of a resource.</span></span> <span data-ttu-id="5ab94-213">Le corps de la requête spécifie l’ensemble de modifications à appliquer à la ressource.</span><span class="sxs-lookup"><span data-stu-id="5ab94-213">The request body specifies the set of changes to apply to the resource.</span></span>
* <span data-ttu-id="5ab94-214">**DELETE** supprime la ressource à l’URI spécifié.</span><span class="sxs-lookup"><span data-stu-id="5ab94-214">**DELETE** removes the resource at the specified URI.</span></span>

<span data-ttu-id="5ab94-215">L’effet d’une requête spécifique sera différent, selon que la ressource est une collection ou un élément individuel.</span><span class="sxs-lookup"><span data-stu-id="5ab94-215">The effect of a specific request should depend on whether the resource is a collection or an individual item.</span></span> <span data-ttu-id="5ab94-216">Le tableau suivant résume les conventions courantes adoptées par la plupart des implémentations RESTful suivant l’exemple du commerce électronique.</span><span class="sxs-lookup"><span data-stu-id="5ab94-216">The following table summarizes the common conventions adopted by most RESTful implementations using the ecommerce example.</span></span> <span data-ttu-id="5ab94-217">Notez que certaines de ces requêtes ne peuvent pas être implémentées ; cela dépend du scénario spécifique.</span><span class="sxs-lookup"><span data-stu-id="5ab94-217">Note that not all of these requests might be implemented; it depends on the specific scenario.</span></span>

| <span data-ttu-id="5ab94-218">**Ressource**</span><span class="sxs-lookup"><span data-stu-id="5ab94-218">**Resource**</span></span> | <span data-ttu-id="5ab94-219">**POST**</span><span class="sxs-lookup"><span data-stu-id="5ab94-219">**POST**</span></span> | <span data-ttu-id="5ab94-220">**GET**</span><span class="sxs-lookup"><span data-stu-id="5ab94-220">**GET**</span></span> | <span data-ttu-id="5ab94-221">**PUT**</span><span class="sxs-lookup"><span data-stu-id="5ab94-221">**PUT**</span></span> | <span data-ttu-id="5ab94-222">**DELETE**</span><span class="sxs-lookup"><span data-stu-id="5ab94-222">**DELETE**</span></span> |
| --- | --- | --- | --- | --- |
| <span data-ttu-id="5ab94-223">/customers</span><span class="sxs-lookup"><span data-stu-id="5ab94-223">/customers</span></span> |<span data-ttu-id="5ab94-224">Créer un client</span><span class="sxs-lookup"><span data-stu-id="5ab94-224">Create a new customer</span></span> |<span data-ttu-id="5ab94-225">Récupérer tous les clients</span><span class="sxs-lookup"><span data-stu-id="5ab94-225">Retrieve all customers</span></span> |<span data-ttu-id="5ab94-226">Mettre à jour des clients en bloc</span><span class="sxs-lookup"><span data-stu-id="5ab94-226">Bulk update of customers</span></span> |<span data-ttu-id="5ab94-227">Supprimer tous les clients</span><span class="sxs-lookup"><span data-stu-id="5ab94-227">Remove all customers</span></span> |
| <span data-ttu-id="5ab94-228">/customers/1</span><span class="sxs-lookup"><span data-stu-id="5ab94-228">/customers/1</span></span> |<span data-ttu-id="5ab94-229">Error</span><span class="sxs-lookup"><span data-stu-id="5ab94-229">Error</span></span> |<span data-ttu-id="5ab94-230">Récupérer les détails du client 1</span><span class="sxs-lookup"><span data-stu-id="5ab94-230">Retrieve the details for customer 1</span></span> |<span data-ttu-id="5ab94-231">Mettre à jour les détails du client 1 s’il existe</span><span class="sxs-lookup"><span data-stu-id="5ab94-231">Update the details of customer 1 if it exists</span></span> |<span data-ttu-id="5ab94-232">Supprimer le client 1</span><span class="sxs-lookup"><span data-stu-id="5ab94-232">Remove customer 1</span></span> |
| <span data-ttu-id="5ab94-233">/customers/1/orders</span><span class="sxs-lookup"><span data-stu-id="5ab94-233">/customers/1/orders</span></span> |<span data-ttu-id="5ab94-234">Créer une commande pour le client 1</span><span class="sxs-lookup"><span data-stu-id="5ab94-234">Create a new order for customer 1</span></span> |<span data-ttu-id="5ab94-235">Récupérer toutes les commandes pour le client 1</span><span class="sxs-lookup"><span data-stu-id="5ab94-235">Retrieve all orders for customer 1</span></span> |<span data-ttu-id="5ab94-236">Mettre à jour des commandes en bloc pour le client 1</span><span class="sxs-lookup"><span data-stu-id="5ab94-236">Bulk update of orders for customer 1</span></span> |<span data-ttu-id="5ab94-237">Supprimer toutes les commandes pour le client 1</span><span class="sxs-lookup"><span data-stu-id="5ab94-237">Remove all orders for customer 1</span></span> |

<span data-ttu-id="5ab94-238">Les différences entre POST, PUT et PATCH peuvent prêter à confusion.</span><span class="sxs-lookup"><span data-stu-id="5ab94-238">The differences between POST, PUT, and PATCH can be confusing.</span></span>

- <span data-ttu-id="5ab94-239">Une requête POST crée une ressource.</span><span class="sxs-lookup"><span data-stu-id="5ab94-239">A POST request creates a resource.</span></span> <span data-ttu-id="5ab94-240">Le serveur assigne un URI à la nouvelle ressource et renvoie cet URI au client.</span><span class="sxs-lookup"><span data-stu-id="5ab94-240">The server assigns a URI for the new resource, and returns that URI to the client.</span></span> <span data-ttu-id="5ab94-241">Dans le modèle REST, vous appliquez fréquemment les requêtes POST aux collections.</span><span class="sxs-lookup"><span data-stu-id="5ab94-241">In the REST model, you frequently apply POST requests to collections.</span></span> <span data-ttu-id="5ab94-242">La nouvelle ressource est ajoutée à la collection.</span><span class="sxs-lookup"><span data-stu-id="5ab94-242">The new resource is added to the collection.</span></span> <span data-ttu-id="5ab94-243">Une requête POST peut également être utilisée pour envoyer des données pour le traitement d’une ressource existante, sans qu’une nouvelle ressource ne soit créée.</span><span class="sxs-lookup"><span data-stu-id="5ab94-243">A POST request can also be used to submit data for processing to an existing resource, without any new resource being created.</span></span>

- <span data-ttu-id="5ab94-244">Une requête PUT crée une ressource *ou* met à jour une ressource existante.</span><span class="sxs-lookup"><span data-stu-id="5ab94-244">A PUT request creates a resource *or* updates an existing resource.</span></span> <span data-ttu-id="5ab94-245">Le client spécifie l’URI de la ressource.</span><span class="sxs-lookup"><span data-stu-id="5ab94-245">The client specifies the URI for the resource.</span></span> <span data-ttu-id="5ab94-246">Le corps de la requête contient une représentation complète de la ressource.</span><span class="sxs-lookup"><span data-stu-id="5ab94-246">The request body contains a complete representation of the resource.</span></span> <span data-ttu-id="5ab94-247">Si une ressource avec cet URI existe déjà, elle est remplacée.</span><span class="sxs-lookup"><span data-stu-id="5ab94-247">If a resource with this URI already exists, it is replaced.</span></span> <span data-ttu-id="5ab94-248">Sinon, une ressource est créée si le serveur peut prendre en charge cette opération.</span><span class="sxs-lookup"><span data-stu-id="5ab94-248">Otherwise a new resource is created, if the server supports doing so.</span></span> <span data-ttu-id="5ab94-249">Les requêtes PUT sont plus fréquemment appliquées à des ressources qui sont des éléments individuels, par exemple un client spécifique, plutôt qu’à des collections.</span><span class="sxs-lookup"><span data-stu-id="5ab94-249">PUT requests are most frequently applied to resources that are individual items, such as a specific customer, rather than collections.</span></span> <span data-ttu-id="5ab94-250">Un serveur peut prendre en charge les mises à jour, mais pas la création via la méthode PUT.</span><span class="sxs-lookup"><span data-stu-id="5ab94-250">A server might support updates but not creation via PUT.</span></span> <span data-ttu-id="5ab94-251">Prendre en charge la création via la méthode PUT dépend de la capacité du client à assigner de façon explicite un URI à une ressource avant qu’elle existe.</span><span class="sxs-lookup"><span data-stu-id="5ab94-251">Whether to support creation via PUT depends on whether the client can meaningfully assign a URI to a resource before it exists.</span></span> <span data-ttu-id="5ab94-252">S’il n’est pas en mesure de le faire, utilisez la méthode POST pour créer des ressources et les méthodes PUT ou PATCH pour effectuer une mise à jour.</span><span class="sxs-lookup"><span data-stu-id="5ab94-252">If not, then use POST to create resources and PUT or PATCH to update.</span></span>

- <span data-ttu-id="5ab94-253">Une requête PATCH effectue une *mise à jour partielle* vers une ressource existante.</span><span class="sxs-lookup"><span data-stu-id="5ab94-253">A PATCH request performs a *partial update* to an existing resource.</span></span> <span data-ttu-id="5ab94-254">Le client spécifie l’URI de la ressource.</span><span class="sxs-lookup"><span data-stu-id="5ab94-254">The client specifies the URI for the resource.</span></span> <span data-ttu-id="5ab94-255">Le corps de la requête spécifie un ensemble de *modifications* à appliquer à la ressource.</span><span class="sxs-lookup"><span data-stu-id="5ab94-255">The request body specifies a set of *changes* to apply to the resource.</span></span> <span data-ttu-id="5ab94-256">Cela peut être plus efficace que l’utilisation de la méthode PUT, étant donné que le client envoie uniquement les modifications, et non pas la représentation entière de la ressource.</span><span class="sxs-lookup"><span data-stu-id="5ab94-256">This can be more efficient than using PUT, because the client only sends the changes, not the entire representation of the resource.</span></span> <span data-ttu-id="5ab94-257">Techniquement, la méthode PATCH peut également créer une ressource (en spécifiant un ensemble de mises à jour vers une ressource « null »), si le serveur prend en charge cette opération.</span><span class="sxs-lookup"><span data-stu-id="5ab94-257">Technically PATCH can also create a new resource (by specifying a set of updates to a "null" resource), if the server supports this.</span></span> 

<span data-ttu-id="5ab94-258">Les requêtes PUT doivent être idempotentes.</span><span class="sxs-lookup"><span data-stu-id="5ab94-258">PUT requests must be idempotent.</span></span> <span data-ttu-id="5ab94-259">Si un client envoie la même requête PUT plusieurs fois, les résultats doivent toujours être identiques (la même ressource sera modifiée avec les mêmes valeurs).</span><span class="sxs-lookup"><span data-stu-id="5ab94-259">If a client submits the same PUT request multiple times, the results should always be the same (the same resource will be modified with the same values).</span></span> <span data-ttu-id="5ab94-260">Le caractère idempotent des requêtes POST et PATCH n’est pas garanti.</span><span class="sxs-lookup"><span data-stu-id="5ab94-260">POST and PATCH requests are not guaranteed to be idempotent.</span></span>

## <a name="conform-to-http-semantics"></a><span data-ttu-id="5ab94-261">Être en conformité par rapport à la sémantique HTTP</span><span class="sxs-lookup"><span data-stu-id="5ab94-261">Conform to HTTP semantics</span></span>

<span data-ttu-id="5ab94-262">Cette section décrit certaines considérations classiques liées à la conception d’une API conforme à la spécification HTTP.</span><span class="sxs-lookup"><span data-stu-id="5ab94-262">This section describes some typical considerations for designing an API that conforms to the HTTP specification.</span></span> <span data-ttu-id="5ab94-263">Toutefois, elle n’aborde pas tous les détails ou scénarios possibles.</span><span class="sxs-lookup"><span data-stu-id="5ab94-263">However, it doesn't cover every possible detail or scenario.</span></span> <span data-ttu-id="5ab94-264">En cas de doute, consultez les spécifications HTTP.</span><span class="sxs-lookup"><span data-stu-id="5ab94-264">When in doubt, consult the HTTP specifications.</span></span>

### <a name="media-types"></a><span data-ttu-id="5ab94-265">Types de médias</span><span class="sxs-lookup"><span data-stu-id="5ab94-265">Media types</span></span>

<span data-ttu-id="5ab94-266">Comme mentionné précédemment, les clients et les serveurs échangent des représentations de ressources.</span><span class="sxs-lookup"><span data-stu-id="5ab94-266">As mentioned earlier, clients and servers exchange representations of resources.</span></span> <span data-ttu-id="5ab94-267">Par exemple, dans une requête POST, le corps de la requête contient une représentation de la ressource à créer.</span><span class="sxs-lookup"><span data-stu-id="5ab94-267">For example, in a POST request, the request body contains a representation of the resource to create.</span></span> <span data-ttu-id="5ab94-268">Dans une requête GET, le corps de la réponse contient une représentation de la ressource extraite.</span><span class="sxs-lookup"><span data-stu-id="5ab94-268">In a GET request, the response body contains a representation of the fetched resource.</span></span>

<span data-ttu-id="5ab94-269">Dans le protocole HTTP, les formats sont spécifiés à l’aide de *types de médias*, également appelés types MIME.</span><span class="sxs-lookup"><span data-stu-id="5ab94-269">In the HTTP protocol, formats are specified through the use of *media types*, also called MIME types.</span></span> <span data-ttu-id="5ab94-270">Pour les données non binaires, la plupart des API web prennent en charge JSON (type de média = application/json) et éventuellement XML (type de média = application/xml).</span><span class="sxs-lookup"><span data-stu-id="5ab94-270">For non-binary data, most web APIs support JSON (media type = application/json) and possibly XML (media type = application/xml).</span></span> 

<span data-ttu-id="5ab94-271">L’en-tête Content-Type dans une requête ou une réponse spécifie le format de la représentation.</span><span class="sxs-lookup"><span data-stu-id="5ab94-271">The Content-Type header in a request or response specifies the format of the representation.</span></span> <span data-ttu-id="5ab94-272">Voici un exemple d’une requête POST qui comprend des données JSON :</span><span class="sxs-lookup"><span data-stu-id="5ab94-272">Here is an example of a POST request that includes JSON data:</span></span>

```HTTP
POST https://adventure-works.com/orders HTTP/1.1
Content-Type: application/json; charset=utf-8
Content-Length: 57

{"Id":1,"Name":"Gizmo","Category":"Widgets","Price":1.99}
```

<span data-ttu-id="5ab94-273">Si le serveur ne prend pas en charge le type de média, il doit renvoyer le code d’état HTTP 415 (Type de support non pris en charge).</span><span class="sxs-lookup"><span data-stu-id="5ab94-273">If the server doesn't support the media type, it should return HTTP status code 415 (Unsupported Media Type).</span></span>

<span data-ttu-id="5ab94-274">Une requête cliente peut inclure un en-tête Accept qui contient une liste des types de médias acceptés par le client à partir du serveur dans le message de réponse.</span><span class="sxs-lookup"><span data-stu-id="5ab94-274">A client request can include an Accept header that contains a list of media types the client will accept from the server in the response message.</span></span> <span data-ttu-id="5ab94-275">Par exemple : </span><span class="sxs-lookup"><span data-stu-id="5ab94-275">For example:</span></span>

```HTTP
GET https://adventure-works.com/orders/2 HTTP/1.1
Accept: application/json
```

<span data-ttu-id="5ab94-276">Si le serveur ne trouve pas de correspondances avec l’un des types de médias répertoriés, il doit renvoyer le code d’état HTTP 406 (Non acceptable).</span><span class="sxs-lookup"><span data-stu-id="5ab94-276">If the server cannot match any of the media type(s) listed, it should return HTTP status code 406 (Not Acceptable).</span></span> 

### <a name="get-methods"></a><span data-ttu-id="5ab94-277">Méthodes GET</span><span class="sxs-lookup"><span data-stu-id="5ab94-277">GET methods</span></span>

<span data-ttu-id="5ab94-278">En général, une méthode GET réussie renvoie le code d’état HTTP 200 (OK).</span><span class="sxs-lookup"><span data-stu-id="5ab94-278">A successful GET method typically returns HTTP status code 200 (OK).</span></span> <span data-ttu-id="5ab94-279">Si la ressource est introuvable, la méthode doit renvoyer 404 (Introuvable).</span><span class="sxs-lookup"><span data-stu-id="5ab94-279">If the resource cannot be found, the method should return 404 (Not Found).</span></span>

### <a name="post-methods"></a><span data-ttu-id="5ab94-280">Méthodes POST</span><span class="sxs-lookup"><span data-stu-id="5ab94-280">POST methods</span></span>

<span data-ttu-id="5ab94-281">Si une méthode POST crée une ressource, elle renvoie le code d’état HTTP 201 (Créé).</span><span class="sxs-lookup"><span data-stu-id="5ab94-281">If a POST method creates a new resource, it returns HTTP status code 201 (Created).</span></span> <span data-ttu-id="5ab94-282">L’URI de la nouvelle ressource est inclus dans l’en-tête Location de la réponse.</span><span class="sxs-lookup"><span data-stu-id="5ab94-282">The URI of the new resource is included in the Location header of the response.</span></span> <span data-ttu-id="5ab94-283">Le corps de la réponse contient une représentation de la ressource.</span><span class="sxs-lookup"><span data-stu-id="5ab94-283">The response body contains a representation of the resource.</span></span>

<span data-ttu-id="5ab94-284">Si la méthode effectue des opérations de traitement, mais ne crée pas de ressource, elle peut renvoyer le code d’état HTTP 200 et inclure le résultat de l’opération dans le corps de la réponse.</span><span class="sxs-lookup"><span data-stu-id="5ab94-284">If the method does some processing but does not create a new resource, the method can return HTTP status code 200 and include the result of the operation in the response body.</span></span> <span data-ttu-id="5ab94-285">Ou bien, en l’absence de résultat à renvoyer, la méthode peut renvoyer le code d’état HTTP 204 (Pas de contenu) sans corps de réponse.</span><span class="sxs-lookup"><span data-stu-id="5ab94-285">Alternatively, if there is no result to return, the method can return HTTP status code 204 (No Content) with no response body.</span></span>

<span data-ttu-id="5ab94-286">Si le client place des données non valides dans la requête, le serveur doit renvoyer le code d’état HTTP 400 (Demande incorrecte).</span><span class="sxs-lookup"><span data-stu-id="5ab94-286">If the client puts invalid data into the request, the server should return HTTP status code 400 (Bad Request).</span></span> <span data-ttu-id="5ab94-287">Le corps de la réponse peut contenir des informations supplémentaires sur l’erreur ou un lien vers un URI qui fournit plus de détails.</span><span class="sxs-lookup"><span data-stu-id="5ab94-287">The response body can contain additional information about the error or a link to a URI that provides more details.</span></span>

### <a name="put-methods"></a><span data-ttu-id="5ab94-288">Méthodes PUT</span><span class="sxs-lookup"><span data-stu-id="5ab94-288">PUT methods</span></span>

<span data-ttu-id="5ab94-289">Si une méthode PUT crée une ressource, elle renvoie le code d’état HTTP 201 (Créé), comme pour la méthode POST.</span><span class="sxs-lookup"><span data-stu-id="5ab94-289">If a PUT method creates a new resource, it returns HTTP status code 201 (Created), as with a POST method.</span></span> <span data-ttu-id="5ab94-290">Si la méthode met à jour une ressource existante, elle renvoie 200 (OK) ou 204 (Pas de contenu).</span><span class="sxs-lookup"><span data-stu-id="5ab94-290">If the method updates an existing resource, it returns either 200 (OK) or 204 (No Content).</span></span> <span data-ttu-id="5ab94-291">Dans certains cas, mettre à jour une ressource existante peut se révéler impossible.</span><span class="sxs-lookup"><span data-stu-id="5ab94-291">In some cases, it might not be possible to update an existing resource.</span></span> <span data-ttu-id="5ab94-292">Dans ce cas, envisagez de renvoyer le code d’état HTTP 409 (Conflit).</span><span class="sxs-lookup"><span data-stu-id="5ab94-292">In that case, consider returning HTTP status code 409 (Conflict).</span></span> 

<span data-ttu-id="5ab94-293">Envisagez d’implémenter des opérations HTTP PUT en bloc, qui peuvent regrouper des mises à jour destinées à plusieurs ressources d’une collection.</span><span class="sxs-lookup"><span data-stu-id="5ab94-293">Consider implementing bulk HTTP PUT operations that can batch updates to multiple resources in a collection.</span></span> <span data-ttu-id="5ab94-294">La requête PUT doit spécifier l’URI de la collection, et le corps de la requête doit spécifier les détails des ressources à modifier.</span><span class="sxs-lookup"><span data-stu-id="5ab94-294">The PUT request should specify the URI of the collection, and the request body should specify the details of the resources to be modified.</span></span> <span data-ttu-id="5ab94-295">Cette approche peut aider à réduire les échanges excessifs et à améliorer les performances.</span><span class="sxs-lookup"><span data-stu-id="5ab94-295">This approach can help to reduce chattiness and improve performance.</span></span>

### <a name="patch-methods"></a><span data-ttu-id="5ab94-296">Méthodes PATCH</span><span class="sxs-lookup"><span data-stu-id="5ab94-296">PATCH methods</span></span>

<span data-ttu-id="5ab94-297">Avec une requête PATCH, le client envoie un ensemble de mises à jour à une ressource existante, sous la forme d’un *document de correctif*.</span><span class="sxs-lookup"><span data-stu-id="5ab94-297">With a PATCH request, the client sends a set of updates to an existing resource, in the form of a *patch document*.</span></span> <span data-ttu-id="5ab94-298">Le serveur traite le document de correctif pour effectuer la mise à jour.</span><span class="sxs-lookup"><span data-stu-id="5ab94-298">The server processes the patch document to perform the update.</span></span> <span data-ttu-id="5ab94-299">Le document de correctif ne décrit pas la ressource entière, mais uniquement un ensemble de modifications à appliquer.</span><span class="sxs-lookup"><span data-stu-id="5ab94-299">The patch document doesn't describe the whole resource, only a set of changes to apply.</span></span> <span data-ttu-id="5ab94-300">La spécification de la méthode PATCH ([RFC 5789](https://tools.ietf.org/html/rfc5789)) ne définit pas un format particulier pour les documents de correctif.</span><span class="sxs-lookup"><span data-stu-id="5ab94-300">The specification for the PATCH method ([RFC 5789](https://tools.ietf.org/html/rfc5789)) doesn't define a particular format for patch documents.</span></span> <span data-ttu-id="5ab94-301">Le format doit être déduit à partir du type de média dans la requête.</span><span class="sxs-lookup"><span data-stu-id="5ab94-301">The format must be inferred from the media type in the request.</span></span>

<span data-ttu-id="5ab94-302">JSON est probablement le format de données le plus courant pour les API web.</span><span class="sxs-lookup"><span data-stu-id="5ab94-302">JSON is probably the most common data format for web APIs.</span></span> <span data-ttu-id="5ab94-303">Il existe deux formats de correctif principaux basés sur JSON, appelés *correctif JSON* et *correctif de fusion JSON*.</span><span class="sxs-lookup"><span data-stu-id="5ab94-303">There are two main JSON-based patch formats, called *JSON patch* and *JSON merge patch*.</span></span>

<span data-ttu-id="5ab94-304">Le correctif de fusion JSON est un peu plus simple.</span><span class="sxs-lookup"><span data-stu-id="5ab94-304">JSON merge patch is somewhat simpler.</span></span> <span data-ttu-id="5ab94-305">Le document de correctif a la même structure que la ressource JSON d’origine, mais inclut uniquement le sous-ensemble de champs à modifier ou à ajouter.</span><span class="sxs-lookup"><span data-stu-id="5ab94-305">The patch document has the same structure as the original JSON resource, but includes just the subset of fields that should be changed or added.</span></span> <span data-ttu-id="5ab94-306">En outre, un champ peut être supprimé en spécifiant `null` pour la valeur du champ dans le document de correctif.</span><span class="sxs-lookup"><span data-stu-id="5ab94-306">In addition, a field can be deleted by specifying `null` for the field value in the patch document.</span></span> <span data-ttu-id="5ab94-307">(Cela signifie que le correctif de fusion n’est pas adapté si la ressource d’origine peut avoir des valeurs null explicites.)</span><span class="sxs-lookup"><span data-stu-id="5ab94-307">(That means merge patch is not suitable if the original resource can have explicit null values.)</span></span>

<span data-ttu-id="5ab94-308">Par exemple, supposons que la ressource d’origine ait la représentation JSON suivante :</span><span class="sxs-lookup"><span data-stu-id="5ab94-308">For example, suppose the original resource has the following JSON representation:</span></span>

```json
{ 
    "name":"gizmo",
    "category":"widgets",
    "color":"blue",
    "price":10
}
```

<span data-ttu-id="5ab94-309">Voici un correctif de fusion JSON possible pour cette ressource :</span><span class="sxs-lookup"><span data-stu-id="5ab94-309">Here is a possible JSON merge patch for this resource:</span></span>

```json
{ 
    "price":12,
    "color":null,
    "size":"small"
}
```

<span data-ttu-id="5ab94-310">Cela indique au serveur de mettre à jour « price », de supprimer « color » et d’ajouter « size ».</span><span class="sxs-lookup"><span data-stu-id="5ab94-310">This tells the server to update "price", delete "color", and add "size".</span></span> <span data-ttu-id="5ab94-311">« Name » et « category » ne sont pas modifiés.</span><span class="sxs-lookup"><span data-stu-id="5ab94-311">"Name" and "category" are not modified.</span></span> <span data-ttu-id="5ab94-312">Pour des informations plus précises sur le correctif de fusion JSON, consultez [RFC 7396](https://tools.ietf.org/html/rfc7396).</span><span class="sxs-lookup"><span data-stu-id="5ab94-312">For the exact details of JSON merge patch, see [RFC 7396](https://tools.ietf.org/html/rfc7396).</span></span> <span data-ttu-id="5ab94-313">Le type de média pour le correctif de fusion JSON est « application/merge-patch+json ».</span><span class="sxs-lookup"><span data-stu-id="5ab94-313">The media type for JSON merge patch is "application/merge-patch+json".</span></span>

<span data-ttu-id="5ab94-314">Le correctif de fusion n’est pas adapté si la ressource d’origine peut contenir des valeurs null explicites, en raison du sens particulier de `null` dans le document de correctif.</span><span class="sxs-lookup"><span data-stu-id="5ab94-314">Merge patch is not suitable if the original resource can contain explicit null values, due to the special meaning of `null` in the patch document.</span></span> <span data-ttu-id="5ab94-315">En outre, le document de correctif ne spécifie pas l’ordre selon lequel le serveur doit appliquer les mises à jour.</span><span class="sxs-lookup"><span data-stu-id="5ab94-315">Also, the patch document doesn't specify the order that the server should apply the updates.</span></span> <span data-ttu-id="5ab94-316">Cela peut, ou non, avoir son importance, selon le domaine et les données concernées.</span><span class="sxs-lookup"><span data-stu-id="5ab94-316">That may or may not matter, depending on the data and the domain.</span></span> <span data-ttu-id="5ab94-317">Le correctif JSON, défini dans [RFC 6902](https://tools.ietf.org/html/rfc6902), est plus souple.</span><span class="sxs-lookup"><span data-stu-id="5ab94-317">JSON patch, defined in [RFC 6902](https://tools.ietf.org/html/rfc6902), is more flexible.</span></span> <span data-ttu-id="5ab94-318">Il spécifie les modifications comme une séquence d’opérations à appliquer.</span><span class="sxs-lookup"><span data-stu-id="5ab94-318">It specifies the changes as a sequence of operations to apply.</span></span> <span data-ttu-id="5ab94-319">Les opérations incluent l’ajout, la suppression, le remplacement, la copie et le test (pour valider les valeurs).</span><span class="sxs-lookup"><span data-stu-id="5ab94-319">Operations include add, remove, replace, copy, and test (to validate values).</span></span> <span data-ttu-id="5ab94-320">Le type de média pour le correctif JSON est « application/json-patch+json ».</span><span class="sxs-lookup"><span data-stu-id="5ab94-320">The media type for JSON patch is "application/json-patch+json".</span></span>

<span data-ttu-id="5ab94-321">Vous trouverez ci-dessous des états d’erreur classiques pouvant être rencontrés lors du traitement d’une requête PATCH, accompagnés du code d’état HTTP approprié.</span><span class="sxs-lookup"><span data-stu-id="5ab94-321">Here are some typical error conditions that might be encountered when processing a PATCH request, along with the appropriate HTTP status code.</span></span>

| <span data-ttu-id="5ab94-322">État d’erreur</span><span class="sxs-lookup"><span data-stu-id="5ab94-322">Error condition</span></span> | <span data-ttu-id="5ab94-323">Code d'état HTTP</span><span class="sxs-lookup"><span data-stu-id="5ab94-323">HTTP status code</span></span> |
|-----------|------------|
| <span data-ttu-id="5ab94-324">Le format de document de correctif n’est pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="5ab94-324">The patch document format isn't supported.</span></span> | <span data-ttu-id="5ab94-325">415 (Type de support non pris en charge)</span><span class="sxs-lookup"><span data-stu-id="5ab94-325">415 (Unsupported Media Type)</span></span> |
| <span data-ttu-id="5ab94-326">Document de correctif incorrect.</span><span class="sxs-lookup"><span data-stu-id="5ab94-326">Malformed patch document.</span></span> | <span data-ttu-id="5ab94-327">400 (Demande incorrecte)</span><span class="sxs-lookup"><span data-stu-id="5ab94-327">400 (Bad Request)</span></span> |
| <span data-ttu-id="5ab94-328">Le document de correctif est valide, mais les modifications ne peuvent pas être appliquées à la ressource dans son état actuel.</span><span class="sxs-lookup"><span data-stu-id="5ab94-328">The patch document is valid, but the changes can't be applied to the resource in its current state.</span></span> | <span data-ttu-id="5ab94-329">409 (Conflit)</span><span class="sxs-lookup"><span data-stu-id="5ab94-329">409 (Conflict)</span></span>

### <a name="delete-methods"></a><span data-ttu-id="5ab94-330">Méthodes DELETE</span><span class="sxs-lookup"><span data-stu-id="5ab94-330">DELETE methods</span></span>

<span data-ttu-id="5ab94-331">Si l’opération de suppression est réussie, le serveur web doit répondre avec un code d’état HTTP 204 indiquant que le processus a été géré correctement mais que le corps de la réponse ne contient aucune information supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="5ab94-331">If the delete operation is successful, the web server should respond with HTTP status code 204, indicating that the process has been successfully handled, but that the response body contains no further information.</span></span> <span data-ttu-id="5ab94-332">Si la ressource n’existe pas, le serveur web peut renvoyer HTTP 404 (Introuvable).</span><span class="sxs-lookup"><span data-stu-id="5ab94-332">If the resource doesn't exist, the web server can return HTTP 404 (Not Found).</span></span>

### <a name="asynchronous-operations"></a><span data-ttu-id="5ab94-333">Opérations asynchrones</span><span class="sxs-lookup"><span data-stu-id="5ab94-333">Asynchronous operations</span></span>

<span data-ttu-id="5ab94-334">Parfois, un processus de traitement un peu long peut avoir lieu pour une opération POST, PUT, PATCH ou DELETE.</span><span class="sxs-lookup"><span data-stu-id="5ab94-334">Sometimes a POST, PUT, PATCH, or DELETE operation might require processing that takes awhile to complete.</span></span> <span data-ttu-id="5ab94-335">Si vous attendez la fin du traitement avant d’envoyer une réponse au client, cela peut entraîner une latence inacceptable.</span><span class="sxs-lookup"><span data-stu-id="5ab94-335">If you wait for completion before sending a response to the client, it may cause unacceptable latency.</span></span> <span data-ttu-id="5ab94-336">Dans ce cas, envisagez de rendre l’opération asynchrone.</span><span class="sxs-lookup"><span data-stu-id="5ab94-336">If so, consider making the operation asynchronous.</span></span> <span data-ttu-id="5ab94-337">Renvoyez le code d’état HTTP 202 (Accepté) pour indiquer que la requête a été acceptée pour traitement, mais que celui-ci n’est pas terminé.</span><span class="sxs-lookup"><span data-stu-id="5ab94-337">Return HTTP status code 202 (Accepted) to indicate the request was accepted for processing but is not completed.</span></span> 

<span data-ttu-id="5ab94-338">Vous devez exposer un point de terminaison qui renvoie l’état d’une requête asynchrone ; le client peut ainsi surveiller l’état en interrogeant le point de terminaison de l’état.</span><span class="sxs-lookup"><span data-stu-id="5ab94-338">You should expose an endpoint that returns the status of an asynchronous request, so the client can monitor the status by polling the status endpoint.</span></span> <span data-ttu-id="5ab94-339">Ajoutez l’URI du point de terminaison de l’état dans l’en-tête Location de la réponse 202.</span><span class="sxs-lookup"><span data-stu-id="5ab94-339">Include the URI of the status endpoint in the Location header of the 202 response.</span></span> <span data-ttu-id="5ab94-340">Par exemple : </span><span class="sxs-lookup"><span data-stu-id="5ab94-340">For example:</span></span>

```http
HTTP/1.1 202 Accepted
Location: /api/status/12345
```

<span data-ttu-id="5ab94-341">Si le client envoie une requête GET à ce point de terminaison, la réponse doit contenir l’état actuel de la requête.</span><span class="sxs-lookup"><span data-stu-id="5ab94-341">If the client sends a GET request to this endpoint, the response should contain the current status of the request.</span></span> <span data-ttu-id="5ab94-342">Sinon, elle peut également inclure une durée estimée pour la fin du traitement ou un lien permettant d’annuler l’opération.</span><span class="sxs-lookup"><span data-stu-id="5ab94-342">Optionally, it could also include an estimated time to completion or a link to cancel the operation.</span></span> 

```http
HTTP/1.1 200 OK
Content-Type: application/json

{
    "status":"In progress",
    "link": { "rel":"cancel", "method":"delete", "href":"/api/status/12345" }
}
```

<span data-ttu-id="5ab94-343">Si l’opération asynchrone crée une ressource, le point de terminaison d’état doit renvoyer le code d’état 303 (See Other) (Voir autre) une fois l’opération terminée.</span><span class="sxs-lookup"><span data-stu-id="5ab94-343">If the asynchronous operation creates a new resource, the status endpoint should return status code 303 (See Other) after the operation completes.</span></span> <span data-ttu-id="5ab94-344">Dans la réponse 303, ajoutez un en-tête Location qui spécifie l’URI de la nouvelle ressource :</span><span class="sxs-lookup"><span data-stu-id="5ab94-344">In the 303 response, include a Location header that gives the URI of the new resource:</span></span>

```http
HTTP/1.1 303 See Other
Location: /api/orders/12345
```

<span data-ttu-id="5ab94-345">Pour plus d’informations, consultez [Asynchronous operations in REST](https://www.adayinthelifeof.nl/2011/06/02/asynchronous-operations-in-rest/) (Opérations asynchrones dans REST).</span><span class="sxs-lookup"><span data-stu-id="5ab94-345">For more information, see [Asynchronous operations in REST](https://www.adayinthelifeof.nl/2011/06/02/asynchronous-operations-in-rest/).</span></span>

## <a name="filter-and-paginate-data"></a><span data-ttu-id="5ab94-346">Filtrer et paginer des données</span><span class="sxs-lookup"><span data-stu-id="5ab94-346">Filter and paginate data</span></span>

<span data-ttu-id="5ab94-347">L’exposition d’une collection de ressources par le biais d’un seul URI peut conduire les applications à extraire d’importantes quantités de données alors que seul un sous-ensemble d’informations est requis.</span><span class="sxs-lookup"><span data-stu-id="5ab94-347">Exposing a collection of resources through a single URI can lead to applications fetching large amounts of data when only a subset of the information is required.</span></span> <span data-ttu-id="5ab94-348">Par exemple, imaginons qu’une application cliente ait besoin de rechercher toutes les commandes dont le coût est supérieur à une valeur spécifique.</span><span class="sxs-lookup"><span data-stu-id="5ab94-348">For example, suppose a client application needs to find all orders with a cost over a specific value.</span></span> <span data-ttu-id="5ab94-349">Elle peut récupérer toutes les commandes à partir de l’URI */commandes*, puis filtrer ces commandes sur le côté client.</span><span class="sxs-lookup"><span data-stu-id="5ab94-349">It might retrieve all orders from the */orders* URI and then filter these orders on the client side.</span></span> <span data-ttu-id="5ab94-350">Clairement, ce processus est très peu efficace.</span><span class="sxs-lookup"><span data-stu-id="5ab94-350">Clearly this process is highly inefficient.</span></span> <span data-ttu-id="5ab94-351">Il gaspille la bande passante réseau et la puissance de traitement du serveur hébergeant l’API web.</span><span class="sxs-lookup"><span data-stu-id="5ab94-351">It wastes network bandwidth and processing power on the server hosting the web API.</span></span>

<span data-ttu-id="5ab94-352">Au lieu de cela, l’API peut autoriser la transmission d’un filtre dans la chaîne de requête de l’URI, tel que */orders?minCost=n*.</span><span class="sxs-lookup"><span data-stu-id="5ab94-352">Instead, the API can allow passing a filter in the query string of the URI, such as */orders?minCost=n*.</span></span> <span data-ttu-id="5ab94-353">L’API web est alors responsable de l’analyse et de la gestion du paramètre `minCost` dans la chaîne de requête et du renvoi des résultats filtrés sur le côté serveur.</span><span class="sxs-lookup"><span data-stu-id="5ab94-353">The web API is then responsible for parsing and handling the `minCost` parameter in the query string and returning the filtered results on the sever side.</span></span> 

<span data-ttu-id="5ab94-354">Les requêtes GET sur les ressources de la collection peuvent renvoyer un grand nombre d’éléments.</span><span class="sxs-lookup"><span data-stu-id="5ab94-354">GET requests over collection resources can potentially return a large number of items.</span></span> <span data-ttu-id="5ab94-355">Vous devez concevoir une API web pour limiter la quantité de données renvoyées par chaque requête.</span><span class="sxs-lookup"><span data-stu-id="5ab94-355">You should design a web API to limit the amount of data returned by any single request.</span></span> <span data-ttu-id="5ab94-356">Envisagez de prendre en charge les chaînes de requête qui spécifient le nombre maximal d’éléments à récupérer et un décalage de départ dans la collection.</span><span class="sxs-lookup"><span data-stu-id="5ab94-356">Consider supporting query strings that specify the maximum number of items to retrieve and a starting offset into the collection.</span></span> <span data-ttu-id="5ab94-357">Par exemple : </span><span class="sxs-lookup"><span data-stu-id="5ab94-357">For example:</span></span>

```
/orders?limit=25&offset=50
```

<span data-ttu-id="5ab94-358">Envisagez également d’imposer une limite supérieure du nombre d’éléments renvoyés, afin d’empêcher les attaques par déni de service.</span><span class="sxs-lookup"><span data-stu-id="5ab94-358">Also consider imposing an upper limit on the number of items returned, to help prevent Denial of Service attacks.</span></span> <span data-ttu-id="5ab94-359">Pour aider les applications clientes, les requêtes GET qui renvoient les données paginées doivent également inclure des métadonnées qui indiquent le nombre total de ressources disponibles dans la collection.</span><span class="sxs-lookup"><span data-stu-id="5ab94-359">To assist client applications, GET requests that return paginated data should also include some form of metadata that indicate the total number of resources available in the collection.</span></span> 

<span data-ttu-id="5ab94-360">Vous pouvez utiliser une stratégie similaire pour trier les données au fil de leur extraction en fournissant un paramètre de tri qui utilise un nom de champ comme valeur, tel que */orders?sort=ProductID*.</span><span class="sxs-lookup"><span data-stu-id="5ab94-360">You can use a similar strategy to sort data as it is fetched, by providing a sort parameter that takes a field name as the value, such as */orders?sort=ProductID*.</span></span> <span data-ttu-id="5ab94-361">Toutefois, cette approche peut avoir un effet négatif sur la mise en cache puisque les paramètres de chaîne de requête font partie de l’identificateur de ressource utilisé par de nombreuses implémentations de cache comme clé pour les données mises en cache.</span><span class="sxs-lookup"><span data-stu-id="5ab94-361">However, this approach can have a negative effect on caching, because query string parameters form part of the resource identifier used by many cache implementations as the key to cached data.</span></span>

<span data-ttu-id="5ab94-362">Vous pouvez étendre cette approche pour limiter les champs renvoyés pour chaque élément, si ceux-ci contiennent une grande quantité de données.</span><span class="sxs-lookup"><span data-stu-id="5ab94-362">You can extend this approach to limit the fields returned for each item, if each item contains a large amount of data.</span></span> <span data-ttu-id="5ab94-363">Vous pouvez notamment utiliser un paramètre de chaîne de requête qui accepte une liste de champs séparés par des virgules, par exemple */orders?fields=ProductID,Quantity*.</span><span class="sxs-lookup"><span data-stu-id="5ab94-363">For example, you could use a query string parameter that accepts a comma-delimited list of fields, such as */orders?fields=ProductID,Quantity*.</span></span> 

<span data-ttu-id="5ab94-364">Affectez des valeurs par défaut significatives à tous les paramètres facultatifs des chaînes de requête.</span><span class="sxs-lookup"><span data-stu-id="5ab94-364">Give all optional parameters in query strings meaningful defaults.</span></span> <span data-ttu-id="5ab94-365">Par exemple, définissez le paramètre `limit` sur 10 et le paramètre `offset` sur 0 si vous implémentez la pagination, définissez le paramètre de tri sur la clé de la ressource si vous implémentez le classement et définissez le paramètre `fields` pour tous les champs de la ressource si vous prenez en charge des projections.</span><span class="sxs-lookup"><span data-stu-id="5ab94-365">For example, set the `limit` parameter to 10 and the `offset` parameter to 0 if you implement pagination, set the sort parameter to the key of the resource if you implement ordering, and set the `fields` parameter to all fields in the resource if you support projections.</span></span>

## <a name="support-partial-responses-for-large-binary-resources"></a><span data-ttu-id="5ab94-366">Prendre en charge des réponses partielles pour les ressources binaires volumineuses</span><span class="sxs-lookup"><span data-stu-id="5ab94-366">Support partial responses for large binary resources</span></span>

<span data-ttu-id="5ab94-367">Une ressource peut contenir des champs binaires volumineux, tels que des fichiers ou des images.</span><span class="sxs-lookup"><span data-stu-id="5ab94-367">A resource may contain large binary fields, such as files or images.</span></span> <span data-ttu-id="5ab94-368">Pour remédier aux problèmes provoqués par des connexions non fiables et intermittentes et pour améliorer les temps de réponse, envisagez la récupération de ces ressources en blocs.</span><span class="sxs-lookup"><span data-stu-id="5ab94-368">To overcome problems caused by unreliable and intermittent connections and to improve response times, consider enabling such resources to be retrieved in chunks.</span></span> <span data-ttu-id="5ab94-369">Pour ce faire, l’API web doit prendre en charge l’en-tête Accept-Ranges pour les requêtes GET en présence de ressources volumineuses.</span><span class="sxs-lookup"><span data-stu-id="5ab94-369">To do this, the web API should support the Accept-Ranges header for GET requests for large resources.</span></span> <span data-ttu-id="5ab94-370">Cet en-tête indique que l’opération GET prend en charge les requêtes partielles.</span><span class="sxs-lookup"><span data-stu-id="5ab94-370">This header indicates that the GET operation supports partial requests.</span></span> <span data-ttu-id="5ab94-371">L’application cliente peut envoyer des requêtes GET qui renvoient un sous-ensemble d’une ressource, spécifié sous la forme d’une plage d’octets.</span><span class="sxs-lookup"><span data-stu-id="5ab94-371">The client application can submit GET requests that return a subset of a resource, specified as a range of bytes.</span></span> 

<span data-ttu-id="5ab94-372">En outre, envisagez d’implémenter les requêtes HEAD HTTP pour ces ressources.</span><span class="sxs-lookup"><span data-stu-id="5ab94-372">Also, consider implementing HTTP HEAD requests for these resources.</span></span> <span data-ttu-id="5ab94-373">Une requête HEAD est similaire à une requête GET, à ceci près qu’elle renvoie uniquement des en-têtes HTTP qui décrivent la ressource et un corps de message vide.</span><span class="sxs-lookup"><span data-stu-id="5ab94-373">A HEAD request is similar to a GET request, except that it only returns the HTTP headers that describe the resource, with an empty message body.</span></span> <span data-ttu-id="5ab94-374">Une application cliente peut émettre une requête HEAD pour déterminer s’il faut extraire une ressource à l’aide de requêtes GET partielles.</span><span class="sxs-lookup"><span data-stu-id="5ab94-374">A client application can issue a HEAD request to determine whether to fetch a resource by using partial GET requests.</span></span> <span data-ttu-id="5ab94-375">Par exemple : </span><span class="sxs-lookup"><span data-stu-id="5ab94-375">For example:</span></span>

```HTTP
HEAD https://adventure-works.com/products/10?fields=productImage HTTP/1.1
```

<span data-ttu-id="5ab94-376">Voici un exemple de message de réponse :</span><span class="sxs-lookup"><span data-stu-id="5ab94-376">Here is an example response message:</span></span> 

```HTTP
HTTP/1.1 200 OK

Accept-Ranges: bytes
Content-Type: image/jpeg
Content-Length: 4580
```

<span data-ttu-id="5ab94-377">L’en-tête Content-Length donne la taille totale de la ressource et l’en-tête Accept-Ranges indique que l’opération GET correspondante prend en charge les résultats partiels.</span><span class="sxs-lookup"><span data-stu-id="5ab94-377">The Content-Length header gives the total size of the resource, and the Accept-Ranges header indicates that the corresponding GET operation supports partial results.</span></span> <span data-ttu-id="5ab94-378">L’application cliente peut utiliser ces informations pour récupérer l’image en blocs plus petits.</span><span class="sxs-lookup"><span data-stu-id="5ab94-378">The client application can use this information to retrieve the image in smaller chunks.</span></span> <span data-ttu-id="5ab94-379">La première requête extrait les 2500 premiers octets à l’aide de l’en-tête Range :</span><span class="sxs-lookup"><span data-stu-id="5ab94-379">The first request fetches the first 2500 bytes by using the Range header:</span></span>

```HTTP
GET https://adventure-works.com/products/10?fields=productImage HTTP/1.1
Range: bytes=0-2499
```

<span data-ttu-id="5ab94-380">Le message de réponse indique qu’il s’agit d’une réponse partielle en renvoyant le code d’état HTTP 206.</span><span class="sxs-lookup"><span data-stu-id="5ab94-380">The response message indicates that this is a partial response by returning HTTP status code 206.</span></span> <span data-ttu-id="5ab94-381">L’en-tête Content-Length indique le nombre réel d’octets renvoyés dans le corps du message (pas la taille de la ressource), et l’en-tête Content-Range indique de quelle partie de la ressource il s’agit (octets 0-2499 sur 4580) :</span><span class="sxs-lookup"><span data-stu-id="5ab94-381">The Content-Length header specifies the actual number of bytes returned in the message body (not the size of the resource), and the Content-Range header indicates which part of the resource this is (bytes 0-2499 out of 4580):</span></span>

```HTTP
HTTP/1.1 206 Partial Content

Accept-Ranges: bytes
Content-Type: image/jpeg
Content-Length: 2500
Content-Range: bytes 0-2499/4580

[...]
```

<span data-ttu-id="5ab94-382">Une requête ultérieure de l’application cliente peut récupérer le reste de la ressource.</span><span class="sxs-lookup"><span data-stu-id="5ab94-382">A subsequent request from the client application can retrieve the remainder of the resource.</span></span>

## <a name="use-hateoas-to-enable-navigation-to-related-resources"></a><span data-ttu-id="5ab94-383">Utilisation de l’approche HATEOAS pour autoriser la navigation vers des ressources associées</span><span class="sxs-lookup"><span data-stu-id="5ab94-383">Use HATEOAS to enable navigation to related resources</span></span>

<span data-ttu-id="5ab94-384">L’utilisation de REST est principalement motivée par la possibilité de naviguer dans l’ensemble des ressources sans connaissance préalable du modèle d’URI.</span><span class="sxs-lookup"><span data-stu-id="5ab94-384">One of the primary motivations behind REST is that it should be possible to navigate the entire set of resources without requiring prior knowledge of the URI scheme.</span></span> <span data-ttu-id="5ab94-385">Chaque requête HTTP GET doit renvoyer les informations nécessaires pour trouver les ressources liées directement à l’objet demandé par le biais de liens hypertexte inclus dans la réponse. Des informations décrivant les opérations disponibles sur chacune de ces ressources doivent également être fournies.</span><span class="sxs-lookup"><span data-stu-id="5ab94-385">Each HTTP GET request should return the information necessary to find the resources related directly to the requested object through hyperlinks included in the response, and it should also be provided with information that describes the operations available on each of these resources.</span></span> <span data-ttu-id="5ab94-386">Il s’agit du principe HATEOAS (Hypertext as the Engine of Application State).</span><span class="sxs-lookup"><span data-stu-id="5ab94-386">This principle is known as HATEOAS, or Hypertext as the Engine of Application State.</span></span> <span data-ttu-id="5ab94-387">Le système est effectivement une machine à états finis, et la réponse à chaque requête contient les informations nécessaires pour passer d’un état à l’autre ; aucune autre information n’est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="5ab94-387">The system is effectively a finite state machine, and the response to each request contains the information necessary to move from one state to another; no other information should be necessary.</span></span>

> [!NOTE]
> <span data-ttu-id="5ab94-388">Il n’existe actuellement aucune norme ou spécification définissant comment modéliser le principe HATEOAS.</span><span class="sxs-lookup"><span data-stu-id="5ab94-388">Currently there are no standards or specifications that define how to model the HATEOAS principle.</span></span> <span data-ttu-id="5ab94-389">Les exemples présentés dans cette section illustrent une solution possible.</span><span class="sxs-lookup"><span data-stu-id="5ab94-389">The examples shown in this section illustrate one possible solution.</span></span>
>
>

<span data-ttu-id="5ab94-390">Par exemple, pour gérer la relation entre une commande et un client, la représentation d’une commande peut inclure des liens qui identifient les opérations disponibles pour le client de la commande.</span><span class="sxs-lookup"><span data-stu-id="5ab94-390">For example, to handle the relationship between an order and a customer, the representation of an order could include links that identify the available operations for the customer of the order.</span></span> <span data-ttu-id="5ab94-391">Voici une représentation possible :</span><span class="sxs-lookup"><span data-stu-id="5ab94-391">Here is a possible representation:</span></span> 

```json
{
  "orderID":3,
  "productID":2,
  "quantity":4,
  "orderValue":16.60,
  "links":[
    {
      "rel":"customer",
      "href":"https://adventure-works.com/customers/3", 
      "action":"GET",
      "types":["text/xml","application/json"] 
    },
    {
      "rel":"customer",
      "href":"https://adventure-works.com/customers/3", 
      "action":"PUT",
      "types":["application/x-www-form-urlencoded"]
    },
    {
      "rel":"customer",
      "href":"https://adventure-works.com/customers/3",
      "action":"DELETE",
      "types":[]
    },
    {
      "rel":"self",
      "href":"https://adventure-works.com/orders/3", 
      "action":"GET",
      "types":["text/xml","application/json"]
    },
    {
      "rel":"self",
      "href":"https://adventure-works.com/orders/3", 
      "action":"PUT",
      "types":["application/x-www-form-urlencoded"]
    },
    {
      "rel":"self",
      "href":"https://adventure-works.com/orders/3", 
      "action":"DELETE",
      "types":[]
    }]
}
```

<span data-ttu-id="5ab94-392">Dans cet exemple, le tableau `links` présente un ensemble de liens.</span><span class="sxs-lookup"><span data-stu-id="5ab94-392">In this example, the `links` array has a set of links.</span></span> <span data-ttu-id="5ab94-393">Chaque lien correspond à une opération sur une entité associée.</span><span class="sxs-lookup"><span data-stu-id="5ab94-393">Each link represents an operation on a related entity.</span></span> <span data-ttu-id="5ab94-394">Les données de chaque lien incluent la relation (« customer »), l’URI (`https://adventure-works.com/customers/3`), la méthode HTTP et les types MIME pris en charge.</span><span class="sxs-lookup"><span data-stu-id="5ab94-394">The data for each link includes the relationship ("customer"), the URI (`https://adventure-works.com/customers/3`), the HTTP method, and the supported MIME types.</span></span> <span data-ttu-id="5ab94-395">Il s’agit de toutes les informations nécessaires à une application cliente pour être en mesure d’appeler l’opération.</span><span class="sxs-lookup"><span data-stu-id="5ab94-395">This is all the information that a client application needs to be able to invoke the operation.</span></span> 

<span data-ttu-id="5ab94-396">Le tableau `links` inclut également des informations avec référence circulaire sur la ressource qui a été récupérée.</span><span class="sxs-lookup"><span data-stu-id="5ab94-396">The `links` array also includes self-referencing information about the resource itself that has been retrieved.</span></span> <span data-ttu-id="5ab94-397">La relation de ces éléments est *self*.</span><span class="sxs-lookup"><span data-stu-id="5ab94-397">These have the relationship *self*.</span></span>

<span data-ttu-id="5ab94-398">L’ensemble de liens renvoyé peut varier en fonction de l’état de la ressource.</span><span class="sxs-lookup"><span data-stu-id="5ab94-398">The set of links that are returned may change, depending on the state of the resource.</span></span> <span data-ttu-id="5ab94-399">C’est la signification de « Hypertext as the Engine of Application State » (hypertexte en tant que moteur de l’état de l’application).</span><span class="sxs-lookup"><span data-stu-id="5ab94-399">This is what is meant by hypertext being the "engine of application state."</span></span>

## <a name="versioning-a-restful-web-api"></a><span data-ttu-id="5ab94-400">Contrôle de version d’une API web RESTful</span><span class="sxs-lookup"><span data-stu-id="5ab94-400">Versioning a RESTful web API</span></span>

<span data-ttu-id="5ab94-401">Il est très improbable qu’une API web reste statique.</span><span class="sxs-lookup"><span data-stu-id="5ab94-401">It is highly unlikely that a web API will remain static.</span></span> <span data-ttu-id="5ab94-402">Au fil de l’évolution des besoins de l’entreprise, de nouvelles collections de ressources peuvent être ajoutées, les relations entre les ressources peuvent changer et la structure des données des ressources peut être modifiée.</span><span class="sxs-lookup"><span data-stu-id="5ab94-402">As business requirements change new collections of resources may be added, the relationships between resources might change, and the structure of the data in resources might be amended.</span></span> <span data-ttu-id="5ab94-403">La mise à jour d’une API web pour gérer les exigences nouvelles ou différentes est un processus relativement simple. Cependant, vous devez considérer les effets de ces modifications sur les applications clientes utilisant l’API web.</span><span class="sxs-lookup"><span data-stu-id="5ab94-403">While updating a web API to handle new or differing requirements is a relatively straightforward process, you must consider the effects that such changes will have on client applications consuming the web API.</span></span> <span data-ttu-id="5ab94-404">Le problème est le suivant : même si le développeur qui conçoit et implémente une API web bénéficie d’un contrôle total sur cette API, il n’a pas le même degré de contrôle sur les applications clientes qui peuvent être créées par des organisations tierces distantes.</span><span class="sxs-lookup"><span data-stu-id="5ab94-404">The issue is that although the developer designing and implementing a web API has full control over that API, the developer does not have the same degree of control over client applications which may be built by third party organizations operating remotely.</span></span> <span data-ttu-id="5ab94-405">L’impératif principal consiste à faire en sorte que les applications clientes existantes puissent continuer à fonctionner sans modification tout en autorisant les nouvelles applications clientes à tirer parti des nouvelles fonctionnalités et ressources.</span><span class="sxs-lookup"><span data-stu-id="5ab94-405">The primary imperative is to enable existing client applications to continue functioning unchanged while allowing new client applications to take advantage of new features and resources.</span></span>

<span data-ttu-id="5ab94-406">Le contrôle de version permet à une API web d’indiquer les fonctionnalités et ressources qu’elle expose. Une application cliente peut alors envoyer des requêtes destinées à une version spécifique d’une fonctionnalité ou d’une ressource.</span><span class="sxs-lookup"><span data-stu-id="5ab94-406">Versioning enables a web API to indicate the features and resources that it exposes, and a client application can submit requests that are directed to a specific version of a feature or resource.</span></span> <span data-ttu-id="5ab94-407">Les sections suivantes décrivent différentes approches présentant chacune des avantages et des inconvénients.</span><span class="sxs-lookup"><span data-stu-id="5ab94-407">The following sections describe several different approaches, each of which has its own benefits and trade-offs.</span></span>

### <a name="no-versioning"></a><span data-ttu-id="5ab94-408">Aucun contrôle de version</span><span class="sxs-lookup"><span data-stu-id="5ab94-408">No versioning</span></span>
<span data-ttu-id="5ab94-409">Il s’agit de l’approche la plus simple. Elle peut être acceptable pour certaines API internes.</span><span class="sxs-lookup"><span data-stu-id="5ab94-409">This is the simplest approach, and may be acceptable for some internal APIs.</span></span> <span data-ttu-id="5ab94-410">De nouvelles ressources ou de nouveaux liens peuvent représenter des changements importants.</span><span class="sxs-lookup"><span data-stu-id="5ab94-410">Big changes could be represented as new resources or new links.</span></span>  <span data-ttu-id="5ab94-411">L’ajout de contenu à des ressources existantes ne représente pas nécessairement une modification avec rupture, dans la mesure où les applications clientes qui n’attendent pas ce contenu l’ignoreront simplement.</span><span class="sxs-lookup"><span data-stu-id="5ab94-411">Adding content to existing resources might not present a breaking change as client applications that are not expecting to see this content will simply ignore it.</span></span>

<span data-ttu-id="5ab94-412">Par exemple, une requête à l’URI *https://adventure-works.com/customers/3* doit renvoyer les détails d’un client unique contenant les champs `id`, `name` et `address` attendus par l’application cliente :</span><span class="sxs-lookup"><span data-stu-id="5ab94-412">For example, a request to the URI *https://adventure-works.com/customers/3* should return the details of a single customer containing `id`, `name`, and `address` fields expected by the client application:</span></span>

```HTTP
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8

{"id":3,"name":"Contoso LLC","address":"1 Microsoft Way Redmond WA 98053"}
```

> [!NOTE]
> <span data-ttu-id="5ab94-413">À des fins de simplicité, les exemples de réponses présentés dans cette section n’incluent pas les liens HATEOAS.</span><span class="sxs-lookup"><span data-stu-id="5ab94-413">For simplicity, the example responses shown in this section do not include HATEOAS links.</span></span>
>
>

<span data-ttu-id="5ab94-414">Si le champ `DateCreated` est ajouté au schéma de la ressource du client, la réponse se présentera comme suit :</span><span class="sxs-lookup"><span data-stu-id="5ab94-414">If the `DateCreated` field is added to the schema of the customer resource, then the response would look like this:</span></span>

```HTTP
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8

{"id":3,"name":"Contoso LLC","dateCreated":"2014-09-04T12:11:38.0376089Z","address":"1 Microsoft Way Redmond WA 98053"}
```

<span data-ttu-id="5ab94-415">Les applications clientes existantes peuvent continuer à fonctionner correctement si elles peuvent ignorer les champs non reconnus. Les nouvelles applications clientes peuvent être conçues pour gérer ce nouveau champ.</span><span class="sxs-lookup"><span data-stu-id="5ab94-415">Existing client applications might continue functioning correctly if they are capable of ignoring unrecognized fields, while new client applications can be designed to handle this new field.</span></span> <span data-ttu-id="5ab94-416">Cependant, des modifications plus importantes affectant le schéma des ressources (par exemple, la suppression ou la modification de nom de champs), ou un changement des relations entre les ressources peuvent constituer des modifications avec rupture empêchant les applications clientes existantes de fonctionner correctement.</span><span class="sxs-lookup"><span data-stu-id="5ab94-416">However, if more radical changes to the schema of resources occur (such as removing or renaming fields) or the relationships between resources change then these may constitute breaking changes that prevent existing client applications from functioning correctly.</span></span> <span data-ttu-id="5ab94-417">Dans ces situations, vous devez envisager l’une des approches suivantes.</span><span class="sxs-lookup"><span data-stu-id="5ab94-417">In these situations you should consider one of the following approaches.</span></span>

### <a name="uri-versioning"></a><span data-ttu-id="5ab94-418">Contrôle de version d’URI</span><span class="sxs-lookup"><span data-stu-id="5ab94-418">URI versioning</span></span>
<span data-ttu-id="5ab94-419">Dès lors que vous modifiez l’API web ou le schéma des ressources, vous ajoutez un numéro de version à l’URI pour chaque ressource.</span><span class="sxs-lookup"><span data-stu-id="5ab94-419">Each time you modify the web API or change the schema of resources, you add a version number to the URI for each resource.</span></span> <span data-ttu-id="5ab94-420">Les URI existants doivent continuer à fonctionner comme avant et à renvoyer les ressources conformes à leur schéma d’origine.</span><span class="sxs-lookup"><span data-stu-id="5ab94-420">The previously existing URIs should continue to operate as before, returning resources that conform to their original schema.</span></span>

<span data-ttu-id="5ab94-421">Si l’on étend l’exemple précédent, si le champ `address` est restructuré dans des sous-champs contenant chaque partie de l’adresse (par exemple, `streetAddress`, `city`, `state` et `zipCode`), cette version de la ressource peut être exposée par le biais d’un URI qui contient un numéro de version, tel que https://adventure-works.com/v2/customers/3:</span><span class="sxs-lookup"><span data-stu-id="5ab94-421">Extending the previous example, if the `address` field is restructured into sub-fields containing each constituent part of the address (such as `streetAddress`, `city`, `state`, and `zipCode`), this version of the resource could be exposed through a URI containing a version number, such as https://adventure-works.com/v2/customers/3:</span></span>

```HTTP
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8

{"id":3,"name":"Contoso LLC","dateCreated":"2014-09-04T12:11:38.0376089Z","address":{"streetAddress":"1 Microsoft Way","city":"Redmond","state":"WA","zipCode":98053}}
```

<span data-ttu-id="5ab94-422">Ce mécanisme de contrôle de version est très simple, mais dépend du routage de la requête par le serveur au point de terminaison approprié.</span><span class="sxs-lookup"><span data-stu-id="5ab94-422">This versioning mechanism is very simple but depends on the server routing the request to the appropriate endpoint.</span></span> <span data-ttu-id="5ab94-423">Toutefois, il peut devenir complexe à mesure que l’API web arrive à maturité par le biais de plusieurs itérations et que le nombre de versions différentes prises en charge par le serveur évolue.</span><span class="sxs-lookup"><span data-stu-id="5ab94-423">However, it can become unwieldy as the web API matures through several iterations and the server has to support a number of different versions.</span></span> <span data-ttu-id="5ab94-424">En outre, d’un point de vue puriste, les applications clientes extraient les mêmes données (client 3) dans tous les cas. L’URI ne devrait donc pas être différent selon la version.</span><span class="sxs-lookup"><span data-stu-id="5ab94-424">Also, from a purist’s point of view, in all cases the client applications are fetching the same data (customer 3), so the URI should not really be different depending on the version.</span></span> <span data-ttu-id="5ab94-425">Ce modèle complique également l’implémentation de HATEOAS, dans la mesure où tous les liens devront inclure le numéro de version dans leurs URI.</span><span class="sxs-lookup"><span data-stu-id="5ab94-425">This scheme also complicates implementation of HATEOAS as all links will need to include the version number in their URIs.</span></span>

### <a name="query-string-versioning"></a><span data-ttu-id="5ab94-426">Contrôle de version de chaîne de requête</span><span class="sxs-lookup"><span data-stu-id="5ab94-426">Query string versioning</span></span>
<span data-ttu-id="5ab94-427">Plutôt que de fournir plusieurs URI, vous pouvez spécifier la version de la ressource en utilisant un paramètre dans la chaîne de requête ajoutée à la requête HTTP, par exemple *https://adventure-works.com/customers/3?version=2*.</span><span class="sxs-lookup"><span data-stu-id="5ab94-427">Rather than providing multiple URIs, you can specify the version of the resource by using a parameter within the query string appended to the HTTP request, such as *https://adventure-works.com/customers/3?version=2*.</span></span> <span data-ttu-id="5ab94-428">La valeur par défaut du paramètre de version doit être significative, par exemple 1, s’il est omis par des applications clientes plus anciennes.</span><span class="sxs-lookup"><span data-stu-id="5ab94-428">The version parameter should default to a meaningful value such as 1 if it is omitted by older client applications.</span></span>

<span data-ttu-id="5ab94-429">D’un point de vue sémantique, cette approche présente l’avantage suivant : la même ressource est toujours extraite du même URI, mais cela dépend du code qui gère la demande d’analyse de la chaîne de requête et de renvoi de la réponse HTTP appropriée.</span><span class="sxs-lookup"><span data-stu-id="5ab94-429">This approach has the semantic advantage that the same resource is always retrieved from the same URI, but it depends on the code that handles the request to parse the query string and send back the appropriate HTTP response.</span></span> <span data-ttu-id="5ab94-430">D’autre part, cette approche présente les mêmes inconvénients que le mécanisme de contrôle de version d’URI concernant l’implémentation de HATEOAS.</span><span class="sxs-lookup"><span data-stu-id="5ab94-430">This approach also suffers from the same complications for implementing HATEOAS as the URI versioning mechanism.</span></span>

> [!NOTE]
> <span data-ttu-id="5ab94-431">Certains proxys et navigateurs web anciens ne mettent pas en cache les réponses aux requêtes qui incluent une chaîne de requête dans l’URI.</span><span class="sxs-lookup"><span data-stu-id="5ab94-431">Some older web browsers and web proxies will not cache responses for requests that include a query string in the URI.</span></span> <span data-ttu-id="5ab94-432">Cela peut avoir un impact négatif sur les performances des applications web qui utilisent une API web et qui s’exécutent à partir des navigateurs web.</span><span class="sxs-lookup"><span data-stu-id="5ab94-432">This can have an adverse impact on performance for web applications that use a web API and that run from within such a web browser.</span></span>
>
>

### <a name="header-versioning"></a><span data-ttu-id="5ab94-433">Contrôle de version d’en-tête</span><span class="sxs-lookup"><span data-stu-id="5ab94-433">Header versioning</span></span>
<span data-ttu-id="5ab94-434">Plutôt que d’ajouter le numéro de version en tant que paramètre dans la chaîne de requête, vous pouvez implémenter un en-tête personnalisé qui indique la version de la ressource.</span><span class="sxs-lookup"><span data-stu-id="5ab94-434">Rather than appending the version number as a query string parameter, you could implement a custom header that indicates the version of the resource.</span></span> <span data-ttu-id="5ab94-435">Cette approche nécessite que l’application cliente ajoute l’en-tête approprié à toutes les requêtes, même si le code qui gère la requête client peut utiliser une valeur par défaut (version 1) si l’en-tête de version est omis.</span><span class="sxs-lookup"><span data-stu-id="5ab94-435">This approach requires that the client application adds the appropriate header to any requests, although the code handling the client request could use a default value (version 1) if the version header is omitted.</span></span> <span data-ttu-id="5ab94-436">Les exemples suivants utilisent un en-tête personnalisé nommé *Custom-Header*.</span><span class="sxs-lookup"><span data-stu-id="5ab94-436">The following examples utilize a custom header named *Custom-Header*.</span></span> <span data-ttu-id="5ab94-437">La valeur de cet en-tête indique la version de l’API web.</span><span class="sxs-lookup"><span data-stu-id="5ab94-437">The value of this header indicates the version of web API.</span></span>

<span data-ttu-id="5ab94-438">Version 1 :</span><span class="sxs-lookup"><span data-stu-id="5ab94-438">Version 1:</span></span>

```HTTP
GET https://adventure-works.com/customers/3 HTTP/1.1
Custom-Header: api-version=1
```

```HTTP
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8

{"id":3,"name":"Contoso LLC","address":"1 Microsoft Way Redmond WA 98053"}
```

<span data-ttu-id="5ab94-439">Version 2 :</span><span class="sxs-lookup"><span data-stu-id="5ab94-439">Version 2:</span></span>

```HTTP
GET https://adventure-works.com/customers/3 HTTP/1.1
Custom-Header: api-version=2
```

```HTTP
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8

{"id":3,"name":"Contoso LLC","dateCreated":"2014-09-04T12:11:38.0376089Z","address":{"streetAddress":"1 Microsoft Way","city":"Redmond","state":"WA","zipCode":98053}}
```

<span data-ttu-id="5ab94-440">Notez que, comme avec les deux approches précédentes, l’implémentation de HATEOAS nécessite l’inclusion de l’en-tête personnalisé approprié dans tous les liens.</span><span class="sxs-lookup"><span data-stu-id="5ab94-440">Note that as with the previous two approaches, implementing HATEOAS requires including the appropriate custom header in any links.</span></span>

### <a name="media-type-versioning"></a><span data-ttu-id="5ab94-441">Contrôle de version du type de média</span><span class="sxs-lookup"><span data-stu-id="5ab94-441">Media type versioning</span></span>
<span data-ttu-id="5ab94-442">Lorsqu’une application cliente envoie une requête HTTP GET à un serveur web, elle doit indiquer le format du contenu qu’elle peut traiter à l’aide d’un en-tête Accept, comme décrit précédemment dans ce guide.</span><span class="sxs-lookup"><span data-stu-id="5ab94-442">When a client application sends an HTTP GET request to a web server it should stipulate the format of the content that it can handle by using an Accept header, as described earlier in this guidance.</span></span> <span data-ttu-id="5ab94-443">Souvent, l’en-tête *Accept* a pour rôle de permettre à l’application cliente de spécifier si le corps de la réponse doit être au format XML ou JSON, ou dans un autre format courant que le client peut analyser.</span><span class="sxs-lookup"><span data-stu-id="5ab94-443">Frequently the purpose of the *Accept* header is to allow the client application to specify whether the body of the response should be XML, JSON, or some other common format that the client can parse.</span></span> <span data-ttu-id="5ab94-444">Toutefois, il est possible de définir des types de médias personnalisés qui incluent des informations permettant à l’application cliente d’indiquer la version de ressource attendue.</span><span class="sxs-lookup"><span data-stu-id="5ab94-444">However, it is possible to define custom media types that include information enabling the client application to indicate which version of a resource it is expecting.</span></span> <span data-ttu-id="5ab94-445">L’exemple suivant illustre une requête qui spécifie un en-tête *Accept* avec la valeur *application/vnd.adventure-works.v1+json*.</span><span class="sxs-lookup"><span data-stu-id="5ab94-445">The following example shows a request that specifies an *Accept* header with the value *application/vnd.adventure-works.v1+json*.</span></span> <span data-ttu-id="5ab94-446">L’élément *vnd.adventure-works.v1* indique au serveur web qu’il doit renvoyer la version 1 de la ressource, tandis que l’élément *json* spécifie que le format du corps de la réponse doit être JSON :</span><span class="sxs-lookup"><span data-stu-id="5ab94-446">The *vnd.adventure-works.v1* element indicates to the web server that it should return version 1 of the resource, while the *json* element specifies that the format of the response body should be JSON:</span></span>

```HTTP
GET https://adventure-works.com/customers/3 HTTP/1.1
Accept: application/vnd.adventure-works.v1+json
```

<span data-ttu-id="5ab94-447">Le code qui gère la requête est responsable du traitement de l’en-tête *Accept* et doit le respecter autant que possible (l’application cliente peut spécifier plusieurs formats dans l’en-tête *Accept*, auquel cas le serveur web peut choisir le format le plus approprié pour le corps de la réponse).</span><span class="sxs-lookup"><span data-stu-id="5ab94-447">The code handling the request is responsible for processing the *Accept* header and honoring it as far as possible (the client application may specify multiple formats in the *Accept* header, in which case the web server can choose the most appropriate format for the response body).</span></span> <span data-ttu-id="5ab94-448">Le serveur web vérifie le format des données dans le corps de la réponse à l’aide de l’en-tête Content-Type :</span><span class="sxs-lookup"><span data-stu-id="5ab94-448">The web server confirms the format of the data in the response body by using the Content-Type header:</span></span>

```HTTP
HTTP/1.1 200 OK
Content-Type: application/vnd.adventure-works.v1+json; charset=utf-8

{"id":3,"name":"Contoso LLC","address":"1 Microsoft Way Redmond WA 98053"}
```

<span data-ttu-id="5ab94-449">Si l’en-tête Accept ne spécifie aucun type de média connu, le serveur web peut générer un message de réponse HTTP 406 (Non acceptable) ou renvoyer un message avec un type de média par défaut.</span><span class="sxs-lookup"><span data-stu-id="5ab94-449">If the Accept header does not specify any known media types, the web server could generate an HTTP 406 (Not Acceptable) response message or return a message with a default media type.</span></span>

<span data-ttu-id="5ab94-450">Cette approche représente sans doute le mécanisme de contrôle de version le plus pur et se prête naturellement à l’utilisation du principe HATEOAS, qui peut inclure le type MIME des données connexes dans les liens de ressources.</span><span class="sxs-lookup"><span data-stu-id="5ab94-450">This approach is arguably the purest of the versioning mechanisms and lends itself naturally to HATEOAS, which can include the MIME type of related data in resource links.</span></span>

> [!NOTE]
> <span data-ttu-id="5ab94-451">Lorsque vous choisissez une stratégie de contrôle de version, vous devez également tenir compte des implications sur les performances et en particulier de la mise en cache sur le serveur web.</span><span class="sxs-lookup"><span data-stu-id="5ab94-451">When you select a versioning strategy, you should also consider the implications on performance, especially caching on the web server.</span></span> <span data-ttu-id="5ab94-452">À cet égard, les modèles de contrôle de version d’URI et de chaîne de requête sont particulièrement efficaces, dans la mesure où la même combinaison URI/chaîne de requête fait référence aux mêmes données à chaque fois.</span><span class="sxs-lookup"><span data-stu-id="5ab94-452">The URI versioning and Query String versioning schemes are cache-friendly inasmuch as the same URI/query string combination refers to the same data each time.</span></span>
>
> <span data-ttu-id="5ab94-453">Les mécanismes de contrôle de version d’en-tête et de type de média requièrent généralement une logique supplémentaire pour examiner les valeurs dans l’en-tête personnalisé ou l’en-tête Accept.</span><span class="sxs-lookup"><span data-stu-id="5ab94-453">The Header versioning and Media Type versioning mechanisms typically require additional logic to examine the values in the custom header or the Accept header.</span></span> <span data-ttu-id="5ab94-454">Dans un environnement à grande échelle, l’utilisation de différentes versions d’une API web par de nombreux clients peut entraîner une quantité importante de données dupliquées dans un cache côté serveur.</span><span class="sxs-lookup"><span data-stu-id="5ab94-454">In a large-scale environment, many clients using different versions of a web API can result in a significant amount of duplicated data in a server-side cache.</span></span> <span data-ttu-id="5ab94-455">Ce problème peut s’aggraver si une application cliente communique avec un serveur web par l’intermédiaire d’un proxy qui implémente la mise en cache et qui transmet une requête au serveur web uniquement s’il ne contient pas une copie des données demandées dans son cache.</span><span class="sxs-lookup"><span data-stu-id="5ab94-455">This issue can become acute if a client application communicates with a web server through a proxy that implements caching, and that only forwards a request to the web server if it does not currently hold a copy of the requested data in its cache.</span></span>
>
>

## <a name="open-api-initiative"></a><span data-ttu-id="5ab94-456">Open API Initiative</span><span class="sxs-lookup"><span data-stu-id="5ab94-456">Open API Initiative</span></span>
<span data-ttu-id="5ab94-457">Le programme [Open API Initiative](https://www.openapis.org/) a été créé par un consortium industriel afin de normaliser les descriptions d’API REST entre les différents fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="5ab94-457">The [Open API Initiative](https://www.openapis.org/) was created by an industry consortium to standardize REST API descriptions across vendors.</span></span> <span data-ttu-id="5ab94-458">Dans le cadre de ce programme, la spécification Swagger 2.0 a été renommée en spécification OpenAPI (OAS) et placée sous le programme Open API Initiative.</span><span class="sxs-lookup"><span data-stu-id="5ab94-458">As part of this initiative, the Swagger 2.0 specification was renamed the OpenAPI Specification (OAS) and brought under the Open API Initiative.</span></span>

<span data-ttu-id="5ab94-459">Vous pouvez adopter la spécification OpenAPI pour vos API Web.</span><span class="sxs-lookup"><span data-stu-id="5ab94-459">You may want to adopt OpenAPI for your web APIs.</span></span> <span data-ttu-id="5ab94-460">Éléments à prendre en considération :</span><span class="sxs-lookup"><span data-stu-id="5ab94-460">Some points to consider:</span></span>

- <span data-ttu-id="5ab94-461">La spécification OpenAPI est fournie avec un ensemble de consignes strictes sur la façon dont une API REST doit être conçue.</span><span class="sxs-lookup"><span data-stu-id="5ab94-461">The OpenAPI Specification comes with a set of opinionated guidelines on how a REST API should be designed.</span></span> <span data-ttu-id="5ab94-462">Ceci présente des avantages en termes d’interopérabilité, mais nécessite un surcroît d’attention de votre part lorsque vous concevez votre API pour qu’elle soit conforme à la spécification.</span><span class="sxs-lookup"><span data-stu-id="5ab94-462">That has advantages for interoperability, but requires more care when designing your API to conform to the specification.</span></span>
- <span data-ttu-id="5ab94-463">OpenAPI promeut une approche qui commence par le contrat plutôt que par l’implémentation.</span><span class="sxs-lookup"><span data-stu-id="5ab94-463">OpenAPI promotes a contract-first approach, rather than an implementation-first approach.</span></span> <span data-ttu-id="5ab94-464">Cela signifie que vous commencez par concevoir le contrat d’API (l’interface), puis que vous écrivez le code qui implémente ce contrat.</span><span class="sxs-lookup"><span data-stu-id="5ab94-464">Contract-first means you design the API contract (the interface) first and then write code that implements the contract.</span></span> 
- <span data-ttu-id="5ab94-465">Des outils tels que Swagger peuvent générer des bibliothèques clientes ou une documentation à partir des contrats d’API.</span><span class="sxs-lookup"><span data-stu-id="5ab94-465">Tools like Swagger can generate client libraries or documentation from API contracts.</span></span> <span data-ttu-id="5ab94-466">Par exemple, consultez l’article [ASP.NET Web API Help Pages using Swagger (Pages d’aide sur l’API Web ASP.NET à l’aide de Swagger)](/aspnet/core/tutorials/web-api-help-pages-using-swagger).</span><span class="sxs-lookup"><span data-stu-id="5ab94-466">For example, see [ASP.NET Web API Help Pages using Swagger](/aspnet/core/tutorials/web-api-help-pages-using-swagger).</span></span>

## <a name="more-information"></a><span data-ttu-id="5ab94-467">Plus d’informations</span><span class="sxs-lookup"><span data-stu-id="5ab94-467">More information</span></span>
* <span data-ttu-id="5ab94-468">[Microsoft REST API Guidelines](https://github.com/Microsoft/api-guidelines/blob/master/Guidelines.md) (Directives relatives aux API REST Microsoft).</span><span class="sxs-lookup"><span data-stu-id="5ab94-468">[Microsoft REST API Guidelines](https://github.com/Microsoft/api-guidelines/blob/master/Guidelines.md).</span></span> <span data-ttu-id="5ab94-469">Recommandations détaillées pour la conception d’API REST publiques.</span><span class="sxs-lookup"><span data-stu-id="5ab94-469">Detailed recommendations for designing public REST APIs.</span></span>
* <span data-ttu-id="5ab94-470">[Web API Checklist](https://mathieu.fenniak.net/the-api-checklist/) (Liste de contrôle pour les API web).</span><span class="sxs-lookup"><span data-stu-id="5ab94-470">[Web API Checklist](https://mathieu.fenniak.net/the-api-checklist/).</span></span> <span data-ttu-id="5ab94-471">Une liste d’éléments à prendre en compte lors de la conception et de l’implémentation d’une API web.</span><span class="sxs-lookup"><span data-stu-id="5ab94-471">A useful list of items to consider when designing and implementing a web API.</span></span>
* <span data-ttu-id="5ab94-472">[Open API Initiative](https://www.openapis.org/).</span><span class="sxs-lookup"><span data-stu-id="5ab94-472">[Open API Initiative](https://www.openapis.org/).</span></span> <span data-ttu-id="5ab94-473">Documentation et informations d’implémentation sur Open API.</span><span class="sxs-lookup"><span data-stu-id="5ab94-473">Documentation and implementation details on Open API.</span></span>
