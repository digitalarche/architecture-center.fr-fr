---
title: "Récupération d’urgence des applications Microsoft Azure"
description: "Présentations techniques et informations détaillées sur la conception d’applications pour la récupération d’urgence sur Microsoft Azure."
author: adamglick
ms.date: 05/26/2017
ms.openlocfilehash: d415b27dd7928996e2a6dc7fd8fcf6a77c835768
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/14/2017
---
[!INCLUDE [header](../_includes/header.md)]
# <a name="disaster-recovery-for-azure-applications"></a><span data-ttu-id="b317d-103">Récupération d’urgence des applications Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="b317d-103">Disaster recovery for Azure applications</span></span>
<span data-ttu-id="b317d-104">Les stratégies de résilience et de haute disponibilité sont conçues pour faciliter la gestion des conditions de défaillance temporaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-104">Resiliency and high availability strategies are intended to handling temporary failure conditions.</span></span> <span data-ttu-id="b317d-105">La récupération d’urgence (DR) se concentre sur la récupération des fonctionnalités des applications en cas de perte catastrophique.</span><span class="sxs-lookup"><span data-stu-id="b317d-105">Disaster recovery (DR) is focused on recovering from a catastrophic loss of application functionality.</span></span> <span data-ttu-id="b317d-106">Par exemple, si une région Azure hébergeant votre application devient indisponible, vous avez besoin d’un plan pour exécuter votre application ou accéder à vos données dans une autre région.</span><span class="sxs-lookup"><span data-stu-id="b317d-106">For example, if an Azure region hosting your application becomes unavailable, you need a plan for running your application or accessing your data in another region.</span></span> <span data-ttu-id="b317d-107">La mise en œuvre de ce plan implique des personnes, des processus et la prise en charge d’applications permettant au système de continuer à fonctionner.</span><span class="sxs-lookup"><span data-stu-id="b317d-107">Executing this plan involves people, processes, and supporting applications that allow the system to continue functioning.</span></span> <span data-ttu-id="b317d-108">Pour être parfaitement fiable, votre plan doit inclure une préparation aux conditions de panne et des essais de récupération des bases de données.</span><span class="sxs-lookup"><span data-stu-id="b317d-108">Your plan should include rehearsing failures and testing the recovery of databases to ensure the plan is sound.</span></span> <span data-ttu-id="b317d-109">Les entrepreneurs et propriétaires de technologies qui définissent le mode opérationnel du système dans une situation d’urgence déterminent également le niveau de fonctionnalité du service requis en cas d’incident.</span><span class="sxs-lookup"><span data-stu-id="b317d-109">The business and technology owners who define the system's operational mode for a disaster also determine the level of service functionality required during a disaster.</span></span> <span data-ttu-id="b317d-110">Le niveau de fonctionnalité peut prendre plusieurs formes : complètement indisponible, partiellement disponible (fonctionnalité réduite ou traitement différé) ou entièrement disponible.</span><span class="sxs-lookup"><span data-stu-id="b317d-110">This level of functionality can take a few forms: completely unavailable, partially available via reduced functionality or delayed processing, or fully available.</span></span>

## <a name="azure-disaster-recovery-features"></a><span data-ttu-id="b317d-111">Fonctionnalités de la récupération d’urgence Azure</span><span class="sxs-lookup"><span data-stu-id="b317d-111">Azure disaster recovery features</span></span>
<span data-ttu-id="b317d-112">Comme pour les considérations relatives à la disponibilité, Azure fournit un [Guide technique de la résilience](./index.md), conçu pour prendre en charge la récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="b317d-112">As with availability considerations, Azure provides [resiliency technical guidance](./index.md) designed to support disaster recovery.</span></span> <span data-ttu-id="b317d-113">Il existe également une relation entre les fonctionnalités de disponibilité d’Azure et la récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="b317d-113">There is also a relationship between availability features of Azure and disaster recovery.</span></span> <span data-ttu-id="b317d-114">Par exemple, la gestion des rôles sur les domaines d’erreur augmente la disponibilité d’une application.</span><span class="sxs-lookup"><span data-stu-id="b317d-114">For example, the management of roles across fault domains increases the availability of an application.</span></span> <span data-ttu-id="b317d-115">Sans cette gestion, une défaillance matérielle non gérée deviendrait un scénario « catastrophe ».</span><span class="sxs-lookup"><span data-stu-id="b317d-115">Without that management, an unhandled hardware failure would become a “disaster” scenario.</span></span> <span data-ttu-id="b317d-116">Tirer parti de ces stratégies et fonctionnalités de disponibilité fait partie intégrante de la protection de votre application contre les situations d’urgence.</span><span class="sxs-lookup"><span data-stu-id="b317d-116">Leveraging these availability features and strategies is an important part of disaster-proofing your application.</span></span> <span data-ttu-id="b317d-117">Toutefois, cet article va au-delà des problèmes de disponibilité générale pour traiter des événements d’urgence plus graves (et plus rares).</span><span class="sxs-lookup"><span data-stu-id="b317d-117">However, this article goes beyond general availability issues to more serious (and rarer) disaster events.</span></span>

## <a name="multiple-datacenter-regions"></a><span data-ttu-id="b317d-118">Plusieurs régions contenant des centres de données</span><span class="sxs-lookup"><span data-stu-id="b317d-118">Multiple datacenter regions</span></span>
<span data-ttu-id="b317d-119">Azure exploite des centres de données dans plusieurs régions à l’échelle internationale.</span><span class="sxs-lookup"><span data-stu-id="b317d-119">Azure maintains datacenters in many regions around the world.</span></span> <span data-ttu-id="b317d-120">Cette infrastructure prend en charge plusieurs scénarios de récupération d’urgence, tels que la géoréplication du stockage Azure vers des régions secondaires, fournie par le système.</span><span class="sxs-lookup"><span data-stu-id="b317d-120">This infrastructure supports several disaster recovery scenarios, such as system-provided geo-replication of Azure Storage to secondary regions.</span></span> <span data-ttu-id="b317d-121">Vous pouvez également déployer un service cloud vers de nombreux emplacements dans le monde entier facilement et de manière économique.</span><span class="sxs-lookup"><span data-stu-id="b317d-121">You can also easily and inexpensively deploy a cloud service to multiple locations around the world.</span></span> <span data-ttu-id="b317d-122">Comparez cela au coût et à la difficulté que représente la création et la maintenance de vos propres centres de données dans plusieurs régions différentes.</span><span class="sxs-lookup"><span data-stu-id="b317d-122">Compare this with the cost and difficulty of building and maintaining your own datacenters in multiple regions.</span></span> <span data-ttu-id="b317d-123">Le déploiement de services et de données dans plusieurs régions contribue à protéger votre application contre une panne majeure survenant dans une seule région.</span><span class="sxs-lookup"><span data-stu-id="b317d-123">Deploying data and services to multiple regions helps protect your application from a major outage in a single region.</span></span> <span data-ttu-id="b317d-124">Lorsque vous concevez votre plan de récupération d’urgence, il est important de comprendre le concept des régions jumelées.</span><span class="sxs-lookup"><span data-stu-id="b317d-124">As you design your disaster recovery plan, it’s important to understand the concept of paired regions.</span></span> <span data-ttu-id="b317d-125">Pour plus d’informations, consultez l’article [Continuité des activités et récupération d’urgence (BCDR) : régions jumelées d’Azure](/azure/best-practices-availability-paired-regions).</span><span class="sxs-lookup"><span data-stu-id="b317d-125">For more information, see [Business continuity and disaster recovery (BCDR): Azure Paired Regions](/azure/best-practices-availability-paired-regions).</span></span>

## <a name="azure-traffic-manager"></a><span data-ttu-id="b317d-126">Azure Traffic Manager</span><span class="sxs-lookup"><span data-stu-id="b317d-126">Azure Traffic Manager</span></span>
<span data-ttu-id="b317d-127">En cas de défaillance spécifique à une région, vous devez rediriger le trafic vers les services ou les déploiements dans une autre région.</span><span class="sxs-lookup"><span data-stu-id="b317d-127">When a region-specific failure occurs, you must redirect traffic to services or deployments in another region.</span></span> <span data-ttu-id="b317d-128">Il est préférable de gérer cette situation via des services tels qu’Azure Traffic Manager, qui automatise le basculement du trafic utilisateur en cas de défaillance dans la région principale.</span><span class="sxs-lookup"><span data-stu-id="b317d-128">It is most effective to handle this via services such as Azure Traffic Manager, which automates the failover of user traffic to another region if the primary region fails.</span></span> <span data-ttu-id="b317d-129">La compréhension des principes de base de Traffic Manager est essentielle pour concevoir une stratégie efficace de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="b317d-129">Understanding the fundamentals of Traffic Manager is important when designing an effective DR strategy.</span></span>

<span data-ttu-id="b317d-130">Traffic Manager utilise le DNS (Domain Name System) pour diriger les requêtes des clients vers le point de terminaison approprié en fonction de la méthode de routage du trafic et de l’intégrité des points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="b317d-130">Traffic Manager uses the Domain Name System (DNS) to direct client requests to the most appropriate endpoint based on a traffic-routing method and the health of the endpoints.</span></span> <span data-ttu-id="b317d-131">Dans le diagramme suivant, les utilisateurs se connectent à une URL Traffic Manager (`http://myATMURL.trafficmanager.net`) qui extrait les URL réelles des sites (`http://app1URL.cloudapp.net` et `http://app2URL.cloudapp.net`).</span><span class="sxs-lookup"><span data-stu-id="b317d-131">In the following diagram, users connect to a Traffic Manager URL (`http://myATMURL.trafficmanager.net`) which abstracts the actual site URLs (`http://app1URL.cloudapp.net` and `http://app2URL.cloudapp.net`).</span></span> <span data-ttu-id="b317d-132">Les requêtes des utilisateurs sont acheminées vers l’URL sous-jacente appropriée en fonction de la [méthode de routage Traffic Manager](/azure/traffic-manager/traffic-manager-routing-methods) configurée.</span><span class="sxs-lookup"><span data-stu-id="b317d-132">User requests are routed to the proper underlying URL based on your configured [Traffic Manager routing method](/azure/traffic-manager/traffic-manager-routing-methods).</span></span> <span data-ttu-id="b317d-133">Dans cet article, nous traiterons uniquement l’option de basculement.</span><span class="sxs-lookup"><span data-stu-id="b317d-133">For the sake of this article, we will be concerned with only the failover option.</span></span>

![Routage via Microsoft Azure Traffic Manager](./images/disaster-recovery-azure-applications/routing-using-azure-traffic-manager.png)

<span data-ttu-id="b317d-135">Lorsque vous configurez Traffic Manager, vous fournissez un nouveau préfixe DNS Traffic Manager qui sera utilisé par les utilisateurs pour accéder à votre service.</span><span class="sxs-lookup"><span data-stu-id="b317d-135">When configuring Traffic Manager, you provide a new Traffic Manager DNS prefix, which users will use to access your service.</span></span> <span data-ttu-id="b317d-136">Traffic Manager extrait à présent l’équilibrage de charge un niveau au-dessus du niveau régional.</span><span class="sxs-lookup"><span data-stu-id="b317d-136">Traffic Manager now abstracts load balancing one level higher that the regional level.</span></span> <span data-ttu-id="b317d-137">Le DNS Traffic Manager mappe vers un enregistrement CNAME pour tous les déploiements qu’il gère.</span><span class="sxs-lookup"><span data-stu-id="b317d-137">The Traffic Manager DNS maps to a CNAME for all the deployments that it manages.</span></span>

<span data-ttu-id="b317d-138">Dans Traffic Manager, vous spécifiez la liste prioritaire des déploiements vers lesquels les utilisateurs doivent être acheminés en cas de défaillance.</span><span class="sxs-lookup"><span data-stu-id="b317d-138">Within Traffic Manager, you specify a prioritized list of deployments that users will be routed to when failure occurs.</span></span> <span data-ttu-id="b317d-139">Traffic Manager surveille les points de terminaison de déploiement.</span><span class="sxs-lookup"><span data-stu-id="b317d-139">Traffic Manager monitors the deployment endpoints.</span></span> <span data-ttu-id="b317d-140">Si le déploiement principal devient indisponible, Traffic Manager achemine les utilisateurs vers le déploiement suivant sur la liste prioritaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-140">If the primary deployment becomes unavailable, Traffic Manager routes users to the next deployment on the priority list.</span></span>

<span data-ttu-id="b317d-141">Bien que Traffic Manager choisisse la destination pendant un basculement, c’est vous qui décidez si votre domaine de basculement doit être dormant ou actif lorsque vous n’êtes pas en mode de basculement (ce qui n’a aucun lien avec Traffic Manager).</span><span class="sxs-lookup"><span data-stu-id="b317d-141">Although Traffic Manager decides where to go during a failover, you can decide whether your failover domain is dormant or active while you're not in failover mode (which is unrelated to Traffic Manager).</span></span> <span data-ttu-id="b317d-142">Traffic Manager détecte une défaillance du site principal et effectue la substitution vers le site de basculement, indépendamment du fait que ce site réponde aux demandes des utilisateurs ou non.</span><span class="sxs-lookup"><span data-stu-id="b317d-142">Traffic Manager detects a failure in the primary site and rolls over to the failover site, regardless of whether that site is currently serving users.</span></span>

<span data-ttu-id="b317d-143">Pour plus d’informations sur le fonctionnement d’Azure Traffic Manager, consultez :</span><span class="sxs-lookup"><span data-stu-id="b317d-143">For more information on how Azure Traffic Manager works, refer to:</span></span>

* [<span data-ttu-id="b317d-144">Vue d’ensemble de Traffic Manager</span><span class="sxs-lookup"><span data-stu-id="b317d-144">Traffic Manager overview</span></span>](/azure/traffic-manager/traffic-manager-overview/)
* [<span data-ttu-id="b317d-145">Méthodes de routage de Traffic Manager</span><span class="sxs-lookup"><span data-stu-id="b317d-145">Traffic Manager routing methods</span></span>](/azure/traffic-manager/traffic-manager-routing-methods)
* [<span data-ttu-id="b317d-146">Configurer la méthode de routage par basculement</span><span class="sxs-lookup"><span data-stu-id="b317d-146">Configure failover routing method</span></span>](/azure/traffic-manager/traffic-manager-configure-failover-routing-method/)

## <a name="azure-disaster-scenarios"></a><span data-ttu-id="b317d-147">Scénarios d’urgence Azure</span><span class="sxs-lookup"><span data-stu-id="b317d-147">Azure disaster scenarios</span></span>
<span data-ttu-id="b317d-148">Les sections suivantes abordent les différents types de scénarios d’urgence.</span><span class="sxs-lookup"><span data-stu-id="b317d-148">The following sections cover several different types of disaster scenarios.</span></span> <span data-ttu-id="b317d-149">Les interruptions de service à l’échelle régionale ne sont pas la seule cause des défaillances des applications.</span><span class="sxs-lookup"><span data-stu-id="b317d-149">Region-wide service disruptions are not the only cause of application-wide failures.</span></span> <span data-ttu-id="b317d-150">Les pannes peuvent aussi être liées à une mauvaise conception et à des erreurs d’administration.</span><span class="sxs-lookup"><span data-stu-id="b317d-150">Poor design and administrative errors can also lead to outages.</span></span> <span data-ttu-id="b317d-151">Il est important de prendre en compte les causes possibles d’une défaillance lors des phases de conception et de test de votre plan de récupération.</span><span class="sxs-lookup"><span data-stu-id="b317d-151">It's important to consider the possible causes of a failure during both the design and testing phases of your recovery plan.</span></span> <span data-ttu-id="b317d-152">Un plan efficace tire parti des fonctionnalités d’Azure et les complète avec les stratégies conçues pour l’application.</span><span class="sxs-lookup"><span data-stu-id="b317d-152">A good plan takes advantage of Azure features and augments them with application-specific strategies.</span></span> <span data-ttu-id="b317d-153">La réponse choisie est déterminée par l’importance de l’application, l’objectif de point de récupération (RPO) et l’objectif de délai de récupération (RTO).</span><span class="sxs-lookup"><span data-stu-id="b317d-153">The chosen response is determined by the importance of the application, the recovery point objective (RPO), and the recovery time objective (RTO).</span></span>

### <a name="application-failure"></a><span data-ttu-id="b317d-154">Échec de l’application</span><span class="sxs-lookup"><span data-stu-id="b317d-154">Application failure</span></span>
<span data-ttu-id="b317d-155">Azure Traffic Manager gère automatiquement les défaillances résultant du logiciel de système d’exploitation ou du matériel sous-jacent dans la machine virtuelle hôte.</span><span class="sxs-lookup"><span data-stu-id="b317d-155">Azure Traffic Manager automatically handles failures that result from the underlying hardware or operating system software in the host virtual machine.</span></span> <span data-ttu-id="b317d-156">Azure crée une nouvelle instance de rôle et l’ajoute au pool disponible.</span><span class="sxs-lookup"><span data-stu-id="b317d-156">Azure creates a new role instance and adds it to the available pool.</span></span> <span data-ttu-id="b317d-157">Si plus d’une instance de rôle est déjà en cours d’exécution, Azure déplace le traitement vers les autres instances de rôle en cours d’exécution, tout en remplaçant le nœud défaillant.</span><span class="sxs-lookup"><span data-stu-id="b317d-157">If  more than one role instance was already running, Azure shifts processing to the other running role instances while replacing the failed node.</span></span>

<span data-ttu-id="b317d-158">Les erreurs graves d’applications ne sont pas toujours dues à une défaillance sous-jacente du matériel ou du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="b317d-158">Serious application errors can occur without any underlying failure of the hardware or operating system.</span></span> <span data-ttu-id="b317d-159">L’application peut échouer en raison d’exceptions graves provoquées par une logique incorrecte ou des problèmes d’intégrité des données.</span><span class="sxs-lookup"><span data-stu-id="b317d-159">The application might fail due to catastrophic exceptions caused by bad logic or data integrity issues.</span></span> <span data-ttu-id="b317d-160">Vous devez inclure suffisamment de télémétrie dans le code de l’application pour qu’un système de surveillance puisse détecter les conditions d’échec et en informer un administrateur d’application.</span><span class="sxs-lookup"><span data-stu-id="b317d-160">You must include sufficient telemetry in the application code so that a monitoring system can detect failure conditions and notify an application administrator.</span></span> <span data-ttu-id="b317d-161">Un administrateur ayant une parfaite connaissance des processus de récupération d’urgence peut décider s’il faut déclencher un processus de basculement ou accepter un manque de disponibilité pendant la résolution des erreurs critiques.</span><span class="sxs-lookup"><span data-stu-id="b317d-161">An administrator who has full knowledge of the disaster recovery processes can decide whether to trigger a failover process or accept an availability outage while resolving the critical errors.</span></span>

### <a name="data-corruption"></a><span data-ttu-id="b317d-162">Corruption des données</span><span class="sxs-lookup"><span data-stu-id="b317d-162">Data corruption</span></span>
<span data-ttu-id="b317d-163">Azure stocke automatiquement les données de la base de données SQL Azure et du stockage Azure trois fois de manière redondante dans différents domaines d’erreur de la même région.</span><span class="sxs-lookup"><span data-stu-id="b317d-163">Azure automatically stores Azure SQL Database and Azure Storage data three times redundantly within different fault domains in the same region.</span></span> <span data-ttu-id="b317d-164">Si vous utilisez la géoréplication, les données sont stockées dans trois domaines supplémentaires dans une autre région.</span><span class="sxs-lookup"><span data-stu-id="b317d-164">If you use geo-replication, the data is stored three additional times in a different region.</span></span> <span data-ttu-id="b317d-165">Toutefois, si vos utilisateurs ou votre application endommagent ces données dans la copie principale, celles-ci sont rapidement répliquées dans les autres copies.</span><span class="sxs-lookup"><span data-stu-id="b317d-165">However, if your users or your application corrupts that data in the primary copy, the data quickly replicates to the other copies.</span></span> <span data-ttu-id="b317d-166">Malheureusement, cela a pour résultat plusieurs copies de données endommagées.</span><span class="sxs-lookup"><span data-stu-id="b317d-166">Unfortunately, this results in multiple copies of corrupt data.</span></span>

<span data-ttu-id="b317d-167">Vous disposez de deux options pour gérer l’altération potentielle de vos données.</span><span class="sxs-lookup"><span data-stu-id="b317d-167">To manage potential corruption of your data, you have two options.</span></span> <span data-ttu-id="b317d-168">Vous pouvez d’abord gérer une stratégie de sauvegarde personnalisée.</span><span class="sxs-lookup"><span data-stu-id="b317d-168">First, you can manage a custom backup strategy.</span></span> <span data-ttu-id="b317d-169">Vous pouvez stocker vos sauvegardes dans Azure ou localement selon les besoins de votre entreprise ou la réglementation en matière de gouvernance.</span><span class="sxs-lookup"><span data-stu-id="b317d-169">You can store your backups in Azure or on-premises, depending on your business requirements or governance regulations.</span></span> <span data-ttu-id="b317d-170">Une autre option consiste à utiliser l’option de limite de restauration dans le temps pour récupérer une base de données SQL.</span><span class="sxs-lookup"><span data-stu-id="b317d-170">Another option is to use the point-in-time restore option to recover a SQL database.</span></span> <span data-ttu-id="b317d-171">Pour plus d’informations, consultez la section consacrée aux [stratégies de données pour une récupération d’urgence](#data-strategies-for-disaster-recovery) ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="b317d-171">For more information, see the [data strategies for disaster recovery](#data-strategies-for-disaster-recovery) section below.</span></span>

### <a name="network-outage"></a><span data-ttu-id="b317d-172">Panne du réseau</span><span class="sxs-lookup"><span data-stu-id="b317d-172">Network outage</span></span>
<span data-ttu-id="b317d-173">Lorsque certaines parties du réseau Azure sont inaccessibles, vous ne pouvez pas toujours accéder à votre application ou à vos données.</span><span class="sxs-lookup"><span data-stu-id="b317d-173">When parts of the Azure network are inaccessible, you may be unable to access your application or data.</span></span> <span data-ttu-id="b317d-174">Si une ou plusieurs instances de rôle ne sont pas disponibles en raison de problèmes de réseau, Azure utilise les autres instances disponibles de votre application.</span><span class="sxs-lookup"><span data-stu-id="b317d-174">If one or more role instances are unavailable due to network issues, Azure uses the remaining available instances of your application.</span></span> <span data-ttu-id="b317d-175">Si votre application ne peut pas accéder à ses données en raison d’une panne du réseau Azure, vous pouvez éventuellement l’exécuter avec des fonctionnalités réduites en local à l’aide des données mises en cache.</span><span class="sxs-lookup"><span data-stu-id="b317d-175">If your application cannot access its data because of an Azure network outage, you can potentially run with reduced application functionality locally by using cached data.</span></span> <span data-ttu-id="b317d-176">Vous devez concevoir la stratégie de récupération d’urgence de manière à exécuter l’application avec des fonctionnalités réduites.</span><span class="sxs-lookup"><span data-stu-id="b317d-176">You need to design the disaster recovery strategy to run with reduced functionality in your application.</span></span> <span data-ttu-id="b317d-177">Pour certaines applications, cela peut se révéler peu pratique.</span><span class="sxs-lookup"><span data-stu-id="b317d-177">For some applications, this might not be practical.</span></span>

<span data-ttu-id="b317d-178">Une autre option consiste à stocker des données à un autre emplacement jusqu’au rétablissement de la connectivité.</span><span class="sxs-lookup"><span data-stu-id="b317d-178">Another option is to store data in an alternate location until connectivity is restored.</span></span> <span data-ttu-id="b317d-179">Si la réduction des fonctionnalités n’est pas une option, il vous reste les interruptions de service ou le basculement vers une autre région.</span><span class="sxs-lookup"><span data-stu-id="b317d-179">If reducing functionality is not an option, the remaining options are application downtime or failover to an alternate region.</span></span> <span data-ttu-id="b317d-180">La conception d’une application s’exécutant avec des fonctionnalités réduites relève aussi bien d’une décision économique que technique.</span><span class="sxs-lookup"><span data-stu-id="b317d-180">The design of an application running with reduced functionality is as much a business decision as a technical one.</span></span> <span data-ttu-id="b317d-181">Ce sujet est abordé plus en détail dans la section [Fonctionnalités réduites des applications](#reduced-application-functionality).</span><span class="sxs-lookup"><span data-stu-id="b317d-181">This is discussed further in the section on [reduced application functionality](#reduced-application-functionality).</span></span>

### <a name="failure-of-a-dependent-service"></a><span data-ttu-id="b317d-182">Échec d’un service dépendant</span><span class="sxs-lookup"><span data-stu-id="b317d-182">Failure of a dependent service</span></span>
<span data-ttu-id="b317d-183">Azure fournit plusieurs services pouvant rencontrer des temps d’arrêt périodiques.</span><span class="sxs-lookup"><span data-stu-id="b317d-183">Azure provides many services that can experience periodic downtime.</span></span> <span data-ttu-id="b317d-184">Par exemple, [Cache Redis Azure](https://azure.microsoft.com/services/cache/) est un service mutualisé qui fournit des fonctionnalités de mise en cache à votre application.</span><span class="sxs-lookup"><span data-stu-id="b317d-184">For example, [Azure Redis Cache](https://azure.microsoft.com/services/cache/) is a multi-tenant service which provides caching capabilities to your application.</span></span> <span data-ttu-id="b317d-185">Il est important de savoir ce qui se passe dans votre application en cas d’indisponibilité du service dépendant.</span><span class="sxs-lookup"><span data-stu-id="b317d-185">It's important to consider what happens in your application if the dependent service is unavailable.</span></span> <span data-ttu-id="b317d-186">Ce scénario est assez semblable au scénario de panne du réseau.</span><span class="sxs-lookup"><span data-stu-id="b317d-186">In many ways, this scenario is similar to the network outage scenario.</span></span> <span data-ttu-id="b317d-187">Toutefois, le fait de considérer chaque service de manière indépendante favorise les améliorations potentielles de votre plan global.</span><span class="sxs-lookup"><span data-stu-id="b317d-187">However, considering each service independently results in potential improvements to your overall plan.</span></span>

<span data-ttu-id="b317d-188">Le Cache Redis Azure permet la mise en cache de votre application à partir de votre déploiement de service cloud, ce qui facilite la récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="b317d-188">Azure Redis Cache provides caching to your application from within your cloud service deployment, which provides disaster recovery benefits.</span></span> <span data-ttu-id="b317d-189">Le service s’exécute désormais sur des rôles propres à votre déploiement.</span><span class="sxs-lookup"><span data-stu-id="b317d-189">First, the service now runs on roles that are local to your deployment.</span></span> <span data-ttu-id="b317d-190">Par conséquent, vous pouvez mieux surveiller et gérer l’état du cache dans le cadre de votre processus de gestion globale pour le service cloud.</span><span class="sxs-lookup"><span data-stu-id="b317d-190">Therefore, you're better able to monitor and manage the status of the cache as part of your overall management processes for the cloud service.</span></span> <span data-ttu-id="b317d-191">Ce type de mise en cache expose également de nouvelles fonctionnalités telles que la haute disponibilité des données mises en cache, qui permet de les conserver en cas de défaillance d’un nœud en conservant des copies dupliquées sur d’autres nœuds.</span><span class="sxs-lookup"><span data-stu-id="b317d-191">This type of caching also exposes new features such as high availability for cached data, which preserves cached data if a single node fails by maintaining duplicate copies on other nodes.</span></span>

<span data-ttu-id="b317d-192">Notez que la haute disponibilité diminue le débit et augmente la latence car les opérations d’écriture doivent également mettre à jour les copies secondaires.</span><span class="sxs-lookup"><span data-stu-id="b317d-192">Note that high availability decreases throughput and increases latency because write operations must also upedate any secondary copies.</span></span> <span data-ttu-id="b317d-193">La quantité de mémoire requise pour stocker les données mises en cache est multipliée par deux. Vous devez prendre cela en compte lors de la planification de capacité.</span><span class="sxs-lookup"><span data-stu-id="b317d-193">The amount of memory required to store the cached data is effectively doubled, which must be taken into account during capacity planning.</span></span>  <span data-ttu-id="b317d-194">Cet exemple montre que chaque service dépendant peut présenter des fonctionnalités pouvant améliorer votre disponibilité globale et la résistance aux défaillances catastrophiques.</span><span class="sxs-lookup"><span data-stu-id="b317d-194">This example demonstrates that each dependent service might have capabilities that improve your overall availability and resistance to catastrophic failures.</span></span>

<span data-ttu-id="b317d-195">Vous devez comprendre les conséquences d’une interruption de service pour chaque service dépendant.</span><span class="sxs-lookup"><span data-stu-id="b317d-195">With each dependent service, you should understand the implications of a service disruption.</span></span> <span data-ttu-id="b317d-196">Dans l’exemple de mise en cache, il est parfois possible d’accéder aux données directement à partir d’une base de données jusqu’à ce que vous restauriez votre cache.</span><span class="sxs-lookup"><span data-stu-id="b317d-196">In the caching example, it might be possible to access the data directly from a database until you restore your cache.</span></span> <span data-ttu-id="b317d-197">Cela diminue les performances, mais vous fournit un accès complet aux données d’application.</span><span class="sxs-lookup"><span data-stu-id="b317d-197">This would result in reduced performance while providing full access to application data.</span></span>

### <a name="region-wide-service-disruption"></a><span data-ttu-id="b317d-198">Interruption du service à l’échelle régionale</span><span class="sxs-lookup"><span data-stu-id="b317d-198">Region-wide service disruption</span></span>
<span data-ttu-id="b317d-199">Les échecs précédents étaient principalement des défaillances pouvant être gérées au sein de la même région Azure.</span><span class="sxs-lookup"><span data-stu-id="b317d-199">The previous failures have primarily been failures that can be managed within the same Azure region.</span></span> <span data-ttu-id="b317d-200">Toutefois, vous devez également prévoir l’éventualité d’une interruption du service dans l’ensemble de la région.</span><span class="sxs-lookup"><span data-stu-id="b317d-200">However, you must also prepare for the possibility that there is a service disruption of the entire region.</span></span> <span data-ttu-id="b317d-201">Le cas échéant, les copies localement redondantes de vos données ne sont pas disponibles.</span><span class="sxs-lookup"><span data-stu-id="b317d-201">If a region-wide service disruption occurs, the locally redundant copies of your data are not available.</span></span> <span data-ttu-id="b317d-202">Si vous avez activé la géoréplication, trois copies supplémentaires de vos tables et objets blob sont stockées dans une autre région.</span><span class="sxs-lookup"><span data-stu-id="b317d-202">If you have enabled geo-replication, there are three additional copies of your blobs and tables in a different region.</span></span> <span data-ttu-id="b317d-203">Si Microsoft déclare la région comme étant perdue, Azure remappe toutes les entrées DNS vers la région géorépliquée.</span><span class="sxs-lookup"><span data-stu-id="b317d-203">If Microsoft declares the region lost, Azure remaps all of the DNS entries to the geo-replicated region.</span></span>

> [!NOTE]
> <span data-ttu-id="b317d-204">N’oubliez pas que vous n’avez aucun contrôle sur ce processus et qu’il ne se produit que pour les interruptions du service au niveau régional.</span><span class="sxs-lookup"><span data-stu-id="b317d-204">Be aware that you don't have any control over this process, and it will occur only for region-wide service disruption.</span></span> <span data-ttu-id="b317d-205">Ainsi, vous devez vous appuyer sur d’autres stratégies de sauvegarde propres à l’application pour atteindre le plus haut niveau de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="b317d-205">Because of this, you must rely on other application-specific backup strategies to achieve the highest level of availability.</span></span> <span data-ttu-id="b317d-206">Pour plus d’informations, consultez la section consacrée aux [stratégies de données pour une récupération d’urgence](#data-strategies-for-disaster-recovery).</span><span class="sxs-lookup"><span data-stu-id="b317d-206">For more information, see the section on [data strategies for disaster recovery](#data-strategies-for-disaster-recovery).</span></span>
> 
> 

### <a name="azure-wide-service-disruption"></a><span data-ttu-id="b317d-207">Interruption du service dans l’ensemble des régions Azure</span><span class="sxs-lookup"><span data-stu-id="b317d-207">Azure-wide service disruption</span></span>
<span data-ttu-id="b317d-208">Vous devez prendre en compte l’ensemble des scénarios catastrophe lors de la planification d’urgence.</span><span class="sxs-lookup"><span data-stu-id="b317d-208">In disaster planning, you must consider the entire range of possible disasters.</span></span> <span data-ttu-id="b317d-209">L’une des interruptions de service les plus graves impliquerait l’interruption simultanée de toutes les régions Azure.</span><span class="sxs-lookup"><span data-stu-id="b317d-209">One of the most severe service disruptions would involve all Azure regions simultaneously.</span></span> <span data-ttu-id="b317d-210">Comme pour les autres interruptions de service, vous pouvez alors décider d’accepter le risque d’un arrêt temporaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-210">As with other service disruptions, you might decide to accept the risk of temporary downtime in that event.</span></span> <span data-ttu-id="b317d-211">Les interruptions de service importantes, couvrant des régions entières, sont beaucoup plus rares que les interruptions de service isolées impliquant des services dépendants ou des régions uniques.</span><span class="sxs-lookup"><span data-stu-id="b317d-211">Widespread service disruptions that span regions are much rarer than isolated service disruptions involving dependent services or single regions.</span></span>

<span data-ttu-id="b317d-212">Cependant, vous pouvez décider que certaines applications critiques nécessitent un plan de sauvegarde pour une interruption de service multirégion.</span><span class="sxs-lookup"><span data-stu-id="b317d-212">However, you may decide that certain mission-critical applications require a backup plan for a multi-region service disruption.</span></span> <span data-ttu-id="b317d-213">Le plan peut comprendre le basculement vers des services dans un [cloud alternatif](#alternative-cloud) ou une [solution hybride locale et cloud](#hybrid-on-premises-and-cloud-solution).</span><span class="sxs-lookup"><span data-stu-id="b317d-213">This plan might include failing over to services in an [alternative cloud](#alternative-cloud) or a [hybrid on-premises and cloud solution](#hybrid-on-premises-and-cloud-solution).</span></span>

### <a name="reduced-application-functionality"></a><span data-ttu-id="b317d-214">Fonctionnalités réduites des applications</span><span class="sxs-lookup"><span data-stu-id="b317d-214">Reduced application functionality</span></span>
<span data-ttu-id="b317d-215">Une application bien conçue utilise généralement des services qui communiquent entre eux via l’implémentation de modèles d’échange d’informations faiblement couplés.</span><span class="sxs-lookup"><span data-stu-id="b317d-215">A well-designed application typically uses services that communicate with each other though the implementation of loosely coupled information-interchange patterns.</span></span> <span data-ttu-id="b317d-216">Une application prenant en charge la récupération d’urgence nécessite la séparation des responsabilités au niveau du service.</span><span class="sxs-lookup"><span data-stu-id="b317d-216">A DR-friendly application requires separation of responsibilities at the service level.</span></span> <span data-ttu-id="b317d-217">Cela évite qu’une interruption de service dépendant ne provoque l’arrêt de l’application.</span><span class="sxs-lookup"><span data-stu-id="b317d-217">This prevents the disruption of a dependent service from bringing down the entire application.</span></span> <span data-ttu-id="b317d-218">Par exemple, les modules suivants peuvent composer une application de commerce en ligne pour la société Y :</span><span class="sxs-lookup"><span data-stu-id="b317d-218">For example, consider a web commerce application for Company Y. The following modules might constitute the application:</span></span>

* <span data-ttu-id="b317d-219">**Catalogue de produits** permet aux utilisateurs de parcourir les produits.</span><span class="sxs-lookup"><span data-stu-id="b317d-219">**Product Catalog** allows users to browse products.</span></span>
* <span data-ttu-id="b317d-220">**Panier** permet aux utilisateurs d’ajouter/supprimer des produits dans leur panier.</span><span class="sxs-lookup"><span data-stu-id="b317d-220">**Shopping Cart** allows users to add/remove products in their shopping cart.</span></span>
* <span data-ttu-id="b317d-221">**État de la commande** affiche le statut d’expédition des commandes des utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="b317d-221">**Order Status** shows the shipping status of user orders.</span></span>
* <span data-ttu-id="b317d-222">**Finalisation de la commande** finalise la session d’achat par la soumission de la commande avec le paiement.</span><span class="sxs-lookup"><span data-stu-id="b317d-222">**Order Submission** finalizes the shopping session by submitting the order with payment.</span></span>
* <span data-ttu-id="b317d-223">**Traitement des commandes** valide la commande pour l’intégrité des données et contrôle les stocks.</span><span class="sxs-lookup"><span data-stu-id="b317d-223">**Order Processing** validates the order for data integrity and performs a quantity availability check.</span></span>

<span data-ttu-id="b317d-224">Quand une dépendance de service dans cette application n’est plus disponible, comment le service fonctionne-t-il jusqu'à la récupération de la dépendance ?</span><span class="sxs-lookup"><span data-stu-id="b317d-224">When a service dependency in this application becomes unavailable, how does the service function until the dependency recovers?</span></span> <span data-ttu-id="b317d-225">Un système bien conçu implémente des limites d’isolement en séparant les responsabilités lors de la conception et de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="b317d-225">A well-designed system implements isolation boundaries through separation of responsibilities, both at design time and at runtime.</span></span> <span data-ttu-id="b317d-226">Vous pouvez classer chaque erreur comme étant récupérable ou non récupérable.</span><span class="sxs-lookup"><span data-stu-id="b317d-226">You can categorize every failure as recoverable and non-recoverable.</span></span> <span data-ttu-id="b317d-227">Les erreurs non récupérables provoqueront l’arrêt du service tandis que les erreurs récupérables peuvent être atténuées par le biais d’autres solutions.</span><span class="sxs-lookup"><span data-stu-id="b317d-227">Non-recoverable errors will bring down the service, but you can mitigate a recoverable error through alternatives.</span></span> <span data-ttu-id="b317d-228">Certains problèmes résolus par la gestion automatique des erreurs et la mise en œuvre d’autres mesures sont transparentes pour l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="b317d-228">Certain problems addressed by automatically handling faults and taking alternate actions are transparent to the user.</span></span> <span data-ttu-id="b317d-229">En cas d’une interruption de service plus sérieuse, l’application peut s’en trouver totalement indisponible.</span><span class="sxs-lookup"><span data-stu-id="b317d-229">During a more serious service disruption, the application might be completely unavailable.</span></span> <span data-ttu-id="b317d-230">La troisième option consiste à continuer à gérer les requêtes des utilisateurs avec des fonctionnalités réduites.</span><span class="sxs-lookup"><span data-stu-id="b317d-230">A third option is to continue handling user requests with reduced functionality.</span></span>

<span data-ttu-id="b317d-231">Par exemple, si la base de données pour l’hébergement des commandes tombe en panne, le service de traitement des commandes perd sa capacité à traiter les transactions commerciales.</span><span class="sxs-lookup"><span data-stu-id="b317d-231">For instance, if the database for hosting orders goes down, the Order Processing service loses its ability to process sales transactions.</span></span> <span data-ttu-id="b317d-232">Selon l’architecture, il peut être difficile, voire impossible pour les services de finalisation des commandes et de traitement des commandes de continuer à fonctionner.</span><span class="sxs-lookup"><span data-stu-id="b317d-232">Depending on the architecture, it might be difficult or impossible for the Order Submission and Order Processing services of the application to continue.</span></span> <span data-ttu-id="b317d-233">Si l’application n’est pas conçue pour gérer ce type de scénario, cette dernière pourrait se déconnecter entièrement.</span><span class="sxs-lookup"><span data-stu-id="b317d-233">If the application is not designed to handle this scenario, the entire application might go offline.</span></span> <span data-ttu-id="b317d-234">Cependant, si les données des produits sont stockées dans un autre emplacement, le module Catalogue de produits peut toujours être utilisé pour afficher les produits.</span><span class="sxs-lookup"><span data-stu-id="b317d-234">However, if the product data is stored in a different location, then the Product Catalog module can still be used for viewing products.</span></span> <span data-ttu-id="b317d-235">Les autres composants de l’application sont toutefois indisponibles, tels que les commandes ou le contrôle des stocks.</span><span class="sxs-lookup"><span data-stu-id="b317d-235">However, other parts of the application are unavailable, such as ordering or inventory queries.</span></span>

<span data-ttu-id="b317d-236">Le choix des fonctionnalités réduites des applications mises à disposition est le fruit de décisions économiques et techniques.</span><span class="sxs-lookup"><span data-stu-id="b317d-236">Deciding what reduced application functionality is available is both a business decision and a technical decision.</span></span> <span data-ttu-id="b317d-237">Vous devez décider comment l’application va informer les utilisateurs des problèmes temporaires.</span><span class="sxs-lookup"><span data-stu-id="b317d-237">You must decide how the application will inform the users of any temporary problems.</span></span> <span data-ttu-id="b317d-238">Dans l’exemple ci-dessus, l’application peut autoriser l’affichage des produits et leur ajout au panier.</span><span class="sxs-lookup"><span data-stu-id="b317d-238">In the example above, the application might allow viewing products and adding them to a shopping cart.</span></span> <span data-ttu-id="b317d-239">Cependant, lorsque l’utilisateur tente d’effectuer un achat, l’application l’informe que la fonctionnalité de commande est temporairement inaccessible.</span><span class="sxs-lookup"><span data-stu-id="b317d-239">However, when the user attempts to make a purchase, the application notifies the user that the ordering functionality is temporarily unavailable.</span></span> <span data-ttu-id="b317d-240">Ce n’est pas idéal pour le client, mais permet d’éviter une interruption de service de l’application dans son intégralité.</span><span class="sxs-lookup"><span data-stu-id="b317d-240">This isn't ideal for the customer, but it does prevent an application-wide service disruption.</span></span>

## <a name="data-strategies-for-disaster-recovery"></a><span data-ttu-id="b317d-241">stratégies de données pour une récupération d’urgence</span><span class="sxs-lookup"><span data-stu-id="b317d-241">Data strategies for disaster recovery</span></span>
<span data-ttu-id="b317d-242">La gestion appropriée des données est un aspect clé de tout plan de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="b317d-242">Proper data handling is a challenging aspect of a disaster recovery plan.</span></span> <span data-ttu-id="b317d-243">Pendant le processus de récupération, la restauration des données est ce qui prend généralement le plus de temps.</span><span class="sxs-lookup"><span data-stu-id="b317d-243">During the recovery process, data restoration typically takes the most time.</span></span> <span data-ttu-id="b317d-244">Des choix différents quant à la réduction des fonctionnalités entraînent des défis difficiles à relever en matière de récupération et de cohérence des données suite à une défaillance.</span><span class="sxs-lookup"><span data-stu-id="b317d-244">Different choices for reducing functionality result in difficult challenges for data recovery from failure and consistency after failure.</span></span>

<span data-ttu-id="b317d-245">Le besoin de restaurer ou de conserver une copie des données de l’application est un facteur à prendre en compte.</span><span class="sxs-lookup"><span data-stu-id="b317d-245">One consideration is the need to restore or maintain a copy of the application’s data.</span></span> <span data-ttu-id="b317d-246">Vous utiliserez ces données à des fins référentielles et transactionnelles sur un site secondaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-246">You will use this data for reference and transactional purposes at a secondary site.</span></span> <span data-ttu-id="b317d-247">Un déploiement local requiert un processus de planification long et coûteux afin d’implémenter une stratégie de récupération d’urgence dans plusieurs régions.</span><span class="sxs-lookup"><span data-stu-id="b317d-247">An on-premises deployment requires an expensive and lengthy planning process to implement a multiple-region disaster recovery strategy.</span></span> <span data-ttu-id="b317d-248">Heureusement, la plupart des fournisseurs cloud, notamment Azure, permettent le déploiement d’applications dans plusieurs régions.</span><span class="sxs-lookup"><span data-stu-id="b317d-248">Conveniently, most cloud providers, including Azure, readily allow the deployment of applications to multiple regions.</span></span> <span data-ttu-id="b317d-249">La répartition géographique de ces régions minimise l’interruption de service dans plusieurs régions.</span><span class="sxs-lookup"><span data-stu-id="b317d-249">These regions are geographically distributed in such a way that multiple-region service disruption should be extremely rare.</span></span> <span data-ttu-id="b317d-250">La stratégie de gestion des données entre les régions est l’un des facteurs décisifs pour la réussite d’un plan de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="b317d-250">The strategy for handling data across regions is one of the contributing factors for the success of any disaster recovery plan.</span></span>

<span data-ttu-id="b317d-251">Les sections suivantes décrivent les techniques de récupération d’urgence liées aux sauvegardes de données, aux données de référence et aux données transactionnelles.</span><span class="sxs-lookup"><span data-stu-id="b317d-251">The following sections discuss disaster recovery techniques related to data backups, reference data, and transactional data.</span></span>

### <a name="backup-and-restore"></a><span data-ttu-id="b317d-252">Sauvegarde et restauration</span><span class="sxs-lookup"><span data-stu-id="b317d-252">Backup and restore</span></span>
<span data-ttu-id="b317d-253">Des sauvegardes régulières des données d’application peuvent prendre en charge certains scénarios de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="b317d-253">Regular backups of application data can support some disaster recovery scenarios.</span></span> <span data-ttu-id="b317d-254">Les différentes ressources de stockage nécessitent des techniques différentes.</span><span class="sxs-lookup"><span data-stu-id="b317d-254">Different storage resources require different techniques.</span></span>

#### <a name="sql-database"></a><span data-ttu-id="b317d-255">Base de données SQL</span><span class="sxs-lookup"><span data-stu-id="b317d-255">SQL Database</span></span>
<span data-ttu-id="b317d-256">Pour les niveaux de base, Standard et Premium de la base de données SQL, vous pouvez tirer parti de la limite de restauration dans le temps pour récupérer votre base de données.</span><span class="sxs-lookup"><span data-stu-id="b317d-256">For the Basic, Standard, and Premium SQL Database tiers, you can take advantage of point-in-time restore to recover your database.</span></span> <span data-ttu-id="b317d-257">Pour en savoir plus, consultez l’article [Vue d’ensemble : continuité des activités cloud et récupération d’urgence d’une base de données avec SQL Database](/azure/sql-database/sql-database-business-continuity/).</span><span class="sxs-lookup"><span data-stu-id="b317d-257">For more information, see [Overview: Cloud business continuity and database disaster recovery with SQL Database](/azure/sql-database/sql-database-business-continuity/).</span></span> <span data-ttu-id="b317d-258">Une autre option consiste à utiliser la géoréplication active pour la base de données SQL.</span><span class="sxs-lookup"><span data-stu-id="b317d-258">Another option is to use Active Geo-Replication for SQL Database.</span></span> <span data-ttu-id="b317d-259">Celle-ci réplique automatiquement les modifications de base de données sur les bases de données secondaires dans la même région Azure, voire dans une région différente.</span><span class="sxs-lookup"><span data-stu-id="b317d-259">This automatically replicates database changes to secondary databases in the same Azure region or even in a different Azure region.</span></span> <span data-ttu-id="b317d-260">Cela représente une alternative possible à certaines techniques de synchronisation de données plus manuelles, présentées dans cet article.</span><span class="sxs-lookup"><span data-stu-id="b317d-260">This provides a potential alternative to some of the more manual data synchronization techniques presented in this article.</span></span> <span data-ttu-id="b317d-261">Pour plus d’informations, consultez l’article [Vue d’ensemble : géoréplication active de base de données SQL](/azure/sql-database/sql-database-geo-replication-overview/).</span><span class="sxs-lookup"><span data-stu-id="b317d-261">For more information, see [Overview: SQL Database Active Geo-Replication](/azure/sql-database/sql-database-geo-replication-overview/).</span></span>

<span data-ttu-id="b317d-262">Vous pouvez également avoir recours à une approche plus manuelle pour la sauvegarde et la restauration.</span><span class="sxs-lookup"><span data-stu-id="b317d-262">You can also use a more manual approach for backup and restore.</span></span> <span data-ttu-id="b317d-263">Utilisez la commande DATABASE COPY pour créer une copie de sauvegarde de la base de données avec une cohérence transactionnelle.</span><span class="sxs-lookup"><span data-stu-id="b317d-263">Use the DATABASE COPY command to create a backup copy of the database with transactional consistency.</span></span> <span data-ttu-id="b317d-264">Vous pouvez également utiliser le service d’importation/exportation d’Azure SQL Database, qui prend en charge l’exportation des bases de données dans des fichiers BACPAC (fichiers compressés contenant votre schéma de base de données et les données associées) qui sont stockés dans le stockage Blob Azure.</span><span class="sxs-lookup"><span data-stu-id="b317d-264">You can also use the import/export service of Azure SQL Database, which supports exporting databases to BACPAC files (compressed files containing your database schema and associated data) that are stored in Azure Blob storage.</span></span>

<span data-ttu-id="b317d-265">La redondance intégrée d’Azure Storage crée deux réplicas du fichier de sauvegarde dans la même région.</span><span class="sxs-lookup"><span data-stu-id="b317d-265">The built-in redundancy of Azure Storage creates two replicas of the backup file in the same region.</span></span> <span data-ttu-id="b317d-266">Toutefois, la fréquence d’exécution du processus de sauvegarde détermine votre RPO, c’est-à-dire la quantité de données que vous risquez de perdre dans les scénarios d’urgence.</span><span class="sxs-lookup"><span data-stu-id="b317d-266">However, the frequency of running the backup process determines your RPO, which is the amount of data you might lose in disaster scenarios.</span></span> <span data-ttu-id="b317d-267">Par exemple, imaginez que vous effectuez une sauvegarde toutes les heures et qu’un incident survient deux minutes avant la nouvelle sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="b317d-267">For example, imagine that you perform a backup at the top of each hour, and a disaster occurs two minutes before the top of the hour.</span></span> <span data-ttu-id="b317d-268">Vous perdez ainsi 58 minutes de données enregistrées depuis la dernière sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="b317d-268">You lose 58 minutes of data recorded after the last backup was performed.</span></span> <span data-ttu-id="b317d-269">En outre, pour vous protéger contre une interruption de service à l’échelle régionale, vous devez copier les fichiers BACPAC vers une autre région.</span><span class="sxs-lookup"><span data-stu-id="b317d-269">Also, to protect against a region-wide service disruption, you should copy the BACPAC files to an alternate region.</span></span> <span data-ttu-id="b317d-270">Vous avez ensuite la possibilité de restaurer ces sauvegardes dans l’autre région.</span><span class="sxs-lookup"><span data-stu-id="b317d-270">You then have the option of restoring those backups in the alternate region.</span></span> <span data-ttu-id="b317d-271">Pour en savoir plus, consultez l’article [Vue d’ensemble : continuité des activités cloud et récupération d’urgence d’une base de données avec SQL Database](/azure/sql-database/sql-database-business-continuity/).</span><span class="sxs-lookup"><span data-stu-id="b317d-271">For more details, see [Overview: Cloud business continuity and database disaster recovery with SQL Database](/azure/sql-database/sql-database-business-continuity/).</span></span>

#### <a name="azure-storage"></a><span data-ttu-id="b317d-272">Azure Storage</span><span class="sxs-lookup"><span data-stu-id="b317d-272">Azure Storage</span></span>
<span data-ttu-id="b317d-273">Pour le stockage Azure, vous pouvez développer un processus de sauvegarde personnalisé ou utiliser l’un des nombreux outils de sauvegarde tiers.</span><span class="sxs-lookup"><span data-stu-id="b317d-273">For Azure Storage, you can develop a custom backup process or use one of many third-party backup tools.</span></span> <span data-ttu-id="b317d-274">Notez que la plupart des conceptions d’applications comportent des complexités supplémentaires dans la mesure où les ressources de stockage se référencent mutuellement.</span><span class="sxs-lookup"><span data-stu-id="b317d-274">Note that most application designs have additional complexities where storage resources reference each other.</span></span> <span data-ttu-id="b317d-275">Prenez l’exemple d’une base de données SQL comportant une colonne liée à un objet blob dans Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="b317d-275">For example, consider a SQL database that has a column that links to a blob in Azure Storage.</span></span> <span data-ttu-id="b317d-276">Si les sauvegardes ne sont pas effectuées simultanément, cela peut être dû à l’absence de sauvegarde du pointeur vers un objet blob de la base de données avant la défaillance.</span><span class="sxs-lookup"><span data-stu-id="b317d-276">If the backups do not happen simultaneously, the database might have a pointer to a blob that was not backed up before the failure.</span></span> <span data-ttu-id="b317d-277">L’application ou le plan de récupération d’urgence doit implémenter des processus pour gérer cette incohérence une fois la récupération effectuée.</span><span class="sxs-lookup"><span data-stu-id="b317d-277">The application or disaster recovery plan must implement processes to handle this inconsistency after a recovery.</span></span>

#### <a name="other-data-platforms"></a><span data-ttu-id="b317d-278">Autres plateformes de données</span><span class="sxs-lookup"><span data-stu-id="b317d-278">Other data platforms</span></span>
<span data-ttu-id="b317d-279">D’autres plateformes de données IaaS (Infrastructure-as-a-Service) hébergées, telles que Elasticsearch ou MongoDB, ont leurs propres fonctionnalités et particularités à prendre en compte lors de la création d’un processus intégré de sauvegarde et de restauration.</span><span class="sxs-lookup"><span data-stu-id="b317d-279">Other infrastructure-as-a-service (IaaS) hosted data platforms, such as Elasticsearch or MongoDB, have their own capabilities and considerations when creating an integrated backup and restore process.</span></span> <span data-ttu-id="b317d-280">Pour ces plateformes de données, la recommandation générale est d’utiliser des fonctionnalités de réplication ou de réalisation de captures instantanées basées sur l’intégration, natives ou disponibles.</span><span class="sxs-lookup"><span data-stu-id="b317d-280">For these data platforms, the general recommendation is to use any native or available integration-based replication or snapshotting capabilities.</span></span> <span data-ttu-id="b317d-281">Si ces fonctionnalités n’existent pas ou ne conviennent pas, vous pouvez éventuellement utiliser le Service de sauvegarde Azure ou les captures instantanées de disques managés/non managés pour créer une copie ponctuelle des données d’application.</span><span class="sxs-lookup"><span data-stu-id="b317d-281">If those capabilities do not exist or are not suitable, then consider using Azure Backup Service or managed/unmanaged disk snapshots to create a point-in-time copy of application data.</span></span> <span data-ttu-id="b317d-282">Dans tous les cas, il est important de déterminer comment effectuer des sauvegardes cohérentes, en particulier lorsque les données d’application sont réparties sur plusieurs systèmes de fichiers, ou lorsque plusieurs lecteurs sont combinés en un seul système de fichiers à l’aide de gestionnaires de volumes ou de systèmes RAID logiciels.</span><span class="sxs-lookup"><span data-stu-id="b317d-282">In all cases, it’s important to determine how to achieve consistent backups, especially when application data spans multiple files systems, or when multiple drives are combined into a single file system using volume managers or software-based RAID.</span></span>

### <a name="reference-data-pattern-for-disaster-recovery"></a><span data-ttu-id="b317d-283">Modèle de données de référence pour la récupération d’urgence</span><span class="sxs-lookup"><span data-stu-id="b317d-283">Reference data pattern for disaster recovery</span></span>
<span data-ttu-id="b317d-284">Les données de référence sont des données en lecture seule qui prennent en charge les fonctionnalités de l’application.</span><span class="sxs-lookup"><span data-stu-id="b317d-284">Reference data is read-only data that supports application functionality.</span></span> <span data-ttu-id="b317d-285">Celles-ci ne changent pas souvent.</span><span class="sxs-lookup"><span data-stu-id="b317d-285">It typically does not change frequently.</span></span> <span data-ttu-id="b317d-286">La sauvegarde et restauration constitue l’une des méthodes pour gérer des interruptions de service à l’échelle régionale ; cependant, l’objectif de délai de récupération (RTO) est relativement long.</span><span class="sxs-lookup"><span data-stu-id="b317d-286">Although backup and restore is one method to handle region-wide service disruptions, the RTO is relatively long.</span></span> <span data-ttu-id="b317d-287">Lorsque vous déployez l’application vers une région secondaire, certaines stratégies peuvent améliorer le RTO pour les données de référence.</span><span class="sxs-lookup"><span data-stu-id="b317d-287">When you deploy the application to a secondary region, some strategies can improve the RTO for reference data.</span></span>

<span data-ttu-id="b317d-288">Étant donné que les données de référence ne changent pas souvent, vous pouvez améliorer le RTO en conservant une copie permanente des données de référence dans la région secondaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-288">Because reference data changes infrequently, you can improve the RTO by maintaining a permanent copy of the reference data in the secondary region.</span></span> <span data-ttu-id="b317d-289">Cela élimine le temps nécessaire à la restauration des sauvegardes en cas de sinistre.</span><span class="sxs-lookup"><span data-stu-id="b317d-289">This eliminates the time required to restore backups in the event of a disaster.</span></span> <span data-ttu-id="b317d-290">Pour répondre aux exigences en matière de récupération d’urgence dans plusieurs régions, vous devez déployer l’application et les données de référence ensemble dans plusieurs régions.</span><span class="sxs-lookup"><span data-stu-id="b317d-290">To meet the multiple-region disaster recovery requirements, you must deploy the application and the reference data together in multiple regions.</span></span> <span data-ttu-id="b317d-291">Comme indiqué dans la section [Modèle de données de référence pour la haute disponibilité](high-availability-azure-applications.md#reference-data-pattern-for-high-availability), vous pouvez déployer des données de référence vers le rôle lui-même, le stockage externe ou une combinaison des deux.</span><span class="sxs-lookup"><span data-stu-id="b317d-291">As mentioned in [Reference data pattern for high availability](high-availability-azure-applications.md#reference-data-pattern-for-high-availability), you can deploy reference data to the role itself, to external storage, or to a combination of both.</span></span>

<span data-ttu-id="b317d-292">Le modèle de déploiement des données de référence au sein des nœuds de calcul répond implicitement aux exigences de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="b317d-292">The reference data deployment model within compute nodes implicitly satisfies the disaster recovery requirements.</span></span> <span data-ttu-id="b317d-293">Le déploiement des données de référence vers la base de données SQL requiert le déploiement d’une copie de ces données vers chaque région.</span><span class="sxs-lookup"><span data-stu-id="b317d-293">Reference data deployment to SQL Database requires that you deploy a copy of the reference data to each region.</span></span> <span data-ttu-id="b317d-294">La même stratégie s’applique à Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="b317d-294">The same strategy applies to Azure Storage.</span></span> <span data-ttu-id="b317d-295">Vous devez déployer une copie de toutes les données de référence stockées dans Azure Storage vers les régions primaires et secondaires.</span><span class="sxs-lookup"><span data-stu-id="b317d-295">You must deploy a copy of any reference data that's stored in Azure Storage to the primary and secondary regions.</span></span>

![Publication de données de référence vers les régions primaires et secondaires](./images/disaster-recovery-azure-applications/reference-data-publication-to-both-primary-and-secondary-regions.png)

<span data-ttu-id="b317d-297">Vous devez implémenter vos routines de sauvegarde propres à l’application pour l’ensemble de vos données, y compris les données de référence.</span><span class="sxs-lookup"><span data-stu-id="b317d-297">You must implement your own application-specific backup routines for all data, including reference data.</span></span> <span data-ttu-id="b317d-298">Les copies géorépliquées entre les régions ne sont utilisées qu’en cas d’interruption de service à l’échelle régionale.</span><span class="sxs-lookup"><span data-stu-id="b317d-298">Geo-replicated copies across regions are used only in a region-wide service disruption.</span></span> <span data-ttu-id="b317d-299">Pour éviter des temps d’arrêt prolongés, déployez les parties critiques des données de l’application vers la région secondaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-299">To prevent extended downtime, deploy the mission-critical parts of the application’s data to the secondary region.</span></span> <span data-ttu-id="b317d-300">Pour obtenir un exemple de cette topologie, consultez le [modèle actif/passif](#active-passive).</span><span class="sxs-lookup"><span data-stu-id="b317d-300">For an example of this topology, see the [active-passive model](#active-passive).</span></span>

### <a name="transactional-data-pattern-for-disaster-recovery"></a><span data-ttu-id="b317d-301">Modèle de données transactionnelles pour la récupération d’urgence</span><span class="sxs-lookup"><span data-stu-id="b317d-301">Transactional data pattern for disaster recovery</span></span>
<span data-ttu-id="b317d-302">L’implémentation d’une stratégie de récupération d’urgence pleinement opérationnelle nécessite la réplication asynchrone des données transactionnelles vers la région secondaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-302">Implementation of a fully functional disaster mode strategy requires asynchronous replication of the transactional data to the secondary region.</span></span> <span data-ttu-id="b317d-303">Les fenêtres temporelles pratiques dans lesquelles la réplication peut se produire déterminent les caractéristiques du RPO de l’application.</span><span class="sxs-lookup"><span data-stu-id="b317d-303">The practical time windows within which the replication can occur will determine the RPO characteristics of the application.</span></span> <span data-ttu-id="b317d-304">Vous pourrez peut-être récupérer les données perdues de la région primaire pendant la durée de réplication.</span><span class="sxs-lookup"><span data-stu-id="b317d-304">You might still recover the data that was lost from the primary region during the replication window.</span></span> <span data-ttu-id="b317d-305">Vous serez peut-être également en mesure de fusionner avec la région secondaire ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="b317d-305">You might also be able to merge with the secondary region later.</span></span>

<span data-ttu-id="b317d-306">Les exemples suivants d’architecture donnent quelques idées sur les différentes façons de gérer les données transactionnelles dans un scénario de basculement.</span><span class="sxs-lookup"><span data-stu-id="b317d-306">The following architecture examples provide some ideas on different ways of handling transactional data in a failover scenario.</span></span> <span data-ttu-id="b317d-307">Veuillez noter que ces exemples ne sont pas exhaustifs.</span><span class="sxs-lookup"><span data-stu-id="b317d-307">It's important to note that these examples are not exhaustive.</span></span> <span data-ttu-id="b317d-308">Par exemple, les emplacements de stockage intermédiaires, tels que des files d’attente, peuvent être remplacés par la base de données SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="b317d-308">For example, intermediate storage locations such as queues might be replaced with Azure SQL Database.</span></span> <span data-ttu-id="b317d-309">Ces files d’attente peuvent être issues du stockage Azure ou d’Azure Service Bus ; consultez la page [Files d’attente Azure et files d’attente Service Bus : comparaison et différences](/azure/service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted/).</span><span class="sxs-lookup"><span data-stu-id="b317d-309">The queues themselves might be either Azure Storage or Azure Service Bus queues (see [Azure queues and Service Bus queues - compared and contrasted](/azure/service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted/)).</span></span> <span data-ttu-id="b317d-310">Les destinations de stockage serveur peuvent également varier (par exemple, des tables Azure au lieu de la base de données SQL).</span><span class="sxs-lookup"><span data-stu-id="b317d-310">Server storage destinations might also vary, such as Azure tables instead of SQL Database.</span></span> <span data-ttu-id="b317d-311">En outre, des rôles de travail peuvent être insérés en tant qu’intermédiaires lors des différentes étapes.</span><span class="sxs-lookup"><span data-stu-id="b317d-311">In addition, worker roles might be inserted as intermediaries in various steps.</span></span> <span data-ttu-id="b317d-312">L’objectif n’est pas d’émuler ces architectures au détail près, mais d’envisager différentes solutions de récupération des données transactionnelles et des modules associés.</span><span class="sxs-lookup"><span data-stu-id="b317d-312">The intent is not to emulate these architectures exactly, but to consider various alternatives in the recovery of transactional data and related modules.</span></span>

#### <a name="replication-of-transactional-data-in-preparation-for-disaster-recovery"></a><span data-ttu-id="b317d-313">Réplication des données transactionnelles en vue d’une récupération d’urgence</span><span class="sxs-lookup"><span data-stu-id="b317d-313">Replication of transactional data in preparation for disaster recovery</span></span>
<span data-ttu-id="b317d-314">Considérez une application qui utilise des files d’attente Azure Storage pour stocker les données transactionnelles.</span><span class="sxs-lookup"><span data-stu-id="b317d-314">Consider an application that uses Azure Storage queues to hold transactional data.</span></span> <span data-ttu-id="b317d-315">Cela permet aux rôles de travail de traiter les données transactionnelles dans la base de données de serveur dans une architecture découplée.</span><span class="sxs-lookup"><span data-stu-id="b317d-315">This allows worker roles to process the transactional data to the server database in a decoupled architecture.</span></span> <span data-ttu-id="b317d-316">Cela requiert l’utilisation d’un type de mise en cache temporaire par les transactions si les rôles frontaux nécessitent l’interrogation immédiate de ces données.</span><span class="sxs-lookup"><span data-stu-id="b317d-316">This requires the transactions to use some form of temporary caching if the front-end roles require the immediate query of that data.</span></span> <span data-ttu-id="b317d-317">Selon le niveau de tolérance de perte de données, vous pouvez choisir de répliquer les files d’attente, la base de données ou l’ensemble des ressources de stockage.</span><span class="sxs-lookup"><span data-stu-id="b317d-317">Depending on the level of data-loss tolerance, you might choose to replicate the queues, the database, or all of the storage resources.</span></span> <span data-ttu-id="b317d-318">Si vous utilisez uniquement la réplication de base de données lorsque la région primaire échoue, vous pouvez toujours récupérer les données présentes dans les files d’attente lorsque la région primaire revient en ligne.</span><span class="sxs-lookup"><span data-stu-id="b317d-318">With only database replication, if the primary region goes down, you can still recover the data in the queues when the primary region comes back.</span></span>

<span data-ttu-id="b317d-319">Le schéma suivant illustre une architecture dans laquelle la base de données du serveur est synchronisée entre les régions.</span><span class="sxs-lookup"><span data-stu-id="b317d-319">The following diagram shows an architecture where the server database is synchronized across regions.</span></span>

![Réplication des données transactionnelles en vue d’une récupération d’urgence](./images/disaster-recovery-azure-applications/replicate-transactional-data-in-preparation-for-disaster-recovery.png)

<span data-ttu-id="b317d-321">Le plus gros défi que pose l’implémentation de cette architecture est la stratégie de réplication entre les régions.</span><span class="sxs-lookup"><span data-stu-id="b317d-321">The biggest challenge to implementing this architecture is the replication strategy between regions.</span></span> <span data-ttu-id="b317d-322">Le service de [Azure SQL Data Sync](/azure/sql-database/sql-database-get-started-sql-data-sync/) active ce type de réplication.</span><span class="sxs-lookup"><span data-stu-id="b317d-322">The [Azure SQL Data Sync](/azure/sql-database/sql-database-get-started-sql-data-sync/) service enables this type of replication.</span></span> <span data-ttu-id="b317d-323">Au moment où cet article est rédigé, il n’existe qu’une version préliminaire de ce service et il n’est pas encore recommandé de l’utiliser pour les environnements de production.</span><span class="sxs-lookup"><span data-stu-id="b317d-323">As of this writing, the service is in preview and is not yet recommended for production environments.</span></span> <span data-ttu-id="b317d-324">Pour en savoir plus, consultez l’article [Vue d’ensemble : continuité des activités cloud et récupération d’urgence d’une base de données avec SQL Database](/azure/sql-database/sql-database-business-continuity/).</span><span class="sxs-lookup"><span data-stu-id="b317d-324">For more information, see [Overview: Cloud business continuity and database disaster recovery with SQL Database](/azure/sql-database/sql-database-business-continuity/).</span></span> <span data-ttu-id="b317d-325">Pour les applications de production, vous devez acheter une solution tierce ou créer votre propre logique de réplication dans le code.</span><span class="sxs-lookup"><span data-stu-id="b317d-325">For production applications, you must invest in a third-party solution or create your own replication logic in code.</span></span> <span data-ttu-id="b317d-326">Selon l’architecture, la réplication peut être bidirectionnelle (plus complexe).</span><span class="sxs-lookup"><span data-stu-id="b317d-326">Depending on the architecture, the replication might be bidirectional, which is more complex.</span></span>

<span data-ttu-id="b317d-327">L’une des implémentations possibles serait d’utiliser la file d’attente intermédiaire de l’exemple précédent.</span><span class="sxs-lookup"><span data-stu-id="b317d-327">One potential implementation might make use of the intermediate queue in the previous example.</span></span> <span data-ttu-id="b317d-328">Le rôle de travail qui traite les données vers la destination de stockage définitive peut apporter la modification dans la région primaire et secondaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-328">The worker role that processes the data to the final storage destination might make the change in both the primary region and the secondary region.</span></span> <span data-ttu-id="b317d-329">Ces tâches sont importantes ; cet article n’aborde cependant pas de manière détaillée la question du code de réplication.</span><span class="sxs-lookup"><span data-stu-id="b317d-329">These are not trivial tasks, and complete guidance for replication code is beyond the scope of this article.</span></span> <span data-ttu-id="b317d-330">Prenez suffisamment de temps pour concevoir et tester votre approche de la réplication des données dans la région secondaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-330">Invest significant time and testing into the approach for replicating data to the secondary region.</span></span> <span data-ttu-id="b317d-331">Des traitements et des tests supplémentaires peuvent vous permettre de vous assurer que les processus de récupération et de basculement gèrent correctement les incohérences des données ou les transactions en double.</span><span class="sxs-lookup"><span data-stu-id="b317d-331">Additional processing and testing can help ensure that the failover and recovery processes correctly handle any possible data inconsistencies or duplicate transactions.</span></span>

> [!NOTE]
> <span data-ttu-id="b317d-332">La majeure partie de ce document porte sur la fonctionnalité PaaS (Platform as a Service).</span><span class="sxs-lookup"><span data-stu-id="b317d-332">Most of this paper focuses on platform as a service (PaaS).</span></span> <span data-ttu-id="b317d-333">Cependant, d’autres options de réplication et de disponibilité pour les applications hybrides utilisent des machines virtuelles Azure.</span><span class="sxs-lookup"><span data-stu-id="b317d-333">However, additional replication and availability options for hybrid applications use Azure Virtual Machines.</span></span> <span data-ttu-id="b317d-334">Ces applications hybrides utilisent la fonctionnalité IaaS (Infrastructure as a Service) pour héberger SQL Server sur des machines virtuelles dans Azure.</span><span class="sxs-lookup"><span data-stu-id="b317d-334">These hybrid applications use infrastructure as a service (IaaS) to host SQL Server on virtual machines in Azure.</span></span> <span data-ttu-id="b317d-335">Cela permet d’avoir des approches de disponibilité traditionnelles dans SQL Server, telles que les groupes de disponibilité AlwaysOn ou la copie des journaux de transaction.</span><span class="sxs-lookup"><span data-stu-id="b317d-335">This allows traditional availability approaches in SQL Server, such as AlwaysOn Availability Groups or Log Shipping.</span></span> <span data-ttu-id="b317d-336">Certaines techniques, telles que AlwaysOn, fonctionnent uniquement entre les machines virtuelles Azure et les instances SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b317d-336">Some techniques, such as AlwaysOn, work only between on-premises SQL Server instances and Azure virtual machines.</span></span> <span data-ttu-id="b317d-337">Pour plus d’informations, consultez [Haute disponibilité et récupération d’urgence pour SQL Server dans Azure Virtual Machines](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span><span class="sxs-lookup"><span data-stu-id="b317d-337">For more information, see [High availability and disaster recovery for SQL Server in Azure Virtual Machines](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span></span>
> 
> 

#### <a name="reduced-application-functionality-for-transaction-capture"></a><span data-ttu-id="b317d-338">Fonctionnalités réduites des applications pour la capture des transactions</span><span class="sxs-lookup"><span data-stu-id="b317d-338">Reduced application functionality for transaction capture</span></span>
<span data-ttu-id="b317d-339">Considérez une deuxième architecture fonctionnant avec des fonctionnalités réduites.</span><span class="sxs-lookup"><span data-stu-id="b317d-339">Consider a second architecture that operates with reduced functionality.</span></span> <span data-ttu-id="b317d-340">L’application de la région secondaire désactive toutes les fonctionnalités, telles que la création de comptes rendus, la Business Intelligence (BI) ou le traitement des files d’attente.</span><span class="sxs-lookup"><span data-stu-id="b317d-340">The application in the secondary region deactivates all the functionality, such as reporting, business intelligence (BI), or draining queues.</span></span> <span data-ttu-id="b317d-341">Elle accepte uniquement les types de flux de travail les plus importants, tels que définis par les besoins de l’entreprise.</span><span class="sxs-lookup"><span data-stu-id="b317d-341">It accepts only the most important types of transactional workflows, as defined by business requirements.</span></span> <span data-ttu-id="b317d-342">Le système capture les transactions et les écrit dans les files d’attente.</span><span class="sxs-lookup"><span data-stu-id="b317d-342">The system captures the transactions and writes them to queues.</span></span> <span data-ttu-id="b317d-343">Le système peut différer le traitement des données lors de la phase initiale de l’interruption de service.</span><span class="sxs-lookup"><span data-stu-id="b317d-343">The system might postpone processing the data during the initial stage of the service disruption.</span></span> <span data-ttu-id="b317d-344">Si le système de la région primaire est réactivé dans l’intervalle de temps attendu, les rôles de travail peuvent traiter les files d’attente dans la région primaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-344">If the system on the primary region is reactivated within the expected time window, the worker roles in the primary region can drain the queues.</span></span> <span data-ttu-id="b317d-345">Ce processus élimine la nécessité de fusionner les bases de données.</span><span class="sxs-lookup"><span data-stu-id="b317d-345">This process eliminates the need for database merging.</span></span> <span data-ttu-id="b317d-346">Si l’interruption de service de la région primaire dépasse la fenêtre de temps acceptable, l’application peut commencer à traiter les files d’attente.</span><span class="sxs-lookup"><span data-stu-id="b317d-346">If the primary region service disruption goes beyond the tolerable window, the application can start processing the queues.</span></span>

<span data-ttu-id="b317d-347">Dans ce scénario, la base de données de la région secondaire contient des données transactionnelles incrémentielles qui doivent être fusionnées après la réactivation de la région primaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-347">In this scenario, the database in the secondary region contains incremental transactional data that must be merged after the primary is reactivated.</span></span> <span data-ttu-id="b317d-348">Le schéma suivant illustre cette stratégie pour le stockage temporaire des données transactionnelles, jusqu’à la restauration de la région primaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-348">The following diagram shows this strategy for temporarily storing transactional data until the primary region is restored.</span></span>

![Fonctionnalités réduites des applications pour la capture des transactions](./images/disaster-recovery-azure-applications/reduced-application-functionality-for-transaction-capture.png)

<span data-ttu-id="b317d-350">Pour plus d’informations sur les techniques de gestion de données pour les applications Azure résilientes, consultez l’article [Failsafe: guidance for resilient cloud architectures](https://channel9.msdn.com/Series/FailSafe)(Sécurité intégrée : recommandations applicables à la résilience des architectures cloud).</span><span class="sxs-lookup"><span data-stu-id="b317d-350">For more discussion of data management techniques for resilient Azure applications, see [Failsafe: Guidance for Resilient Cloud Architectures](https://channel9.msdn.com/Series/FailSafe).</span></span>

## <a name="deployment-topologies-for-disaster-recovery"></a><span data-ttu-id="b317d-351">Topologies de déploiement pour la récupération d’urgence</span><span class="sxs-lookup"><span data-stu-id="b317d-351">Deployment topologies for disaster recovery</span></span>
<span data-ttu-id="b317d-352">Vous devez préparer les applications critiques à gérer une interruption de service à l’échelle régionale.</span><span class="sxs-lookup"><span data-stu-id="b317d-352">You must prepare mission-critical applications to handle region-wide service disruptions.</span></span> <span data-ttu-id="b317d-353">Incorporez à la planification opérationnelle une stratégie de déploiement de plusieurs régions.</span><span class="sxs-lookup"><span data-stu-id="b317d-353">Incorporate a multiple-region deployment strategy into the operational planning.</span></span>

<span data-ttu-id="b317d-354">Les déploiements multirégions peuvent impliquer la publication de l’application et des données de référence par des processus informatiques vers la région secondaire suite à un incident.</span><span class="sxs-lookup"><span data-stu-id="b317d-354">Multiple-region deployments might involve IT processes to publish the application and reference data to the secondary region after a disaster.</span></span> <span data-ttu-id="b317d-355">Si l’application requiert un basculement instantané, le processus de déploiement peut comprendre une configuration en mode actif/passif ou en mode actif/actif.</span><span class="sxs-lookup"><span data-stu-id="b317d-355">If the application requires instant failover, the deployment process might involve an active/passive setup or an active/active setup.</span></span> <span data-ttu-id="b317d-356">Pour ce type de déploiement, des instances existantes de l’application s’exécutent dans l’autre région.</span><span class="sxs-lookup"><span data-stu-id="b317d-356">This type of deployment has existing instances of the application running in the alternate region.</span></span> <span data-ttu-id="b317d-357">Un service de routage tel qu’Azure Traffic Manager fournit des services d’équilibrage de charge au niveau du DNS.</span><span class="sxs-lookup"><span data-stu-id="b317d-357">A routing service such as Azure Traffic Manager provides load-balancing services at the DNS level.</span></span> <span data-ttu-id="b317d-358">Il peut détecter des interruptions de service et router les utilisateurs vers différentes régions lorsque cela s’avère nécessaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-358">It can detect service disruptions and route the users to different regions when needed.</span></span>

<span data-ttu-id="b317d-359">Une récupération d’urgence Azure efficace implique d’intégrer cette récupération dans la solution dès le début.</span><span class="sxs-lookup"><span data-stu-id="b317d-359">A successful Azure disaster recovery includes building that recovery into the solution from the start.</span></span> <span data-ttu-id="b317d-360">Le cloud propose des options supplémentaires pour la récupération des données lors d’un incident ; celles-ci ne sont pas proposées par un fournisseur d’hébergement traditionnel.</span><span class="sxs-lookup"><span data-stu-id="b317d-360">The cloud provides additional options for recovering from failures during a disaster that are not available in a traditional hosting provider.</span></span> <span data-ttu-id="b317d-361">Plus précisément, vous pouvez allouer des ressources dans une autre région de façon dynamique et rapide, en évitant le coût des ressources inactives, avant une défaillance.</span><span class="sxs-lookup"><span data-stu-id="b317d-361">Specifically, you can dynamically and quickly allocate resources in a different region, avoiding the cost of idle resources prior to a failure.</span></span>

<span data-ttu-id="b317d-362">Les sections suivantes abordent différentes topologies de déploiement pour la récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="b317d-362">The following sections cover different deployment topologies for disaster recovery.</span></span> <span data-ttu-id="b317d-363">En règle générale, il existe un compromis entre l’augmentation des coûts ou la complexité liée à une disponibilité accrue.</span><span class="sxs-lookup"><span data-stu-id="b317d-363">Typically, there's a tradeoff in increased cost or complexity for additional availability.</span></span>

### <a name="single-region-deployment"></a><span data-ttu-id="b317d-364">Déploiement dans une seule région</span><span class="sxs-lookup"><span data-stu-id="b317d-364">Single-region deployment</span></span>
<span data-ttu-id="b317d-365">Un déploiement dans une seule région ne constitue pas réellement une topologie de récupération d’urgence, mais sert plutôt à créer un contraste avec les autres architectures.</span><span class="sxs-lookup"><span data-stu-id="b317d-365">A single-region deployment is not really a disaster recovery topology, but is meant to contrast with the other architectures.</span></span> <span data-ttu-id="b317d-366">Les déploiements monorégion des applications dans Azure sont courants. Toutefois, ils ne sont pas conformes aux exigences d’une topologie de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="b317d-366">Single-region deployments are common for applications in Azure; however, they do not meet the requirements of a disaster recovery topology.</span></span>

<span data-ttu-id="b317d-367">Le diagramme suivant illustre une application exécutée dans une seule région Azure.</span><span class="sxs-lookup"><span data-stu-id="b317d-367">The following diagram depicts an application running in a single Azure region.</span></span> <span data-ttu-id="b317d-368">Azure Traffic Manager et l’utilisation des domaines d’erreur et de mise à niveau augmentent la disponibilité de l’application dans la région.</span><span class="sxs-lookup"><span data-stu-id="b317d-368">Azure Traffic Manager and the use of fault and upgrade domains increase availability of the application within the region.</span></span>

![Déploiement dans une seule région](./images/disaster-recovery-azure-applications/single-region-deployment.png)

<span data-ttu-id="b317d-370">Dans ce scénario, la base de données constitue un point de défaillance unique.</span><span class="sxs-lookup"><span data-stu-id="b317d-370">In this scenario, the database is a single point of failure.</span></span> <span data-ttu-id="b317d-371">Bien qu’Azure réplique les données dans différents domaines d’erreur vers des réplicas internes, la réplication se produit uniquement dans la même région.</span><span class="sxs-lookup"><span data-stu-id="b317d-371">Though Azure replicates the data across different fault domains to internal replicas, this replication occurs only within the same region.</span></span> <span data-ttu-id="b317d-372">L’application ne peut pas résister aux pannes catastrophiques.</span><span class="sxs-lookup"><span data-stu-id="b317d-372">The application cannot withstand a catastrophic failure.</span></span> <span data-ttu-id="b317d-373">Si la région devient indisponible, il en est de même pour les domaines d’erreur, ce qui inclut toutes les instances de service et les ressources de stockage.</span><span class="sxs-lookup"><span data-stu-id="b317d-373">If the region becomes unavailable, then so do the fault domains, including all service instances and storage resources.</span></span>

<span data-ttu-id="b317d-374">Pour toutes les applications les moins critiques, vous devez concevoir un plan pour déployer vos applications dans plusieurs régions.</span><span class="sxs-lookup"><span data-stu-id="b317d-374">For all but the least critical applications, you must devise a plan to deploy your applications across multiple regions.</span></span> <span data-ttu-id="b317d-375">Vous devez également considérer le RTO et les contraintes de coût lorsque vous décidez quelle topologie de déploiement utiliser.</span><span class="sxs-lookup"><span data-stu-id="b317d-375">You should also consider RTO and cost constraints in considering which deployment topology to use.</span></span>

<span data-ttu-id="b317d-376">Examinons à présent les approches spécifiques pour prendre en charge le basculement entre les différentes régions.</span><span class="sxs-lookup"><span data-stu-id="b317d-376">Let’s take a look now at specific approaches to supporting failover across different regions.</span></span> <span data-ttu-id="b317d-377">Ces exemples utilisent tous deux régions pour décrire le processus.</span><span class="sxs-lookup"><span data-stu-id="b317d-377">These examples all use two regions to describe the process.</span></span>

### <a name="redeployment-to-a-secondary-azure-region"></a><span data-ttu-id="b317d-378">Redéploiement vers une région Azure secondaire</span><span class="sxs-lookup"><span data-stu-id="b317d-378">Redeployment to a secondary Azure region</span></span>
<span data-ttu-id="b317d-379">Dans l’approche de redéploiement vers une région secondaire, seule la région primaire contient des applications et des bases de données en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="b317d-379">For the approach of redeployment to a secondary region, only the primary region has applications and databases running.</span></span> <span data-ttu-id="b317d-380">La région secondaire n’est pas configurée pour un basculement automatique.</span><span class="sxs-lookup"><span data-stu-id="b317d-380">The secondary region is not set up for an automatic failover.</span></span> <span data-ttu-id="b317d-381">Par conséquent, en cas d’incident, vous devez activer toutes les parties du service dans la nouvelle région.</span><span class="sxs-lookup"><span data-stu-id="b317d-381">So when a disaster occurs, you must spin up all the parts of the service in the new region.</span></span> <span data-ttu-id="b317d-382">Cela inclut le chargement d’un service cloud sur Azure, le déploiement du service cloud, la restauration des données et la modification du DNS afin de rerouter le trafic.</span><span class="sxs-lookup"><span data-stu-id="b317d-382">This includes uploading a cloud service to Azure, deploying the cloud service, restoring the data, and changing DNS to reroute the traffic.</span></span>

<span data-ttu-id="b317d-383">Bien que cette option soit la plus abordable des options couvrant plusieurs régions, elle présente les caractéristiques RTO les moins avantageuses.</span><span class="sxs-lookup"><span data-stu-id="b317d-383">Although this is the most affordable of the multiple-region options, it has the worst RTO characteristics.</span></span> <span data-ttu-id="b317d-384">Dans ce modèle, les sauvegardes de base de données et de packages de service sont stockées localement ou dans l’instance du stockage d’objets blob Azure de la région secondaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-384">In this model, the service package and database backups are stored either on-premises or in the Azure Blob storage instance of the secondary region.</span></span> <span data-ttu-id="b317d-385">Toutefois, vous devez déployer un nouveau service et restaurer les données avant la reprise des opérations du modèle.</span><span class="sxs-lookup"><span data-stu-id="b317d-385">However, you must deploy a new service and restore the data before it resumes operation.</span></span> <span data-ttu-id="b317d-386">Même si vous automatisez entièrement le transfert de données du stockage de sauvegarde, le déploiement d’un nouvel environnement de base de données est très chronophage.</span><span class="sxs-lookup"><span data-stu-id="b317d-386">Even with full automation of the data transfer from backup storage, provisioning a new database environment consumes a lot of time.</span></span> <span data-ttu-id="b317d-387">Le déplacement des données à partir du stockage de sauvegarde sur disque vers la base de données vide de la région secondaire constitue la partie la plus coûteuse du processus de restauration.</span><span class="sxs-lookup"><span data-stu-id="b317d-387">Moving data from the backup disk storage to the empty database on the secondary region is the most expensive part of the restore process.</span></span> <span data-ttu-id="b317d-388">Cette opération est cependant nécessaire pour que la nouvelle base de données puisse fonctionner, cette dernière n’étant pas répliquée.</span><span class="sxs-lookup"><span data-stu-id="b317d-388">You must do this, however, to bring the new database to an operational state because it isn't replicated.</span></span>

<span data-ttu-id="b317d-389">La meilleure approche consiste à stocker les packages de service dans le stockage d’objets blob de la région secondaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-389">The best approach is to store the service packages in Blob storage in the secondary region.</span></span> <span data-ttu-id="b317d-390">Cela élimine la nécessité de charger le package vers Azure ; c’est ce qui se produit lorsqu’un déploiement est effectué à partir d’un ordinateur de développement local.</span><span class="sxs-lookup"><span data-stu-id="b317d-390">This eliminates the need to upload the package to Azure, which is what happens when you deploy from an on-premises development machine.</span></span> <span data-ttu-id="b317d-391">À l’aide des scripts PowerShell, vous pouvez rapidement déployer les packages de service vers un nouveau service cloud à partir d’un stockage d’objets blob.</span><span class="sxs-lookup"><span data-stu-id="b317d-391">You can quickly deploy the service packages to a new cloud service from Blob storage by using PowerShell scripts.</span></span>

<span data-ttu-id="b317d-392">Cette option est seulement pratique pour les applications non critiques pouvant tolérer un RTO élevé.</span><span class="sxs-lookup"><span data-stu-id="b317d-392">This option is practical only for non-critical applications that can tolerate a high RTO.</span></span> <span data-ttu-id="b317d-393">Cela peut, par exemple, fonctionner pour une application pouvant être arrêtée plusieurs heures, mais qui doit être à nouveau disponible dans les 24 heures.</span><span class="sxs-lookup"><span data-stu-id="b317d-393">For instance, this might work for an application that can be down for several hours but is required to be available within 24 hours.</span></span>

![Redéploiement vers une région Azure secondaire](./images/disaster-recovery-azure-applications/redeploy-to-a-secondary-azure-region.png)

### <a name="active-passive"></a><span data-ttu-id="b317d-395">Actif/Passif</span><span class="sxs-lookup"><span data-stu-id="b317d-395">Active-passive</span></span>
<span data-ttu-id="b317d-396">La topologie actif/passif a été adoptée par de nombreuses sociétés.</span><span class="sxs-lookup"><span data-stu-id="b317d-396">An active-passive topology is the choice that many companies favor.</span></span> <span data-ttu-id="b317d-397">Elle apporte des améliorations au RTO, avec une augmentation relativement faible du coût par rapport à l’approche de redéploiement.</span><span class="sxs-lookup"><span data-stu-id="b317d-397">This topology provides improvements to the RTO with a relatively small increase in cost over the redeployment approach.</span></span> <span data-ttu-id="b317d-398">Dans ce scénario, des régions Azure primaire et secondaire sont de nouveau présentes.</span><span class="sxs-lookup"><span data-stu-id="b317d-398">In this scenario, there is again a primary and a secondary Azure region.</span></span> <span data-ttu-id="b317d-399">Tout le trafic est acheminé vers le déploiement actif de la région primaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-399">All of the traffic goes to the active deployment on the primary region.</span></span> <span data-ttu-id="b317d-400">La région secondaire est mieux préparée pour la récupération d’urgence, car la base de données s’exécute dans les deux régions.</span><span class="sxs-lookup"><span data-stu-id="b317d-400">The secondary region is better prepared for disaster recovery because the database is running on both regions.</span></span> <span data-ttu-id="b317d-401">En outre, un mécanisme de synchronisation est mis en place entre les deux régions.</span><span class="sxs-lookup"><span data-stu-id="b317d-401">Additionally, a synchronization mechanism is in place between them.</span></span> <span data-ttu-id="b317d-402">Cette approche de secours comprend deux variantes : une approche basée uniquement sur la base de données ou un déploiement complet dans la région secondaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-402">This standby approach can involve two variations: a database-only approach or a complete deployment in the secondary region.</span></span>

#### <a name="database-only"></a><span data-ttu-id="b317d-403">Base de données uniquement</span><span class="sxs-lookup"><span data-stu-id="b317d-403">Database only</span></span>
<span data-ttu-id="b317d-404">Dans la première variante de la topologie actif/passif, seule la région primaire contient une application de service cloud déployée.</span><span class="sxs-lookup"><span data-stu-id="b317d-404">In the first variation of the active-passive topology, only the primary region has a deployed cloud service application.</span></span> <span data-ttu-id="b317d-405">Toutefois, contrairement à l’approche de redéploiement, les deux régions sont synchronisées avec les contenus de la base de données.</span><span class="sxs-lookup"><span data-stu-id="b317d-405">However, unlike the redeployment approach, both regions are synchronized with the contents of the database.</span></span> <span data-ttu-id="b317d-406">(Pour plus d’informations, consultez la section consacrée au [modèle de données transactionnel pour une récupération d’urgence](#transactional-data-pattern-for-disaster-recovery).) En cas d’incident, les exigences d’activation sont réduites.</span><span class="sxs-lookup"><span data-stu-id="b317d-406">(For more information, see the section on [transactional data pattern for disaster recovery](#transactional-data-pattern-for-disaster-recovery).) When a disaster occurs, there are fewer activation requirements.</span></span> <span data-ttu-id="b317d-407">Vous démarrez l’application dans la région secondaire, modifiez les chaînes de connexion à la nouvelle base de données et modifiez les entrées DNS afin de rerouter le trafic.</span><span class="sxs-lookup"><span data-stu-id="b317d-407">You start the application in the secondary region, change connection strings to the new database, and change the DNS entries to reroute traffic.</span></span>

<span data-ttu-id="b317d-408">Comme pour l’approche de redéploiement, vous devez déjà avoir stocké les packages de service dans le stockage d’objets blob Azure dans la région secondaire pour un déploiement plus rapide.</span><span class="sxs-lookup"><span data-stu-id="b317d-408">Like the redeployment approach, you should have already stored the service packages in Azure Blob storage in the secondary region for faster deployment.</span></span> <span data-ttu-id="b317d-409">Cependant, vous échappez à la majorité du traitement que nécessite l’opération de restauration de base de données, car la base de données est prête et en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="b317d-409">However, you don’t incur the majority of the overhead that database restore operation requires, because the database is ready and running.</span></span> <span data-ttu-id="b317d-410">Cette approche permet de gagner beaucoup de temps, ce qui en fait une solution de récupération d’urgence économique (et aussi majoritairement utilisée).</span><span class="sxs-lookup"><span data-stu-id="b317d-410">This saves a significant amount of time, making this an affordable DR pattern (and the one most frequently used).</span></span>

![Actif/passif : base de données uniquement](./images/disaster-recovery-azure-applications/active-passive-database-only.png)

#### <a name="full-replica"></a><span data-ttu-id="b317d-412">Réplica complet</span><span class="sxs-lookup"><span data-stu-id="b317d-412">Full replica</span></span>
<span data-ttu-id="b317d-413">Dans la deuxième variante de la topologie actif/passif, la région primaire et la région secondaire connaissent un déploiement complet.</span><span class="sxs-lookup"><span data-stu-id="b317d-413">In the second variation of the active-passive topology, both the primary region and the secondary region have a full deployment.</span></span> <span data-ttu-id="b317d-414">Ce déploiement inclut les services cloud et une base de données synchronisée.</span><span class="sxs-lookup"><span data-stu-id="b317d-414">This deployment includes the cloud services and a synchronized database.</span></span> <span data-ttu-id="b317d-415">Toutefois, seule la région primaire traite activement les requêtes réseau des utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="b317d-415">However, only the primary region is actively handling network requests from the users.</span></span> <span data-ttu-id="b317d-416">La région secondaire devient active uniquement lorsque la région primaire subit une interruption de service.</span><span class="sxs-lookup"><span data-stu-id="b317d-416">The secondary region becomes active only when the primary region experiences a service disruption.</span></span> <span data-ttu-id="b317d-417">Dans ce cas, toutes les nouvelles requêtes réseau effectuent le routage vers la région secondaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-417">In that case, all new network requests route to the secondary region.</span></span> <span data-ttu-id="b317d-418">Azure Traffic Manager gère automatiquement ce basculement.</span><span class="sxs-lookup"><span data-stu-id="b317d-418">Azure Traffic Manager can manage this failover automatically.</span></span>

<span data-ttu-id="b317d-419">Le basculement se produit plus rapidement que dans la variante contenant uniquement la base de données, les services étant déjà déployés.</span><span class="sxs-lookup"><span data-stu-id="b317d-419">Failover occurs faster than the database-only variation because the services are already deployed.</span></span> <span data-ttu-id="b317d-420">Cette topologie fournit un objectif de délai de récupération (RTO) très faible.</span><span class="sxs-lookup"><span data-stu-id="b317d-420">This topology provides a very low RTO.</span></span> <span data-ttu-id="b317d-421">La région de basculement secondaire doit être opérationnelle dès que la région primaire rencontre une défaillance.</span><span class="sxs-lookup"><span data-stu-id="b317d-421">The secondary failover region must be ready to go immediately after failure of the primary region.</span></span>

<span data-ttu-id="b317d-422">En plus d’assurer un temps de réponse plus rapide, cette topologie pré-alloue et déploie des services de sauvegarde, évitant le risque d’un manque d’espace pour allouer de nouvelles instances lors d’un incident.</span><span class="sxs-lookup"><span data-stu-id="b317d-422">Along with a quicker response time, this topology pre-allocates and deploys backup services, avoiding the possibility of a lack of space to allocate new instances during a disaster.</span></span> <span data-ttu-id="b317d-423">C’est un élément important si votre région Azure secondaire est proche de sa capacité maximale.</span><span class="sxs-lookup"><span data-stu-id="b317d-423">This is important if your secondary Azure region is nearing capacity.</span></span> <span data-ttu-id="b317d-424">Aucun contrat de niveau de service (SLA) ne garantit que vous pouvez déployer instantanément un ou plusieurs nouveaux services cloud dans n’importe quelle région.</span><span class="sxs-lookup"><span data-stu-id="b317d-424">No service-level agreement (SLA) guarantees that you can instantly deploy one or more new cloud services in any region.</span></span>

<span data-ttu-id="b317d-425">Pour obtenir un temps de réponse optimal avec ce modèle, vous devez disposer d’une échelle semblable (nombre d’instances de rôle) dans les régions primaires et secondaires.</span><span class="sxs-lookup"><span data-stu-id="b317d-425">For the fastest response time with this model, you must have similar scale (number of role instances) in the primary and secondary regions.</span></span> <span data-ttu-id="b317d-426">Malgré les avantages, le fait de payer pour des instances de calcul inutilisées se révèle coûteux ; cela peut ne pas être le meilleur choix d’un point de vue financier.</span><span class="sxs-lookup"><span data-stu-id="b317d-426">Despite the advantages, paying for unused compute instances is costly, and this might not be the most prudent financial choice.</span></span> <span data-ttu-id="b317d-427">Pour cette raison, il est plus courant d’utiliser une version des services cloud dont la puissance a été légèrement réduite dans la région secondaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-427">Because of this, it's more common to use a slightly scaled-down version of cloud services on the secondary region.</span></span> <span data-ttu-id="b317d-428">Vous pouvez ensuite rapidement faire basculer et monter en charge le déploiement secondaire, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-428">Then you can quickly fail over and scale out the secondary deployment if necessary.</span></span> <span data-ttu-id="b317d-429">Vous devriez automatiser le processus de basculement afin de pouvoir activer des instances supplémentaires, selon la charge, lorsque la région primaire devient inaccessible.</span><span class="sxs-lookup"><span data-stu-id="b317d-429">You should automate the failover process so that after the primary region is inaccessible, you activate additional instances, depending on the load.</span></span> <span data-ttu-id="b317d-430">Cela peut impliquer l’utilisation d’un mécanisme de mise à l’échelle automatique, tel que des [groupes de machines virtuelles identiques](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-overview/).</span><span class="sxs-lookup"><span data-stu-id="b317d-430">This might involve the use of an autoscaling mechanism like [virtual machine scale sets](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-overview/).</span></span>

<span data-ttu-id="b317d-431">Le schéma suivant présente un modèle dans lequel les régions primaires et secondaires contiennent un service cloud entièrement déployé selon une topologie actif/passif.</span><span class="sxs-lookup"><span data-stu-id="b317d-431">The following diagram shows the model where the primary and secondary regions contain a fully deployed cloud service in an active-passive topology.</span></span>

![Actif/passif : réplica complet](./images/disaster-recovery-azure-applications/active-passive-full-replica.png)

### <a name="active-active"></a><span data-ttu-id="b317d-433">Actif/actif</span><span class="sxs-lookup"><span data-stu-id="b317d-433">Active-active</span></span>
<span data-ttu-id="b317d-434">Dans une topologie actif/actif, les services cloud et la base de données sont entièrement déployés dans les deux régions.</span><span class="sxs-lookup"><span data-stu-id="b317d-434">In an active-active topology, the cloud services and database are fully deployed in both regions.</span></span> <span data-ttu-id="b317d-435">Contrairement au modèle actif/passif, les deux régions reçoivent le trafic utilisateur.</span><span class="sxs-lookup"><span data-stu-id="b317d-435">Unlike the active-passive model, both regions receive user traffic.</span></span> <span data-ttu-id="b317d-436">Cette option réduit au minimum le temps de récupération.</span><span class="sxs-lookup"><span data-stu-id="b317d-436">This option yields the quickest recovery time.</span></span> <span data-ttu-id="b317d-437">Les services ont déjà été mis à l’échelle pour gérer une partie de la charge dans chaque région.</span><span class="sxs-lookup"><span data-stu-id="b317d-437">The services are already scaled to handle a portion of the load at each region.</span></span> <span data-ttu-id="b317d-438">DNS est déjà activé pour une utilisation dans la région secondaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-438">DNS is already enabled to use the secondary region.</span></span> <span data-ttu-id="b317d-439">La décision visant à router les utilisateurs vers la région appropriée présente des difficultés supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="b317d-439">There's additional complexity in determining how to route users to the appropriate region.</span></span> <span data-ttu-id="b317d-440">La planification par tourniquet (round robin) pourrait se révéler une option.</span><span class="sxs-lookup"><span data-stu-id="b317d-440">Round-robin scheduling might be possible.</span></span> <span data-ttu-id="b317d-441">Il est plus probable que certains utilisateurs utilisent une région dans laquelle se trouve la copie principale de leurs données.</span><span class="sxs-lookup"><span data-stu-id="b317d-441">It's more likely that certain users would use a specific region where the primary copy of their data resides.</span></span>

<span data-ttu-id="b317d-442">En cas de basculement, vous devez simplement désactiver DNS dans la région primaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-442">In case of failover, simply disable DNS to the primary region.</span></span> <span data-ttu-id="b317d-443">Ainsi, tout le trafic est acheminé vers la région secondaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-443">This routes all traffic to the secondary region.</span></span>

<span data-ttu-id="b317d-444">Ce modèle présente également des variantes.</span><span class="sxs-lookup"><span data-stu-id="b317d-444">Even in this model, there are some variations.</span></span> <span data-ttu-id="b317d-445">Par exemple, le schéma suivant illustre une région primaire qui possède la copie principale de la base de données.</span><span class="sxs-lookup"><span data-stu-id="b317d-445">For example, the following diagram depicts a primary region which owns the master copy of the database.</span></span> <span data-ttu-id="b317d-446">Les services cloud des deux régions écrivent vers cette base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-446">The cloud services in both regions write to that primary database.</span></span> <span data-ttu-id="b317d-447">Le déploiement secondaire peut effectuer la lecture à partir de la base de données primaire ou répliquée.</span><span class="sxs-lookup"><span data-stu-id="b317d-447">The secondary deployment can read from the primary or replicated database.</span></span> <span data-ttu-id="b317d-448">Dans cet exemple, la réplication est unidirectionnelle.</span><span class="sxs-lookup"><span data-stu-id="b317d-448">Replication in this example is one-way.</span></span>

![Actif/actif](./images/disaster-recovery-azure-applications/active-active.png)

<span data-ttu-id="b317d-450">L’architecture actif/actif du schéma précédent présente cependant un inconvénient.</span><span class="sxs-lookup"><span data-stu-id="b317d-450">There is a downside to the active-active architecture in the preceding diagram.</span></span> <span data-ttu-id="b317d-451">La deuxième région doit accéder à la base de données de la première région car cette dernière détient la copie principale.</span><span class="sxs-lookup"><span data-stu-id="b317d-451">The second region must access the database in the first region because the master copy resides there.</span></span> <span data-ttu-id="b317d-452">Les performances connaissent une forte baisse lorsque vous accédez à des données en dehors d’une région.</span><span class="sxs-lookup"><span data-stu-id="b317d-452">Performance significantly drops off when you access data from outside a region.</span></span> <span data-ttu-id="b317d-453">Pour les appels de base de données entre les régions, vous devez envisager une stratégie de traitement par lots afin d’améliorer les performances de ces appels.</span><span class="sxs-lookup"><span data-stu-id="b317d-453">In cross-region database calls, you should consider some type of batching strategy to improve the performance of these calls.</span></span> <span data-ttu-id="b317d-454">Pour en savoir plus, consultez l’article [Comment utiliser le traitement par lots pour améliorer les performances des applications de base de données SQL](/azure/sql-database/sql-database-use-batching-to-improve-performance/).</span><span class="sxs-lookup"><span data-stu-id="b317d-454">For more information, see [How to use batching to improve SQL Database application performance](/azure/sql-database/sql-database-use-batching-to-improve-performance/).</span></span>

<span data-ttu-id="b317d-455">Dans une autre architecture possible, chaque région peut directement accéder à sa propre base de données.</span><span class="sxs-lookup"><span data-stu-id="b317d-455">An alternative architecture might involve each region accessing its own database directly.</span></span> <span data-ttu-id="b317d-456">Dans ce modèle, un type quelconque de réplication bidirectionnelle peut être nécessaire pour synchroniser les bases de données dans chaque région.</span><span class="sxs-lookup"><span data-stu-id="b317d-456">In that model, some type of bidirectional replication is required to synchronize the databases in each region.</span></span>

<span data-ttu-id="b317d-457">Avec les topologies précédentes, diminuer le RTO revient généralement à augmenter les coûts et la complexité.</span><span class="sxs-lookup"><span data-stu-id="b317d-457">With the previous topologies, decreasing RTO generally increases costs and complexity.</span></span> <span data-ttu-id="b317d-458">La topologie actif/actif diffère de ce modèle de coût.</span><span class="sxs-lookup"><span data-stu-id="b317d-458">The active-active topology deviates from this cost pattern.</span></span> <span data-ttu-id="b317d-459">Dans la topologie actif/actif, la région primaire peut ne pas nécessiter autant d’instances que dans la topologie actif/passif.</span><span class="sxs-lookup"><span data-stu-id="b317d-459">In the active-active topology, you might not need as many instances on the primary region as you would in the active-passive topology.</span></span> <span data-ttu-id="b317d-460">Si, dans une architecture actif/passif, 10 instances sont présentes dans la région primaire, une architecture actif/actif ne nécessiterait en revanche que 5 instances dans chaque région.</span><span class="sxs-lookup"><span data-stu-id="b317d-460">If you have 10 instances on the primary region in an active-passive architecture, you might need only 5 in each region in an active-active architecture.</span></span> <span data-ttu-id="b317d-461">Les deux régions partagent à présent la même charge.</span><span class="sxs-lookup"><span data-stu-id="b317d-461">Both regions now share the load.</span></span> <span data-ttu-id="b317d-462">Cela peut représenter des économies d’argent par rapport à la topologie actif/passif si vous avez conservé une solution de secours actif pour la région passive, avec 10 instances en attente de basculement.</span><span class="sxs-lookup"><span data-stu-id="b317d-462">This might be a cost savings over the active-passive topology if you keep a warm standby on the passive region with 10 instances waiting for failover.</span></span>

<span data-ttu-id="b317d-463">Sachez que, jusqu’à ce que vous restauriez la région primaire, la région secondaire peut connaître une hausse soudaine du nombre de nouveaux utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="b317d-463">Realize that until you restore the primary region, the secondary region might receive a sudden surge of new users.</span></span> <span data-ttu-id="b317d-464">Si chaque serveur accueille 10 000 utilisateurs au moment de l’interruption de service de la région primaire, la région secondaire doit soudain gérer 20 000 utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="b317d-464">If there are 10,000 users on each server when the primary region experiences a service disruption, the secondary region suddenly has to handle 20,000 users.</span></span> <span data-ttu-id="b317d-465">Les règles de surveillance de la région secondaire doivent détecter cette hausse et donc doubler le nombre d’instances présentes dans la région secondaire.</span><span class="sxs-lookup"><span data-stu-id="b317d-465">Monitoring rules on the secondary region must detect this increase and double the instances in the secondary region.</span></span> <span data-ttu-id="b317d-466">Pour plus d’informations à ce sujet, consultez la section [Détection des défaillances](#failure-detection).</span><span class="sxs-lookup"><span data-stu-id="b317d-466">For more information on this, see the section on [failure detection](#failure-detection).</span></span>

## <a name="hybrid-on-premises-and-cloud-solution"></a><span data-ttu-id="b317d-467">solutions hybrides en local et dans le cloud</span><span class="sxs-lookup"><span data-stu-id="b317d-467">Hybrid on-premises and cloud solution</span></span>
<span data-ttu-id="b317d-468">Une stratégie supplémentaire de récupération d’urgence consiste à créer une application hybride qui s’exécute à la fois en local et dans le cloud.</span><span class="sxs-lookup"><span data-stu-id="b317d-468">One additional strategy for disaster recovery is to architect a hybrid application that runs on-premises and in the cloud.</span></span> <span data-ttu-id="b317d-469">La région primaire peut se trouver à l’un des deux emplacements, selon l’application.</span><span class="sxs-lookup"><span data-stu-id="b317d-469">Depending on the application, the primary region might be either location.</span></span> <span data-ttu-id="b317d-470">Prenez l’exemple des architectures précédentes et imaginez la région primaire ou secondaire comme étant un emplacement local.</span><span class="sxs-lookup"><span data-stu-id="b317d-470">Consider the previous architectures and imagine the primary or secondary region as an on-premises location.</span></span>

<span data-ttu-id="b317d-471">Ces architectures hybrides posent certains défis.</span><span class="sxs-lookup"><span data-stu-id="b317d-471">There are some challenges in these hybrid architectures.</span></span> <span data-ttu-id="b317d-472">Cet article a traité en grande partie des modèles d’architecture PaaS.</span><span class="sxs-lookup"><span data-stu-id="b317d-472">First, most of this article has addressed PaaS architecture patterns.</span></span> <span data-ttu-id="b317d-473">Les applications PaaS classiques dans Azure s’appuient sur des constructions Azure spécifiques, telles que les rôles, les services cloud et Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="b317d-473">Typical PaaS applications in Azure rely on Azure-specific constructs such as roles, cloud services, and Traffic Manager.</span></span> <span data-ttu-id="b317d-474">La création d’une solution locale pour ce type d’application PaaS nécessiterait une architecture bien plus différente.</span><span class="sxs-lookup"><span data-stu-id="b317d-474">Creating an on-premises solution for this type of PaaS application would require a significantly different architecture.</span></span> <span data-ttu-id="b317d-475">Cela peut être dissuasif d’un point de vue financier ou administratif.</span><span class="sxs-lookup"><span data-stu-id="b317d-475">This might not be feasible from a management or cost perspective.</span></span>

<span data-ttu-id="b317d-476">Cependant, une solution hybride de récupération d’urgence pose moins de défis que les architectures traditionnelles ayant été déplacées vers le cloud, comme les architectures IaaS.</span><span class="sxs-lookup"><span data-stu-id="b317d-476">However, a hybrid solution for disaster recovery has fewer challenges for traditional architectures that have been migrated to the cloud, such as IaaS-based architectures.</span></span> <span data-ttu-id="b317d-477">Les applications IaaS utilisent des machines virtuelles dans le cloud pouvant avoir des équivalents directs en local.</span><span class="sxs-lookup"><span data-stu-id="b317d-477">IaaS applications use virtual machines in the cloud that can have direct on-premises equivalents.</span></span> <span data-ttu-id="b317d-478">Vous pouvez utiliser des réseaux virtuels pour connecter des machines virtuelles dans le cloud aux ressources du réseau local.</span><span class="sxs-lookup"><span data-stu-id="b317d-478">You can also use virtual networks to connect machines in the cloud with on-premises network resources.</span></span> <span data-ttu-id="b317d-479">Cela crée de nombreuses possibilités, inenvisageables avec les applications basées uniquement sur PaaS.</span><span class="sxs-lookup"><span data-stu-id="b317d-479">This allows several possibilities that are not possible with PaaS-only applications.</span></span> <span data-ttu-id="b317d-480">Par exemple, SQL Server peut ainsi tirer parti de solutions de récupération d’urgence telles que les groupes de disponibilité AlwaysOn et la mise en miroir des bases de données.</span><span class="sxs-lookup"><span data-stu-id="b317d-480">For example, SQL Server can take advantage of disaster recovery solutions such as AlwaysOn Availability Groups and database mirroring.</span></span> <span data-ttu-id="b317d-481">Pour en savoir plus, consultez [Haute disponibilité et récupération d’urgence pour SQL Server sur des machines virtuelles Azure](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span><span class="sxs-lookup"><span data-stu-id="b317d-481">For details, see [High availability and disaster recovery for SQL Server in Azure virtual machines](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span></span>

<span data-ttu-id="b317d-482">Les solutions IaaS fournissent également un moyen plus simple aux applications locales d’utiliser Azure comme option de basculement.</span><span class="sxs-lookup"><span data-stu-id="b317d-482">IaaS solutions also provide an easier path for on-premises applications to use Azure as the failover option.</span></span> <span data-ttu-id="b317d-483">Vous pourriez avoir une application entièrement fonctionnelle dans une région locale existante.</span><span class="sxs-lookup"><span data-stu-id="b317d-483">You might have a fully functioning application in an existing on-premises region.</span></span> <span data-ttu-id="b317d-484">Mais que se passe-t-il si vous ne disposez pas d’assez de ressources pour entretenir une région géographiquement distincte pour le basculement ?</span><span class="sxs-lookup"><span data-stu-id="b317d-484">However, what if you lack the resources to maintain a geographically separate region for failover?</span></span> <span data-ttu-id="b317d-485">Vous pouvez décider d’utiliser des machines virtuelles et des réseaux virtuels pour exécuter votre application dans Azure.</span><span class="sxs-lookup"><span data-stu-id="b317d-485">You might decide to use virtual machines and virtual networks to get your application running in Azure.</span></span> <span data-ttu-id="b317d-486">Dans ce cas, définissez des processus pouvant synchroniser des données vers le cloud.</span><span class="sxs-lookup"><span data-stu-id="b317d-486">In that case, define processes that synchronize data to the cloud.</span></span> <span data-ttu-id="b317d-487">Le déploiement Azure devient ensuite la région secondaire à utiliser pour le basculement.</span><span class="sxs-lookup"><span data-stu-id="b317d-487">The Azure deployment then becomes the secondary region to use for failover.</span></span> <span data-ttu-id="b317d-488">La région primaire reste l’application en local.</span><span class="sxs-lookup"><span data-stu-id="b317d-488">The primary region remains the on-premises application.</span></span> <span data-ttu-id="b317d-489">Pour plus d’informations sur les architectures et les fonctionnalités IaaS, consultez la [documentation sur les machines virtuelles](https://azure.microsoft.com/documentation/services/virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="b317d-489">For more information about IaaS architectures and capabilities, see the [Virtual Machines documentation](https://azure.microsoft.com/documentation/services/virtual-machines/).</span></span>

## <a name="alternative-cloud"></a><span data-ttu-id="b317d-490">Autre cloud</span><span class="sxs-lookup"><span data-stu-id="b317d-490">Alternative cloud</span></span>
<span data-ttu-id="b317d-491">Dans certaines situations, les fonctionnalités étendues de Microsoft Azure peuvent ne pas satisfaire aux règles de conformité internes ou aux stratégies exigées par votre organisation.</span><span class="sxs-lookup"><span data-stu-id="b317d-491">There are situations where the broad capabilities of Microsoft Azure still may not meet internal compliance rules or policies required by your organization.</span></span> <span data-ttu-id="b317d-492">Même la meilleure préparation et conception pour l’implémentation des systèmes de sauvegarde en cas d’incident n’est pas adaptée dans le cas où le fournisseur de service cloud rencontre une interruption généralisée du service.</span><span class="sxs-lookup"><span data-stu-id="b317d-492">Even the best preparation and design to implement backup systems during a disaster are inadequate during a global service disruption of a cloud service provider.</span></span>

<span data-ttu-id="b317d-493">Vous devez comparer les exigences en matière de disponibilité au coût et à la complexité que représente une disponibilité accrue.</span><span class="sxs-lookup"><span data-stu-id="b317d-493">You should compare availability requirements with the cost and complexity of increased availability.</span></span> <span data-ttu-id="b317d-494">Effectuez une analyse des risques et définissez le RTO et le RPO pour votre solution.</span><span class="sxs-lookup"><span data-stu-id="b317d-494">Perform a risk analysis, and define the RTO and RPO for your solution.</span></span> <span data-ttu-id="b317d-495">Si votre application ne peut tolérer aucun temps d’arrêt, vous devez peut-être envisager une autre solution cloud.</span><span class="sxs-lookup"><span data-stu-id="b317d-495">If your application cannot tolerate any downtime, you might consider using an additional cloud solution.</span></span> <span data-ttu-id="b317d-496">À moins qu’Internet rencontre une panne générale, une autre solution cloud peut toujours être disponible si les services Azure tombent en panne dans le monde entier.</span><span class="sxs-lookup"><span data-stu-id="b317d-496">Unless the entire Internet goes down, another cloud solution might still be available if Azure becomes globally inaccessible.</span></span>

<span data-ttu-id="b317d-497">Comme pour le scénario hybride, les déploiements de basculement dans les architectures de récupération d’urgence précédentes peuvent également exister dans une autre solution cloud.</span><span class="sxs-lookup"><span data-stu-id="b317d-497">As with the hybrid scenario, the failover deployments in the previous disaster recovery architectures can also exist within another cloud solution.</span></span> <span data-ttu-id="b317d-498">D’autres sites de récupération d’urgence par cloud doivent être utilisés uniquement pour les solutions dont le RTO autorise peu de temps d’arrêt, voire aucun.</span><span class="sxs-lookup"><span data-stu-id="b317d-498">Alternative cloud DR sites should be used only for solutions whose RTO allows very little, if any, downtime.</span></span> <span data-ttu-id="b317d-499">Notez qu’une solution utilisant un site de récupération d’urgence en dehors d’Azure nécessite plus de travail pour la configuration, le développement, le déploiement ainsi que l’entretien.</span><span class="sxs-lookup"><span data-stu-id="b317d-499">Note that a solution that uses a DR site outside Azure will require more work to configure, develop, deploy, and maintain.</span></span> <span data-ttu-id="b317d-500">Il est également plus difficile d’implémenter des pratiques éprouvées dans une architecture intégrant plusieurs clouds.</span><span class="sxs-lookup"><span data-stu-id="b317d-500">It's also more difficult to implement proven practices in a cross-cloud architecture.</span></span> <span data-ttu-id="b317d-501">Bien que les plateformes cloud aient des concepts de haut niveau similaires, les API et les architectures sont différentes.</span><span class="sxs-lookup"><span data-stu-id="b317d-501">Although cloud platforms have similar high-level concepts, the APIs and architectures are different.</span></span>

<span data-ttu-id="b317d-502">Si votre stratégie de récupération d’urgence s’appuie sur plusieurs plateformes cloud, il peut être intéressant d’inclure des couches d’abstraction dans la conception de la solution.</span><span class="sxs-lookup"><span data-stu-id="b317d-502">If your DR strategy relies upon multiple cloud platforms, it's valuable to include abstraction layers in the design of the solution.</span></span> <span data-ttu-id="b317d-503">Ainsi, vous n’aurez pas à développer et entretenir deux versions différentes de la même application pour différentes plateformes cloud en cas d’urgence.</span><span class="sxs-lookup"><span data-stu-id="b317d-503">This eliminates the need to develop and maintain two different versions of the same application for different cloud platforms in case of disaster.</span></span> <span data-ttu-id="b317d-504">Comme pour le scénario hybride, l’utilisation de machines virtuelles Azure ou d’Azure Container Service peut s’avérer plus facile dans ce cas que l’utilisation des conceptions PaaS propres au cloud.</span><span class="sxs-lookup"><span data-stu-id="b317d-504">As with the hybrid scenario, the use of Azure Virtual Machines or Azure Container Service might be easier in these cases than the use of cloud-specific PaaS designs.</span></span>

## <a name="automation"></a><span data-ttu-id="b317d-505">Automatisation</span><span class="sxs-lookup"><span data-stu-id="b317d-505">Automation</span></span>
<span data-ttu-id="b317d-506">Certains des modèles présentés nécessitent l’activation rapide des déploiements hors connexion, ainsi que la restauration d’éléments spécifiques d’un système.</span><span class="sxs-lookup"><span data-stu-id="b317d-506">Some of the patterns that we just discussed require quick activation of offline deployments as well as restoration of specific parts of a system.</span></span> <span data-ttu-id="b317d-507">Les scripts d’automatisation peuvent activer des ressources à la demande et déployer des solutions rapidement.</span><span class="sxs-lookup"><span data-stu-id="b317d-507">Automation scripts can activate resources on demand and deploy solutions rapidly.</span></span> <span data-ttu-id="b317d-508">Les exemples ci-dessous d’automatisation associée à la récupération d’urgence utilisent [Azure PowerShell](https://msdn.microsoft.com/library/azure/jj156055.aspx), mais l’utilisation de [l’interface de ligne de commande Azure](https://docs.microsoft.com/en-us/cli/azure/get-started-with-azure-cli) ou de [l’API REST de gestion de service](https://msdn.microsoft.com/library/azure/ee460799.aspx) est également une bonne option.</span><span class="sxs-lookup"><span data-stu-id="b317d-508">The DR-related automation examples below use [Azure PowerShell](https://msdn.microsoft.com/library/azure/jj156055.aspx), but using the [Azure CLI](https://docs.microsoft.com/en-us/cli/azure/get-started-with-azure-cli) or the [Service Management REST API](https://msdn.microsoft.com/library/azure/ee460799.aspx) are also good options.</span></span>

<span data-ttu-id="b317d-509">Les scripts d’automatisation gèrent les aspects de la récupération d’urgence qui ne sont pas gérés de façon transparente par Azure.</span><span class="sxs-lookup"><span data-stu-id="b317d-509">Automation scripts manage aspects of DR not transparently handled by Azure.</span></span> <span data-ttu-id="b317d-510">Ils produisent des résultats cohérents et reproductibles, minimisant l’erreur humaine.</span><span class="sxs-lookup"><span data-stu-id="b317d-510">This produces consistent and repeatable results, minimizing human error.</span></span> <span data-ttu-id="b317d-511">Les scripts de récupération d’urgence prédéfinis réduisent également le temps nécessaire pour reconstruire un système et ses composants lors d’un sinistre.</span><span class="sxs-lookup"><span data-stu-id="b317d-511">Predefined DR scripts also reduce the time to rebuild a system and its constituent parts during a disaster.</span></span> <span data-ttu-id="b317d-512">Il n’est pas judicieux de rechercher manuellement des solutions pour restaurer votre site alors qu’il est hors connexion ; cela vous fait perdre de l’argent à chaque minute qui passe.</span><span class="sxs-lookup"><span data-stu-id="b317d-512">You don’t want to try to manually figure out how to restore your site while it's down and losing money every minute.</span></span>

<span data-ttu-id="b317d-513">Testez vos scripts à plusieurs reprises, du début à la fin.</span><span class="sxs-lookup"><span data-stu-id="b317d-513">Test your scripts repeatedly from start to finish.</span></span> <span data-ttu-id="b317d-514">Après avoir vérifié leurs fonctionnalités de base, testez-les en [simulant un incident](#disaster-simulation).</span><span class="sxs-lookup"><span data-stu-id="b317d-514">After verifying their basic functionality, make sure to test them in [disaster simulation](#disaster-simulation).</span></span> <span data-ttu-id="b317d-515">Cela permet de détecter les erreurs dans les scripts ou les processus.</span><span class="sxs-lookup"><span data-stu-id="b317d-515">This helps uncover defects in the scripts or processes.</span></span>

<span data-ttu-id="b317d-516">Une meilleure pratique de l’automation consiste à créer un référentiel de scripts PowerShell ou de scripts d’interface de ligne de commande (CLI) de récupération d’urgence Azure.</span><span class="sxs-lookup"><span data-stu-id="b317d-516">A best practice with automation is to create a repository of PowerShell scripts or command-line interface (CLI) scripts for Azure disaster recovery.</span></span> <span data-ttu-id="b317d-517">Marquez-les et classez-les clairement pour y accéder rapidement.</span><span class="sxs-lookup"><span data-stu-id="b317d-517">Clearly mark and categorize them for quick access.</span></span> <span data-ttu-id="b317d-518">Désignez une personne principale pour gérer le référentiel et le contrôle de version des scripts.</span><span class="sxs-lookup"><span data-stu-id="b317d-518">Designate a primary person to manage the repository and versioning of the scripts.</span></span> <span data-ttu-id="b317d-519">Documentez ces derniers de manière exhaustive avec des explications des paramètres et des exemples d’utilisation de script.</span><span class="sxs-lookup"><span data-stu-id="b317d-519">Document them well with explanations of parameters and examples of script use.</span></span> <span data-ttu-id="b317d-520">Assurez-vous que cette documentation est synchronisée avec vos déploiements Azure.</span><span class="sxs-lookup"><span data-stu-id="b317d-520">Also ensure that you keep this documentation in sync with your Azure deployments.</span></span> <span data-ttu-id="b317d-521">Cela souligne l’importance d’avoir une personne principale responsable de l’ensemble du référentiel.</span><span class="sxs-lookup"><span data-stu-id="b317d-521">This underscores the purpose of having a primary person in charge of all parts of the repository.</span></span>

## <a name="failure-detection"></a><span data-ttu-id="b317d-522">Détection des défaillances</span><span class="sxs-lookup"><span data-stu-id="b317d-522">Failure detection</span></span>
<span data-ttu-id="b317d-523">Pour gérer correctement les problèmes liés à la disponibilité et à la récupération d’urgence, vous devez être en mesure de détecter et diagnostiquer les défaillances.</span><span class="sxs-lookup"><span data-stu-id="b317d-523">To correctly handle problems with availability and disaster recovery, you must be able to detect and diagnose failures.</span></span> <span data-ttu-id="b317d-524">Vous devez surveiller de manière étendue les serveurs et les déploiements afin de savoir rapidement si un système ou ses composants deviennent indisponibles.</span><span class="sxs-lookup"><span data-stu-id="b317d-524">Perform advanced server and deployment monitoring to quickly recognize when a system or its components suddenly become unavailable.</span></span> <span data-ttu-id="b317d-525">Les outils d’analyse qui évaluent l’intégrité globale du service cloud et de ses dépendances peuvent effectuer une partie de ce travail.</span><span class="sxs-lookup"><span data-stu-id="b317d-525">Monitoring tools that assess the overall health of the cloud service and its dependencies can perform part of this work.</span></span> <span data-ttu-id="b317d-526">L’outil Microsoft [System Center 2016](https://www.microsoft.com/en-us/server-cloud/products/system-center-2016/) est approprié.</span><span class="sxs-lookup"><span data-stu-id="b317d-526">One suitable Microsoft tool is [System Center 2016](https://www.microsoft.com/en-us/server-cloud/products/system-center-2016/).</span></span> <span data-ttu-id="b317d-527">Des outils tiers proposent également des fonctionnalités d’analyse.</span><span class="sxs-lookup"><span data-stu-id="b317d-527">Third-party tools can also provide monitoring capabilities.</span></span> <span data-ttu-id="b317d-528">La plupart des solutions d’analyse suivent les principaux compteurs de performance et de disponibilité des services.</span><span class="sxs-lookup"><span data-stu-id="b317d-528">Most monitoring solutions track key performance counters and service availability.</span></span>

<span data-ttu-id="b317d-529">Bien que ces outils soient essentiels, vous devez planifier la détection des erreurs et la création de rapports au sein d’un service cloud.</span><span class="sxs-lookup"><span data-stu-id="b317d-529">Although these tools are vital, you must plan for fault detection and reporting within a cloud service.</span></span> <span data-ttu-id="b317d-530">Vous devez également planifier l’utilisation appropriée des diagnostics Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="b317d-530">You must also plan to properly use Azure Diagnostics.</span></span> <span data-ttu-id="b317d-531">Des compteurs de performance personnalisés ou des entrées du journal des événements peuvent également faire partie de la stratégie globale.</span><span class="sxs-lookup"><span data-stu-id="b317d-531">Custom performance counters or event-log entries can also be part of the overall strategy.</span></span> <span data-ttu-id="b317d-532">Cela fournit davantage de données lors des défaillances, ce qui permet de diagnostiquer le problème rapidement et de restaurer l’ensemble des fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="b317d-532">This provides more data during failures to quickly diagnose the problem and restore full capabilities.</span></span> <span data-ttu-id="b317d-533">Des métriques supplémentaires sont également fournies qui permettent aux outils d’analyse de déterminer l’intégrité de l’application.</span><span class="sxs-lookup"><span data-stu-id="b317d-533">It also provides additional metrics that the monitoring tools can use to determine application health.</span></span> <span data-ttu-id="b317d-534">Pour plus d’informations, consultez la page [Activation des diagnostics Azure dans Azure Cloud Services](/azure/cloud-services/cloud-services-dotnet-diagnostics/).</span><span class="sxs-lookup"><span data-stu-id="b317d-534">For more information, see [Enabling Azure Diagnostics in Azure Cloud Services](/azure/cloud-services/cloud-services-dotnet-diagnostics/).</span></span> <span data-ttu-id="b317d-535">Pour une présentation de la planification d’un « modèle d’intégrité » général, consultez [Failsafe: Guidance for Resilient Cloud Architectures](https://channel9.msdn.com/Series/FailSafe)(Sécurité intégrée : recommandations applicables à la résilience des architectures cloud).</span><span class="sxs-lookup"><span data-stu-id="b317d-535">For a discussion of how to plan for an overall “health model,” see [Failsafe: Guidance for Resilient Cloud Architectures](https://channel9.msdn.com/Series/FailSafe).</span></span>

## <a name="disaster-simulation"></a><span data-ttu-id="b317d-536">simulant un incident</span><span class="sxs-lookup"><span data-stu-id="b317d-536">Disaster simulation</span></span>
<span data-ttu-id="b317d-537">Les tests de simulation impliquent la création de petites situations réelles sur le lieu de travail afin d’observer la réaction des membres de l’équipe.</span><span class="sxs-lookup"><span data-stu-id="b317d-537">Simulation testing involves creating small real-life situations on the work floor to observe how the team members react.</span></span> <span data-ttu-id="b317d-538">Les simulations permettent également d’avoir une indication de l’efficacité des solutions dans le plan de récupération.</span><span class="sxs-lookup"><span data-stu-id="b317d-538">Simulations also show how effective the solutions are in the recovery plan.</span></span> <span data-ttu-id="b317d-539">Exécutez des simulations de manière à ce que les scénarios créés ne perturbent pas votre activité commerciale, tout en donnant l’impression d’une situation « réelle ».</span><span class="sxs-lookup"><span data-stu-id="b317d-539">Execute simulations so that the created scenarios don't disrupt actual business, while still feeling like real situations.</span></span>

<span data-ttu-id="b317d-540">Envisagez de créer un type de « menu général » dans l’application pour simuler manuellement les problèmes de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="b317d-540">Consider architecting a type of “switchboard” in the application to manually simulate availability issues.</span></span> <span data-ttu-id="b317d-541">Par exemple : déclenchez, à l’aide d’un commutateur logiciel, des exceptions d’accès à la base de données pour un module de commande en provoquant son dysfonctionnement.</span><span class="sxs-lookup"><span data-stu-id="b317d-541">For instance, through a soft switch, trigger database access exceptions for an ordering module by causing it to malfunction.</span></span> <span data-ttu-id="b317d-542">Vous pouvez mener des approches légères similaires pour d’autres modules au niveau de l’interface réseau.</span><span class="sxs-lookup"><span data-stu-id="b317d-542">You can take similar lightweight approaches for other modules at the network interface level.</span></span>

<span data-ttu-id="b317d-543">La simulation souligne les problèmes non résolus.</span><span class="sxs-lookup"><span data-stu-id="b317d-543">The simulation highlights any issues that were inadequately addressed.</span></span> <span data-ttu-id="b317d-544">Les scénarios simulés doivent être entièrement contrôlables.</span><span class="sxs-lookup"><span data-stu-id="b317d-544">The simulated scenarios must be completely controllable.</span></span> <span data-ttu-id="b317d-545">Cela signifie que, même si le plan de récupération échoue, vous pouvez restaurer l’état normal sans entraîner de dommage significatif.</span><span class="sxs-lookup"><span data-stu-id="b317d-545">This means that, even if the recovery plan seems to be failing, you can restore the situation back to normal without causing any significant damage.</span></span> <span data-ttu-id="b317d-546">Il est également important que vous informiez vos dirigeants de quand et comment les exercices de simulation seront conduits.</span><span class="sxs-lookup"><span data-stu-id="b317d-546">It’s also important that you inform higher-level management about when and how the simulation exercises will be executed.</span></span> <span data-ttu-id="b317d-547">Ce plan doit préciser le temps ou les ressources impactés pendant la simulation.</span><span class="sxs-lookup"><span data-stu-id="b317d-547">This plan should detail the time or resources affected during the simulation.</span></span> <span data-ttu-id="b317d-548">Lorsque vous testez votre plan de récupération d’urgence, vous devez également définir les mesures de réussite.</span><span class="sxs-lookup"><span data-stu-id="b317d-548">Also define the measures of success when testing your disaster recovery plan.</span></span>

<span data-ttu-id="b317d-549">Plusieurs autres techniques permettent de tester les plans de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="b317d-549">Several other techniques can test disaster recovery plans.</span></span> <span data-ttu-id="b317d-550">Toutefois, la plupart sont simplement des variantes de ces techniques de base.</span><span class="sxs-lookup"><span data-stu-id="b317d-550">However, most of them are simply variations of these basic techniques.</span></span> <span data-ttu-id="b317d-551">Ce test vise à évaluer la faisabilité du plan de récupération.</span><span class="sxs-lookup"><span data-stu-id="b317d-551">The intent of this testing is to evaluate the feasibility of the recovery plan.</span></span> <span data-ttu-id="b317d-552">Les tests des plans de récupération d’urgence recherchent les lacunes dans ces plans.</span><span class="sxs-lookup"><span data-stu-id="b317d-552">Disaster recovery testing focuses on the details to discover gaps in the basic recovery plan.</span></span>

## <a name="service-specific-guidance"></a><span data-ttu-id="b317d-553">Guide spécifique relatif au service</span><span class="sxs-lookup"><span data-stu-id="b317d-553">Service-specific guidance</span></span>

<span data-ttu-id="b317d-554">Les rubriques suivantes décrivent les services Azure spécifiques à la récupération d’urgence :</span><span class="sxs-lookup"><span data-stu-id="b317d-554">The following topics describe disaster recovery specific Azure services:</span></span>

| <span data-ttu-id="b317d-555">Service</span><span class="sxs-lookup"><span data-stu-id="b317d-555">Service</span></span> | <span data-ttu-id="b317d-556">Rubrique</span><span class="sxs-lookup"><span data-stu-id="b317d-556">Topic</span></span> |
|---------|-------|
| <span data-ttu-id="b317d-557">Services cloud</span><span class="sxs-lookup"><span data-stu-id="b317d-557">Cloud Services</span></span> | [<span data-ttu-id="b317d-558">Que faire si une interruption de service Azure affecte Azure Cloud Services</span><span class="sxs-lookup"><span data-stu-id="b317d-558">What to do in the event of an Azure service disruption that impacts Azure Cloud Services</span></span>](/azure/cloud-services/cloud-services-disaster-recovery-guidance) |
| <span data-ttu-id="b317d-559">Key Vault</span><span class="sxs-lookup"><span data-stu-id="b317d-559">Key Vault</span></span> | [<span data-ttu-id="b317d-560">Disponibilité et redondance d’Azure Key Vault</span><span class="sxs-lookup"><span data-stu-id="b317d-560">Azure Key Vault availability and redundancy</span></span>](/azure/key-vault/key-vault-disaster-recovery-guidance) |
|<span data-ttu-id="b317d-561">Storage</span><span class="sxs-lookup"><span data-stu-id="b317d-561">Storage</span></span> | [<span data-ttu-id="b317d-562">Que faire en cas de panne du Stockage Azure</span><span class="sxs-lookup"><span data-stu-id="b317d-562">What to do if an Azure Storage outage occurs</span></span>](/azure/storage/storage-disaster-recovery-guidance) |
| <span data-ttu-id="b317d-563">Base de données SQL</span><span class="sxs-lookup"><span data-stu-id="b317d-563">SQL Database</span></span> | [<span data-ttu-id="b317d-564">Restaurer une base de données SQL Azure ou basculer vers une base de données secondaire</span><span class="sxs-lookup"><span data-stu-id="b317d-564">Restore an Azure SQL Database or failover to a secondary</span></span>](/azure/sql-database/sql-database-disaster-recovery) |
| <span data-ttu-id="b317d-565">Machines virtuelles</span><span class="sxs-lookup"><span data-stu-id="b317d-565">Virtual machines</span></span> | [<span data-ttu-id="b317d-566">Que faire si une interruption du service Azure affecte des machines virtuelles Azure ?</span><span class="sxs-lookup"><span data-stu-id="b317d-566">What to do in the event that an Azure service disruption impacts Azure virtual machines</span></span>](/azure/virtual-machines/virtual-machines-disaster-recovery-guidance) |
| <span data-ttu-id="b317d-567">Réseaux virtuels</span><span class="sxs-lookup"><span data-stu-id="b317d-567">Virtual networks</span></span> | [<span data-ttu-id="b317d-568">Réseau virtuel – Continuité des activités</span><span class="sxs-lookup"><span data-stu-id="b317d-568">Virtual Network – Business Continuity</span></span>](/azure/virtual-network/virtual-network-disaster-recovery-guidance) |


