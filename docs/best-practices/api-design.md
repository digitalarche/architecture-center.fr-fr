---
title: "Guide de conception d’API"
description: "Conseils sur la création et la conception efficace d’une API."
author: dragon119
ms.date: 07/13/2016
pnp.series.title: Best Practices
ms.openlocfilehash: 3ffadce1b0c4a4da808e52d61cff0b7f0b27de11
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/14/2017
---
# <a name="api-design"></a><span data-ttu-id="1d504-103">Conception d’API</span><span class="sxs-lookup"><span data-stu-id="1d504-103">API design</span></span>
[!INCLUDE [header](../_includes/header.md)]

<span data-ttu-id="1d504-104">De nombreuses solutions modernes basées sur le web utilisent des services web, hébergés par des serveurs web, pour fournir des fonctionnalités aux applications clientes distantes.</span><span class="sxs-lookup"><span data-stu-id="1d504-104">Many modern web-based solutions make the use of web services, hosted by web servers, to provide functionality for remote client applications.</span></span> <span data-ttu-id="1d504-105">Les opérations exposées par un service web constituent une API web.</span><span class="sxs-lookup"><span data-stu-id="1d504-105">The operations that a web service exposes constitute a web API.</span></span> <span data-ttu-id="1d504-106">Une API web bien conçue doit prendre en charge les capacités suivantes :</span><span class="sxs-lookup"><span data-stu-id="1d504-106">A well-designed web API should aim to support:</span></span>

* <span data-ttu-id="1d504-107">**Indépendance de la plateforme**.</span><span class="sxs-lookup"><span data-stu-id="1d504-107">**Platform independence**.</span></span> <span data-ttu-id="1d504-108">Les applications clientes doivent être en mesure d’utiliser l’API fournie par le service web quelle que soit la façon dont les données ou opérations exposées par l’API sont implémentées physiquement.</span><span class="sxs-lookup"><span data-stu-id="1d504-108">Client applications should be able to utilize the API that the web service provides without requiring how the data or operations that API exposes are physically implemented.</span></span> <span data-ttu-id="1d504-109">Pour cela, l’API doit respecter des normes communes permettant à une application cliente et à un service web de s’accorder sur les formats de données à utiliser et sur la structure des données échangées entre les applications clientes et le service web.</span><span class="sxs-lookup"><span data-stu-id="1d504-109">This requires that the API abides by common standards that enable a client application and web service to agree on which data formats to use, and the structure of the data that is exchanged between client applications and the web service.</span></span>
* <span data-ttu-id="1d504-110">**Évolution des services**.</span><span class="sxs-lookup"><span data-stu-id="1d504-110">**Service evolution**.</span></span> <span data-ttu-id="1d504-111">Le service web doit être en mesure d’évoluer et ses fonctionnalités doivent pouvoir être modifiées (ajout ou suppression) indépendamment des applications clientes.</span><span class="sxs-lookup"><span data-stu-id="1d504-111">The web service should be able to evolve and add (or remove) functionality independently from client applications.</span></span> <span data-ttu-id="1d504-112">Les applications clientes existantes doivent être en mesure de continuer à fonctionner sans modification au fil de l’évolution des fonctionnalités fournies par le service web.</span><span class="sxs-lookup"><span data-stu-id="1d504-112">Existing client applications should be able to continue to operate unmodified as the features provided by the web service change.</span></span> <span data-ttu-id="1d504-113">Toutes les fonctionnalités doivent également être détectables, de sorte que les applications clientes puissent les utiliser pleinement.</span><span class="sxs-lookup"><span data-stu-id="1d504-113">All functionality should also be discoverable, so that client applications can fully utilize it.</span></span>

<span data-ttu-id="1d504-114">L’objectif de ce guide est de décrire les problèmes à prendre en compte lorsque vous concevez une API web.</span><span class="sxs-lookup"><span data-stu-id="1d504-114">The purpose of this guidance is to describe the issues that you should consider when designing a web API.</span></span>

## <a name="introduction-to-representational-state-transfer-rest"></a><span data-ttu-id="1d504-115">Introduction à REST (Representational State Transfer)</span><span class="sxs-lookup"><span data-stu-id="1d504-115">Introduction to Representational State Transfer (REST)</span></span>
<span data-ttu-id="1d504-116">Dans son étude de 2000, Roy Fielding propose une approche architecturale alternative à la structuration des opérations exposées par les services web : REST.</span><span class="sxs-lookup"><span data-stu-id="1d504-116">In his dissertation in 2000, Roy Fielding proposed an alternative architectural approach to structuring the operations exposed by web services; REST.</span></span> <span data-ttu-id="1d504-117">REST est un style d’architecture pour la création de systèmes distribués basés sur l’hypermédia.</span><span class="sxs-lookup"><span data-stu-id="1d504-117">REST is an architectural style for building distributed systems based on hypermedia.</span></span> <span data-ttu-id="1d504-118">L’un des principaux avantages du modèle REST est qu’il est basé sur des normes ouvertes et qu’il ne lie pas l’implémentation du modèle ou les applications clientes qui accèdent au modèle à une implémentation spécifique.</span><span class="sxs-lookup"><span data-stu-id="1d504-118">A primary advantage of the REST model is that it is based on open standards and does not bind the implementation of the model or the client applications that access it to any specific implementation.</span></span> <span data-ttu-id="1d504-119">Par exemple, un service web REST peut être implémenté à l’aide de l’API web Microsoft ASP.NET, et les applications clientes peuvent être développées à l’aide de n’importe quel langage et n’importe quel ensemble d’outils pouvant générer des requêtes HTTP et analyser les réponses HTTP.</span><span class="sxs-lookup"><span data-stu-id="1d504-119">For example, a REST web service could be implemented by using the Microsoft ASP.NET Web API, and client applications could be developed by using any language and toolset that can generate HTTP requests and parse HTTP responses.</span></span>

> [!NOTE]
> <span data-ttu-id="1d504-120">REST est indépendant de tout protocole sous-jacent et n’est pas nécessairement lié à HTTP.</span><span class="sxs-lookup"><span data-stu-id="1d504-120">REST is actually independent of any underlying protocol and is not necessarily tied to HTTP.</span></span> <span data-ttu-id="1d504-121">Toutefois, la plupart des implémentations courantes de systèmes basés sur REST utilisent HTTP comme protocole d’application pour l’envoi et la réception de requêtes.</span><span class="sxs-lookup"><span data-stu-id="1d504-121">However, most common implementations of systems that are based on REST utilize HTTP as the application protocol for sending and receiving requests.</span></span> <span data-ttu-id="1d504-122">Ce document est axé sur le mappage des principes REST aux systèmes conçus pour fonctionner à l’aide de HTTP.</span><span class="sxs-lookup"><span data-stu-id="1d504-122">This document focuses on mapping REST principles to systems designed to operate using HTTP.</span></span>
>
>

<span data-ttu-id="1d504-123">Le modèle REST utilise un schéma de navigation pour représenter les objets et les services sur un réseau (les *ressources*).</span><span class="sxs-lookup"><span data-stu-id="1d504-123">The REST model uses a navigational scheme to represent objects and services over a network (referred to as *resources*).</span></span> <span data-ttu-id="1d504-124">De nombreux systèmes qui implémentent REST utilisent généralement le protocole HTTP pour transmettre les demandes d’accès à ces ressources.</span><span class="sxs-lookup"><span data-stu-id="1d504-124">Many systems that implement REST typically use the HTTP protocol to transmit requests to access these resources.</span></span> <span data-ttu-id="1d504-125">Dans ces systèmes, une application cliente envoie une requête sous la forme d’un URI qui identifie une ressource, avec une méthode HTTP (les plus courantes étant GET, POST, PUT et DELETE) qui indique l’opération à effectuer sur cette ressource.</span><span class="sxs-lookup"><span data-stu-id="1d504-125">In these systems, a client application submits a request in the form of a URI that identifies a resource, and an HTTP method (the most common being GET, POST, PUT, or DELETE) that indicates the operation to be performed on that resource.</span></span>  <span data-ttu-id="1d504-126">Le corps de la requête HTTP contient les données requises pour effectuer l’opération.</span><span class="sxs-lookup"><span data-stu-id="1d504-126">The body of the HTTP request contains the data required to perform the operation.</span></span> <span data-ttu-id="1d504-127">Il est essentiel de bien comprendre que REST définit un modèle de requête sans état.</span><span class="sxs-lookup"><span data-stu-id="1d504-127">The important point to understand is that REST defines a stateless request model.</span></span> <span data-ttu-id="1d504-128">Les requêtes HTTP doivent être indépendantes et peuvent être générées dans n’importe quel ordre. Par conséquent, les informations d’état temporaires entre les requêtes ne peuvent pas être conservées.</span><span class="sxs-lookup"><span data-stu-id="1d504-128">HTTP requests should be independent and may occur in any order, so attempting to retain transient state information between requests is not feasible.</span></span>  <span data-ttu-id="1d504-129">Les ressources elles-mêmes représentent l’unique emplacement de stockage de ces informations. Chaque requête doit être une opération atomique.</span><span class="sxs-lookup"><span data-stu-id="1d504-129">The only place where information is stored is in the resources themselves, and each request should be an atomic operation.</span></span> <span data-ttu-id="1d504-130">En effet, un modèle REST implémente une machine à états finis où une requête fait passer une ressource d’un état non temporaire bien défini à un autre.</span><span class="sxs-lookup"><span data-stu-id="1d504-130">Effectively, a REST model implements a finite state machine where a request transitions a resource from one well-defined non-transient state to another.</span></span>

> [!NOTE]
> <span data-ttu-id="1d504-131">De par la nature sans état des requêtes individuelles du modèle REST, un système construit selon ces principes peut être hautement évolutif.</span><span class="sxs-lookup"><span data-stu-id="1d504-131">The stateless nature of individual requests in the REST model enables a system constructed by following these principles to be highly scalable.</span></span> <span data-ttu-id="1d504-132">Il est inutile de conserver une affinité entre une application cliente effectuant une série de requêtes et les serveurs web spécifiques qui gèrent ces requêtes.</span><span class="sxs-lookup"><span data-stu-id="1d504-132">There is no need to retain any affinity between a client application making a series of requests and the specific web servers handling those requests.</span></span>
>
>

<span data-ttu-id="1d504-133">Pour implémenter un modèle REST efficace, il est également crucial de comprendre les relations entre les différentes ressources auxquelles le modèle fournit l’accès.</span><span class="sxs-lookup"><span data-stu-id="1d504-133">Another crucial point in implementing an effective REST model is to understand the relationships between the various resources to which the model provides access.</span></span> <span data-ttu-id="1d504-134">Ces ressources sont généralement organisées sous forme de collections et relations.</span><span class="sxs-lookup"><span data-stu-id="1d504-134">These resources are typically organized as collections and relationships.</span></span> <span data-ttu-id="1d504-135">Par exemple, supposons qu’une analyse rapide d’un système de commerce électronique montre que deux collections sont susceptibles d’intéresser des applications clientes : les commandes et les clients.</span><span class="sxs-lookup"><span data-stu-id="1d504-135">For example, suppose that a quick analysis of an ecommerce system shows that there are two collections in which client applications are likely to be interested: orders and customers.</span></span> <span data-ttu-id="1d504-136">Chaque commande et chaque client doivent posséder leur propre clé pour l’identification.</span><span class="sxs-lookup"><span data-stu-id="1d504-136">Each order and customer should have its own unique key for identification purposes.</span></span> <span data-ttu-id="1d504-137">L’URI permettant d’accéder à la collection de commandes peut être aussi simple que */orders*. De même, l’URI pour la récupération de tous les clients peut être */customers*.</span><span class="sxs-lookup"><span data-stu-id="1d504-137">The URI to access the collection of orders could be something as simple as */orders*, and similarly the URI for retrieving all customers could be */customers*.</span></span> <span data-ttu-id="1d504-138">L’émission d’une requête HTTP GET à l’URI */orders* doit renvoyer une liste de toutes les commandes de la collection, encodée sous la forme d’une réponse HTTP :</span><span class="sxs-lookup"><span data-stu-id="1d504-138">Issuing an HTTP GET request to the */orders* URI should return a list representing all orders in the collection encoded as an HTTP response:</span></span>

```HTTP
GET http://adventure-works.com/orders HTTP/1.1
...
```

<span data-ttu-id="1d504-139">La réponse ci-dessous encode les commandes sous la forme d’une structure de liste JSON :</span><span class="sxs-lookup"><span data-stu-id="1d504-139">The response shown below encodes the orders as a JSON list structure:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Date: Fri, 22 Aug 2014 08:49:02 GMT
Content-Length: ...
[{"orderId":1,"orderValue":99.90,"productId":1,"quantity":1},{"orderId":2,"orderValue":10.00,"productId":4,"quantity":2},{"orderId":3,"orderValue":16.60,"productId":2,"quantity":4},{"orderId":4,"orderValue":25.90,"productId":3,"quantity":1},{"orderId":5,"orderValue":99.90,"productId":1,"quantity":1}]
```
<span data-ttu-id="1d504-140">L’extraction d’une commande individuelle nécessite de spécifier l’identificateur de la commande à partir de la ressource *orders*, par exemple */orders/2* :</span><span class="sxs-lookup"><span data-stu-id="1d504-140">To fetch an individual order requires specifying the identifier for the order from the *orders* resource, such as */orders/2*:</span></span>

```HTTP
GET http://adventure-works.com/orders/2 HTTP/1.1
...
```

```HTTP
HTTP/1.1 200 OK
...
Date: Fri, 22 Aug 2014 08:49:02 GMT
Content-Length: ...
{"orderId":2,"orderValue":10.00,"productId":4,"quantity":2}
```

> [!NOTE]
> <span data-ttu-id="1d504-141">Par souci de simplicité, ces exemples illustrent les informations dans des réponses renvoyées sous forme de données de texte JSON.</span><span class="sxs-lookup"><span data-stu-id="1d504-141">For simplicity, these examples show the information in responses being returned as JSON text data.</span></span> <span data-ttu-id="1d504-142">Toutefois, des ressources peuvent contenir d’autres types de données pris en charge par HTTP, par exemple des informations binaires ou chiffrées. L’en-tête Content-Type de la réponse HTTP doit spécifier le type.</span><span class="sxs-lookup"><span data-stu-id="1d504-142">However, there is no reason why resources should not contain any other type of data supported by HTTP, such as binary or encrypted information; the content-type in the HTTP response should specify the type.</span></span> <span data-ttu-id="1d504-143">En outre, un modèle REST peut renvoyer les mêmes données dans différents formats, tels que XML ou JSON.</span><span class="sxs-lookup"><span data-stu-id="1d504-143">Also, a REST model may be able to return the same data in different formats, such as XML or JSON.</span></span> <span data-ttu-id="1d504-144">Dans ce cas, le service web doit être en mesure d’effectuer la négociation de contenu avec le client qui effectue la requête.</span><span class="sxs-lookup"><span data-stu-id="1d504-144">In this case, the web service should be able to perform content negotiation with the client making the request.</span></span> <span data-ttu-id="1d504-145">La requête peut inclure un en-tête *Accept* qui spécifie le format de réception privilégié par le client. Dans la mesure du possible, le service web doit alors tenter de respecter ce format.</span><span class="sxs-lookup"><span data-stu-id="1d504-145">The request can include an *Accept* header which specifies the preferred format that the client would like to receive and the web service should attempt to honor this format if at all possible.</span></span>
>
>

<span data-ttu-id="1d504-146">Notez que la réponse liée à une requête REST utilise les codes d’état HTTP standard.</span><span class="sxs-lookup"><span data-stu-id="1d504-146">Notice that the response from a REST request makes use of the standard HTTP status codes.</span></span> <span data-ttu-id="1d504-147">Par exemple, une requête qui renvoie des données valides doit inclure le code de réponse HTTP 200 (OK), alors qu’une requête qui ne parvient pas à trouver ou supprimer une ressource spécifique doit renvoyer une réponse qui inclut le code d’état HTTP 404 (Introuvable).</span><span class="sxs-lookup"><span data-stu-id="1d504-147">For example, a request that returns valid data should include the HTTP response code 200 (OK), while a request that fails to find or delete a specified resource should return a response that includes the HTTP status code 404 (Not Found).</span></span>

## <a name="design-and-structure-of-a-restful-web-api"></a><span data-ttu-id="1d504-148">Conception et structure d’une API web RESTful</span><span class="sxs-lookup"><span data-stu-id="1d504-148">Design and structure of a RESTful web API</span></span>
<span data-ttu-id="1d504-149">La simplicité et la cohérence sont les clés de la réussite en matière de conception d’API web.</span><span class="sxs-lookup"><span data-stu-id="1d504-149">The keys to designing a successful web API are simplicity and consistency.</span></span> <span data-ttu-id="1d504-150">Une API web offrant ces deux qualités simplifie la création des applications clientes qui devront l’utiliser.</span><span class="sxs-lookup"><span data-stu-id="1d504-150">A Web API that exhibits these two factors makes it easier to build client applications that need to consume the API.</span></span>

<span data-ttu-id="1d504-151">Une API web RESTful repose principalement sur l’exposition d’un ensemble de ressources connectées et la fourniture des opérations principales qui permettent à une application de manipuler ces ressources et de naviguer facilement entre ces ressources.</span><span class="sxs-lookup"><span data-stu-id="1d504-151">A RESTful web API is focused on exposing a set of connected resources, and providing the core operations that enable an application to manipulate these resources and easily navigate between them.</span></span> <span data-ttu-id="1d504-152">Par conséquent, les URI qui constituent une API web RESTful classique doivent être orientées vers les données qu’elle expose et utiliser les fonctionnalités fournies par HTTP pour agir sur ces données.</span><span class="sxs-lookup"><span data-stu-id="1d504-152">For this reason, the URIs that constitute a typical RESTful web API should be oriented towards the data that it exposes, and use the facilities provided by HTTP to operate on this data.</span></span> <span data-ttu-id="1d504-153">Cette approche requiert une mentalité différente de celle généralement adoptée pour la conception d’un ensemble de classes dans une API orientée objet, dont la motivation porte plutôt sur le comportement des objets et des classes.</span><span class="sxs-lookup"><span data-stu-id="1d504-153">This approach requires a different mindset from that typically employed when designing a set of classes in an object-oriented API which tends to be more motivated by the behavior of objects and classes.</span></span> <span data-ttu-id="1d504-154">En outre, une API web RESTful doit être sans état et indépendante des opérations appelées dans une séquence particulière.</span><span class="sxs-lookup"><span data-stu-id="1d504-154">Additionally, a RESTful web API should be stateless and not depend on operations being invoked in a particular sequence.</span></span> <span data-ttu-id="1d504-155">Les sections suivantes résument les points à prendre en compte lors de la conception d’une API web RESTful.</span><span class="sxs-lookup"><span data-stu-id="1d504-155">The following sections summarize the points you should consider when designing a RESTful web API.</span></span>

### <a name="organizing-the-web-api-around-resources"></a><span data-ttu-id="1d504-156">Organisation de l’API web autour des ressources</span><span class="sxs-lookup"><span data-stu-id="1d504-156">Organizing the web API around resources</span></span>
> [!TIP]
> <span data-ttu-id="1d504-157">Les URI exposés par un service web REST doivent être basés sur des noms (les données auxquelles l’API web permet d’accéder) et non des verbes (ce qu’une application peut faire avec les données).</span><span class="sxs-lookup"><span data-stu-id="1d504-157">The URIs exposed by a REST web service should be based on nouns (the data to which the web API provides access) and not verbs (what an application can do with the data).</span></span>
>
>

<span data-ttu-id="1d504-158">Concentrez-vous sur les entités métier exposées par l’API web.</span><span class="sxs-lookup"><span data-stu-id="1d504-158">Focus on the business entities that the web API exposes.</span></span> <span data-ttu-id="1d504-159">Par exemple, avec une API web conçue pour prendre en charge le système de commerce électronique décrit précédemment, les entités principales sont les clients et les commandes.</span><span class="sxs-lookup"><span data-stu-id="1d504-159">For example, in a web API designed to support the ecommerce system described earlier, the primary entities are customers and orders.</span></span> <span data-ttu-id="1d504-160">Les processus tels que le passage d’une commande peuvent être assurés grâce à la fourniture d’une opération HTTP POST qui extrait les informations de commande et les ajoute à la liste de commandes du client.</span><span class="sxs-lookup"><span data-stu-id="1d504-160">Processes such as the act of placing an order can be achieved by providing an HTTP POST operation that takes the order information and adds it to the list of orders for the customer.</span></span> <span data-ttu-id="1d504-161">En interne, cette opération POST peut effectuer des tâches telles que la vérification des niveaux de stock et la facturation du client.</span><span class="sxs-lookup"><span data-stu-id="1d504-161">Internally, this POST operation can perform tasks such as checking stock levels, and billing the customer.</span></span> <span data-ttu-id="1d504-162">La réponse HTTP peut indiquer si la commande a été passée avec succès ou non.</span><span class="sxs-lookup"><span data-stu-id="1d504-162">The HTTP response can indicate whether the order was placed successfully or not.</span></span> <span data-ttu-id="1d504-163">Notez également qu’une ressource ne doit pas nécessairement être basée sur un élément de données physique unique.</span><span class="sxs-lookup"><span data-stu-id="1d504-163">Also note that a resource does not have to be based on a single physical data item.</span></span> <span data-ttu-id="1d504-164">Par exemple, une ressource de commande peut être implémentée en interne à l’aide des informations agrégées à partir de nombreuses lignes réparties sur plusieurs tables d’une base de données relationnelle, mais présentée au client comme une entité unique.</span><span class="sxs-lookup"><span data-stu-id="1d504-164">As an example, an order resource might be implemented internally by using information aggregated from many rows spread across several tables in a relational database but presented to the client as a single entity.</span></span>

> [!TIP]
> <span data-ttu-id="1d504-165">Évitez de concevoir une interface REST qui reflète ou dépend de la structure interne des données qu’elle expose.</span><span class="sxs-lookup"><span data-stu-id="1d504-165">Avoid designing a REST interface that mirrors or depends on the internal structure of the data that it exposes.</span></span> <span data-ttu-id="1d504-166">REST offre plus que l’implémentation de simples opérations CRUD (Create, Retrieve, Update, Delete) sur des tables distinctes d’une base de données relationnelle.</span><span class="sxs-lookup"><span data-stu-id="1d504-166">REST is about more than implementing simple CRUD (Create, Retrieve, Update, Delete) operations over separate tables in a relational database.</span></span> <span data-ttu-id="1d504-167">REST a pour objet de mapper des entités métier et les opérations qu’une application peut effectuer sur ces entités à l’implémentation physique de ces entités, mais un client ne doit pas être exposé à ces détails physiques.</span><span class="sxs-lookup"><span data-stu-id="1d504-167">The purpose of REST is to map business entities and the operations that an application can perform on these entities to the physical implementation of these entities, but a client should not be exposed to these physical details.</span></span>
>
>

<span data-ttu-id="1d504-168">Les entités métier individuelles existent rarement de façon isolée (même s’il peut exister certains objets singleton). Elles sont généralement regroupées dans des collections.</span><span class="sxs-lookup"><span data-stu-id="1d504-168">Individual business entities rarely exist in isolation (although some singleton objects may exist), but instead tend to be grouped together into collections.</span></span> <span data-ttu-id="1d504-169">Dans le cadre de REST, toutes les entités et collections sont des ressources.</span><span class="sxs-lookup"><span data-stu-id="1d504-169">In REST terms, each entity and each collection are resources.</span></span> <span data-ttu-id="1d504-170">Dans une API web RESTful, chaque collection a son propre URI dans le service web. Une requête HTTP GET sur l’URI d’une collection récupère une liste d’éléments de cette collection.</span><span class="sxs-lookup"><span data-stu-id="1d504-170">In a RESTful web API, each collection has its own URI within the web service, and performing an HTTP GET request over a URI for a collection retrieves a list of items in that collection.</span></span> <span data-ttu-id="1d504-171">Chaque élément individuel possède également son propre URI. Une application peut envoyer une autre requête HTTP GET avec cet URI pour récupérer les détails de l’élément.</span><span class="sxs-lookup"><span data-stu-id="1d504-171">Each individual item also has its own URI, and an application can submit another HTTP GET request using that URI to retrieve the details of that item.</span></span> <span data-ttu-id="1d504-172">Vous devez organiser les URI des collections et éléments de façon hiérarchique.</span><span class="sxs-lookup"><span data-stu-id="1d504-172">You should organize the URIs for collections and items in a hierarchical manner.</span></span> <span data-ttu-id="1d504-173">Dans le système de commerce électronique, l’URI */customers* désigne la collection du client, et */customers/5* récupère les détails du client unique avec l’ID 5 de cette collection.</span><span class="sxs-lookup"><span data-stu-id="1d504-173">In the ecommerce system, the URI */customers* denotes the customer’s collection, and */customers/5* retrieves the details for the single customer with the ID 5 from this collection.</span></span> <span data-ttu-id="1d504-174">Cette approche contribue à préserver l’intuitivité de l’API web.</span><span class="sxs-lookup"><span data-stu-id="1d504-174">This approach helps to keep the web API intuitive.</span></span>

> [!TIP]
> <span data-ttu-id="1d504-175">Adoptez une convention d’affectation de noms cohérente pour les URI. En général, il est recommandé d’utiliser des noms au pluriel pour les URI qui référencent des collections.</span><span class="sxs-lookup"><span data-stu-id="1d504-175">Adopt a consistent naming convention in URIs; in general it helps to use plural nouns for URIs that reference collections.</span></span>
>
>

<span data-ttu-id="1d504-176">Vous devez également prendre en compte les relations entre les différents types de ressources et la façon dont vous pouvez exposer ces associations.</span><span class="sxs-lookup"><span data-stu-id="1d504-176">You also need to consider the relationships between different types of resources and how you might expose these associations.</span></span> <span data-ttu-id="1d504-177">Par exemple, les clients peuvent ne passer aucune commande ou en passer plusieurs.</span><span class="sxs-lookup"><span data-stu-id="1d504-177">For example, customers may place zero or more orders.</span></span> <span data-ttu-id="1d504-178">L’utilisation d’un URI tel que */customers/5/orders* pour rechercher toutes les commandes du client 5 offre une façon naturelle de représenter cette relation.</span><span class="sxs-lookup"><span data-stu-id="1d504-178">A natural way to represent this relationship would be through a URI such as */customers/5/orders* to find all the orders for customer 5.</span></span> <span data-ttu-id="1d504-179">Vous pouvez également envisager de représenter l’association d’une commande associée à un client spécifique par le biais d’un URI tel que */orders/99/customer* pour rechercher le client auquel est associée la commande 99. Cependant, il n’est pas judicieux d’étendre ce modèle de façon excessive, car son implémentation deviendrait trop complexe.</span><span class="sxs-lookup"><span data-stu-id="1d504-179">You might also consider representing the association from an order back to a specific customer through a URI such as */orders/99/customer* to find the customer for order 99, but extending this model too far can become cumbersome to implement.</span></span> <span data-ttu-id="1d504-180">Une meilleure solution consiste à fournir des liens navigables vers des ressources associées, telles que le client, dans le corps du message de réponse HTTP renvoyé lorsque la commande fait l’objet d’une interrogation.</span><span class="sxs-lookup"><span data-stu-id="1d504-180">A better solution is to provide navigable links to associated resources, such as the customer, in the body of the HTTP response message returned when the order is queried.</span></span> <span data-ttu-id="1d504-181">Ce mécanisme est décrit plus en détail dans la section Utilisation de l’approche HATEOAS pour autoriser la navigation vers des ressources associées, plus loin dans ce guide.</span><span class="sxs-lookup"><span data-stu-id="1d504-181">This mechanism is described in more detail in the section Using the HATEOAS Approach to Enable Navigation To Related Resources later in this guidance.</span></span>

<span data-ttu-id="1d504-182">Les systèmes plus complexes peuvent inclure des types d’entité beaucoup plus nombreux, et il peut être tentant de fournir des URI qui permettent à une application cliente de naviguer dans plusieurs niveaux de relations, par exemple */customers/1/orders/99/products*, pour obtenir la liste des produits de la commande 99 passée par le client 1.</span><span class="sxs-lookup"><span data-stu-id="1d504-182">In more complex systems there may be many more types of entity, and it can be tempting to provide URIs that enable a client application to navigate through several levels of relationships, such as */customers/1/orders/99/products* to obtain the list of products in order 99 placed by customer 1.</span></span> <span data-ttu-id="1d504-183">Toutefois, ce niveau de complexité peut être difficile à gérer et n’offre aucune flexibilité si les relations entre les ressources changent ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="1d504-183">However, this level of complexity can be difficult to maintain and is inflexible if the relationships between resources change in the future.</span></span> <span data-ttu-id="1d504-184">Il est donc préférable de conserver des URI relativement simples.</span><span class="sxs-lookup"><span data-stu-id="1d504-184">Rather, you should seek to keep URIs relatively simple.</span></span> <span data-ttu-id="1d504-185">N’oubliez pas qu’une fois qu’une application a une référence à une ressource, il doit être possible d’utiliser cette référence pour rechercher des éléments liés à cette ressource.</span><span class="sxs-lookup"><span data-stu-id="1d504-185">Bear in mind that once an application has a reference to a resource, it should be possible to use this reference to find items related to that resource.</span></span> <span data-ttu-id="1d504-186">La requête précédente peut être remplacée par l’URI */customers/1/orders* pour rechercher toutes les commandes du client 1, puis interroger l’URI */orders/99/products* pour rechercher les produits de cette commande (en supposant que la commande 99 a été passée par le client 1).</span><span class="sxs-lookup"><span data-stu-id="1d504-186">The preceding query can be replaced with the URI */customers/1/orders* to find all the orders for customer 1, and then query the URI */orders/99/products* to find the products in this order (assuming order 99 was placed by customer 1).</span></span>

> [!TIP]
> <span data-ttu-id="1d504-187">Évitez d’imposer des URI de ressource plus complexes que *collection/item/collection*.</span><span class="sxs-lookup"><span data-stu-id="1d504-187">Avoid requiring resource URIs more complex than *collection/item/collection*.</span></span>
>
>

<span data-ttu-id="1d504-188">Un autre point à prendre en considération est la charge imposée au serveur web par toutes les requêtes web. Plus le nombre de requêtes est élevé, plus la charge est importante.</span><span class="sxs-lookup"><span data-stu-id="1d504-188">Another point to consider is that all web requests impose a load on the web server, and the greater the number of requests the bigger the load.</span></span> <span data-ttu-id="1d504-189">Vous devez tenter de définir vos ressources afin d’éviter les API web effectuant de nombreux échanges et qui exposent un grand nombre de ressources de petite taille.</span><span class="sxs-lookup"><span data-stu-id="1d504-189">You should attempt to define your resources to avoid “chatty” web APIs that expose a large number of small resources.</span></span> <span data-ttu-id="1d504-190">Une telle API peut nécessiter l’envoi de plusieurs requêtes par une application cliente pour rechercher toutes les données requises.</span><span class="sxs-lookup"><span data-stu-id="1d504-190">Such an API may require a client application to submit multiple requests to find all the data that it requires.</span></span> <span data-ttu-id="1d504-191">Il peut être avantageux de dénormaliser des données et de combiner des informations connexes en ressources plus volumineuses, qui peuvent être récupérées à l’aide d’une seule requête.</span><span class="sxs-lookup"><span data-stu-id="1d504-191">It may be beneficial to denormalize data and combine related information together into bigger resources that can be retrieved by issuing a single request.</span></span> <span data-ttu-id="1d504-192">Toutefois, vous devez mesurer cette approche par rapport à la surcharge imposée par l’extraction de données qui ne sont peut-être pas fréquemment requises par le client.</span><span class="sxs-lookup"><span data-stu-id="1d504-192">However, you need to balance this approach against the overhead of fetching data that might not be frequently required by the client.</span></span> <span data-ttu-id="1d504-193">La récupération d’objets volumineux peut augmenter la latence d’une requête et entraîner des coûts supplémentaires liés à la bande passante, et ce, pour un avantage modeste si les données supplémentaires ne sont pas souvent utilisées.</span><span class="sxs-lookup"><span data-stu-id="1d504-193">Retrieving large objects can increase the latency of a request and incur additional bandwidth costs for little advantage if the additional data is not often used.</span></span>

<span data-ttu-id="1d504-194">Évitez d’introduire des dépendances entre l’API web et la structure, le type ou l’emplacement des sources de données sous-jacentes.</span><span class="sxs-lookup"><span data-stu-id="1d504-194">Avoid introducing dependencies between the web API to the structure, type, or location of the underlying data sources.</span></span> <span data-ttu-id="1d504-195">Par exemple, si vos données se trouvent dans une base de données relationnelle, l’API web n’a pas besoin d’exposer chaque table comme une collection de ressources.</span><span class="sxs-lookup"><span data-stu-id="1d504-195">For example, if your data is located in a relational database, the web API does not need to expose each table as a collection of resources.</span></span> <span data-ttu-id="1d504-196">Considérez l’API web comme une abstraction de la base de données et, si nécessaire, introduisez une couche de mappage entre la base de données et l’API web.</span><span class="sxs-lookup"><span data-stu-id="1d504-196">Think of the web API as an abstraction of the database, and if necessary introduce a mapping layer between the database and the web API.</span></span> <span data-ttu-id="1d504-197">Ainsi, si la conception ou l’implémentation de la base de données évolue (par exemple, si vous passez d’une base de données relationnelle contenant une collection de tables normalisées à un système de stockage NoSQL dénormalisé tel qu’une base de données de documents), les applications clientes ne sont pas affectées par ces modifications.</span><span class="sxs-lookup"><span data-stu-id="1d504-197">In this way, if the design or implementation of the database changes (for example, you move from a relational database containing a collection of normalized tables to a denormalized NoSQL storage system such as a document database) client applications are insulated from these changes.</span></span>

> [!TIP]
> <span data-ttu-id="1d504-198">La source de données sur laquelle s’appuie une API web ne doit pas nécessairement être un magasin de données. Il peut s’agir d’une autre application de service ou métier, ou même d’une application héritée exécutée localement dans une organisation.</span><span class="sxs-lookup"><span data-stu-id="1d504-198">The source of the data that underpins a web API does not have to be a data store; it could be another service or line-of-business application or even a legacy application running on-premises within an organization.</span></span>
>
>

<span data-ttu-id="1d504-199">Enfin, il n’est pas toujours possible de mapper chaque opération implémentée par une API web à une ressource spécifique.</span><span class="sxs-lookup"><span data-stu-id="1d504-199">Finally, it might not be possible to map every operation implemented by a web API to a specific resource.</span></span> <span data-ttu-id="1d504-200">Vous pouvez gérer ces scénarios *sans ressource* par le biais de requêtes HTTP GET qui appellent une partie des fonctionnalités et renvoient les résultats dans un message de réponse HTTP.</span><span class="sxs-lookup"><span data-stu-id="1d504-200">You can handle such *non-resource* scenarios through HTTP GET requests that invoke a piece of functionality and return the results as an HTTP response message.</span></span> <span data-ttu-id="1d504-201">Une API web qui implémente des opérations de calcul simples, par exemple d’addition ou de soustraction, peut fournir des URI qui exposent ces opérations en tant que pseudo-ressources et utilisent la chaîne de requête pour spécifier les paramètres requis.</span><span class="sxs-lookup"><span data-stu-id="1d504-201">A web API that implements simple calculator-style operations such as add and subtract could provide URIs that expose these operations as pseudo resources and utilize the query string to specify the parameters required.</span></span> <span data-ttu-id="1d504-202">Par exemple une requête GET à l’URI */add?operand1=99&operand2=1* peut renvoyer un message de réponse dont le corps contenant la valeur 100, et une requête GET à l’URI */subtract?operand1=50&operand2=20* peut renvoyer un message de réponse dont le corps contient la valeur 30.</span><span class="sxs-lookup"><span data-stu-id="1d504-202">For example a GET request to the URI */add?operand1=99&operand2=1* could return a response message with the body containing the value 100, and GET request to the URI */subtract?operand1=50&operand2=20* could return a response message with the body containing the value 30.</span></span> <span data-ttu-id="1d504-203">Toutefois, utilisez ces formes d’URI avec parcimonie.</span><span class="sxs-lookup"><span data-stu-id="1d504-203">However, only use these forms of URIs sparingly.</span></span>

### <a name="defining-operations-in-terms-of-http-methods"></a><span data-ttu-id="1d504-204">Définition d’opérations en termes de méthodes HTTP</span><span class="sxs-lookup"><span data-stu-id="1d504-204">Defining operations in terms of HTTP methods</span></span>
<span data-ttu-id="1d504-205">Le protocole HTTP définit un certain nombre de méthodes qui affectent une signification sémantique à une requête.</span><span class="sxs-lookup"><span data-stu-id="1d504-205">The HTTP protocol defines a number of methods that assign semantic meaning to a request.</span></span> <span data-ttu-id="1d504-206">Les méthodes HTTP utilisées par la plupart des API web RESTful sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="1d504-206">The common HTTP methods used by most RESTful web APIs are:</span></span>

* <span data-ttu-id="1d504-207">**GET**pour récupérer une copie de la ressource à l’URI spécifié.</span><span class="sxs-lookup"><span data-stu-id="1d504-207">**GET**, to retrieve a copy of the resource at the specified URI.</span></span> <span data-ttu-id="1d504-208">Le corps du message de réponse contient les détails de la ressource demandée.</span><span class="sxs-lookup"><span data-stu-id="1d504-208">The body of the response message contains the details of the requested resource.</span></span>
* <span data-ttu-id="1d504-209">**POST**pour créer une ressource à l’URI spécifié.</span><span class="sxs-lookup"><span data-stu-id="1d504-209">**POST**, to create a new resource at the specified URI.</span></span> <span data-ttu-id="1d504-210">Le corps du message de requête fournit les détails de la nouvelle ressource.</span><span class="sxs-lookup"><span data-stu-id="1d504-210">The body of the request message provides the details of the new resource.</span></span> <span data-ttu-id="1d504-211">Notez que POST permet également de déclencher des opérations qui ne créent pas réellement de ressources.</span><span class="sxs-lookup"><span data-stu-id="1d504-211">Note that POST can also be used to trigger operations that don't actually create resources.</span></span>
* <span data-ttu-id="1d504-212">**PUT**pour remplacer ou mettre à jour la ressource à l’URI spécifié.</span><span class="sxs-lookup"><span data-stu-id="1d504-212">**PUT**, to replace or update the resource at the specified URI.</span></span> <span data-ttu-id="1d504-213">Le corps du message de requête spécifie la ressource à modifier et les valeurs à appliquer.</span><span class="sxs-lookup"><span data-stu-id="1d504-213">The body of the request message specifies the resource to be modified and the values to be applied.</span></span>
* <span data-ttu-id="1d504-214">**DELETE**pour supprimer la ressource à l’URI spécifié.</span><span class="sxs-lookup"><span data-stu-id="1d504-214">**DELETE**, to remove the resource at the specified URI.</span></span>

> [!NOTE]
> <span data-ttu-id="1d504-215">Le protocole HTTP définit également d’autres méthodes moins couramment utilisées, notamment la méthode PATCH pour demander des mises à jour sélectives pour une ressource, la méthode HEAD, pour demander une description d’une ressource, la méthode OPTIONS qui permet à une application cliente d’obtenir des informations sur les options de communication prises en charge par le serveur et la méthode TRACE, qui permet à un client de demander des informations qu’il peut utiliser à des fins de test et de diagnostic.</span><span class="sxs-lookup"><span data-stu-id="1d504-215">The HTTP protocol also defines other less commonly-used methods, such as PATCH which is used to request selective updates to a resource, HEAD which is used to request a description of a resource, OPTIONS which enables a client information to obtain information about the communication options supported by the server, and TRACE which allows a client to request information that it can use for testing and diagnostics purposes.</span></span>
>
>

<span data-ttu-id="1d504-216">L’effet d’une requête spécifique sera différent, selon que la ressource à laquelle elle est appliquée est une collection ou un élément individuel.</span><span class="sxs-lookup"><span data-stu-id="1d504-216">The effect of a specific request should depend on whether the resource to which it is applied is a collection or an individual item.</span></span> <span data-ttu-id="1d504-217">Le tableau suivant résume les conventions courantes adoptées par la plupart des implémentations RESTful suivant l’exemple du commerce électronique.</span><span class="sxs-lookup"><span data-stu-id="1d504-217">The following table summarizes the common conventions adopted by most RESTful implementations using the ecommerce example.</span></span> <span data-ttu-id="1d504-218">Notez que certaines de ces requêtes ne peuvent pas être implémentées ; cela dépend du scénario spécifique.</span><span class="sxs-lookup"><span data-stu-id="1d504-218">Note that not all of these requests might be implemented; it depends on the specific scenario.</span></span>

| <span data-ttu-id="1d504-219">**Ressource**</span><span class="sxs-lookup"><span data-stu-id="1d504-219">**Resource**</span></span> | <span data-ttu-id="1d504-220">**POST**</span><span class="sxs-lookup"><span data-stu-id="1d504-220">**POST**</span></span> | <span data-ttu-id="1d504-221">**GET**</span><span class="sxs-lookup"><span data-stu-id="1d504-221">**GET**</span></span> | <span data-ttu-id="1d504-222">**PUT**</span><span class="sxs-lookup"><span data-stu-id="1d504-222">**PUT**</span></span> | <span data-ttu-id="1d504-223">**DELETE**</span><span class="sxs-lookup"><span data-stu-id="1d504-223">**DELETE**</span></span> |
| --- | --- | --- | --- | --- |
| <span data-ttu-id="1d504-224">/customers</span><span class="sxs-lookup"><span data-stu-id="1d504-224">/customers</span></span> |<span data-ttu-id="1d504-225">Créer un client</span><span class="sxs-lookup"><span data-stu-id="1d504-225">Create a new customer</span></span> |<span data-ttu-id="1d504-226">Récupérer tous les clients</span><span class="sxs-lookup"><span data-stu-id="1d504-226">Retrieve all customers</span></span> |<span data-ttu-id="1d504-227">Mettre à jour des clients en bloc (*si implémentée*)</span><span class="sxs-lookup"><span data-stu-id="1d504-227">Bulk update of customers (*if implemented*)</span></span> |<span data-ttu-id="1d504-228">Supprimer tous les clients</span><span class="sxs-lookup"><span data-stu-id="1d504-228">Remove all customers</span></span> |
| <span data-ttu-id="1d504-229">/customers/1</span><span class="sxs-lookup"><span data-stu-id="1d504-229">/customers/1</span></span> |<span data-ttu-id="1d504-230">Erreur</span><span class="sxs-lookup"><span data-stu-id="1d504-230">Error</span></span> |<span data-ttu-id="1d504-231">Récupérer les détails du client 1</span><span class="sxs-lookup"><span data-stu-id="1d504-231">Retrieve the details for customer 1</span></span> |<span data-ttu-id="1d504-232">Mettre à jour les détails du client 1 s’il existe, sinon renvoyer une erreur</span><span class="sxs-lookup"><span data-stu-id="1d504-232">Update the details of customer 1 if it exists, otherwise return an error</span></span> |<span data-ttu-id="1d504-233">Supprimer le client 1</span><span class="sxs-lookup"><span data-stu-id="1d504-233">Remove customer 1</span></span> |
| <span data-ttu-id="1d504-234">/customers/1/orders</span><span class="sxs-lookup"><span data-stu-id="1d504-234">/customers/1/orders</span></span> |<span data-ttu-id="1d504-235">Créer une commande pour le client 1</span><span class="sxs-lookup"><span data-stu-id="1d504-235">Create a new order for customer 1</span></span> |<span data-ttu-id="1d504-236">Récupérer toutes les commandes pour le client 1</span><span class="sxs-lookup"><span data-stu-id="1d504-236">Retrieve all orders for customer 1</span></span> |<span data-ttu-id="1d504-237">Mettre à jour des commandes en bloc pour le client 1 (*si implémentée*)</span><span class="sxs-lookup"><span data-stu-id="1d504-237">Bulk update of orders for customer 1 (*if implemented*)</span></span> |<span data-ttu-id="1d504-238">Supprimer toutes les commandes du client 1 (*si implémentée*)</span><span class="sxs-lookup"><span data-stu-id="1d504-238">Remove all orders for customer 1(*if implemented*)</span></span> |

<span data-ttu-id="1d504-239">Le rôle des requêtes GET et DELETE est relativement simple. Cependant, le rôle et les effets des requêtes POST et PUT peuvent prêter à confusion.</span><span class="sxs-lookup"><span data-stu-id="1d504-239">The purpose of GET and DELETE requests are relatively straightforward, but there is scope for confusion concerning the purpose and effects of POST and PUT requests.</span></span>

<span data-ttu-id="1d504-240">Une requête POST doit créer une ressource avec les données fournies dans le corps de la requête.</span><span class="sxs-lookup"><span data-stu-id="1d504-240">A POST request should create a new resource with data provided in the body of the request.</span></span> <span data-ttu-id="1d504-241">Dans le cadre du modèle REST, vous appliquez fréquemment des requêtes POST à des ressources qui sont des collections ; la nouvelle ressource est ajoutée à la collection.</span><span class="sxs-lookup"><span data-stu-id="1d504-241">In the REST model, you frequently apply POST requests to resources that are collections; the new resource is added to the collection.</span></span>

> [!NOTE]
> <span data-ttu-id="1d504-242">Vous pouvez également définir des requêtes POST qui déclenchent certaines fonctionnalités (et qui ne renvoient pas nécessairement des données). Ces types de requête peuvent être appliqués aux collections.</span><span class="sxs-lookup"><span data-stu-id="1d504-242">You can also define POST requests that trigger some functionality (and that don't necessarily return data), and these types of request can be applied to collections.</span></span> <span data-ttu-id="1d504-243">Par exemple, vous pouvez utiliser une requête POST pour transmettre une feuille de temps à un service de traitement de paie et obtenir en réponse les taxes calculées.</span><span class="sxs-lookup"><span data-stu-id="1d504-243">For example you could use a POST request to pass a timesheet to a payroll processing service and get the calculated taxes back as a response.</span></span>
>
>

<span data-ttu-id="1d504-244">Une requête PUT est destinée à modifier une ressource existante.</span><span class="sxs-lookup"><span data-stu-id="1d504-244">A PUT request is intended to modify an existing resource.</span></span> <span data-ttu-id="1d504-245">Si la ressource spécifiée n’existe pas, la requête PUT peut renvoyer une erreur (dans certains cas, elle peut créer la ressource).</span><span class="sxs-lookup"><span data-stu-id="1d504-245">If the specified resource does not exist, the PUT request could return an error (in some cases, it might actually create the resource).</span></span> <span data-ttu-id="1d504-246">Les requêtes PUT sont généralement appliquées aux ressources qui sont des éléments individuels (par exemple, un client ou une commande spécifique). Elles peuvent cependant être appliquées à des collections, même si ce type d’implémentation est moins fréquent.</span><span class="sxs-lookup"><span data-stu-id="1d504-246">PUT requests are most frequently applied to resources that are individual items (such as a specific customer or order), although they can be applied to collections, although this is less-commonly implemented.</span></span> <span data-ttu-id="1d504-247">Notez que les requêtes PUT sont idempotentes, à la différence des requêtes POST ; si une application envoie la même requête PUT plusieurs fois, les résultats seront toujours les mêmes (la même ressource sera modifiée avec les mêmes valeurs), mais si une application répète la même requête POST, plusieurs ressources seront créées.</span><span class="sxs-lookup"><span data-stu-id="1d504-247">Note that PUT requests are idempotent whereas POST requests are not; if an application submits the same PUT request multiple times the results should always be the same (the same resource will be modified with the same values), but if an application repeats the same POST request the result will be the creation of multiple resources.</span></span>

> [!NOTE]
> <span data-ttu-id="1d504-248">À proprement parler, une requête HTTP PUT remplace une ressource existante par la ressource spécifiée dans le corps de la requête.</span><span class="sxs-lookup"><span data-stu-id="1d504-248">Strictly speaking, an HTTP PUT request replaces an existing resource with the resource specified in the body of the request.</span></span> <span data-ttu-id="1d504-249">Si l’intention est de modifier une sélection de propriétés d’une ressource tout en conservant les autres propriétés inchangées, une requête HTTP PATCH doit être utilisée.</span><span class="sxs-lookup"><span data-stu-id="1d504-249">If the intention is to modify a selection of properties in a resource but leave other properties unchanged, then this should be implemented by using an HTTP PATCH request.</span></span> <span data-ttu-id="1d504-250">Toutefois, de nombreuses implémentations RESTful assouplissent cette règle et utilisent une requête PUT dans les deux cas.</span><span class="sxs-lookup"><span data-stu-id="1d504-250">However, many RESTful implementations relax this rule and use PUT for both situations.</span></span>
>
>

### <a name="processing-http-requests"></a><span data-ttu-id="1d504-251">Traitement des requêtes HTTP</span><span class="sxs-lookup"><span data-stu-id="1d504-251">Processing HTTP requests</span></span>
<span data-ttu-id="1d504-252">Les données incluses par une application cliente dans de nombreuses requêtes HTTP et les messages de réponse correspondants envoyés par le serveur web peuvent être présentés dans divers formats (ou types de médias).</span><span class="sxs-lookup"><span data-stu-id="1d504-252">The data included by a client application in many HTTP requests, and the corresponding response messages from the web server, could be presented in a variety of formats (or media types).</span></span> <span data-ttu-id="1d504-253">Par exemple, les données qui spécifient les détails d’une commande ou d’un client peuvent être fournies au format XML ou JSON, ou dans un autre format encodé et compressé.</span><span class="sxs-lookup"><span data-stu-id="1d504-253">For example, the data that specifies the details for a customer or order could be provided as XML, JSON, or some other encoded and compressed format.</span></span> <span data-ttu-id="1d504-254">Une API web RESTful doit également prendre en charge les différents types de média demandés par l’application cliente qui envoie une requête.</span><span class="sxs-lookup"><span data-stu-id="1d504-254">A RESTful web API should support different media types as requested by the client application that submits a request.</span></span>

<span data-ttu-id="1d504-255">Lorsqu’une application cliente envoie une requête qui renvoie des données dans le corps d’un message, elle peut spécifier les types de média qu’elle peut gérer dans l’en-tête Accept de la requête.</span><span class="sxs-lookup"><span data-stu-id="1d504-255">When a client application sends a request that returns data in the body of a message, it can specify the media types it can handle in the Accept header of the request.</span></span> <span data-ttu-id="1d504-256">Le code ci-après illustre une requête HTTP GET qui récupère les détails de la commande 2 et indique que le résultat doit être renvoyé au format JSON (le client doit toujours examiner le type de média des données dans la réponse pour vérifier le format des données renvoyées) :</span><span class="sxs-lookup"><span data-stu-id="1d504-256">The following code illustrates an HTTP GET request that retrieves the details of order 2 and requests the result to be returned as JSON (the client should still examine the media type of the data in the response to verify the format of the data returned):</span></span>

```HTTP
GET http://adventure-works.com/orders/2 HTTP/1.1
...
Accept: application/json
...
```

<span data-ttu-id="1d504-257">Si le serveur web prend en charge ce type de média, il peut renvoyer une réponse dont l’en-tête Content-Type spécifie le format des données dans le corps du message :</span><span class="sxs-lookup"><span data-stu-id="1d504-257">If the web server supports this media type, it can reply with a response that includes Content-Type header that specifies the format of the data in the body of the message:</span></span>

> [!NOTE]
> <span data-ttu-id="1d504-258">Pour une interopérabilité maximale, les types de média référencés dans les en-têtes Accept et Content-Type doivent être des types MIME reconnus plutôt que des types de média personnalisés.</span><span class="sxs-lookup"><span data-stu-id="1d504-258">For maximum interoperability, the media types referenced in the Accept and Content-Type headers should be recognized MIME types rather than some custom media type.</span></span>
>
>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
Content-Length: ...
{"orderID":2,"productID":4,"quantity":2,"orderValue":10.00}
```

<span data-ttu-id="1d504-259">Si le serveur web ne prend pas en charge le type de média demandé, il peut envoyer les données dans un format différent.</span><span class="sxs-lookup"><span data-stu-id="1d504-259">If the web server does not support the requested media type, it can send the data in a different format.</span></span> <span data-ttu-id="1d504-260">Dans tous les cas, il doit spécifier le type de média (par exemple, *application/json*) dans l’en-tête Content-Type.</span><span class="sxs-lookup"><span data-stu-id="1d504-260">IN all cases it must specify the media type (such as *application/json*) in the Content-Type header.</span></span> <span data-ttu-id="1d504-261">Il incombe à l’application cliente d’analyser le message de réponse et d’interpréter les résultats dans le corps du message de manière appropriée.</span><span class="sxs-lookup"><span data-stu-id="1d504-261">It is the responsibility of the client application to parse the response message and interpret the results in the message body appropriately.</span></span>

<span data-ttu-id="1d504-262">Notez que dans cet exemple, le serveur web récupère correctement les données demandées et indique la réussite en repassant un code d’état 200 dans l’en-tête de la réponse.</span><span class="sxs-lookup"><span data-stu-id="1d504-262">Note that in this example, the web server successfully retrieves the requested data and indicates success by passing back a status code of 200 in the response header.</span></span> <span data-ttu-id="1d504-263">Si aucune donnée correspondante n’est trouvée, il doit renvoyer un code d’état 404 (Introuvable), et le corps du message de réponse peut contenir des informations supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="1d504-263">If no matching data is found, it should instead return a status code of 404 (not found) and the body of the response message can contain additional information.</span></span> <span data-ttu-id="1d504-264">Le format de ces informations est spécifié par l’en-tête Content-Type, comme illustré dans l’exemple suivant :</span><span class="sxs-lookup"><span data-stu-id="1d504-264">The format of this information is specified by the Content-Type header, as shown in the following example:</span></span>

```HTTP
GET http://adventure-works.com/orders/222 HTTP/1.1
...
Accept: application/json
...
```

<span data-ttu-id="1d504-265">La commande 222 n’existe pas. Le message de réponse ressemble donc à ceci :</span><span class="sxs-lookup"><span data-stu-id="1d504-265">Order 222 does not exist, so the response message looks like this:</span></span>

```HTTP
HTTP/1.1 404 Not Found
...
Content-Type: application/json; charset=utf-8
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
Content-Length: ...
{"message":"No such order"}
```

<span data-ttu-id="1d504-266">Lorsqu’une application envoie une requête HTTP PUT pour mettre à jour une ressource, elle spécifie l’URI de la ressource et fournit les données à modifier dans le corps du message de requête.</span><span class="sxs-lookup"><span data-stu-id="1d504-266">When an application sends an HTTP PUT request to update a resource, it specifies the URI of the resource and provides the data to be modified in the body of the request message.</span></span> <span data-ttu-id="1d504-267">Elle doit également spécifier le format de ces données à l’aide de l’en-tête Content-Type.</span><span class="sxs-lookup"><span data-stu-id="1d504-267">It should also specify the format of this data by using the Content-Type header.</span></span> <span data-ttu-id="1d504-268">Le format *application/x-www-form-urlencoded* est souvent utilisé pour les informations textuelles. Il comprend un ensemble de paires nom/valeur séparées par le caractère &.</span><span class="sxs-lookup"><span data-stu-id="1d504-268">A common format used for text-based information is *application/x-www-form-urlencoded*, which comprises a set of name/value pairs separated by the & character.</span></span> <span data-ttu-id="1d504-269">L’exemple suivant illustre une requête HTTP PUT qui modifie les informations de la commande 1 :</span><span class="sxs-lookup"><span data-stu-id="1d504-269">The next example shows an HTTP PUT request that modifies the information in order 1:</span></span>

```HTTP
PUT http://adventure-works.com/orders/1 HTTP/1.1
...
Content-Type: application/x-www-form-urlencoded
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
Content-Length: ...
ProductID=3&Quantity=5&OrderValue=250
```

<span data-ttu-id="1d504-270">Si la modification est réussie, le serveur doit idéalement répondre avec un code d’état HTTP 204 indiquant que le processus a été géré correctement mais que le corps de la réponse ne contient aucune information supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="1d504-270">If the modification is successful, it should ideally respond with an HTTP 204 status code, indicating that the process has been successfully handled, but that the response body contains no further information.</span></span> <span data-ttu-id="1d504-271">L’en-tête Location de la réponse contient l’URI de la ressource récemment mise à jour :</span><span class="sxs-lookup"><span data-stu-id="1d504-271">The Location header in the response contains the URI of the newly updated resource:</span></span>

```HTTP
HTTP/1.1 204 No Content
...
Location: http://adventure-works.com/orders/1
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
```

> [!TIP]
> <span data-ttu-id="1d504-272">Si les données d’un message de requête HTTP PUT incluent des informations de date et d’heure, assurez-vous que votre service web accepte les dates et heures au format de la norme ISO 8601.</span><span class="sxs-lookup"><span data-stu-id="1d504-272">If the data in an HTTP PUT request message includes date and time information, make sure that your web service accepts dates and times formatted following the ISO 8601 standard.</span></span>
>
>

<span data-ttu-id="1d504-273">Si la ressource à mettre à jour n’existe pas, le serveur web peut répondre avec une réponse Introuvable, comme décrit précédemment.</span><span class="sxs-lookup"><span data-stu-id="1d504-273">If the resource to be updated does not exist, the web server can respond with a Not Found response as described earlier.</span></span> <span data-ttu-id="1d504-274">Si le serveur crée l’objet lui-même, il peut renvoyer les codes d’état HTTP 200 (OK) ou HTTP 201 (Créé) et le corps de la réponse peut contenir les données de la nouvelle ressource.</span><span class="sxs-lookup"><span data-stu-id="1d504-274">Alternatively, if the server actually creates the object itself it could return the status codes HTTP 200 (OK) or HTTP 201 (Created) and the response body could contain the data for the new resource.</span></span> <span data-ttu-id="1d504-275">Si l’en-tête Content-Type de la requête spécifie un format de données que le serveur web ne peut pas gérer, il doit répondre avec le code d’état HTTP 415 (Type de support non pris en charge).</span><span class="sxs-lookup"><span data-stu-id="1d504-275">If the Content-Type header of the request specifies a data format that the web server cannot handle, it should respond with HTTP status code 415 (Unsupported Media Type).</span></span>

> [!TIP]
> <span data-ttu-id="1d504-276">Envisagez d’implémenter des opérations HTTP PUT en bloc, qui peuvent regrouper des mises à jour destinées à plusieurs ressources d’une collection.</span><span class="sxs-lookup"><span data-stu-id="1d504-276">Consider implementing bulk HTTP PUT operations that can batch updates to multiple resources in a collection.</span></span> <span data-ttu-id="1d504-277">La requête PUT doit spécifier l’URI de la collection, et le corps de la requête doit spécifier les détails des ressources à modifier.</span><span class="sxs-lookup"><span data-stu-id="1d504-277">The PUT request should specify the URI of the collection, and the request body should specify the details of the resources to be modified.</span></span> <span data-ttu-id="1d504-278">Cette approche peut aider à réduire les échanges excessifs et à améliorer les performances.</span><span class="sxs-lookup"><span data-stu-id="1d504-278">This approach can help to reduce chattiness and improve performance.</span></span>
>
>

<span data-ttu-id="1d504-279">Le format d’une requête HTTP POST créant des ressources est semblable à celui des requêtes PUT ; le corps du message contient les détails de la nouvelle ressource à ajouter.</span><span class="sxs-lookup"><span data-stu-id="1d504-279">The format of an HTTP POST requests that create new resources are similar to those of PUT requests; the message body contains the details of the new resource to be added.</span></span> <span data-ttu-id="1d504-280">Toutefois, l’URI spécifie généralement la collection à laquelle la ressource doit être ajoutée.</span><span class="sxs-lookup"><span data-stu-id="1d504-280">However, the URI typically specifies the collection to which the resource should be added.</span></span> <span data-ttu-id="1d504-281">L’exemple suivant crée une commande et l’ajoute à la collection de commandes :</span><span class="sxs-lookup"><span data-stu-id="1d504-281">The following example creates a new order and adds it to the orders collection:</span></span>

```HTTP
POST http://adventure-works.com/orders HTTP/1.1
...
Content-Type: application/x-www-form-urlencoded
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
Content-Length: ...
productID=5&quantity=15&orderValue=400
```

<span data-ttu-id="1d504-282">Si la requête réussit, le serveur web doit répondre avec un message possédant le code d’état HTTP 201 (Créé).</span><span class="sxs-lookup"><span data-stu-id="1d504-282">If the request is successful, the web server should respond with a message code with HTTP status code 201 (Created).</span></span> <span data-ttu-id="1d504-283">L’en-tête Location doit contenir l’URI de la ressource nouvellement créée, et le corps de la réponse doit contenir une copie de la nouvelle ressource. L’en-tête Content-Type spécifie le format de ces données :</span><span class="sxs-lookup"><span data-stu-id="1d504-283">The Location header should contain the URI of the newly created resource, and the body of the response should contain a copy of the new resource; the Content-Type header specifies the format of this data:</span></span>

```HTTP
HTTP/1.1 201 Created
...
Content-Type: application/json; charset=utf-8
Location: http://adventure-works.com/orders/99
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
Content-Length: ...
{"orderID":99,"productID":5,"quantity":15,"orderValue":400}
```

> [!TIP]
> <span data-ttu-id="1d504-284">Si les données fournies par une requête PUT ou POST ne sont pas valides, le serveur web doit répondre avec un message possédant le code d’état HTTP 400 (Requête incorrecte).</span><span class="sxs-lookup"><span data-stu-id="1d504-284">If the data provided by a PUT or POST request is invalid, the web server should respond with a message with HTTP status code 400 (Bad Request).</span></span> <span data-ttu-id="1d504-285">Le corps de ce message peut contenir des informations supplémentaires sur le problème avec la requête et les formats attendus ou un lien vers une URL qui fournit plus de détails.</span><span class="sxs-lookup"><span data-stu-id="1d504-285">The body of this message can contain additional information about the problem with the request and the formats expected, or it can contain a link to a URL that provides more details.</span></span>
>
>

<span data-ttu-id="1d504-286">Pour supprimer une ressource, une requête HTTP DELETE fournit simplement l’URI de la ressource à supprimer.</span><span class="sxs-lookup"><span data-stu-id="1d504-286">To remove a resource, an HTTP DELETE request simply provides the URI of the resource to be deleted.</span></span> <span data-ttu-id="1d504-287">L’exemple suivant tente de supprimer la commande 99 :</span><span class="sxs-lookup"><span data-stu-id="1d504-287">The following example attempts to remove order 99:</span></span>

```HTTP
DELETE http://adventure-works.com/orders/99 HTTP/1.1
...
```

<span data-ttu-id="1d504-288">Si l’opération de suppression réussit, le serveur web doit répondre avec un code d’état HTTP 204, indiquant que le processus a été géré correctement, mais que le corps de la réponse ne contient aucune information supplémentaire (il s’agit de la même réponse renvoyée par une opération PUT ayant réussi, mais sans en-tête Location car la ressource n’existe plus.) Une requête DELETE peut également renvoyer le code d’état HTTP 200 (OK) ou 202 (Accepté) si la suppression est exécutée de façon asynchrone.</span><span class="sxs-lookup"><span data-stu-id="1d504-288">If the delete operation is successful, the web server should respond with HTTP status code 204, indicating that the process has been successfully handled, but that the response body contains no further information (this is the same response returned by a successful PUT operation, but without a Location header as the resource no longer exists.) It is also possible for a DELETE request to return HTTP status code 200 (OK) or 202 (Accepted) if the deletion is performed asynchronously.</span></span>

```HTTP
HTTP/1.1 204 No Content
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
```

<span data-ttu-id="1d504-289">Si la ressource est introuvable, le serveur web doit renvoyer un message 404 (Introuvable).</span><span class="sxs-lookup"><span data-stu-id="1d504-289">If the resource is not found, the web server should return a 404 (Not Found) message instead.</span></span>

> [!TIP]
> <span data-ttu-id="1d504-290">Si toutes les ressources d’une collection doivent être supprimées, autorisez la spécification d’une requête HTTP DELETE pour l’URI de la collection, et ne forcez pas une application à supprimer successivement chaque ressource de la collection.</span><span class="sxs-lookup"><span data-stu-id="1d504-290">If all the resources in a collection need to be deleted, enable an HTTP DELETE request to be specified for the URI of the collection rather than forcing an application to remove each resource in turn from the collection.</span></span>
>
>

### <a name="filtering-and-paginating-data"></a><span data-ttu-id="1d504-291">Filtrage et pagination des données</span><span class="sxs-lookup"><span data-stu-id="1d504-291">Filtering and paginating data</span></span>
<span data-ttu-id="1d504-292">Vous devez vous efforcer de garder les URI simples et intuitifs.</span><span class="sxs-lookup"><span data-stu-id="1d504-292">You should endeavor to keep the URIs simple and intuitive.</span></span> <span data-ttu-id="1d504-293">L’exposition d’une collection de ressources par le biais d’un seul URI peut y contribuer. Cependant, dans ce cas, il se peut que les applications extraient de grandes quantités de données alors que seul un sous-ensemble d’informations est requis.</span><span class="sxs-lookup"><span data-stu-id="1d504-293">Exposing a collection of resources through a single URI assists in this respect, but it can lead to applications fetching large amounts of data when only a subset of the information is required.</span></span> <span data-ttu-id="1d504-294">La génération d’un grand volume de trafic affecte non seulement les performances et l’évolutivité du serveur web mais également la réactivité des applications clientes qui demandent les données.</span><span class="sxs-lookup"><span data-stu-id="1d504-294">Generating a large volume of traffic impacts not only the performance and scalability of the web server but also adversely affect the responsiveness of client applications requesting the data.</span></span>

<span data-ttu-id="1d504-295">Par exemple, si les commandes contiennent le prix d’achat de la commande, une application cliente qui a besoin de récupérer toutes les commandes dont le coût est supérieur à une valeur spécifique devra peut-être récupérer toutes les commandes à partir de l’URI */orders*, puis filtrer ces commandes localement.</span><span class="sxs-lookup"><span data-stu-id="1d504-295">For example, if orders contain the price paid for the order, a client application that needs to retrieve all orders that have a cost over a specific value might need to retrieve all orders from the */orders* URI and then filter these orders locally.</span></span> <span data-ttu-id="1d504-296">Ce processus est très peu efficace. Il gaspille la bande passante réseau et la puissance de traitement du serveur hébergeant l’API web.</span><span class="sxs-lookup"><span data-stu-id="1d504-296">Clearly this process is highly inefficient; it wastes network bandwidth and processing power on the server hosting the web API.</span></span>

<span data-ttu-id="1d504-297">Une solution consiste à fournir un modèle d’URI tel que */orders/ordervalue_greater_than_n* où *n* est le prix de la commande. Toutefois, hormis pour un nombre limité de prix, une telle approche présente des inconvénients.</span><span class="sxs-lookup"><span data-stu-id="1d504-297">One solution may be to provide a URI scheme such as */orders/ordervalue_greater_than_n* where *n* is the order price, but for all but a limited number of prices such an approach is impractical.</span></span> <span data-ttu-id="1d504-298">En outre, si vous devez interroger des commandes selon d’autres critères, vous pouvez être tenu de fournir une longue liste d’URI contenant des noms potentiellement non intuitifs.</span><span class="sxs-lookup"><span data-stu-id="1d504-298">Additionally, if you need to query orders based on other criteria, you can end up being faced with providing with a long list of URIs with possibly non-intuitive names.</span></span>

<span data-ttu-id="1d504-299">Pour le filtrage des données, une meilleure stratégie consiste à fournir des critères de filtre dans la chaîne de requête qui est passée à l’API web, par exemple */orders?ordervaluethreshold=n*.</span><span class="sxs-lookup"><span data-stu-id="1d504-299">A better strategy to filtering data is to provide the filter criteria in the query string that is passed to the web API, such as */orders?ordervaluethreshold=n*.</span></span> <span data-ttu-id="1d504-300">Dans cet exemple, l’opération correspondante dans l’API web est responsable de l’analyse et de la gestion du paramètre `ordervaluethreshold` dans la chaîne de requête et du renvoi des résultats filtrés dans la réponse HTTP.</span><span class="sxs-lookup"><span data-stu-id="1d504-300">In this example, the corresponding operation in the web API is responsible for parsing and handling the `ordervaluethreshold` parameter in the query string and returning the filtered results in the HTTP response.</span></span>

<span data-ttu-id="1d504-301">Certaines requêtes HTTP GET simples sur les ressources de la collection peuvent renvoyer un grand nombre d’éléments.</span><span class="sxs-lookup"><span data-stu-id="1d504-301">Some simple HTTP GET requests over collection resources could potentially return a large number of items.</span></span> <span data-ttu-id="1d504-302">Pour réduire ce risque, vous devez concevoir l’API web de façon à limiter la quantité de données renvoyées par chaque requête.</span><span class="sxs-lookup"><span data-stu-id="1d504-302">To combat the possibility of this occurring you should design the web API to limit the amount of data returned by any single request.</span></span> <span data-ttu-id="1d504-303">Pour cela, vous pouvez prendre en charge les chaînes de requête permettant aux utilisateurs de spécifier le nombre maximal d’éléments à récupérer (qui peut lui-même être soumis à une limite supérieure pour contribuer à empêcher les attaques par déni de service) et un décalage de départ dans la collection.</span><span class="sxs-lookup"><span data-stu-id="1d504-303">You can achieve this by supporting query strings that enable the user to specify the maximum number of items to be retrieved (which could itself be subject to an upperbound limit to help prevent Denial of Service attacks), and a starting offset into the collection.</span></span> <span data-ttu-id="1d504-304">Par exemple, la chaîne de requête dans l’URI */orders?limit=25&offset=50* doit récupérer 25 commandes à partir de la cinquantième commande trouvée dans la collection.</span><span class="sxs-lookup"><span data-stu-id="1d504-304">For example, the query string in the URI */orders?limit=25&offset=50* should retrieve 25 orders starting with the 50th order found in the orders collection.</span></span> <span data-ttu-id="1d504-305">Comme avec le filtrage des données, l’opération qui implémente la requête GET dans l’API web est responsable de l’analyse et de la gestion des paramètres `limit` et `offset` dans la chaîne de requête.</span><span class="sxs-lookup"><span data-stu-id="1d504-305">As with filtering data, the operation that implements the GET request in the web API is responsible for parsing and handling the `limit` and `offset` parameters in the query string.</span></span> <span data-ttu-id="1d504-306">Pour aider les applications clientes, les requêtes GET qui renvoient les données paginées doivent également inclure des métadonnées qui indiquent le nombre total de ressources disponibles dans la collection.</span><span class="sxs-lookup"><span data-stu-id="1d504-306">To assist client applications, GET requests that return paginated data should also include some form of metadata that indicate the total number of resources available in the collection.</span></span> <span data-ttu-id="1d504-307">Vous pouvez également envisager d’autres stratégies de pagination intelligente. Pour plus d’informations, consultez [API Design Notes: Smart Paging](http://bizcoder.com/api-design-notes-smart-paging) (Notes de conception d’API : pagination intelligente).</span><span class="sxs-lookup"><span data-stu-id="1d504-307">You might also consider other intelligent paging strategies; for more information, see [API Design Notes: Smart Paging](http://bizcoder.com/api-design-notes-smart-paging)</span></span>

<span data-ttu-id="1d504-308">Vous pouvez suivre une stratégie similaire pour trier les données au fil de leur extraction. Vous pouvez fournir un paramètre de tri qui utilise un nom de champ comme valeur, tel que */orders?sort=ProductID*.</span><span class="sxs-lookup"><span data-stu-id="1d504-308">You can follow a similar strategy for sorting data as it is fetched; you could provide a sort parameter that takes a field name as the value, such as */orders?sort=ProductID*.</span></span> <span data-ttu-id="1d504-309">Toutefois, notez que cette approche peut avoir un effet nuisible sur la mise en cache (les paramètres de chaîne de requête font partie de l’identificateur de ressource utilisé par de nombreuses implémentations de cache comme clé pour les données mises en cache).</span><span class="sxs-lookup"><span data-stu-id="1d504-309">However, note that this approach can have a deleterious effect on caching (query string parameters form part of the resource identifier used by many cache implementations as the key to cached data).</span></span>

<span data-ttu-id="1d504-310">Vous pouvez étendre cette approche pour limiter (projeter) les champs renvoyés si un élément de ressource unique contient une grande quantité de données.</span><span class="sxs-lookup"><span data-stu-id="1d504-310">You can extend this approach to limit (project) the fields returned if a single resource item contains a large amount of data.</span></span> <span data-ttu-id="1d504-311">Vous pouvez notamment utiliser un paramètre de chaîne de requête qui accepte une liste de champs séparés par des virgules, par exemple */orders?fields=ProductID,Quantity*.</span><span class="sxs-lookup"><span data-stu-id="1d504-311">For example, you could use a query string parameter that accepts a comma-delimited list of fields, such as */orders?fields=ProductID,Quantity*.</span></span>

> [!TIP]
> <span data-ttu-id="1d504-312">Affectez des valeurs par défaut significatives à tous les paramètres facultatifs des chaînes de requête.</span><span class="sxs-lookup"><span data-stu-id="1d504-312">Give all optional parameters in query strings meaningful defaults.</span></span> <span data-ttu-id="1d504-313">Par exemple, définissez le paramètre `limit` sur 10 et le paramètre `offset` sur 0 si vous implémentez la pagination, définissez le paramètre de tri sur la clé de la ressource si vous implémentez le classement et définissez le paramètre `fields` pour tous les champs de la ressource si vous prenez en charge des projections.</span><span class="sxs-lookup"><span data-stu-id="1d504-313">For example, set the `limit` parameter to 10 and the `offset` parameter to 0 if you implement pagination, set the sort parameter to the key of the resource if you implement ordering, and set the `fields` parameter to all fields in the resource if you support projections.</span></span>
>
>

### <a name="handling-large-binary-resources"></a><span data-ttu-id="1d504-314">Gestion de ressources binaires volumineuses</span><span class="sxs-lookup"><span data-stu-id="1d504-314">Handling large binary resources</span></span>
<span data-ttu-id="1d504-315">Une ressource unique peut contenir des champs binaires volumineux, tels que des fichiers ou des images.</span><span class="sxs-lookup"><span data-stu-id="1d504-315">A single resource may contain large binary fields, such as files or images.</span></span> <span data-ttu-id="1d504-316">Pour remédier aux problèmes de transmission provoqués par des connexions non fiables et intermittentes et pour améliorer les temps de réponse, envisagez de fournir des opérations qui permettent la récupération de ces ressources en blocs par l’application cliente.</span><span class="sxs-lookup"><span data-stu-id="1d504-316">To overcome the transmission problems caused by unreliable and intermittent connections and to improve response times, consider providing operations that enable such resources to be retrieved in chunks by the client application.</span></span> <span data-ttu-id="1d504-317">Pour ce faire, l’API web doit prendre en charge l’en-tête Accept-Ranges pour les requêtes GET en présence de ressources volumineuses et, dans l’idéal, implémenter les requêtes HTTP HEAD pour ces ressources.</span><span class="sxs-lookup"><span data-stu-id="1d504-317">To do this, the web API should support the Accept-Ranges header for GET requests for large resources, and ideally implement HTTP HEAD requests for these resources.</span></span> <span data-ttu-id="1d504-318">L’en-tête Accept-Ranges indique que l’opération GET prend en charge les résultats partiels et qu’une application cliente peut envoyer des requêtes GET qui renvoient un sous-ensemble d’une ressource spécifiée sous forme de plage d’octets.</span><span class="sxs-lookup"><span data-stu-id="1d504-318">The Accept-Ranges header indicates that the GET operation supports partial results, and that a client application can submit GET requests that return a subset of a resource specified as a range of bytes.</span></span> <span data-ttu-id="1d504-319">Une requête HEAD est similaire à une requête GET à ceci près qu’elle renvoie uniquement un en-tête qui décrit la ressource et un corps de message vide.</span><span class="sxs-lookup"><span data-stu-id="1d504-319">A HEAD request is similar to a GET request except that it only returns a header that describes the resource and an empty message body.</span></span> <span data-ttu-id="1d504-320">Une application cliente peut émettre une requête HEAD pour déterminer s’il faut extraire une ressource à l’aide de requêtes GET partielles.</span><span class="sxs-lookup"><span data-stu-id="1d504-320">A client application can issue a HEAD request to determine whether to fetch a resource by using partial GET requests.</span></span> <span data-ttu-id="1d504-321">L’exemple suivant illustre une requête HEAD qui obtient des informations sur une image de produit :</span><span class="sxs-lookup"><span data-stu-id="1d504-321">The following example shows a HEAD request that obtains information about a product image:</span></span>

```HTTP
HEAD http://adventure-works.com/products/10?fields=productImage HTTP/1.1
...
```

<span data-ttu-id="1d504-322">Le message de réponse contient un en-tête qui inclut la taille de la ressource (4580 octets), et l’en-tête Accept-Ranges indiquant que l’opération GET correspondante prend en charge les résultats partiels :</span><span class="sxs-lookup"><span data-stu-id="1d504-322">The response message contains a header that includes the size of the resource (4580 bytes), and the Accept-Ranges header that the corresponding GET operation supports partial results:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Accept-Ranges: bytes
Content-Type: image/jpeg
Content-Length: 4580
...
```

<span data-ttu-id="1d504-323">L’application cliente peut utiliser ces informations pour construire une série d’opérations GET afin de récupérer l’image en blocs plus petits.</span><span class="sxs-lookup"><span data-stu-id="1d504-323">The client application can use this information to construct a series of GET operations to retrieve the image in smaller chunks.</span></span> <span data-ttu-id="1d504-324">La première requête extrait les 2500 premiers octets à l’aide de l’en-tête Range :</span><span class="sxs-lookup"><span data-stu-id="1d504-324">The first request fetches the first 2500 bytes by using the Range header:</span></span>

```HTTP
GET http://adventure-works.com/products/10?fields=productImage HTTP/1.1
Range: bytes=0-2499
...
```

<span data-ttu-id="1d504-325">Le message de réponse indique qu’il s’agit d’une réponse partielle en renvoyant le code d’état HTTP 206.</span><span class="sxs-lookup"><span data-stu-id="1d504-325">The response message indicates that this is a partial response by returning HTTP status code 206.</span></span> <span data-ttu-id="1d504-326">L’en-tête Content-Length indique le nombre réel d’octets renvoyés dans le corps du message (pas la taille de la ressource), et l’en-tête Content-Range indique de quelle partie de la ressource il s’agit (octets 0-2499 sur 4580) :</span><span class="sxs-lookup"><span data-stu-id="1d504-326">The Content-Length header specifies the actual number of bytes returned in the message body (not the size of the resource), and the Content-Range header indicates which part of the resource this is (bytes 0-2499 out of 4580):</span></span>

```HTTP
HTTP/1.1 206 Partial Content
...
Accept-Ranges: bytes
Content-Type: image/jpeg
Content-Length: 2500
Content-Range: bytes 0-2499/4580
...
_{binary data not shown}_
```

<span data-ttu-id="1d504-327">Une demande ultérieure de l’application cliente peut extraire le reste de la ressource à l’aide d’un en-tête Range approprié :</span><span class="sxs-lookup"><span data-stu-id="1d504-327">A subsequent request from the client application can retrieve the remainder of the resource by using an appropriate Range header:</span></span>

```HTTP
GET http://adventure-works.com/products/10?fields=productImage HTTP/1.1
Range: bytes=2500-
...
```

<span data-ttu-id="1d504-328">Le message de résultat correspondant doit ressembler à ceci :</span><span class="sxs-lookup"><span data-stu-id="1d504-328">The corresponding result message should look like this:</span></span>

```HTTP
HTTP/1.1 206 Partial Content
...
Accept-Ranges: bytes
Content-Type: image/jpeg
Content-Length: 2080
Content-Range: bytes 2500-4580/4580
...
```

## <a name="using-the-hateoas-approach-to-enable-navigation-to-related-resources"></a><span data-ttu-id="1d504-329">Utilisation de l’approche HATEOAS pour autoriser la navigation vers des ressources associées</span><span class="sxs-lookup"><span data-stu-id="1d504-329">Using the HATEOAS approach to enable navigation to related resources</span></span>
<span data-ttu-id="1d504-330">L’utilisation de REST est principalement motivée par la possibilité de naviguer dans l’ensemble des ressources sans connaissance préalable du modèle d’URI.</span><span class="sxs-lookup"><span data-stu-id="1d504-330">One of the primary motivations behind REST is that it should be possible to navigate the entire set of resources without requiring prior knowledge of the URI scheme.</span></span> <span data-ttu-id="1d504-331">Chaque requête HTTP GET doit renvoyer les informations nécessaires pour trouver les ressources liées directement à l’objet demandé par le biais de liens hypertexte inclus dans la réponse. Des informations décrivant les opérations disponibles sur chacune de ces ressources doivent également être fournies.</span><span class="sxs-lookup"><span data-stu-id="1d504-331">Each HTTP GET request should return the information necessary to find the resources related directly to the requested object through hyperlinks included in the response, and it should also be provided with information that describes the operations available on each of these resources.</span></span> <span data-ttu-id="1d504-332">Il s’agit du principe HATEOAS (Hypertext as the Engine of Application State).</span><span class="sxs-lookup"><span data-stu-id="1d504-332">This principle is known as HATEOAS, or Hypertext as the Engine of Application State.</span></span> <span data-ttu-id="1d504-333">Le système est effectivement une machine à états finis, et la réponse à chaque requête contient les informations nécessaires pour passer d’un état à l’autre ; aucune autre information n’est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="1d504-333">The system is effectively a finite state machine, and the response to each request contains the information necessary to move from one state to another; no other information should be necessary.</span></span>

> [!NOTE]
> <span data-ttu-id="1d504-334">Il n’existe actuellement aucune norme ou spécification définissant comment modéliser le principe HATEOAS.</span><span class="sxs-lookup"><span data-stu-id="1d504-334">Currently there are no standards or specifications that define how to model the HATEOAS principle.</span></span> <span data-ttu-id="1d504-335">Les exemples présentés dans cette section illustrent une solution possible.</span><span class="sxs-lookup"><span data-stu-id="1d504-335">The examples shown in this section illustrate one possible solution.</span></span>
>
>

<span data-ttu-id="1d504-336">Par exemple, pour gérer la relation entre les clients et les commandes, les données renvoyées dans la réponse pour une commande spécifique doivent contenir les URI sous la forme d’un lien hypertexte qui identifie le client qui a passé la commande et les opérations qui peuvent être effectuées sur ce client.</span><span class="sxs-lookup"><span data-stu-id="1d504-336">As an example, to handle the relationship between customers and orders, the data returned in the response for a specific order should contain URIs in the form of a hyperlink identifying the customer that placed the order, and the operations that can be performed on that customer.</span></span>

```HTTP
GET http://adventure-works.com/orders/3 HTTP/1.1
Accept: application/json
...
```

<span data-ttu-id="1d504-337">Le corps du message de réponse contient un tableau `links` (mis en évidence dans l’exemple de code) qui spécifie la nature de la relation (*Customer*), l’URI du client (*http://adventure-works.com/customers/3*), le mode de récupération des détails de ce client (*GET*) et les types MIME que le serveur Web prend en charge pour la récupération de ces informations (*text/xml* et *application/json*).</span><span class="sxs-lookup"><span data-stu-id="1d504-337">The body of the response message contains a `links` array (highlighted in the code example) that specifies the nature of the relationship (*Customer*), the URI of the customer (*http://adventure-works.com/customers/3*), how to retrieve the details of this customer (*GET*), and the MIME types that the web server supports for retrieving this information (*text/xml* and *application/json*).</span></span> <span data-ttu-id="1d504-338">Il s’agit de toutes les informations nécessaires à une application cliente pour être en mesure d’extraire les détails du client.</span><span class="sxs-lookup"><span data-stu-id="1d504-338">This is all the information that a client application needs to be able to fetch the details of the customer.</span></span> <span data-ttu-id="1d504-339">En outre, le tableau Links inclut également des liens pour les autres opérations qui peuvent être effectuées, telles que PUT (pour modifier le client, ainsi que le format que le serveur web attend du client) et DELETE.</span><span class="sxs-lookup"><span data-stu-id="1d504-339">Additionally, the Links array also includes links for the other operations that can be performed, such as PUT (to modify the customer, together with the format that the web server expects the client to provide), and DELETE.</span></span>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"orderID":3,"productID":2,"quantity":4,"orderValue":16.60,"links":[(some links omitted){"rel":"customer","href":" http://adventure-works.com/customers/3", "action":"GET","types":["text/xml","application/json"]},{"rel":"
customer","href":" http://adventure-works.com /customers/3", "action":"PUT","types":["application/x-www-form-urlencoded"]},{"rel":"customer","href":" http://adventure-works.com /customers/3","action":"DELETE","types":[]}]}
```

<span data-ttu-id="1d504-340">Pour être complet, le tableau Links doit également inclure des informations d’auto-référencement se rapportant à la ressource récupérée.</span><span class="sxs-lookup"><span data-stu-id="1d504-340">For completeness, the Links array should also include self-referencing information pertaining to the resource that has been retrieved.</span></span> <span data-ttu-id="1d504-341">Ces liens ont été omis dans l’exemple précédent, mais sont mis en évidence dans le code suivant.</span><span class="sxs-lookup"><span data-stu-id="1d504-341">These links have been omitted from the previous example, but are highlighted in the following code.</span></span> <span data-ttu-id="1d504-342">Notez que dans ces liens, la relation *self* a été utilisée pour indiquer qu’il s’agit d’une référence à la ressource renvoyée par l’opération :</span><span class="sxs-lookup"><span data-stu-id="1d504-342">Notice that in these links, the relationship *self* has been used to indicate that this is a reference to the resource being returned by the operation:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"orderID":3,"productID":2,"quantity":4,"orderValue":16.60,"links":[{"rel":"self","href":" http://adventure-works.com/orders/3", "action":"GET","types":["text/xml","application/json"]},{"rel":" self","href":" http://adventure-works.com /orders/3", "action":"PUT","types":["application/x-www-form-urlencoded"]},{"rel":"self","href":" http://adventure-works.com /orders/3", "action":"DELETE","types":[]},{"rel":"customer",
"href":" http://adventure-works.com /customers/3", "action":"GET","types":["text/xml","application/json"]},{"rel":" customer" (customer links omitted)}]}
```

<span data-ttu-id="1d504-343">Pour que cette approche soit efficace, les applications clientes doivent être préparées pour récupérer et analyser ces informations supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="1d504-343">For this approach to be effective, client applications must be prepared to retrieve and parse this additional information.</span></span>

## <a name="versioning-a-restful-web-api"></a><span data-ttu-id="1d504-344">Contrôle de version d’une API web RESTful</span><span class="sxs-lookup"><span data-stu-id="1d504-344">Versioning a RESTful web API</span></span>
<span data-ttu-id="1d504-345">Il est peu probable qu’une API web reste statique, hormis dans les situations les plus simples.</span><span class="sxs-lookup"><span data-stu-id="1d504-345">It is highly unlikely that in all but the simplest of situations that a web API will remain static.</span></span> <span data-ttu-id="1d504-346">Au fil de l’évolution des besoins de l’entreprise, de nouvelles collections de ressources peuvent être ajoutées, les relations entre les ressources peuvent changer et la structure des données des ressources peut être modifiée.</span><span class="sxs-lookup"><span data-stu-id="1d504-346">As business requirements change new collections of resources may be added, the relationships between resources might change, and the structure of the data in resources might be amended.</span></span> <span data-ttu-id="1d504-347">La mise à jour d’une API web pour gérer les exigences nouvelles ou différentes est un processus relativement simple. Cependant, vous devez considérer les effets de ces modifications sur les applications clientes utilisant l’API web.</span><span class="sxs-lookup"><span data-stu-id="1d504-347">While updating a web API to handle new or differing requirements is a relatively straightforward process, you must consider the effects that such changes will have on client applications consuming the web API.</span></span> <span data-ttu-id="1d504-348">Le problème est le suivant : même si le développeur qui conçoit et implémente une API web bénéficie d’un contrôle total sur cette API, il n’a pas le même degré de contrôle sur les applications clientes qui peuvent être créées par des organisations tierces distantes.</span><span class="sxs-lookup"><span data-stu-id="1d504-348">The issue is that although the developer designing and implementing a web API has full control over that API, the developer does not have the same degree of control over client applications which may be built by third party organizations operating remotely.</span></span> <span data-ttu-id="1d504-349">L’impératif principal consiste à faire en sorte que les applications clientes existantes puissent continuer à fonctionner sans modification tout en autorisant les nouvelles applications clientes à tirer parti des nouvelles fonctionnalités et ressources.</span><span class="sxs-lookup"><span data-stu-id="1d504-349">The primary imperative is to enable existing client applications to continue functioning unchanged while allowing new client applications to take advantage of new features and resources.</span></span>

<span data-ttu-id="1d504-350">Le contrôle de version permet à une API web d’indiquer les fonctionnalités et ressources qu’elle expose. Une application cliente peut alors envoyer des requêtes destinées à une version spécifique d’une fonctionnalité ou d’une ressource.</span><span class="sxs-lookup"><span data-stu-id="1d504-350">Versioning enables a web API to indicate the features and resources that it exposes, and a client application can submit requests that are directed to a specific version of a feature or resource.</span></span> <span data-ttu-id="1d504-351">Les sections suivantes décrivent différentes approches présentant chacune des avantages et des inconvénients.</span><span class="sxs-lookup"><span data-stu-id="1d504-351">The following sections describe several different approaches, each of which has its own benefits and trade-offs.</span></span>

### <a name="no-versioning"></a><span data-ttu-id="1d504-352">Aucun contrôle de version</span><span class="sxs-lookup"><span data-stu-id="1d504-352">No versioning</span></span>
<span data-ttu-id="1d504-353">Il s’agit de l’approche la plus simple. Elle peut être acceptable pour certaines API internes.</span><span class="sxs-lookup"><span data-stu-id="1d504-353">This is the simplest approach, and may be acceptable for some internal APIs.</span></span> <span data-ttu-id="1d504-354">De nouvelles ressources ou de nouveaux liens peuvent représenter des changements importants.</span><span class="sxs-lookup"><span data-stu-id="1d504-354">Big changes could be represented as new resources or new links.</span></span>  <span data-ttu-id="1d504-355">L’ajout de contenu à des ressources existantes ne représente pas nécessairement une modification avec rupture, dans la mesure où les applications clientes qui n’attendent pas ce contenu l’ignoreront simplement.</span><span class="sxs-lookup"><span data-stu-id="1d504-355">Adding content to existing resources might not present a breaking change as client applications that are not expecting to see this content will simply ignore it.</span></span>

<span data-ttu-id="1d504-356">Par exemple, une requête à l’URI *http://adventure-works.com/customers/3* doit renvoyer les détails d’un client unique contenant les champs `id`, `name` et `address` attendus par l’application cliente :</span><span class="sxs-lookup"><span data-stu-id="1d504-356">For example, a request to the URI *http://adventure-works.com/customers/3* should return the details of a single customer containing `id`, `name`, and `address` fields expected by the client application:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"id":3,"name":"Contoso LLC","address":"1 Microsoft Way Redmond WA 98053"}
```

> [!NOTE]
> <span data-ttu-id="1d504-357">À des fins de simplicité et de clarté, les exemples de réponses présentés dans cette section n’incluent pas les liens HATEOAS.</span><span class="sxs-lookup"><span data-stu-id="1d504-357">For the purposes of simplicity and clarity, the example responses shown in this section do not include HATEOAS links.</span></span>
>
>

<span data-ttu-id="1d504-358">Si le champ `DateCreated` est ajouté au schéma de la ressource du client, la réponse se présentera comme suit :</span><span class="sxs-lookup"><span data-stu-id="1d504-358">If the `DateCreated` field is added to the schema of the customer resource, then the response would look like this:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"id":3,"name":"Contoso LLC","dateCreated":"2014-09-04T12:11:38.0376089Z","address":"1 Microsoft Way Redmond WA 98053"}
```

<span data-ttu-id="1d504-359">Les applications clientes existantes peuvent continuer à fonctionner correctement si elles peuvent ignorer les champs non reconnus. Les nouvelles applications clientes peuvent être conçues pour gérer ce nouveau champ.</span><span class="sxs-lookup"><span data-stu-id="1d504-359">Existing client applications might continue functioning correctly if they are capable of ignoring unrecognized fields, while new client applications can be designed to handle this new field.</span></span> <span data-ttu-id="1d504-360">Cependant, des modifications plus importantes affectant le schéma des ressources (par exemple, la suppression ou la modification de nom de champs), ou un changement des relations entre les ressources peuvent constituer des modifications avec rupture empêchant les applications clientes existantes de fonctionner correctement.</span><span class="sxs-lookup"><span data-stu-id="1d504-360">However, if more radical changes to the schema of resources occur (such as removing or renaming fields) or the relationships between resources change then these may constitute breaking changes that prevent existing client applications from functioning correctly.</span></span> <span data-ttu-id="1d504-361">Dans ces situations, vous devez envisager l’une des approches suivantes.</span><span class="sxs-lookup"><span data-stu-id="1d504-361">In these situations you should consider one of the following approaches.</span></span>

### <a name="uri-versioning"></a><span data-ttu-id="1d504-362">Contrôle de version d’URI</span><span class="sxs-lookup"><span data-stu-id="1d504-362">URI versioning</span></span>
<span data-ttu-id="1d504-363">Dès lors que vous modifiez l’API web ou le schéma des ressources, vous ajoutez un numéro de version à l’URI pour chaque ressource.</span><span class="sxs-lookup"><span data-stu-id="1d504-363">Each time you modify the web API or change the schema of resources, you add a version number to the URI for each resource.</span></span> <span data-ttu-id="1d504-364">Les URI existants doivent continuer à fonctionner comme avant et à renvoyer les ressources conformes à leur schéma d’origine.</span><span class="sxs-lookup"><span data-stu-id="1d504-364">The previously existing URIs should continue to operate as before, returning resources that conform to their original schema.</span></span>

<span data-ttu-id="1d504-365">Si l’on étend l’exemple précédent, si le champ `address` est restructuré dans des sous-champs contenant chaque partie de l’adresse (par exemple, `streetAddress`, `city`, `state` et `zipCode`), cette version de la ressource peut être exposée par le biais d’un URI qui contient un numéro de version, tel que http://adventure-works.com/v2/customers/3 :</span><span class="sxs-lookup"><span data-stu-id="1d504-365">Extending the previous example, if the `address` field is restructured into sub-fields containing each constituent part of the address (such as `streetAddress`, `city`, `state`, and `zipCode`), this version of the resource could be exposed through a URI containing a version number, such as http://adventure-works.com/v2/customers/3:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"id":3,"name":"Contoso LLC","dateCreated":"2014-09-04T12:11:38.0376089Z","address":{"streetAddress":"1 Microsoft Way","city":"Redmond","state":"WA","zipCode":98053}}
```

<span data-ttu-id="1d504-366">Ce mécanisme de contrôle de version est très simple, mais dépend du routage de la requête par le serveur au point de terminaison approprié.</span><span class="sxs-lookup"><span data-stu-id="1d504-366">This versioning mechanism is very simple but depends on the server routing the request to the appropriate endpoint.</span></span> <span data-ttu-id="1d504-367">Toutefois, il peut devenir complexe à mesure que l’API web arrive à maturité par le biais de plusieurs itérations et que le nombre de versions différentes prises en charge par le serveur évolue.</span><span class="sxs-lookup"><span data-stu-id="1d504-367">However, it can become unwieldy as the web API matures through several iterations and the server has to support a number of different versions.</span></span> <span data-ttu-id="1d504-368">En outre, d’un point de vue puriste, les applications clientes extraient les mêmes données (client 3) dans tous les cas. L’URI ne devrait donc pas être différent selon la version.</span><span class="sxs-lookup"><span data-stu-id="1d504-368">Also, from a purist’s point of view, in all cases the client applications are fetching the same data (customer 3), so the URI should not really be different depending on the version.</span></span> <span data-ttu-id="1d504-369">Ce modèle complique également l’implémentation de HATEOAS, dans la mesure où tous les liens devront inclure le numéro de version dans leurs URI.</span><span class="sxs-lookup"><span data-stu-id="1d504-369">This scheme also complicates implementation of HATEOAS as all links will need to include the version number in their URIs.</span></span>

### <a name="query-string-versioning"></a><span data-ttu-id="1d504-370">Contrôle de version de chaîne de requête</span><span class="sxs-lookup"><span data-stu-id="1d504-370">Query string versioning</span></span>
<span data-ttu-id="1d504-371">Plutôt que de fournir plusieurs URI, vous pouvez spécifier la version de la ressource en utilisant un paramètre dans la chaîne de requête ajoutée à la requête HTTP, par exemple *http://adventure-works.com/customers/3?version=2*.</span><span class="sxs-lookup"><span data-stu-id="1d504-371">Rather than providing multiple URIs, you can specify the version of the resource by using a parameter within the query string appended to the HTTP request, such as *http://adventure-works.com/customers/3?version=2*.</span></span> <span data-ttu-id="1d504-372">La valeur par défaut du paramètre de version doit être significative, par exemple 1, s’il est omis par des applications clientes plus anciennes.</span><span class="sxs-lookup"><span data-stu-id="1d504-372">The version parameter should default to a meaningful value such as 1 if it is omitted by older client applications.</span></span>

<span data-ttu-id="1d504-373">D’un point de vue sémantique, cette approche présente l’avantage suivant : la même ressource est toujours extraite du même URI, mais cela dépend du code qui gère la demande d’analyse de la chaîne de requête et de renvoi de la réponse HTTP appropriée.</span><span class="sxs-lookup"><span data-stu-id="1d504-373">This approach has the semantic advantage that the same resource is always retrieved from the same URI, but it depends on the code that handles the request to parse the query string and send back the appropriate HTTP response.</span></span> <span data-ttu-id="1d504-374">D’autre part, cette approche présente les mêmes inconvénients que le mécanisme de contrôle de version d’URI concernant l’implémentation de HATEOAS.</span><span class="sxs-lookup"><span data-stu-id="1d504-374">This approach also suffers from the same complications for implementing HATEOAS as the URI versioning mechanism.</span></span>

> [!NOTE]
> <span data-ttu-id="1d504-375">Certains proxys et navigateurs web anciens ne mettent pas en cache les réponses aux requêtes qui incluent une chaîne de requête dans l’URL.</span><span class="sxs-lookup"><span data-stu-id="1d504-375">Some older web browsers and web proxies will not cache responses for requests that include a query string in the URL.</span></span> <span data-ttu-id="1d504-376">Cela peut avoir un impact négatif sur les performances des applications web qui utilisent une API web et qui s’exécutent à partir des navigateurs web.</span><span class="sxs-lookup"><span data-stu-id="1d504-376">This can have an adverse impact on performance for web applications that use a web API and that run from within such a web browser.</span></span>
>
>

### <a name="header-versioning"></a><span data-ttu-id="1d504-377">Contrôle de version d’en-tête</span><span class="sxs-lookup"><span data-stu-id="1d504-377">Header versioning</span></span>
<span data-ttu-id="1d504-378">Plutôt que d’ajouter le numéro de version en tant que paramètre dans la chaîne de requête, vous pouvez implémenter un en-tête personnalisé qui indique la version de la ressource.</span><span class="sxs-lookup"><span data-stu-id="1d504-378">Rather than appending the version number as a query string parameter, you could implement a custom header that indicates the version of the resource.</span></span> <span data-ttu-id="1d504-379">Cette approche nécessite que l’application cliente ajoute l’en-tête approprié à toutes les requêtes, même si le code qui gère la requête client peut utiliser une valeur par défaut (version 1) si l’en-tête de version est omis.</span><span class="sxs-lookup"><span data-stu-id="1d504-379">This approach requires that the client application adds the appropriate header to any requests, although the code handling the client request could use a default value (version 1) if the version header is omitted.</span></span> <span data-ttu-id="1d504-380">Les exemples suivants utilisent un en-tête personnalisé nommé *Custom-Header*.</span><span class="sxs-lookup"><span data-stu-id="1d504-380">The following examples utilize a custom header named *Custom-Header*.</span></span> <span data-ttu-id="1d504-381">La valeur de cet en-tête indique la version de l’API web.</span><span class="sxs-lookup"><span data-stu-id="1d504-381">The value of this header indicates the version of web API.</span></span>

<span data-ttu-id="1d504-382">Version 1 :</span><span class="sxs-lookup"><span data-stu-id="1d504-382">Version 1:</span></span>

```HTTP
GET http://adventure-works.com/customers/3 HTTP/1.1
...
Custom-Header: api-version=1
...
```

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"id":3,"name":"Contoso LLC","address":"1 Microsoft Way Redmond WA 98053"}
```

<span data-ttu-id="1d504-383">Version 2 :</span><span class="sxs-lookup"><span data-stu-id="1d504-383">Version 2:</span></span>

```HTTP
GET http://adventure-works.com/customers/3 HTTP/1.1
...
Custom-Header: api-version=2
...
```

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"id":3,"name":"Contoso LLC","dateCreated":"2014-09-04T12:11:38.0376089Z","address":{"streetAddress":"1 Microsoft Way","city":"Redmond","state":"WA","zipCode":98053}}
```

<span data-ttu-id="1d504-384">Notez que, comme avec les deux approches précédentes, l’implémentation de HATEOAS nécessite l’inclusion de l’en-tête personnalisé approprié dans tous les liens.</span><span class="sxs-lookup"><span data-stu-id="1d504-384">Note that as with the previous two approaches, implementing HATEOAS requires including the appropriate custom header in any links.</span></span>

### <a name="media-type-versioning"></a><span data-ttu-id="1d504-385">Contrôle de version du type de média</span><span class="sxs-lookup"><span data-stu-id="1d504-385">Media type versioning</span></span>
<span data-ttu-id="1d504-386">Lorsqu’une application cliente envoie une requête HTTP GET à un serveur web, elle doit indiquer le format du contenu qu’elle peut traiter à l’aide d’un en-tête Accept, comme décrit précédemment dans ce guide.</span><span class="sxs-lookup"><span data-stu-id="1d504-386">When a client application sends an HTTP GET request to a web server it should stipulate the format of the content that it can handle by using an Accept header, as described earlier in this guidance.</span></span> <span data-ttu-id="1d504-387">Souvent, l’en-tête *Accept* a pour rôle de permettre à l’application cliente de spécifier si le corps de la réponse doit être au format XML ou JSON, ou dans un autre format courant que le client peut analyser.</span><span class="sxs-lookup"><span data-stu-id="1d504-387">Frequently the purpose of the *Accept* header is to allow the client application to specify whether the body of the response should be XML, JSON, or some other common format that the client can parse.</span></span> <span data-ttu-id="1d504-388">Toutefois, il est possible de définir des types de médias personnalisés qui incluent des informations permettant à l’application cliente d’indiquer la version de ressource attendue.</span><span class="sxs-lookup"><span data-stu-id="1d504-388">However, it is possible to define custom media types that include information enabling the client application to indicate which version of a resource it is expecting.</span></span> <span data-ttu-id="1d504-389">L’exemple suivant illustre une requête qui spécifie un en-tête *Accept* avec la valeur *application/vnd.adventure-works.v1+json*.</span><span class="sxs-lookup"><span data-stu-id="1d504-389">The following example shows a request that specifies an *Accept* header with the value *application/vnd.adventure-works.v1+json*.</span></span> <span data-ttu-id="1d504-390">L’élément *vnd.adventure-works.v1* indique au serveur web qu’il doit renvoyer la version 1 de la ressource, tandis que l’élément *json* spécifie que le format du corps de la réponse doit être JSON :</span><span class="sxs-lookup"><span data-stu-id="1d504-390">The *vnd.adventure-works.v1* element indicates to the web server that it should return version 1 of the resource, while the *json* element specifies that the format of the response body should be JSON:</span></span>

```HTTP
GET http://adventure-works.com/customers/3 HTTP/1.1
...
Accept: application/vnd.adventure-works.v1+json
...
```

<span data-ttu-id="1d504-391">Le code qui gère la requête est responsable du traitement de l’en-tête *Accept* et doit le respecter autant que possible (l’application cliente peut spécifier plusieurs formats dans l’en-tête *Accept*, auquel cas le serveur web peut choisir le format le plus approprié pour le corps de la réponse).</span><span class="sxs-lookup"><span data-stu-id="1d504-391">The code handling the request is responsible for processing the *Accept* header and honoring it as far as possible (the client application may specify multiple formats in the *Accept* header, in which case the web server can choose the most appropriate format for the response body).</span></span> <span data-ttu-id="1d504-392">Le serveur web vérifie le format des données dans le corps de la réponse à l’aide de l’en-tête Content-Type :</span><span class="sxs-lookup"><span data-stu-id="1d504-392">The web server confirms the format of the data in the response body by using the Content-Type header:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/vnd.adventure-works.v1+json; charset=utf-8
...
Content-Length: ...
{"id":3,"name":"Contoso LLC","address":"1 Microsoft Way Redmond WA 98053"}
```

<span data-ttu-id="1d504-393">Si l’en-tête Accept ne spécifie aucun type de média connu, le serveur web peut générer un message de réponse HTTP 406 (Non acceptable) ou renvoyer un message avec un type de média par défaut.</span><span class="sxs-lookup"><span data-stu-id="1d504-393">If the Accept header does not specify any known media types, the web server could generate an HTTP 406 (Not Acceptable) response message or return a message with a default media type.</span></span>

<span data-ttu-id="1d504-394">Cette approche représente sans doute le mécanisme de contrôle de version le plus pur et se prête naturellement à l’utilisation du principe HATEOAS, qui peut inclure le type MIME des données connexes dans les liens de ressources.</span><span class="sxs-lookup"><span data-stu-id="1d504-394">This approach is arguably the purest of the versioning mechanisms and lends itself naturally to HATEOAS, which can include the MIME type of related data in resource links.</span></span>

> [!NOTE]
> <span data-ttu-id="1d504-395">Lorsque vous choisissez une stratégie de contrôle de version, vous devez également tenir compte des implications sur les performances et en particulier de la mise en cache sur le serveur web.</span><span class="sxs-lookup"><span data-stu-id="1d504-395">When you select a versioning strategy, you should also consider the implications on performance, especially caching on the web server.</span></span> <span data-ttu-id="1d504-396">À cet égard, les modèles de contrôle de version d’URI et de chaîne de requête sont particulièrement efficaces, dans la mesure où la même combinaison URI/chaîne de requête fait référence aux mêmes données à chaque fois.</span><span class="sxs-lookup"><span data-stu-id="1d504-396">The URI versioning and Query String versioning schemes are cache-friendly inasmuch as the same URI/query string combination refers to the same data each time.</span></span>
>
> <span data-ttu-id="1d504-397">Les mécanismes de contrôle de version d’en-tête et de type de média requièrent généralement une logique supplémentaire pour examiner les valeurs dans l’en-tête personnalisé ou l’en-tête Accept.</span><span class="sxs-lookup"><span data-stu-id="1d504-397">The Header versioning and Media Type versioning mechanisms typically require additional logic to examine the values in the custom header or the Accept header.</span></span> <span data-ttu-id="1d504-398">Dans un environnement à grande échelle, l’utilisation de différentes versions d’une API web par de nombreux clients peut entraîner une quantité importante de données dupliquées dans un cache côté serveur.</span><span class="sxs-lookup"><span data-stu-id="1d504-398">In a large-scale environment, many clients using different versions of a web API can result in a significant amount of duplicated data in a server-side cache.</span></span> <span data-ttu-id="1d504-399">Ce problème peut s’aggraver si une application cliente communique avec un serveur web par l’intermédiaire d’un proxy qui implémente la mise en cache et qui transmet une requête au serveur web uniquement s’il ne contient pas une copie des données demandées dans son cache.</span><span class="sxs-lookup"><span data-stu-id="1d504-399">This issue can become acute if a client application communicates with a web server through a proxy that implements caching, and that only forwards a request to the web server if it does not currently hold a copy of the requested data in its cache.</span></span>
>
>

## <a name="open-api-initiative"></a><span data-ttu-id="1d504-400">Open API Initiative</span><span class="sxs-lookup"><span data-stu-id="1d504-400">Open API Initiative</span></span>
<span data-ttu-id="1d504-401">Le programme [Open API Initiative](https://www.openapis.org/) a été créé par un consortium industriel afin de normaliser les descriptions d’API REST entre les différents fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="1d504-401">The [Open API Initiative](https://www.openapis.org/) was created by an industry consortium to standardize REST API descriptions across vendors.</span></span> <span data-ttu-id="1d504-402">Dans le cadre de ce programme, la spécification Swagger 2.0 a été renommée en spécification OpenAPI (OAS) et placée sous le programme Open API Initiative.</span><span class="sxs-lookup"><span data-stu-id="1d504-402">As part of this initiative, the Swagger 2.0 specification was renamed the OpenAPI Specification (OAS) and brought under the Open API Initiative.</span></span>

<span data-ttu-id="1d504-403">Vous pouvez adopter la spécification OpenAPI pour vos API Web.</span><span class="sxs-lookup"><span data-stu-id="1d504-403">You may want to adopt OpenAPI for your web APIs.</span></span> <span data-ttu-id="1d504-404">Éléments à prendre en considération :</span><span class="sxs-lookup"><span data-stu-id="1d504-404">Some points to consider:</span></span>

- <span data-ttu-id="1d504-405">La spécification OpenAPI est fournie avec un ensemble de consignes strictes sur la façon dont une API REST doit être conçue.</span><span class="sxs-lookup"><span data-stu-id="1d504-405">The OpenAPI Specification comes with with a set of opinionated guidelines on how a REST API should be designed.</span></span> <span data-ttu-id="1d504-406">Ceci présente des avantages en termes d’interopérabilité, mais nécessite un surcroît d’attention de votre part lorsque vous concevez votre API pour qu’elle soit conforme à la spécification.</span><span class="sxs-lookup"><span data-stu-id="1d504-406">That has advantages for interoperability, but requires more care when designing your API to conform to the specification.</span></span>
- <span data-ttu-id="1d504-407">OpenAPI promeut une approche qui commence par le contrat plutôt que par l’implémentation.</span><span class="sxs-lookup"><span data-stu-id="1d504-407">OpenAPI promotes a contract-first approach, rather than an implementation-first approach.</span></span> <span data-ttu-id="1d504-408">Cela signifie que vous commencez par concevoir le contrat d’API (l’interface), puis que vous écrivez le code qui implémente ce contrat.</span><span class="sxs-lookup"><span data-stu-id="1d504-408">Contract-first means you design the API contract (the interface) first and then write code that implements the contract.</span></span> 
- <span data-ttu-id="1d504-409">Des outils tels que Swagger peuvent générer des bibliothèques clientes ou une documentation à partir des contrats d’API.</span><span class="sxs-lookup"><span data-stu-id="1d504-409">Tools like Swagger can generate client libraries or documentation from API contracts.</span></span> <span data-ttu-id="1d504-410">Par exemple, consultez l’article [ASP.NET Web API Help Pages using Swagger (Pages d’aide sur l’API Web ASP.NET à l’aide de Swagger)](/aspnet/core/tutorials/web-api-help-pages-using-swagger).</span><span class="sxs-lookup"><span data-stu-id="1d504-410">For example, see [ASP.NET Web API Help Pages using Swagger](/aspnet/core/tutorials/web-api-help-pages-using-swagger).</span></span>

## <a name="more-information"></a><span data-ttu-id="1d504-411">Plus d’informations</span><span class="sxs-lookup"><span data-stu-id="1d504-411">More information</span></span>
* <span data-ttu-id="1d504-412">L’article [Microsoft REST API Guidelines (Directives relatives aux API REST Microsoft)](https://github.com/Microsoft/api-guidelines/blob/master/Guidelines.md) contient des recommandations détaillées concernant la conception d’API REST publiques.</span><span class="sxs-lookup"><span data-stu-id="1d504-412">The [Microsoft REST API Guidelines](https://github.com/Microsoft/api-guidelines/blob/master/Guidelines.md) contain detailed recommendations for designing public REST APIs.</span></span>
* <span data-ttu-id="1d504-413">Le site [RESTful Cookbook](http://restcookbook.com/) (en anglais) offre une introduction à la création d’API RESTful.</span><span class="sxs-lookup"><span data-stu-id="1d504-413">The [RESTful Cookbook](http://restcookbook.com/) contains an introduction to building RESTful APIs.</span></span>
* <span data-ttu-id="1d504-414">L’article [Web API Checklist (Liste de contrôle pour les API Web)](https://mathieu.fenniak.net/the-api-checklist/) présente une liste d’éléments à prendre en compte lors de la conception et de l’implémentation d’une API Web.</span><span class="sxs-lookup"><span data-stu-id="1d504-414">The [Web API Checklist](https://mathieu.fenniak.net/the-api-checklist/) contains a useful list of items to consider when designing and implementing a web API.</span></span>
* <span data-ttu-id="1d504-415">Le site [Open API Initiative](https://www.openapis.org/) contient l’ensemble de la documentation associée et tous les détails d’implémentation sur Open API.</span><span class="sxs-lookup"><span data-stu-id="1d504-415">The [Open API Initiative](https://www.openapis.org/) site, contains all related documentation and implementation details on Open API.</span></span>
