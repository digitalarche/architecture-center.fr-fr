---
title: "Style d’architecture de microservices"
description: "Décrit les avantages, les inconvénients et les bonnes pratiques pour les architectures de microservices sur Azure"
author: MikeWasson
ms.openlocfilehash: 6426b3342a319832baf5eec35e9c783ba9348bdd
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/14/2017
---
# <a name="microservices-architecture-style"></a><span data-ttu-id="897a1-103">Style d’architecture de microservices</span><span class="sxs-lookup"><span data-stu-id="897a1-103">Microservices architecture style</span></span>

<span data-ttu-id="897a1-104">Une architecture de microservices se compose d’un ensemble de petits services autonomes.</span><span class="sxs-lookup"><span data-stu-id="897a1-104">A microservices architecture consists of a collection of small, autonomous services.</span></span> <span data-ttu-id="897a1-105">Chaque service est autonome et doit implémenter une fonctionnalité unique.</span><span class="sxs-lookup"><span data-stu-id="897a1-105">Each service is self-contained and should implement a single business capability.</span></span> 

![](./images/microservices-logical.svg)
 
<span data-ttu-id="897a1-106">À certains égards, les microservices sont l’évolution naturelle des architectures orientées services (SOA), mais il existe des différences.</span><span class="sxs-lookup"><span data-stu-id="897a1-106">In some ways, microservices are the natural evolution of service oriented architectures (SOA), but there are differences between microservices and SOA.</span></span> <span data-ttu-id="897a1-107">Voici certaines caractéristiques qui définissent un microservice :</span><span class="sxs-lookup"><span data-stu-id="897a1-107">Here are some defining characteristics of a microservice:</span></span>

- <span data-ttu-id="897a1-108">Dans une architecture de microservices, les services sont de petite taille, indépendants et faiblement liés.</span><span class="sxs-lookup"><span data-stu-id="897a1-108">In a microservices architecture, services are small, independent, and loosely coupled.</span></span>

- <span data-ttu-id="897a1-109">Chaque service est un code base distinct, qui peut être géré par une petite équipe de développement.</span><span class="sxs-lookup"><span data-stu-id="897a1-109">Each service is a separate codebase, which can be managed by a small development team.</span></span>

- <span data-ttu-id="897a1-110">Les services peuvent être déployés de manière indépendante.</span><span class="sxs-lookup"><span data-stu-id="897a1-110">Services can be deployed independently.</span></span> <span data-ttu-id="897a1-111">Une équipe peut mettre à jour un service existant sans avoir à recréer et redéployer l’application entière.</span><span class="sxs-lookup"><span data-stu-id="897a1-111">A team can update an existing service without rebuilding and redeploying the entire application.</span></span>

- <span data-ttu-id="897a1-112">Les services sont responsables de la persistance de leurs propres données ou de leur propre état externe.</span><span class="sxs-lookup"><span data-stu-id="897a1-112">Services are responsible for persisting their own data or external state.</span></span> <span data-ttu-id="897a1-113">Ils se distinguent en cela du modèle traditionnel dans lequel une couche de données distincte gère la persistance des données.</span><span class="sxs-lookup"><span data-stu-id="897a1-113">This differs from the traditional model, where a separate data layer handles data persistence.</span></span>

- <span data-ttu-id="897a1-114">Les services communiquent entre eux à l’aide d’API bien définies.</span><span class="sxs-lookup"><span data-stu-id="897a1-114">Services communicate with each other by using well-defined APIs.</span></span> <span data-ttu-id="897a1-115">Les détails de l’implémentation interne de chaque service sont cachés aux autres services.</span><span class="sxs-lookup"><span data-stu-id="897a1-115">Internal implementation details of each service are hidden from other services.</span></span>

- <span data-ttu-id="897a1-116">Les services n’ont pas besoin de partager une pile de technologies, des bibliothèques ou des frameworks identiques.</span><span class="sxs-lookup"><span data-stu-id="897a1-116">Services don't need to share the same technology stack, libraries, or frameworks.</span></span>

<span data-ttu-id="897a1-117">Outre les services proprement dits, une architecture de microservices type est constituée d’autres composants :</span><span class="sxs-lookup"><span data-stu-id="897a1-117">Besides for the services themselves, some other components appear in a typical microservices architecture:</span></span>

<span data-ttu-id="897a1-118">**Gestion** :</span><span class="sxs-lookup"><span data-stu-id="897a1-118">**Management**.</span></span> <span data-ttu-id="897a1-119">le composant de gestion est chargé de placer les services sur les nœuds, d’identifier les défaillances, de rééquilibrer les services entre les nœuds, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="897a1-119">The management component is responsible for placing services on nodes, identifying failures, rebalancing services across nodes, and so forth.</span></span>  

<span data-ttu-id="897a1-120">**Découverte des services** :</span><span class="sxs-lookup"><span data-stu-id="897a1-120">**Service Discovery**.</span></span>  <span data-ttu-id="897a1-121">tient à jour une liste des services et des nœuds sur lesquels ils se trouvent.</span><span class="sxs-lookup"><span data-stu-id="897a1-121">Maintains a list of services and which nodes they are located on.</span></span> <span data-ttu-id="897a1-122">Permet de rechercher le point de terminaison d’un service.</span><span class="sxs-lookup"><span data-stu-id="897a1-122">Enables service lookup to find the endpoint for a service.</span></span> 

<span data-ttu-id="897a1-123">**Passerelle d’API** :</span><span class="sxs-lookup"><span data-stu-id="897a1-123">**API Gateway**.</span></span> <span data-ttu-id="897a1-124">la passerelle d’API est le point d’entrée des clients.</span><span class="sxs-lookup"><span data-stu-id="897a1-124">The API gateway is the entry point for clients.</span></span> <span data-ttu-id="897a1-125">Les clients n’appellent pas les services directement.</span><span class="sxs-lookup"><span data-stu-id="897a1-125">Clients don't call services directly.</span></span> <span data-ttu-id="897a1-126">Au lieu de cela, ils appellent la passerelle d’API, qui transfère l’appel aux services appropriés sur le backend.</span><span class="sxs-lookup"><span data-stu-id="897a1-126">Instead, they call the API gateway, which forwards the call to the appropriate services on the back end.</span></span> <span data-ttu-id="897a1-127">La passerelle d’API peut agréger les réponses de plusieurs services et retourner la réponse agrégée.</span><span class="sxs-lookup"><span data-stu-id="897a1-127">The API gateway might aggregate the responses from several services and return the aggregated response.</span></span> 

<span data-ttu-id="897a1-128">L’utilisation de la passerelle d’API offre les avantages suivants :</span><span class="sxs-lookup"><span data-stu-id="897a1-128">The advantages of using an API gateway include:</span></span>

- <span data-ttu-id="897a1-129">Il dissocie les clients des services.</span><span class="sxs-lookup"><span data-stu-id="897a1-129">It decouples clients from services.</span></span> <span data-ttu-id="897a1-130">Les services peuvent être versionnés ou refactorisés sans avoir à mettre à jour tous les clients.</span><span class="sxs-lookup"><span data-stu-id="897a1-130">Services can be versioned or refactored without needing to update all of the clients.</span></span>

-  <span data-ttu-id="897a1-131">Les services peuvent utiliser des protocoles de messagerie qui ne sont pas compatibles avec le web, comme AMQP.</span><span class="sxs-lookup"><span data-stu-id="897a1-131">Services can use messaging protocols that are not web friendly, such as AMQP.</span></span>

- <span data-ttu-id="897a1-132">La passerelle d’API peut exécuter d’autres fonctions transversales, telles que l’authentification, la journalisation, la terminaison SSL et l’équilibrage de charge.</span><span class="sxs-lookup"><span data-stu-id="897a1-132">The API Gateway can perform other cross-cutting functions such as authentication, logging, SSL termination, and load balancing.</span></span>

## <a name="when-to-use-this-architecture"></a><span data-ttu-id="897a1-133">Quand utiliser cette architecture</span><span class="sxs-lookup"><span data-stu-id="897a1-133">When to use this architecture</span></span>

<span data-ttu-id="897a1-134">Envisagez ce style d’architecture pour :</span><span class="sxs-lookup"><span data-stu-id="897a1-134">Consider this architecture style for:</span></span>

- <span data-ttu-id="897a1-135">Les applications volumineuses qui exigent une grande rapidité de diffusion.</span><span class="sxs-lookup"><span data-stu-id="897a1-135">Large applications that require a high release velocity.</span></span>

- <span data-ttu-id="897a1-136">Les applications complexes qui doivent offrir une grande scalabilité.</span><span class="sxs-lookup"><span data-stu-id="897a1-136">Complex applications that need to be highly scalable.</span></span>

- <span data-ttu-id="897a1-137">Les applications dotées de domaines étoffés ou d’un grand nombre de sous-domaines.</span><span class="sxs-lookup"><span data-stu-id="897a1-137">Applications with rich domains or many subdomains.</span></span>

- <span data-ttu-id="897a1-138">Une organisation constituée de petites équipes de développement.</span><span class="sxs-lookup"><span data-stu-id="897a1-138">An organization that consists of small development teams.</span></span>


## <a name="benefits"></a><span data-ttu-id="897a1-139">Avantages</span><span class="sxs-lookup"><span data-stu-id="897a1-139">Benefits</span></span> 

- <span data-ttu-id="897a1-140">**Déploiements indépendants** :</span><span class="sxs-lookup"><span data-stu-id="897a1-140">**Independent deployments**.</span></span> <span data-ttu-id="897a1-141">vous pouvez mettre à jour un service sans avoir à redéployer l’application entière et effectuer une restauration ou une restauration par progression si une mise à jour est une source de problèmes.</span><span class="sxs-lookup"><span data-stu-id="897a1-141">You can update a service without redeploying the entire application, and roll back or roll forward an update if something goes wrong.</span></span> <span data-ttu-id="897a1-142">Les résolutions de bogues et les diffusions de fonctionnalités sont plus faciles à gérer et moins risquées.</span><span class="sxs-lookup"><span data-stu-id="897a1-142">Bug fixes and feature releases are more manageable and less risky.</span></span>

- <span data-ttu-id="897a1-143">**Développement indépendant** :</span><span class="sxs-lookup"><span data-stu-id="897a1-143">**Independent development**.</span></span> <span data-ttu-id="897a1-144">une même équipe de développement peut créer, tester et déployer un service.</span><span class="sxs-lookup"><span data-stu-id="897a1-144">A single development team can build, test, and deploy a service.</span></span> <span data-ttu-id="897a1-145">Résultat : l’innovation est continue et la cadence des diffusions est supérieure.</span><span class="sxs-lookup"><span data-stu-id="897a1-145">The result is continuous innovation and a faster release cadence.</span></span> 

- <span data-ttu-id="897a1-146">**Petites équipes spécialisées** :</span><span class="sxs-lookup"><span data-stu-id="897a1-146">**Small, focused teams**.</span></span> <span data-ttu-id="897a1-147">les équipes peuvent se concentrer sur un seul service.</span><span class="sxs-lookup"><span data-stu-id="897a1-147">Teams can focus on one service.</span></span> <span data-ttu-id="897a1-148">la portée de chaque service étant plus limitée, le code base est plus facile à comprendre et les nouveaux membres d’équipes s’intègrent plus facilement.</span><span class="sxs-lookup"><span data-stu-id="897a1-148">The smaller scope of each service makes the code base easier to understand, and it's easier for new team members to ramp up.</span></span>

- <span data-ttu-id="897a1-149">**Isolation des erreurs** :</span><span class="sxs-lookup"><span data-stu-id="897a1-149">**Fault isolation**.</span></span> <span data-ttu-id="897a1-150">si un service tombe en panne, il n’impacte pas l’ensemble de l’application.</span><span class="sxs-lookup"><span data-stu-id="897a1-150">If a service goes down, it won't take out the entire application.</span></span> <span data-ttu-id="897a1-151">Cependant, cela ne signifie pas pour autant que vous bénéficiez d’une résilience ex nihilo.</span><span class="sxs-lookup"><span data-stu-id="897a1-151">However, that doesn't mean you get resiliency for free.</span></span> <span data-ttu-id="897a1-152">Vous devez toujours suivre les bonnes pratiques de résilience et les modèles de conception.</span><span class="sxs-lookup"><span data-stu-id="897a1-152">You still need to follow resiliency best practices and design patterns.</span></span> <span data-ttu-id="897a1-153">Consultez [Conception d’applications résilientes pour Azure][resiliency-overview].</span><span class="sxs-lookup"><span data-stu-id="897a1-153">See [Designing resilient applications for Azure][resiliency-overview].</span></span>

- <span data-ttu-id="897a1-154">**Piles de technologies mixtes** :</span><span class="sxs-lookup"><span data-stu-id="897a1-154">**Mixed technology stacks**.</span></span> <span data-ttu-id="897a1-155">les équipes peuvent opter pour les technologies qui se prêtent le mieux à leur service.</span><span class="sxs-lookup"><span data-stu-id="897a1-155">Teams can pick the technology that best fits their service.</span></span> 

- <span data-ttu-id="897a1-156">**Mise à l’échelle précise** :</span><span class="sxs-lookup"><span data-stu-id="897a1-156">**Granular scaling**.</span></span> <span data-ttu-id="897a1-157">les services peuvent mis à l’échelle de manière indépendante.</span><span class="sxs-lookup"><span data-stu-id="897a1-157">Services can be scaled independently.</span></span> <span data-ttu-id="897a1-158">Dans le même temps, la plus grande densité des services par machine virtuelle signifie que les ressources des machines virtuelles sont entièrement exploitées.</span><span class="sxs-lookup"><span data-stu-id="897a1-158">At the same time, the higher density of services per VM means that VM resources are fully utilized.</span></span> <span data-ttu-id="897a1-159">En utilisant des contraintes de placement, un service peut être assorti à un profil de machine virtuelle (processeur rapide, mémoire volumineuse, etc.).</span><span class="sxs-lookup"><span data-stu-id="897a1-159">Using placement constraints, a services can be matched to a VM profile (high CPU, high memory, and so on).</span></span>

## <a name="challenges"></a><span data-ttu-id="897a1-160">Inconvénients</span><span class="sxs-lookup"><span data-stu-id="897a1-160">Challenges</span></span>

- <span data-ttu-id="897a1-161">**Complexité** :</span><span class="sxs-lookup"><span data-stu-id="897a1-161">**Complexity**.</span></span> <span data-ttu-id="897a1-162">une application de microservices possède plus d’éléments mobiles qu’une application monolithique équivalente.</span><span class="sxs-lookup"><span data-stu-id="897a1-162">A microservices application has more moving parts than the equivalent monolithic application.</span></span> <span data-ttu-id="897a1-163">Si chaque service est plus simple, le système dans son ensemble est plus complexe.</span><span class="sxs-lookup"><span data-stu-id="897a1-163">Each service is simpler, but the entire system as a whole is more complex.</span></span>

- <span data-ttu-id="897a1-164">**Développement et tests** :</span><span class="sxs-lookup"><span data-stu-id="897a1-164">**Development and test**.</span></span> <span data-ttu-id="897a1-165">développer avec des dépendances de services demande une approche différente.</span><span class="sxs-lookup"><span data-stu-id="897a1-165">Developing against service dependencies requires a different approach.</span></span> <span data-ttu-id="897a1-166">Les outils existants ne sont pas nécessairement conçus pour fonctionner avec des dépendances de services.</span><span class="sxs-lookup"><span data-stu-id="897a1-166">Existing tools are not necessarily designed to work with service dependencies.</span></span> <span data-ttu-id="897a1-167">Refactoriser au-delà des limites des services peut être une tâche ardue.</span><span class="sxs-lookup"><span data-stu-id="897a1-167">Refactoring across service boundaries can be difficult.</span></span> <span data-ttu-id="897a1-168">Il est aussi difficile de tester les dépendances de services, en particulier quand l’application évolue rapidement.</span><span class="sxs-lookup"><span data-stu-id="897a1-168">It is also challenging to test service dependencies, especially when the application is evolving quickly.</span></span>

- <span data-ttu-id="897a1-169">**Manque de gouvernance** :</span><span class="sxs-lookup"><span data-stu-id="897a1-169">**Lack of governance**.</span></span> <span data-ttu-id="897a1-170">l’approche décentralisée de création de microservices présente des avantages, mais elle peut aussi être une source de problèmes.</span><span class="sxs-lookup"><span data-stu-id="897a1-170">The decentralized approach to building microservices has advantages, but it can also lead to problems.</span></span> <span data-ttu-id="897a1-171">Vous pouvez en effet vous trouver face à une diversité de langages et de frameworks telle que l’application devient difficile à gérer.</span><span class="sxs-lookup"><span data-stu-id="897a1-171">You may end up with so many different languages and frameworks that the application becomes hard to maintain.</span></span> <span data-ttu-id="897a1-172">Il peut être utile de mettre en place certains standards à l’échelle du projet, sans trop amoindrir la flexibilité des équipes.</span><span class="sxs-lookup"><span data-stu-id="897a1-172">It may be useful to put some project-wide standards in place, without overly restricting teams' flexibility.</span></span> <span data-ttu-id="897a1-173">Cela vaut en particulier pour les fonctionnalités transversales, telles que la journalisation.</span><span class="sxs-lookup"><span data-stu-id="897a1-173">This especially applies to cross-cutting functionality such as logging.</span></span>

- <span data-ttu-id="897a1-174">**Surcharge du réseau et latence** :</span><span class="sxs-lookup"><span data-stu-id="897a1-174">**Network congestion and latency**.</span></span> <span data-ttu-id="897a1-175">l’utilisation de nombreux services granulaires de petite taille peut se traduire par une intensification des communications entre les services.</span><span class="sxs-lookup"><span data-stu-id="897a1-175">The use of many small, granular services can result in more interservice communication.</span></span> <span data-ttu-id="897a1-176">De même, si la chaîne des dépendances de services devient trop longue (le service A appelle le service B, qui appelle le service C, etc.), la latence supplémentaire qui s’ensuit peut devenir un problème.</span><span class="sxs-lookup"><span data-stu-id="897a1-176">Also, if the chain of service dependencies gets too long (service A calls B, which calls C...), the additional latency can become a problem.</span></span> <span data-ttu-id="897a1-177">Vous devrez faire preuve de circonspection au moment de concevoir des API.</span><span class="sxs-lookup"><span data-stu-id="897a1-177">You will need to design APIs carefully.</span></span> <span data-ttu-id="897a1-178">Évitez les API trop bavardes, envisagez des formats de sérialisation et cherchez à utiliser des modèles de communication asynchrone.</span><span class="sxs-lookup"><span data-stu-id="897a1-178">Avoid overly chatty APIs, think about serialization formats, and look for places to use asynchronous communication patterns.</span></span>

- <span data-ttu-id="897a1-179">**Intégrité des données** :</span><span class="sxs-lookup"><span data-stu-id="897a1-179">**Data integrity**.</span></span> <span data-ttu-id="897a1-180">chaque microservice étant responsable de la persistance de ses propres données,</span><span class="sxs-lookup"><span data-stu-id="897a1-180">With each microservice responsible for its own data persistence.</span></span> <span data-ttu-id="897a1-181">la cohérence des données peut être une gageure.</span><span class="sxs-lookup"><span data-stu-id="897a1-181">As a result, data consistency can be a challenge.</span></span> <span data-ttu-id="897a1-182">Adoptez la cohérence éventuelle dans la mesure du possible.</span><span class="sxs-lookup"><span data-stu-id="897a1-182">Embrace eventual consistency where possible.</span></span>

- <span data-ttu-id="897a1-183">**Gestion** :</span><span class="sxs-lookup"><span data-stu-id="897a1-183">**Management**.</span></span> <span data-ttu-id="897a1-184">une expérience réussie avec les microservices exige une culture DevOps mature.</span><span class="sxs-lookup"><span data-stu-id="897a1-184">To be successful with microservices requires a mature DevOps culture.</span></span> <span data-ttu-id="897a1-185">La mise en place d’une journalisation corrélée entre les services peut poser des problèmes.</span><span class="sxs-lookup"><span data-stu-id="897a1-185">Correlated logging across services can be challenging.</span></span> <span data-ttu-id="897a1-186">En règle générale, la journalisation doit mettre en corrélation plusieurs appels de services pour une même opération utilisateur.</span><span class="sxs-lookup"><span data-stu-id="897a1-186">Typically, logging must correlate multiple service calls for a single user operation.</span></span>

- <span data-ttu-id="897a1-187">**Gestion des versions** :</span><span class="sxs-lookup"><span data-stu-id="897a1-187">**Versioning**.</span></span> <span data-ttu-id="897a1-188">les mises à jour apportées à un service ne doivent pas perturber les services qui en dépendent.</span><span class="sxs-lookup"><span data-stu-id="897a1-188">Updates to a service must not break services that depend on it.</span></span> <span data-ttu-id="897a1-189">Plusieurs services pouvant être mis à jour à tout moment, sans une conception minutieuse, vous risquez de rencontrer des problèmes de compatibilité descendante ou ascendante.</span><span class="sxs-lookup"><span data-stu-id="897a1-189">Multiple services could be updated at any given time, so without careful design, you might have problems with backward or forward compatibility.</span></span>

- <span data-ttu-id="897a1-190">**Compétences** :</span><span class="sxs-lookup"><span data-stu-id="897a1-190">**Skillset**.</span></span> <span data-ttu-id="897a1-191">les microservices sont des systèmes hautement distribués.</span><span class="sxs-lookup"><span data-stu-id="897a1-191">Microservices are highly distributed systems.</span></span> <span data-ttu-id="897a1-192">Évaluez avec soin les chances de réussite en tenant compte des compétences et de l’expérience de l’équipe.</span><span class="sxs-lookup"><span data-stu-id="897a1-192">Carefully evaluate whether the team has the skills and experience to be successful.</span></span>

## <a name="best-practices"></a><span data-ttu-id="897a1-193">Bonnes pratiques</span><span class="sxs-lookup"><span data-stu-id="897a1-193">Best practices</span></span>

- <span data-ttu-id="897a1-194">Modélisez les services autour du domaine de l’entreprise.</span><span class="sxs-lookup"><span data-stu-id="897a1-194">Model services around the business domain.</span></span> 

- <span data-ttu-id="897a1-195">Décentralisez tout.</span><span class="sxs-lookup"><span data-stu-id="897a1-195">Decentralize everything.</span></span> <span data-ttu-id="897a1-196">Les équipes individuelles sont chargées de concevoir et de créer des services.</span><span class="sxs-lookup"><span data-stu-id="897a1-196">Individual teams are responsible for designing and building services.</span></span> <span data-ttu-id="897a1-197">Évitez de partager du code ou des schémas de données.</span><span class="sxs-lookup"><span data-stu-id="897a1-197">Avoid sharing code or data schemas.</span></span> 

- <span data-ttu-id="897a1-198">Le stockage de données doit être privé par rapport au service qui détient les données.</span><span class="sxs-lookup"><span data-stu-id="897a1-198">Data storage should be private to the service that owns the data.</span></span> <span data-ttu-id="897a1-199">Utilisez le stockage le mieux adapté à chaque service et type de données.</span><span class="sxs-lookup"><span data-stu-id="897a1-199">Use the best storage for each service and data type.</span></span> 

- <span data-ttu-id="897a1-200">Les services communiquent via des API bien conçues.</span><span class="sxs-lookup"><span data-stu-id="897a1-200">Services communicate through well-designed APIs.</span></span> <span data-ttu-id="897a1-201">Évitez de divulguer les détails d’une implémentation.</span><span class="sxs-lookup"><span data-stu-id="897a1-201">Avoid leaking implementation details.</span></span> <span data-ttu-id="897a1-202">Les API doivent modéliser le domaine, et non l’implémentation interne du service.</span><span class="sxs-lookup"><span data-stu-id="897a1-202">APIs should model the domain, not the internal implementation of the service.</span></span>

- <span data-ttu-id="897a1-203">Évitez le couplage entre les services.</span><span class="sxs-lookup"><span data-stu-id="897a1-203">Avoid coupling between services.</span></span> <span data-ttu-id="897a1-204">Le couplage trouve souvent son origine dans les schémas de base de données partagés et les protocoles de communication rigides.</span><span class="sxs-lookup"><span data-stu-id="897a1-204">Causes of coupling include shared database schemas and rigid communication protocols.</span></span>

- <span data-ttu-id="897a1-205">Déchargez les problèmes transversaux, tels que l’authentification et la terminaison SSL, sur la passerelle.</span><span class="sxs-lookup"><span data-stu-id="897a1-205">Offload cross-cutting concerns, such as authentication and SSL termination, to the gateway.</span></span>

- <span data-ttu-id="897a1-206">Maintenez la connaissance du domaine à l’extérieur de la passerelle.</span><span class="sxs-lookup"><span data-stu-id="897a1-206">Keep domain knowledge out of the gateway.</span></span> <span data-ttu-id="897a1-207">La passerelle doit traiter et acheminer les demandes des clients sans connaître les règles d’entreprise ou la logique du domaine.</span><span class="sxs-lookup"><span data-stu-id="897a1-207">The gateway should handle and route client requests without any knowledge of the business rules or domain logic.</span></span> <span data-ttu-id="897a1-208">Sinon, la passerelle devient une dépendance et peut provoquer un couplage entre les services.</span><span class="sxs-lookup"><span data-stu-id="897a1-208">Otherwise, the gateway becomes a dependency and can cause coupling between services.</span></span>

- <span data-ttu-id="897a1-209">Le couplage entre les services doit être faible et leur cohésion fonctionnelle élevée.</span><span class="sxs-lookup"><span data-stu-id="897a1-209">Services should have loose coupling and high functional cohesion.</span></span> <span data-ttu-id="897a1-210">Les fonctions susceptibles de changer en même temps doivent être empaquetées et déployées ensemble.</span><span class="sxs-lookup"><span data-stu-id="897a1-210">Functions that are likely to change together should be packaged and deployed together.</span></span> <span data-ttu-id="897a1-211">Si elles résident dans des services distincts, ces services finissent par être fortement couplés, car une modification dans un service nécessite la mise à jour de l’autre service.</span><span class="sxs-lookup"><span data-stu-id="897a1-211">If they reside in separate services, those services end up being tightly coupled, because a change in one service will require updating the other service.</span></span> <span data-ttu-id="897a1-212">Une communication proéminente entre deux services peut être le signe d’un couplage étroit et d’une faible cohésion.</span><span class="sxs-lookup"><span data-stu-id="897a1-212">Overly chatty communication between two services may be a symptom of tight coupling and low cohesion.</span></span> 

- <span data-ttu-id="897a1-213">Isolez les défaillances.</span><span class="sxs-lookup"><span data-stu-id="897a1-213">Isolate failures.</span></span> <span data-ttu-id="897a1-214">Utilisez des stratégies de résilience pour empêcher que les défaillances au sein d’un service se répercutent en cascade.</span><span class="sxs-lookup"><span data-stu-id="897a1-214">Use resiliency strategies to prevent failures within a service from cascading.</span></span> <span data-ttu-id="897a1-215">Consultez [Modèles de résilience][resiliency-patterns] et [Conception d’applications résilientes][resiliency-overview].</span><span class="sxs-lookup"><span data-stu-id="897a1-215">See [Resiliency patterns][resiliency-patterns] and [Designing resilient applications][resiliency-overview].</span></span>

## <a name="microservices-using-azure-container-service"></a><span data-ttu-id="897a1-216">Microservices et Azure Container Service</span><span class="sxs-lookup"><span data-stu-id="897a1-216">Microservices using Azure Container Service</span></span> 

<span data-ttu-id="897a1-217">Vous pouvez utiliser Azure Container Service pour configurer et provisionner un cluster Docker.</span><span class="sxs-lookup"><span data-stu-id="897a1-217">You can use Azure Container Service to configure and provision a Docker cluster.</span></span> <span data-ttu-id="897a1-218">Azure Container Services prend en charge plusieurs conteneurs et orchestrateurs courants, dont Kubernetes, DC/OS et Docker Swarm.</span><span class="sxs-lookup"><span data-stu-id="897a1-218">Azure Container Services supports several popular container orchestrators, including Kubernetes, DC/OS, and Docker Swarm.</span></span>

![](./images/microservices-acs.png)
 
<span data-ttu-id="897a1-219">**Nœuds publics** :</span><span class="sxs-lookup"><span data-stu-id="897a1-219">**Public nodes**.</span></span> <span data-ttu-id="897a1-220">ces nœuds sont accessibles via un équilibreur de charge public.</span><span class="sxs-lookup"><span data-stu-id="897a1-220">These nodes are reachable through a public-facing load balancer.</span></span> <span data-ttu-id="897a1-221">La passerelle d’API est hébergée sur ces nœuds.</span><span class="sxs-lookup"><span data-stu-id="897a1-221">The API gateway is hosted on these nodes.</span></span>

<span data-ttu-id="897a1-222">**Nœuds backend** :</span><span class="sxs-lookup"><span data-stu-id="897a1-222">**Backend nodes**.</span></span> <span data-ttu-id="897a1-223">ces nœuds exécutent des services auxquels les clients accèdent via la passerelle d’API.</span><span class="sxs-lookup"><span data-stu-id="897a1-223">These nodes run services that clients reach via the API gateway.</span></span> <span data-ttu-id="897a1-224">Ces nœuds ne reçoivent pas directement de trafic Internet.</span><span class="sxs-lookup"><span data-stu-id="897a1-224">These nodes don't receive Internet traffic directly.</span></span> <span data-ttu-id="897a1-225">Les nœuds backend peuvent englober plusieurs pools de machines virtuelles, chacun avec un profil matériel différent.</span><span class="sxs-lookup"><span data-stu-id="897a1-225">The backend nodes might include more than one pool of VMs, each with a different hardware profile.</span></span> <span data-ttu-id="897a1-226">Par exemple, vous pouvez créer des pools distincts pour des charges de travail de calcul générales, des charges de travail processeur élevées et des charges de travail mémoire élevées.</span><span class="sxs-lookup"><span data-stu-id="897a1-226">For example, you could create separate pools for general compute workloads, high CPU workloads, and high memory workloads.</span></span> 

<span data-ttu-id="897a1-227">**Machines virtuelles de gestion** :</span><span class="sxs-lookup"><span data-stu-id="897a1-227">**Management VMs**.</span></span> <span data-ttu-id="897a1-228">ces machines virtuelles exécutent les nœuds principaux de l’orchestrateur de conteneur.</span><span class="sxs-lookup"><span data-stu-id="897a1-228">These VMs run the master nodes for the container orchestrator.</span></span> 

<span data-ttu-id="897a1-229">**Mise en réseau** :</span><span class="sxs-lookup"><span data-stu-id="897a1-229">**Networking**.</span></span> <span data-ttu-id="897a1-230">les nœuds publics, les nœuds backend et les machines virtuelles de gestion sont placés dans des sous-réseaux distincts au sein d’un même réseau virtuel (VNet).</span><span class="sxs-lookup"><span data-stu-id="897a1-230">The public nodes, backend nodes, and management VMs are placed in separate subnets within the same virtual network (VNet).</span></span> 

<span data-ttu-id="897a1-231">**Équilibreurs de charge** :</span><span class="sxs-lookup"><span data-stu-id="897a1-231">**Load balancers**.</span></span>  <span data-ttu-id="897a1-232">un équilibreur de charge externe fait face aux nœuds publics.</span><span class="sxs-lookup"><span data-stu-id="897a1-232">An externally facing load balancer sits in front of the public nodes.</span></span> <span data-ttu-id="897a1-233">Il distribue les demandes Internet aux nœuds publics.</span><span class="sxs-lookup"><span data-stu-id="897a1-233">It distributes internet requests to the public nodes.</span></span> <span data-ttu-id="897a1-234">Un autre équilibreur de charge est placé devant les machines virtuelles de gestion pour autoriser le trafic Secure Shell (SSH) vers les machines virtuelles de gestion, en utilisant des règles NAT.</span><span class="sxs-lookup"><span data-stu-id="897a1-234">Another load balancer is placed in front of the management VMs, to allow secure shell (ssh) traffic to the management VMs, using NAT rules.</span></span>

<span data-ttu-id="897a1-235">Pour des besoins de fiabilité et de scalabilité, chaque service est répliqué sur plusieurs machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="897a1-235">For reliability and scalability, each service is replicated across multiple VMs.</span></span> <span data-ttu-id="897a1-236">Mais comme les services sont aussi relativement légers (par rapport à une application monolithique), ils sont généralement plusieurs à être empaquetés dans une même machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="897a1-236">However, because services are also relatively lightweight (compared with a monolithic application), multiple services are usually packed into a single VM.</span></span> <span data-ttu-id="897a1-237">Cette plus forte densité autorise une meilleure utilisation des ressources.</span><span class="sxs-lookup"><span data-stu-id="897a1-237">Higher density allows better resource utilization.</span></span> <span data-ttu-id="897a1-238">Si un service déterminé n’utilise pas beaucoup de ressources, vous n’avez pas besoin de dédier une machine virtuelle entière à l’exécution de ce service.</span><span class="sxs-lookup"><span data-stu-id="897a1-238">If a particular service doesn't use a lot of resources, you don't need to dedicate an entire VM to running that service.</span></span>

<span data-ttu-id="897a1-239">Le diagramme suivant illustre trois nœuds exécutant quatre services différents (indiqués par différentes formes).</span><span class="sxs-lookup"><span data-stu-id="897a1-239">The following diagram shows three nodes running four different services (indicated by different shapes).</span></span> <span data-ttu-id="897a1-240">Notez que chaque service compte au moins deux instances.</span><span class="sxs-lookup"><span data-stu-id="897a1-240">Notice that each service has at least two instances.</span></span> 
 
![](./images/microservices-node-density.png)

## <a name="microservices-using-azure-service-fabric"></a><span data-ttu-id="897a1-241">Microservices et Azure Service Fabric</span><span class="sxs-lookup"><span data-stu-id="897a1-241">Microservices using Azure Service Fabric</span></span>

<span data-ttu-id="897a1-242">Le diagramme suivant illustre une architecture de microservices utilisant Azure Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="897a1-242">The following diagram shows a microservices architecture using Azure Service Fabric.</span></span>

![](./images/service-fabric.png)

<span data-ttu-id="897a1-243">Le cluster Service Fabric est déployé sur un ou plusieurs groupes de machines virtuelles identiques.</span><span class="sxs-lookup"><span data-stu-id="897a1-243">The Service Fabric Cluster is deployed to one or more VM scale sets.</span></span> <span data-ttu-id="897a1-244">Le cluster peut être constitué de plusieurs groupes de machines virtuelles identiques pour profiter d’une combinaison de types de machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="897a1-244">You might have more than one VM scale set in the cluster, in order to have a mix of VM types.</span></span> <span data-ttu-id="897a1-245">Une passerelle d’API est placée devant le cluster Service Fabric, avec un équilibreur de charge externe pour réceptionner les demandes des clients.</span><span class="sxs-lookup"><span data-stu-id="897a1-245">An API Gateway is placed in front of the Service Fabric cluster, with an external load balancer to receive client requests.</span></span>

<span data-ttu-id="897a1-246">Le runtime Service Fabric assure la gestion du cluster, notamment le placement des services, le basculement des nœuds et le contrôle d’intégrité.</span><span class="sxs-lookup"><span data-stu-id="897a1-246">The Service Fabric runtime performs cluster management, including service placement, node failover, and health monitoring.</span></span> <span data-ttu-id="897a1-247">Le runtime est déployé sur les nœuds du cluster proprement dits.</span><span class="sxs-lookup"><span data-stu-id="897a1-247">The runtime is deployed on the cluster nodes themselves.</span></span> <span data-ttu-id="897a1-248">Il n’existe pas d’ensemble distinct de machines virtuelles de gestion de cluster.</span><span class="sxs-lookup"><span data-stu-id="897a1-248">There isn't a separate set of cluster management VMs.</span></span>

<span data-ttu-id="897a1-249">Les services communiquent entre eux via le proxy inverse intégré à Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="897a1-249">Services communicate with each other using the reverse proxy that is built into Service Fabric.</span></span> <span data-ttu-id="897a1-250">Service Fabric propose un service de découverte qui peut résoudre le point de terminaison pour un service nommé.</span><span class="sxs-lookup"><span data-stu-id="897a1-250">Service Fabric provides a discovery service that can resolve the endpoint for a named service.</span></span>


<!-- links -->

[resiliency-overview]: ../../resiliency/index.md
[resiliency-patterns]: ../../patterns/category/resiliency.md



