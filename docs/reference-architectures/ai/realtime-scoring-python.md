---
title: Scoring en temps réel des modèles de Python
titleSuffix: Azure Reference Architectures
description: Cette architecture de référence montre comment déployer des modèles Python en tant que services web sur Azure pour élaborer des prédictions en temps réel.
author: msalvaris
ms.date: 11/09/2018
ms.topic: reference-architecture
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: azcat-ai
ms.openlocfilehash: 135e86b447684efd9f54340eda4b6bf6e4c35bbb
ms.sourcegitcommit: 1b50810208354577b00e89e5c031b774b02736e2
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/23/2019
ms.locfileid: "54487676"
---
# <a name="real-time-scoring-of-python-scikit-learn-and-deep-learning-models-on-azure"></a><span data-ttu-id="caedf-103">Scoring en temps réel des modèles Python Scikit-Learn et Apprentissage profond sur Azure</span><span class="sxs-lookup"><span data-stu-id="caedf-103">Real-time scoring of Python Scikit-Learn and deep learning models on Azure</span></span>

<span data-ttu-id="caedf-104">Cette architecture de référence montre comment déployer des modèles Python en tant que services web pour élaborer des prédictions en temps réel.</span><span class="sxs-lookup"><span data-stu-id="caedf-104">This reference architecture shows how to deploy Python models as web services to make real-time predictions.</span></span> <span data-ttu-id="caedf-105">Deux scénarios sont couverts : le déploiement de modèles Python standards et les exigences spécifiques du déploiement de modèles d’apprentissage profond.</span><span class="sxs-lookup"><span data-stu-id="caedf-105">Two scenarios are covered: deploying regular Python models, and the specific requirements of deploying deep learning models.</span></span> <span data-ttu-id="caedf-106">Les deux scénarios utilisent l’architecture illustrée.</span><span class="sxs-lookup"><span data-stu-id="caedf-106">Both scenarios use the architecture shown.</span></span>

<span data-ttu-id="caedf-107">Deux implémentations de référence pour cette architecture sont disponibles sur GitHub, une pour [les modèles Python standards][github-python] et l’autre pour [les modèles d’apprentissage profond][github-dl].</span><span class="sxs-lookup"><span data-stu-id="caedf-107">Two reference implementations for this architecture are available on GitHub, one for [regular Python models][github-python] and one for [deep learning models][github-dl].</span></span>

![Diagramme d’architecture pour le scoring en temps réel des modèles Python sur Azure](./_images/python-model-architecture.png)

## <a name="scenarios"></a><span data-ttu-id="caedf-109">Scénarios</span><span class="sxs-lookup"><span data-stu-id="caedf-109">Scenarios</span></span>

<span data-ttu-id="caedf-110">Les implémentations de référence montrent deux scénarios à l’aide de cette architecture.</span><span class="sxs-lookup"><span data-stu-id="caedf-110">The reference implementations demonstrate two scenarios using this architecture.</span></span>

<span data-ttu-id="caedf-111">**Scénario 1 : Correspondance du Forum aux questions**.</span><span class="sxs-lookup"><span data-stu-id="caedf-111">**Scenario 1: FAQ matching**.</span></span> <span data-ttu-id="caedf-112">Ce scénario montre comment déployer un modèle de correspondance des questions fréquentes (FAQ) comme un service web pour fournir des prédictions pour les questions de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="caedf-112">This scenario shows how to deploy a frequently asked questions (FAQ) matching model as a web service to provide predictions for user questions.</span></span> <span data-ttu-id="caedf-113">Pour ce scénario, la mention « Entrée de données » dans le diagramme d’architecture fait référence aux chaînes de texte contenant les questions de l’utilisateur à faire correspondre avec une liste des questions fréquentes.</span><span class="sxs-lookup"><span data-stu-id="caedf-113">For this scenario, "Input Data" in the architecture diagram refers to text strings containing user questions to match with a list of FAQs.</span></span> <span data-ttu-id="caedf-114">Ce scénario est conçu pour la bibliothèque de Machine Learning [scikit-learn][scikit] pour Python, mais il peut être étendu à n’importe quel scénario utilisant des modèles Python pour effectuer des prédictions en temps réel.</span><span class="sxs-lookup"><span data-stu-id="caedf-114">This scenario is designed for the [scikit-learn][scikit] machine learning library for Python, but can be generalized to any scenario that uses Python models to make real-time predictions.</span></span>

<span data-ttu-id="caedf-115">Ce scénario utilise un sous-ensemble de données de question Stack Overflow qui comprend des questions d’origine marquées comme JavaScript, leurs questions dupliquées et leurs réponses.</span><span class="sxs-lookup"><span data-stu-id="caedf-115">This scenario uses a subset of Stack Overflow question data that includes original questions tagged as JavaScript, their duplicate questions, and their answers.</span></span> <span data-ttu-id="caedf-116">Il effectue l’apprentissage d’un pipeline scikit-learn pour prédire la probabilité de correspondance d’une question dupliquée avec chacune des questions d’origine.</span><span class="sxs-lookup"><span data-stu-id="caedf-116">It trains a scikit-learn pipeline to predict the match probability of a duplicate question with each of the original questions.</span></span> <span data-ttu-id="caedf-117">Ces prédictions sont faites en temps réel à l’aide d’un point de terminaison API REST.</span><span class="sxs-lookup"><span data-stu-id="caedf-117">These predictions are made in real time using a REST API endpoint.</span></span>

<span data-ttu-id="caedf-118">Le flux d’application pour cette architecture est le suivant :</span><span class="sxs-lookup"><span data-stu-id="caedf-118">The application flow for this architecture is as follows:</span></span>

1. <span data-ttu-id="caedf-119">Le client envoie une requête HTTP POST avec les données encodées de la question.</span><span class="sxs-lookup"><span data-stu-id="caedf-119">The client sends an HTTP POST request with the encoded question data.</span></span>

2. <span data-ttu-id="caedf-120">L’application Flask extrait la question à partir de la requête.</span><span class="sxs-lookup"><span data-stu-id="caedf-120">The Flask app extracts the question from the request.</span></span>

3. <span data-ttu-id="caedf-121">La question est envoyée au modèle de pipeline scikit-learn pour la personnalisation et le scoring.</span><span class="sxs-lookup"><span data-stu-id="caedf-121">The question is sent to the scikit-learn pipeline model for featurization and scoring.</span></span>

4. <span data-ttu-id="caedf-122">Les questions fréquentes correspondantes avec leurs scores sont transmises dans un objet JSON et retournées au client.</span><span class="sxs-lookup"><span data-stu-id="caedf-122">The matching FAQ questions with their scores are piped into a JSON object and returned to the client.</span></span>

<span data-ttu-id="caedf-123">Voici une capture d’écran de l’exemple d’application qui consomme les résultats :</span><span class="sxs-lookup"><span data-stu-id="caedf-123">Here is a screenshot of the example app that consumes the results:</span></span>

![Capture d’écran de l’exemple d’application](./_images/python-faq-matches.png)

<span data-ttu-id="caedf-125">**Scénario 2 : Classification d’image**.</span><span class="sxs-lookup"><span data-stu-id="caedf-125">**Scenario 2: Image classification**.</span></span> <span data-ttu-id="caedf-126">Ce scénario montre comment déployer un modèle de réseau de neurones convolutifs (CNN) comme un service web pour fournir des prévisions sur des images.</span><span class="sxs-lookup"><span data-stu-id="caedf-126">This scenario shows how to deploy a Convolutional Neural Network (CNN) model as a web service to provide predictions on images.</span></span> <span data-ttu-id="caedf-127">Pour ce scénario, la mention « Entrée de données » dans le diagramme d’architecture fait référence aux fichiers d’image.</span><span class="sxs-lookup"><span data-stu-id="caedf-127">For this scenario, "Input Data" in the architecture diagram refers to image files.</span></span> <span data-ttu-id="caedf-128">Les CNN sont très efficaces dans la vision par ordinateur pour des tâches telles que la classification d’images et la détection d’objets.</span><span class="sxs-lookup"><span data-stu-id="caedf-128">CNNs are very effective in computer vision for tasks such as image classification and object detection.</span></span> <span data-ttu-id="caedf-129">Ce scénario est conçu pour les infrastructures TensorFlow, Keras (avec le serveur principal TensorFlow) et PyTorch.</span><span class="sxs-lookup"><span data-stu-id="caedf-129">This scenario is designed for the frameworks TensorFlow, Keras (with the TensorFlow back end), and PyTorch.</span></span> <span data-ttu-id="caedf-130">Toutefois, il peut être généralisé aux scénarios utilisant des modèles d’apprentissage profond pour effectuer des prédictions en temps réel.</span><span class="sxs-lookup"><span data-stu-id="caedf-130">However, it can be generalized to any scenario that uses deep learning models to make real-time predictions.</span></span>

<span data-ttu-id="caedf-131">Ce scénario utilise un modèle ResNet-152 préentraîné formé sur un jeu de données ImageNet-1 K (1 000 classes) pour prédire la catégorie (voir la figure ci-dessous) à laquelle appartient une image.</span><span class="sxs-lookup"><span data-stu-id="caedf-131">This scenario uses a pre-trained ResNet-152 model trained on ImageNet-1K (1,000 classes) dataset to predict which category (see figure below) an image belongs to.</span></span> <span data-ttu-id="caedf-132">Ces prédictions sont faites en temps réel à l’aide d’un point de terminaison API REST.</span><span class="sxs-lookup"><span data-stu-id="caedf-132">These predictions are made in real time using a REST API endpoint.</span></span>

![Exemple de prédictions](./_images/python-example-predictions.png)

<span data-ttu-id="caedf-134">Le flux d’application pour le modèle d’apprentissage profond est comme suit :</span><span class="sxs-lookup"><span data-stu-id="caedf-134">The application flow for the deep learning model is as follows:</span></span>

1. <span data-ttu-id="caedf-135">Le client envoie une requête HTTP POST avec les données encodées de l’image.</span><span class="sxs-lookup"><span data-stu-id="caedf-135">The client sends an HTTP POST request with the encoded image data.</span></span>

2. <span data-ttu-id="caedf-136">L’application Flask extrait l’image à partir de la requête.</span><span class="sxs-lookup"><span data-stu-id="caedf-136">The Flask app extracts the image from the request.</span></span>

3. <span data-ttu-id="caedf-137">L’image est prétraitée et envoyée au modèle pour le scoring.</span><span class="sxs-lookup"><span data-stu-id="caedf-137">The image is preprocessed and sent to the model for scoring.</span></span>

4. <span data-ttu-id="caedf-138">Le résultat du scoring est transmis dans un objet JSON et retourné au client.</span><span class="sxs-lookup"><span data-stu-id="caedf-138">The scoring result is piped into a JSON object and returned to the client.</span></span>

## <a name="architecture"></a><span data-ttu-id="caedf-139">Architecture</span><span class="sxs-lookup"><span data-stu-id="caedf-139">Architecture</span></span>

<span data-ttu-id="caedf-140">Cette architecture est constituée des composants suivants.</span><span class="sxs-lookup"><span data-stu-id="caedf-140">This architecture consists of the following components.</span></span>

<span data-ttu-id="caedf-141">**[Machine virtuelle][vm]**.</span><span class="sxs-lookup"><span data-stu-id="caedf-141">**[Virtual machine][vm]** (VM).</span></span> <span data-ttu-id="caedf-142">La machine virtuelle est affichée comme un exemple d’appareil &mdash; local ou dans le cloud &mdash; pouvant envoyer une requête HTTP.</span><span class="sxs-lookup"><span data-stu-id="caedf-142">The VM is shown as an example of a device &mdash; local or in the cloud &mdash; that can send an HTTP request.</span></span>

<span data-ttu-id="caedf-143">**[Azure Kubernetes Service][aks]** (AKS) est utilisé pour déployer l’application au sein d’un cluster Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="caedf-143">**[Azure Kubernetes Service][aks]** (AKS) is used to deploy the application on a Kubernetes cluster.</span></span> <span data-ttu-id="caedf-144">AKS simplifie le déploiement et les opérations de Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="caedf-144">AKS simplifies the deployment and operations of Kubernetes.</span></span> <span data-ttu-id="caedf-145">Le cluster peut être configuré à l’aide de machines virtuelles compatibles processeur uniquement pour des modèles Python standards ou des machines virtuelles compatibles GPU pour les modèles d’apprentissage profond.</span><span class="sxs-lookup"><span data-stu-id="caedf-145">The cluster can be configured using CPU-only VMs for regular Python models or GPU-enabled VMs for deep learning models.</span></span>

<span data-ttu-id="caedf-146">**[Équilibreur de charge][lb]**.</span><span class="sxs-lookup"><span data-stu-id="caedf-146">**[Load balancer][lb]**.</span></span> <span data-ttu-id="caedf-147">Un équilibreur de charge approvisionné par AKS est utilisé pour exposer le service en externe.</span><span class="sxs-lookup"><span data-stu-id="caedf-147">A load balancer, provisioned by AKS, is used to expose the service externally.</span></span> <span data-ttu-id="caedf-148">Le trafic venant de l’équilibreur de charge est dirigé vers les pods principaux.</span><span class="sxs-lookup"><span data-stu-id="caedf-148">Traffic from the load balancer is directed to the back-end pods.</span></span>

<span data-ttu-id="caedf-149">**[Docker Hub][docker]** est utilisé pour stocker l’image Docker déployée sur un cluster Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="caedf-149">**[Docker Hub][docker]** is used to store the Docker image that is deployed on Kubernetes cluster.</span></span> <span data-ttu-id="caedf-150">DockerHub a été choisi pour cette architecture, car il est simple d’utilisation et constitue le référentiel d’images par défaut des utilisateurs de Docker.</span><span class="sxs-lookup"><span data-stu-id="caedf-150">Docker Hub was chosen for this architecture because it's easy to use and is the default image repository for Docker users.</span></span> <span data-ttu-id="caedf-151">[Azure Container Registry][acr] peut aussi être utilisé pour cette architecture.</span><span class="sxs-lookup"><span data-stu-id="caedf-151">[Azure Container Registry][acr] can also be used for this architecture.</span></span>

## <a name="performance-considerations"></a><span data-ttu-id="caedf-152">Considérations relatives aux performances</span><span class="sxs-lookup"><span data-stu-id="caedf-152">Performance considerations</span></span>

<span data-ttu-id="caedf-153">Pour les architectures de scoring en temps réel, les performances de débit constituent un facteur important.</span><span class="sxs-lookup"><span data-stu-id="caedf-153">For real-time scoring architectures, throughput performance becomes a dominant consideration.</span></span> <span data-ttu-id="caedf-154">Pour les modèles Python standards, il est généralement admis que les processeurs sont suffisants pour gérer la charge de travail.</span><span class="sxs-lookup"><span data-stu-id="caedf-154">For regular Python models, it's generally accepted that CPUs are sufficient to handle the workload.</span></span>

<span data-ttu-id="caedf-155">Toutefois pour les charges de travail d’apprentissage profond, où la vitesse constitue un goulot d’étranglement, les GPU offrent généralement de meilleures [performances][gpus-vs-cpus] par rapport aux processeurs.</span><span class="sxs-lookup"><span data-stu-id="caedf-155">However for deep learning workloads, when speed is a bottleneck, GPUs generally provide better [performance][gpus-vs-cpus] compared to CPUs.</span></span> <span data-ttu-id="caedf-156">Pour faire correspondre les performances de GPU en utilisant des processeurs, un cluster disposant d’un grand nombre de processeurs est généralement nécessaire.</span><span class="sxs-lookup"><span data-stu-id="caedf-156">To match GPU performance using CPUs, a cluster with large number of CPUs is usually needed.</span></span>

<span data-ttu-id="caedf-157">Vous pouvez utiliser des processeurs pour cette architecture dans les deux cas, mais pour les modèles d’apprentissage profond, les GPU offrent des débits considérablement supérieurs par rapport à un cluster de processeurs d’un coût similaire.</span><span class="sxs-lookup"><span data-stu-id="caedf-157">You can use CPUs for this architecture in either scenario, but for deep learning models, GPUs provide significantly higher throughput values compared to a CPU cluster of similar cost.</span></span> <span data-ttu-id="caedf-158">AKS prend en charge l’utilisation de GPU, qui est l’un des avantages de l’utilisation d’AKS pour cette architecture.</span><span class="sxs-lookup"><span data-stu-id="caedf-158">AKS supports the use of GPUs, which is one advantage of using AKS for this architecture.</span></span> <span data-ttu-id="caedf-159">En outre, les déploiements d’apprentissage profond utilisent généralement modèles comportant un grand nombre de paramètres.</span><span class="sxs-lookup"><span data-stu-id="caedf-159">Also, deep learning deployments typically use models with a high number of parameters.</span></span> <span data-ttu-id="caedf-160">L’utilisation des GPU empêche la contention de ressources entre le modèle et le service web, ce qui constitue un problème dans les déploiements constitués uniquement de processeurs.</span><span class="sxs-lookup"><span data-stu-id="caedf-160">Using GPUs prevents contention for resources between the model and the web service, which is an issue in CPU-only deployments.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="caedf-161">Considérations relatives à l’extensibilité</span><span class="sxs-lookup"><span data-stu-id="caedf-161">Scalability considerations</span></span>

<span data-ttu-id="caedf-162">Pour les modèles Python standards, où le cluster AKS est fourni avec des machines virtuelles pourvues uniquement de processeurs, faites attention lors de [l’extension du nombre de pods][manually-scale-pods].</span><span class="sxs-lookup"><span data-stu-id="caedf-162">For regular Python models, where AKS cluster is provisioned with CPU-only VMs, take care when [scaling out the number of pods][manually-scale-pods].</span></span> <span data-ttu-id="caedf-163">L’objectif est d’utiliser pleinement le cluster.</span><span class="sxs-lookup"><span data-stu-id="caedf-163">The goal is to fully utilize the cluster.</span></span> <span data-ttu-id="caedf-164">L’extensibilité dépend des requêtes du processeur et des limites définies pour les pods.</span><span class="sxs-lookup"><span data-stu-id="caedf-164">Scaling depends on the CPU requests and limits defined for the pods.</span></span> <span data-ttu-id="caedf-165">Kubernetes prend également en charge [l’extension automatique][autoscale-pods] des pods pour ajuster le nombre de pods dans un déploiement en fonction de l’utilisation du processeur ou d’autres métriques.</span><span class="sxs-lookup"><span data-stu-id="caedf-165">Kubernetes also supports [autoscaling][autoscale-pods] of the pods to adjust the number of pods in a deployment depending on CPU utilization or other select metrics.</span></span> <span data-ttu-id="caedf-166">L’[autoscaler de cluster][autoscaler] (en préversion) peut mettre à l’échelle vos nœuds d’agent en fonction des pods en attente.</span><span class="sxs-lookup"><span data-stu-id="caedf-166">The [cluster autoscaler][autoscaler] (in preview) can scale agent nodes based on pending pods.</span></span>

<span data-ttu-id="caedf-167">Pour des scénarios d’apprentissage profond, à l’aide de machines virtuelles compatibles GPU, les limites de ressources sur les pods sont telles qu’un GPU est attribué à un pod.</span><span class="sxs-lookup"><span data-stu-id="caedf-167">For deep learning scenarios, using GPU-enabled VMs, resource limits on pods are such that one GPU is assigned to one pod.</span></span> <span data-ttu-id="caedf-168">Selon le type de machine virtuelle utilisé, vous devez [mettre à l’échelle les nœuds du cluster][scale-cluster] pour répondre à la demande du service.</span><span class="sxs-lookup"><span data-stu-id="caedf-168">Depending on the type of VM used, you must [scale the nodes of the cluster][scale-cluster] to meet the demand for the service.</span></span> <span data-ttu-id="caedf-169">Vous pouvez faire cela facilement à l’aide d’Azure CLI et de kubectl.</span><span class="sxs-lookup"><span data-stu-id="caedf-169">You can do this easily using the Azure CLI and kubectl.</span></span>

## <a name="monitoring-and-logging-considerations"></a><span data-ttu-id="caedf-170">Supervision et enregistrement des considérations</span><span class="sxs-lookup"><span data-stu-id="caedf-170">Monitoring and logging considerations</span></span>

### <a name="aks-monitoring"></a><span data-ttu-id="caedf-171">Supervision AKS</span><span class="sxs-lookup"><span data-stu-id="caedf-171">AKS monitoring</span></span>

<span data-ttu-id="caedf-172">Pour visualiser les performances de AKS, utilisez la fonctionnalité [Azure Monitor pour les conteneurs][monitor-containers].</span><span class="sxs-lookup"><span data-stu-id="caedf-172">For visibility into AKS performance, use the [Azure Monitor for containers][monitor-containers] feature.</span></span> <span data-ttu-id="caedf-173">Cela collecte des métriques sur la mémoire et le processeur à partir des contrôleurs, des nœuds et des conteneurs qui sont disponibles dans Kubernetes via l’API Metrics.</span><span class="sxs-lookup"><span data-stu-id="caedf-173">It collects memory and processor metrics from controllers, nodes, and containers that are available in Kubernetes through the Metrics API.</span></span>

<span data-ttu-id="caedf-174">Lors du déploiement de votre application, surveillez le cluster AKS pour vous assurer qu’il fonctionne comme prévu, tous les nœuds sont opérationnels, et tous les pods sont en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="caedf-174">While deploying your application, monitor the AKS cluster to make sure it's working as expected, all the nodes are operational, and all pods are running.</span></span> <span data-ttu-id="caedf-175">Bien que vous puissiez utiliser l’outil en ligne de commande [kubectl][kubectl] pour récupérer l’état du pod, Kubernetes comprend également un tableau de bord web pour la surveillance de l’état du cluster et la gestion de base.</span><span class="sxs-lookup"><span data-stu-id="caedf-175">Although you can use the [kubectl][kubectl] command-line tool to retrieve pod status, Kubernetes also includes a web dashboard for basic monitoring of the cluster status and management.</span></span>

![Capture d’écran du tableau de bord Kubernetes](./_images/python-kubernetes-dashboard.png)

<span data-ttu-id="caedf-177">Pour afficher l’état global du cluster et des nœuds, accédez à la section **Nœuds** du tableau de bord Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="caedf-177">To see the overall state of the cluster and nodes, go to the **Nodes** section of the Kubernetes dashboard.</span></span> <span data-ttu-id="caedf-178">Si un nœud est inactif ou a échoué, vous pouvez afficher les journaux d’erreurs à partir de cette page.</span><span class="sxs-lookup"><span data-stu-id="caedf-178">If a node is inactive or has failed, you can display the error logs from that page.</span></span> <span data-ttu-id="caedf-179">De même, accédez aux sections **Pods** et **Déploiements** pour plus d’informations sur le nombre de pods et l’état de votre déploiement.</span><span class="sxs-lookup"><span data-stu-id="caedf-179">Similarly, go to the **Pods** and **Deployments** sections for information about the number of pods and status of your deployment.</span></span>

### <a name="aks-logs"></a><span data-ttu-id="caedf-180">Journaux AKS</span><span class="sxs-lookup"><span data-stu-id="caedf-180">AKS logs</span></span>

<span data-ttu-id="caedf-181">AKS enregistre automatiquement tous les stdout/stderr au sein des journaux des pods dans le cluster.</span><span class="sxs-lookup"><span data-stu-id="caedf-181">AKS automatically logs all stdout/stderr to the logs of the pods in the cluster.</span></span> <span data-ttu-id="caedf-182">Utilisez kubectl pour les voir, de même que les événements et les journaux au niveau du nœud.</span><span class="sxs-lookup"><span data-stu-id="caedf-182">Use kubectl to see these and also node-level events and logs.</span></span> <span data-ttu-id="caedf-183">Pour plus d’informations, consultez les étapes de déploiement.</span><span class="sxs-lookup"><span data-stu-id="caedf-183">For details, see the deployment steps.</span></span>

<span data-ttu-id="caedf-184">Utilisez [Azure Monitor pour les conteneurs][monitor-containers] pour collecter des métriques et des journaux par l’intermédiaire d’une version en conteneur de l’agent Log Analytics pour Linux, stocké dans votre espace de travail Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="caedf-184">Use [Azure Monitor for containers][monitor-containers] to collect metrics and logs through a containerized version of the Log Analytics agent for Linux, which is stored in your Log Analytics workspace.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="caedf-185">Considérations relatives à la sécurité</span><span class="sxs-lookup"><span data-stu-id="caedf-185">Security considerations</span></span>

<span data-ttu-id="caedf-186">[Azure Security Center][security-center] vous offre un aperçu global de l’état de toutes vos ressources Azure en termes de sécurité.</span><span class="sxs-lookup"><span data-stu-id="caedf-186">Use [Azure Security Center][security-center] to get a central view of the security state of your Azure resources.</span></span> <span data-ttu-id="caedf-187">Il surveille les problèmes potentiels de sécurité et fournit une image complète de la sécurité de votre déploiement, même s’il ne surveille pas les nœuds d’agent AKS.</span><span class="sxs-lookup"><span data-stu-id="caedf-187">Security Center monitors potential security issues and provides a comprehensive picture of the security health of your deployment, although it doesn't monitor AKS agent nodes.</span></span> <span data-ttu-id="caedf-188">Le Centre de sécurité est configuré pour chaque abonnement Azure.</span><span class="sxs-lookup"><span data-stu-id="caedf-188">Security Center is configured per Azure subscription.</span></span> <span data-ttu-id="caedf-189">Activez la collecte de données de sécurité comme décrit dans [Intégrer un abonnement Azure à Security Center Standard][get-started].</span><span class="sxs-lookup"><span data-stu-id="caedf-189">Enable security data collection as described in [Onboard your Azure subscription to Security Center Standard][get-started].</span></span> <span data-ttu-id="caedf-190">Une fois la collecte de données activée, le Centre de sécurité analyse automatiquement les machines virtuelles créées dans le cadre de cet abonnement.</span><span class="sxs-lookup"><span data-stu-id="caedf-190">When data collection is enabled, Security Center automatically scans any VMs created under that subscription.</span></span>

<span data-ttu-id="caedf-191">**Opérations**.</span><span class="sxs-lookup"><span data-stu-id="caedf-191">**Operations**.</span></span> <span data-ttu-id="caedf-192">Pour vous connecter à un cluster AKS à l’aide de votre jeton d’authentification Azure Active Directory (Azure AD), configurez AKS pour utiliser Azure AD pour [l’authentification utilisateur][aad-auth].</span><span class="sxs-lookup"><span data-stu-id="caedf-192">To sign in to an AKS cluster using your Azure Active Directory (Azure AD) authentication token, configure AKS to use Azure AD for [user authentication][aad-auth].</span></span> <span data-ttu-id="caedf-193">Les administrateurs de cluster peuvent également configurer le contrôle d’accès en fonction du rôle (RBAC) Kubernetes basé sur une identité utilisateur ou l’appartenance à un groupe de répertoires.</span><span class="sxs-lookup"><span data-stu-id="caedf-193">Cluster administrators can also configure Kubernetes role-based access control (RBAC) based on a user's identity or directory group membership.</span></span>

<span data-ttu-id="caedf-194">Utilisez le contrôle [RBAC][rbac] pour contrôler l’accès aux ressources Azure que vous déployez.</span><span class="sxs-lookup"><span data-stu-id="caedf-194">Use [RBAC][rbac] to control access to the Azure resources that you deploy.</span></span> <span data-ttu-id="caedf-195">Le contrôle RBAC vous permet d’affecter des rôles d’autorisation aux membres de votre équipe DevOps.</span><span class="sxs-lookup"><span data-stu-id="caedf-195">RBAC lets you assign authorization roles to members of your DevOps team.</span></span> <span data-ttu-id="caedf-196">Un utilisateur peut être affecté à plusieurs rôles, et vous pouvez créer des rôles personnalisés pour d’autres [autorisations] plus affinées.</span><span class="sxs-lookup"><span data-stu-id="caedf-196">A user can be assigned to multiple roles, and you can create custom roles for even more fine-grained [permissions].</span></span>

<span data-ttu-id="caedf-197">**HTTPS**.</span><span class="sxs-lookup"><span data-stu-id="caedf-197">**HTTPS**.</span></span> <span data-ttu-id="caedf-198">Comme meilleure pratique de sécurité, l’application doit appliquer le protocole HTTPS et rediriger les requêtes HTTP.</span><span class="sxs-lookup"><span data-stu-id="caedf-198">As a security best practice, the application should enforce HTTPS and redirect HTTP requests.</span></span> <span data-ttu-id="caedf-199">Utilisez un [contrôleur d’entrée][ingress-controller] pour déployer un proxy inverse qui arrête le protocole SSL et redirige les requêtes HTTP.</span><span class="sxs-lookup"><span data-stu-id="caedf-199">Use an [ingress controller][ingress-controller] to deploy a reverse proxy that terminates SSL and redirects HTTP requests.</span></span> <span data-ttu-id="caedf-200">Pour plus d’informations, consultez [Créer un contrôleur d’entrée HTTPS dans Azure Kubernetes Service (AKS)][https-ingress].</span><span class="sxs-lookup"><span data-stu-id="caedf-200">For more information, see [Create an HTTPS ingress controller on Azure Kubernetes Service (AKS)][https-ingress].</span></span>

<span data-ttu-id="caedf-201">**Authentification**.</span><span class="sxs-lookup"><span data-stu-id="caedf-201">**Authentication**.</span></span> <span data-ttu-id="caedf-202">Cette solution ne restreint pas l’accès aux points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="caedf-202">This solution doesn't restrict access to the endpoints.</span></span> <span data-ttu-id="caedf-203">Pour déployer l’architecture dans un environnement d’entreprise, sécurisez les points de terminaison via des clés API et ajoutez une forme d’authentification utilisateur à l’application cliente.</span><span class="sxs-lookup"><span data-stu-id="caedf-203">To deploy the architecture in an enterprise setting, secure the endpoints through API keys and add some form of user authentication to the client application.</span></span>

<span data-ttu-id="caedf-204">**Registre de conteneurs**.</span><span class="sxs-lookup"><span data-stu-id="caedf-204">**Container registry**.</span></span> <span data-ttu-id="caedf-205">Cette solution utilise un registre public pour stocker l’image Docker.</span><span class="sxs-lookup"><span data-stu-id="caedf-205">This solution uses a public registry to store the Docker image.</span></span> <span data-ttu-id="caedf-206">Le code dont dépend l’application, ainsi que le modèle, sont contenus dans cette image.</span><span class="sxs-lookup"><span data-stu-id="caedf-206">The code that the application depends on, and the model, are contained within this image.</span></span> <span data-ttu-id="caedf-207">Les applications d’entreprise doivent utiliser un registre privé pour se prémunir contre l’exécution de code malveillant et pour mieux éviter que les informations contenues dans le conteneur soient compromises.</span><span class="sxs-lookup"><span data-stu-id="caedf-207">Enterprise applications should use a private registry to help guard against running malicious code and to help keep the information inside the container from being compromised.</span></span>

<span data-ttu-id="caedf-208">**Protection DDOS**.</span><span class="sxs-lookup"><span data-stu-id="caedf-208">**DDoS protection**.</span></span> <span data-ttu-id="caedf-209">Envisagez l’activation de la [Protection DDoS Standard][ddos].</span><span class="sxs-lookup"><span data-stu-id="caedf-209">Consider enabling [DDoS Protection Standard][ddos].</span></span> <span data-ttu-id="caedf-210">Bien que la protection DDoS soit activée sur la plateforme Azure, la protection DDoS standard offre des capacités d’atténuation des risques spécifiquement adaptées aux ressources de réseau virtuel Azure.</span><span class="sxs-lookup"><span data-stu-id="caedf-210">Although basic DDoS protection is enabled as part of the Azure platform, DDoS Protection Standard provides mitigation capabilities that are tuned specifically to Azure virtual network resources.</span></span>

<span data-ttu-id="caedf-211">**Journalisation**.</span><span class="sxs-lookup"><span data-stu-id="caedf-211">**Logging**.</span></span> <span data-ttu-id="caedf-212">Utilisez les meilleures pratiques avant de stocker des données de journal, comme le nettoyage des mots de passe utilisateur et d’autres informations pouvant être utilisées pour commettre une usurpation de sécurité.</span><span class="sxs-lookup"><span data-stu-id="caedf-212">Use best practices before storing log data, such as scrubbing user passwords and other information that could be used to commit security fraud.</span></span>

## <a name="deployment"></a><span data-ttu-id="caedf-213">Déploiement</span><span class="sxs-lookup"><span data-stu-id="caedf-213">Deployment</span></span>

<span data-ttu-id="caedf-214">Pour déployer cette architecture de référence, suivez les étapes décrites dans les dépôts GitHub :</span><span class="sxs-lookup"><span data-stu-id="caedf-214">To deploy this reference architecture, follow the steps described in the GitHub repos:</span></span>

- <span data-ttu-id="caedf-215">[Modèles Python standards][github-python]</span><span class="sxs-lookup"><span data-stu-id="caedf-215">[Regular Python models][github-python]</span></span>
- <span data-ttu-id="caedf-216">[Modèles d’apprentissage profond][github-dl]</span><span class="sxs-lookup"><span data-stu-id="caedf-216">[Deep learning models][github-dl]</span></span>

<!-- links -->

[aad-auth]: /azure/aks/aad-integration
[acr]: /azure/container-registry/
[something]: https://kubernetes.io/docs/reference/access-authn-authz/authentication/
[aks]: /azure/aks/intro-kubernetes
[autoscaler]: /azure/aks/autoscaler
[autoscale-pods]: /azure/aks/tutorial-kubernetes-scale#autoscale-pods
[azcopy]: /azure/storage/common/storage-use-azcopy-linux
[ddos]: /azure/virtual-network/ddos-protection-overview
[docker]: https://hub.docker.com/
[get-started]: /azure/security-center/security-center-get-started
[github-python]: https://github.com/Azure/MLAKSDeployment
[github-dl]: https://github.com/Microsoft/AKSDeploymentTutorial
[gpus-vs-cpus]: https://azure.microsoft.com/en-us/blog/gpus-vs-cpus-for-deployment-of-deep-learning-models/
[https-ingress]: /azure/aks/ingress-tls
[ingress-controller]: https://kubernetes.io/docs/concepts/services-networking/ingress/
[kubectl]: https://kubernetes.io/docs/tasks/tools/install-kubectl/
[lb]: /azure/load-balancer/load-balancer-overview
[manually-scale-pods]: /azure/aks/tutorial-kubernetes-scale#manually-scale-pods
[monitor-containers]: /azure/monitoring/monitoring-container-insights-overview
[autorisations]: /azure/aks/concepts-identity
[permissions]: /azure/aks/concepts-identity
[rbac]: /azure/active-directory/role-based-access-control-what-is
[scale-cluster]: /azure/aks/scale-cluster
[scikit]: https://pypi.org/project/scikit-learn/
[security-center]: /azure/security-center/security-center-intro
[vm]: /azure/virtual-machines/
