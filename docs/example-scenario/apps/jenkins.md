---
title: Exécuter un serveur Jenkins sur Azure
titleSuffix: Azure Reference Architectures
description: Cette architecture recommandée montre comment déployer et utiliser un serveur Jenkins scalable de classe entreprise sur Azure sécurisé avec l’authentification unique (SSO).
author: njray
ms.date: 04/30/2018
ms.topic: example-scenario
ms.service: architecture-center
ms.subservice: example-scenario
ms.custom: seodec18
social_image_url: /azure/architecture/example-scenario/apps/media/architecture-jenkins.png
ms.openlocfilehash: cddfa3be8bc31c1d60d2f2f8518d90ba84f68d9a
ms.sourcegitcommit: 579c39ff4b776704ead17a006bf24cd4cdc65edd
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59646560"
---
# <a name="run-a-jenkins-server-on-azure"></a><span data-ttu-id="6ab45-103">Exécuter un serveur Jenkins sur Azure</span><span class="sxs-lookup"><span data-stu-id="6ab45-103">Run a Jenkins server on Azure</span></span>

<span data-ttu-id="6ab45-104">Ce scénario montre comment déployer et utiliser un serveur de Jenkins de classe entreprise évolutif sur Azure sécurisé avec authentification unique (SSO).</span><span class="sxs-lookup"><span data-stu-id="6ab45-104">This scenario shows how to deploy and operate a scalable, enterprise-grade Jenkins server on Azure secured with single sign-on (SSO).</span></span> <span data-ttu-id="6ab45-105">L’architecture utilise également Azure Monitor pour surveiller l’état du serveur Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-105">The architecture also uses Azure Monitor to monitor the state of the Jenkins server.</span></span> <span data-ttu-id="6ab45-106">[**Déployez cette solution**](#deploy-the-solution).</span><span class="sxs-lookup"><span data-stu-id="6ab45-106">[**Deploy this solution**](#deploy-the-solution).</span></span>

![Serveur Jenkins s’exécutant sur Azure][0]

<span data-ttu-id="6ab45-108">*Téléchargez un [fichier Visio](https://archcenter.blob.core.windows.net/cdn/Jenkins-architecture.vsdx) contenant ce diagramme d’architecture.*</span><span class="sxs-lookup"><span data-stu-id="6ab45-108">*Download a [Visio file](https://archcenter.blob.core.windows.net/cdn/Jenkins-architecture.vsdx) that contains this architecture diagram.*</span></span>

<span data-ttu-id="6ab45-109">Cette architecture prend en charge la récupération d’urgence avec les services Azure, mais ne couvre pas les scénarios plus avancés de montée en puissance impliquant plusieurs maîtres ou la haute disponibilité (HA) sans temps d’arrêt.</span><span class="sxs-lookup"><span data-stu-id="6ab45-109">This architecture supports disaster recovery with Azure services but does not cover more advanced scale-out scenarios involving multiple masters or high availability (HA) with no downtime.</span></span> <span data-ttu-id="6ab45-110">Pour des informations générales sur les différents composants Azure, notamment un didacticiel pas à pas sur la création d’un pipeline d’intégration continue/de déploiement continu sur Azure, consultez [Jenkins sur Azure][jenkins-on-azure].</span><span class="sxs-lookup"><span data-stu-id="6ab45-110">For general insights about the various Azure components, including a step-by-step tutorial about building out a CI/CD pipeline on Azure, see [Jenkins on Azure][jenkins-on-azure].</span></span>

<span data-ttu-id="6ab45-111">Ce document porte sur les opérations Azure principales nécessaires à la prise en charge de Jenkins, notamment l’utilisation du stockage Azure pour mettre à jour les artefacts de build, les éléments de sécurité nécessaires à l’authentification unique, d’autres services qui peuvent être intégrés et l’évolutivité pour le pipeline.</span><span class="sxs-lookup"><span data-stu-id="6ab45-111">The focus of this document is on the core Azure operations needed to support Jenkins, including the use of Azure Storage to maintain build artifacts, the security items needed for SSO, other services that can be integrated, and scalability for the pipeline.</span></span> <span data-ttu-id="6ab45-112">Cette architecture est conçue pour fonctionner avec un référentiel de contrôle de code source existant.</span><span class="sxs-lookup"><span data-stu-id="6ab45-112">The architecture is designed to work with an existing source control repository.</span></span> <span data-ttu-id="6ab45-113">Par exemple, un scénario courant est de démarrer des travaux Jenkins selon les validations de GitHub.</span><span class="sxs-lookup"><span data-stu-id="6ab45-113">For example, a common scenario is to start Jenkins jobs based on GitHub commits.</span></span>

## <a name="architecture"></a><span data-ttu-id="6ab45-114">Architecture</span><span class="sxs-lookup"><span data-stu-id="6ab45-114">Architecture</span></span>

<span data-ttu-id="6ab45-115">L’architecture est constituée des composants suivants :</span><span class="sxs-lookup"><span data-stu-id="6ab45-115">The architecture consists of the following components:</span></span>

- <span data-ttu-id="6ab45-116">**Groupe de ressources**.</span><span class="sxs-lookup"><span data-stu-id="6ab45-116">**Resource group**.</span></span> <span data-ttu-id="6ab45-117">Un [groupe de ressources][rg] sert à regrouper des ressources Azure afin de pouvoir les gérer en fonction de la durée de vie, du propriétaire et d’autres critères.</span><span class="sxs-lookup"><span data-stu-id="6ab45-117">A [resource group][rg] is used to group Azure assets so they can be managed by lifetime, owner, and other criteria.</span></span> <span data-ttu-id="6ab45-118">Utiliser des groupes de ressources vous permet de déployer et de surveiller les ressources Azure en tant que groupe et de suivre les coûts de facturation par groupe de ressources.</span><span class="sxs-lookup"><span data-stu-id="6ab45-118">Use resource groups to deploy and monitor Azure assets as a group and track billing costs by resource group.</span></span> <span data-ttu-id="6ab45-119">Vous pouvez également supprimer des ressources dans un ensemble, ce qui est très utile pour les déploiements de test.</span><span class="sxs-lookup"><span data-stu-id="6ab45-119">You can also delete resources as a set, which is very useful for test deployments.</span></span>

- <span data-ttu-id="6ab45-120">**Serveur Jenkins**.</span><span class="sxs-lookup"><span data-stu-id="6ab45-120">**Jenkins server**.</span></span> <span data-ttu-id="6ab45-121">Une machine virtuelle est déployée pour exécuter [Jenkins] [ azure-market] en tant que serveur automation et sert en tant que serveur maître Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-121">A virtual machine is deployed to run [Jenkins][azure-market] as an automation server and serves as Jenkins Master.</span></span> <span data-ttu-id="6ab45-122">Pour déployer cette machine virtuelle, utilisez le [modèle de solution pour Jenkins sur Azure][solution].</span><span class="sxs-lookup"><span data-stu-id="6ab45-122">To deploy this VM, use the [solution template for Jenkins on Azure][solution].</span></span> <span data-ttu-id="6ab45-123">D’autres offres Jenkins sont disponibles sur la Place de marché Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="6ab45-123">Other Jenkins offerings are available in the Azure Marketplace.</span></span>

  > [!NOTE]
  > <span data-ttu-id="6ab45-124">Nginx est installé sur la machine virtuelle en tant que proxy inverse pour Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-124">Nginx is installed on the VM to act as a reverse proxy to Jenkins.</span></span> <span data-ttu-id="6ab45-125">Vous pouvez configurer Nginx pour activer SSL pour le serveur Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-125">You can configure Nginx to enable SSL for the Jenkins server.</span></span>
  >

- <span data-ttu-id="6ab45-126">**Réseau virtuel**.</span><span class="sxs-lookup"><span data-stu-id="6ab45-126">**Virtual network**.</span></span> <span data-ttu-id="6ab45-127">Un [réseau virtuel][vnet] connecte des ressources Azure entre elles et fournit une isolation logique.</span><span class="sxs-lookup"><span data-stu-id="6ab45-127">A [virtual network][vnet] connects Azure resources to each other and provides logical isolation.</span></span> <span data-ttu-id="6ab45-128">Dans cette architecture, le serveur Jenkins s’exécute dans un réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="6ab45-128">In this architecture, the Jenkins server runs in a virtual network.</span></span>

- <span data-ttu-id="6ab45-129">**Sous-réseaux**.</span><span class="sxs-lookup"><span data-stu-id="6ab45-129">**Subnets**.</span></span> <span data-ttu-id="6ab45-130">Le serveur Jenkins est isolé dans un [sous-réseau][subnet] pour faciliter la gestion et la répartition du trafic réseau sans nuire aux performances.</span><span class="sxs-lookup"><span data-stu-id="6ab45-130">The Jenkins server is isolated in a [subnet][subnet] to make it easier to manage and segregate network traffic without affecting performance.</span></span>

- <span data-ttu-id="6ab45-131">**NSG**.</span><span class="sxs-lookup"><span data-stu-id="6ab45-131">**NSGs**.</span></span> <span data-ttu-id="6ab45-132">Utilisez des [groupes de sécurité réseau][nsg] (NSG) pour limiter le trafic réseau à partir d’Internet vers le sous-réseau d’un réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="6ab45-132">Use [network security groups][nsg] (NSGs) to restrict network traffic from the Internet to the subnet of a virtual network.</span></span>

- <span data-ttu-id="6ab45-133">**Disques managés**.</span><span class="sxs-lookup"><span data-stu-id="6ab45-133">**Managed disks**.</span></span> <span data-ttu-id="6ab45-134">Un [disque managé][managed-disk] est un disque dur virtuel (VHD) persistant utilisé pour le stockage d’application et également pour maintenir l’état du serveur Jenkins et permettre une récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="6ab45-134">A [managed disk][managed-disk] is a persistent virtual hard disk (VHD) used for application storage and also to maintain the state of the Jenkins server and provide disaster recovery.</span></span> <span data-ttu-id="6ab45-135">Les disques de données sont stockés dans Stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="6ab45-135">Data disks are stored in Azure Storage.</span></span> <span data-ttu-id="6ab45-136">Le [stockage Premium][premium] est recommandé pour de hautes performances.</span><span class="sxs-lookup"><span data-stu-id="6ab45-136">For high performance, [premium storage][premium] is recommended.</span></span>

- <span data-ttu-id="6ab45-137">**Stockage Blob Azure**.</span><span class="sxs-lookup"><span data-stu-id="6ab45-137">**Azure Blob Storage**.</span></span> <span data-ttu-id="6ab45-138">Le [plug-in Stockage Microsoft Azure][configure-storage] utilise le stockage Blob Azure pour stocker les artefacts de build qui sont créés et partagés avec d’autres builds Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-138">The [Windows Azure Storage plugin][configure-storage] uses Azure Blob Storage to store the build artifacts that are created and shared with other Jenkins builds.</span></span>

- <span data-ttu-id="6ab45-139">**Azure Active Directory (Azure AD)**.</span><span class="sxs-lookup"><span data-stu-id="6ab45-139">**Azure Active Directory (Azure AD)**.</span></span> <span data-ttu-id="6ab45-140">[Azure AD][azure-ad] prend en charge l’authentification utilisateur, ce qui vous permet de configurer l’authentification unique.</span><span class="sxs-lookup"><span data-stu-id="6ab45-140">[Azure AD][azure-ad] supports user authentication, allowing you to set up SSO.</span></span> <span data-ttu-id="6ab45-141">Les [principaux de service][service-principal] Azure AD définissent la stratégie et les autorisations pour chaque autorisation de rôle dans le flux de travail via le [contrôle d’accès en fonction du rôle][rbac] (RBAC).</span><span class="sxs-lookup"><span data-stu-id="6ab45-141">Azure AD [service principals][service-principal] define the policy and permissions for each role authorization in the workflow, using [role-based access control][rbac] (RBAC).</span></span> <span data-ttu-id="6ab45-142">Chaque principal de service est associé à un travail Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-142">Each service principal is associated with a Jenkins job.</span></span>

- <span data-ttu-id="6ab45-143">**Azure Key Vault**.</span><span class="sxs-lookup"><span data-stu-id="6ab45-143">**Azure Key Vault**.</span></span> <span data-ttu-id="6ab45-144">Pour gérer les clés secrètes et de chiffrement utilisées pour configurer les ressources Azure lorsque les secrets sont requis, cette architecture utilise [Key Vault][key-vault].</span><span class="sxs-lookup"><span data-stu-id="6ab45-144">To manage secrets and cryptographic keys used to provision Azure resources when secrets are required, this architecture uses [Key Vault][key-vault].</span></span> <span data-ttu-id="6ab45-145">Pour obtenir de l’aide supplémentaire concernant le stockage des secrets associés à l’application dans le pipeline, consultez également le plug-in pour Jenkins [Informations d’identification Azure][configure-credential].</span><span class="sxs-lookup"><span data-stu-id="6ab45-145">For added help storing secrets associated with the application in the pipeline, see also the [Azure Credentials][configure-credential] plugin for Jenkins.</span></span>

- <span data-ttu-id="6ab45-146">**Services de surveillance Azure**.</span><span class="sxs-lookup"><span data-stu-id="6ab45-146">**Azure monitoring services**.</span></span> <span data-ttu-id="6ab45-147">Ce service [analyse][monitor] la machine virtuelle Azure hébergeant Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-147">This service [monitors][monitor] the Azure virtual machine hosting Jenkins.</span></span> <span data-ttu-id="6ab45-148">Ce déploiement surveille l’état de la machine virtuelle et l’utilisation de l’UC et envoie des alertes.</span><span class="sxs-lookup"><span data-stu-id="6ab45-148">This deployment monitors the virtual machine status and CPU utilization and sends alerts.</span></span>

## <a name="recommendations"></a><span data-ttu-id="6ab45-149">Recommandations</span><span class="sxs-lookup"><span data-stu-id="6ab45-149">Recommendations</span></span>

<span data-ttu-id="6ab45-150">Les recommandations suivantes s’appliquent à la plupart des scénarios.</span><span class="sxs-lookup"><span data-stu-id="6ab45-150">The following recommendations apply for most scenarios.</span></span> <span data-ttu-id="6ab45-151">Suivez ces recommandations, sauf si vous avez un besoin spécifique qui vous oblige à les ignorer.</span><span class="sxs-lookup"><span data-stu-id="6ab45-151">Follow these recommendations unless you have a specific requirement that overrides them.</span></span>

### <a name="azure-ad"></a><span data-ttu-id="6ab45-152">Azure AD</span><span class="sxs-lookup"><span data-stu-id="6ab45-152">Azure AD</span></span>

<span data-ttu-id="6ab45-153">Le locataire [Azure AD][azure-ad] pour votre abonnement Azure est utilisé pour activer l’authentification unique pour les utilisateurs Jenkins et pour configurer les [principaux de service][service-principal] qui permettent aux travaux Jenkins d’accéder aux ressources Azure.</span><span class="sxs-lookup"><span data-stu-id="6ab45-153">The [Azure AD][azure-ad] tenant for your Azure subscription is used to enable SSO for Jenkins users and set up [service principals][service-principal] that enable Jenkins jobs to access Azure resources.</span></span>

<span data-ttu-id="6ab45-154">L’autorisation et l’authentification unique sont implémentées par le plug-in Azure AD installé sur le serveur Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-154">SSO authentication and authorization are implemented by the Azure AD plugin installed on the Jenkins server.</span></span> <span data-ttu-id="6ab45-155">L’authentification unique vous permet de vous authentifier à l’aide des informations d’identification Azure AD de votre organisation lors de la connexion au serveur Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-155">SSO allows you to authenticate using your organization credentials from Azure AD when logging on to the Jenkins server.</span></span> <span data-ttu-id="6ab45-156">Lorsque vous configurez le plug-in Azure AD, vous pouvez spécifier le niveau d’accès autorisé d’un utilisateur au serveur Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-156">When configuring the Azure AD plugin, you can specify the level of a user’s authorized access to the Jenkins server.</span></span>

<span data-ttu-id="6ab45-157">Pour fournir des travaux Jenkins avec accès aux ressources Azure, un administrateur Azure AD crée des principaux de service.</span><span class="sxs-lookup"><span data-stu-id="6ab45-157">To provide Jenkins jobs with access to Azure resources, an Azure AD administrator creates service principals.</span></span> <span data-ttu-id="6ab45-158">Ces derniers accordent aux applications (dans le cas présent, les travaux Jenkins) un [accès autorisé et authentifié][ad-sp] aux ressources Azure.</span><span class="sxs-lookup"><span data-stu-id="6ab45-158">These grant applications &mdash; in this case, the Jenkins jobs &mdash; [authenticated, authorized access][ad-sp] to Azure resources.</span></span>

<span data-ttu-id="6ab45-159">Le [contrôle d’accès en fonction du rôle (RBAC)][rbac] définit et contrôle davantage l’accès aux ressources Azure pour les utilisateurs ou les principaux de service via leur rôle assigné.</span><span class="sxs-lookup"><span data-stu-id="6ab45-159">[RBAC][rbac] further defines and controls access to Azure resources for users or service principals through their assigned role.</span></span> <span data-ttu-id="6ab45-160">Les rôles intégrés et personnalisés sont pris en charge.</span><span class="sxs-lookup"><span data-stu-id="6ab45-160">Both built-in and custom roles are supported.</span></span> <span data-ttu-id="6ab45-161">Les rôles peuvent également aider à sécuriser le pipeline et garantissent que les responsabilités de l’agent ou de l’utilisateur sont affectées et autorisées correctement.</span><span class="sxs-lookup"><span data-stu-id="6ab45-161">Roles also help secure the pipeline and ensure that a user’s or agent’s responsibilities are assigned and authorized correctly.</span></span> <span data-ttu-id="6ab45-162">En outre, la fonctionnalité RBAC peut être configurée pour limiter l’accès aux ressources Azure.</span><span class="sxs-lookup"><span data-stu-id="6ab45-162">In addition, RBAC can be set up to limit access to Azure assets.</span></span> <span data-ttu-id="6ab45-163">Par exemple, un utilisateur peut être limité à l’utilisation des composants dans un groupe de ressources particulier.</span><span class="sxs-lookup"><span data-stu-id="6ab45-163">For example, a user can be limited to working with only the assets in a particular resource group.</span></span>

### <a name="storage"></a><span data-ttu-id="6ab45-164">Stockage</span><span class="sxs-lookup"><span data-stu-id="6ab45-164">Storage</span></span>

<span data-ttu-id="6ab45-165">Utilisez le [plug-in Jenkins Stockage Microsoft Azure][storage-plugin], qui est installé à partir de la Place de marché Microsoft Azure, pour stocker les artefacts de build qui peuvent être partagés avec d’autres builds et d’autres tests.</span><span class="sxs-lookup"><span data-stu-id="6ab45-165">Use the Jenkins [Windows Azure Storage plugin][storage-plugin], which is installed from the Azure Marketplace, to store build artifacts that can be shared with other builds and tests.</span></span> <span data-ttu-id="6ab45-166">Un compte de stockage Azure doit être configuré avant que ce plug-in puisse être utilisé par les travaux Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-166">An Azure Storage account must be configured before this plugin can be used by the Jenkins jobs.</span></span>

### <a name="jenkins-azure-plugins"></a><span data-ttu-id="6ab45-167">Plug-ins Jenkins Azure</span><span class="sxs-lookup"><span data-stu-id="6ab45-167">Jenkins Azure plugins</span></span>

<span data-ttu-id="6ab45-168">Le modèle de solution pour Jenkins sur Azure installe plusieurs plug-ins Azure.</span><span class="sxs-lookup"><span data-stu-id="6ab45-168">The solution template for Jenkins on Azure installs several Azure plugins.</span></span> <span data-ttu-id="6ab45-169">L’équipe DevOps Azure génère et gère le modèle de solution et les plug-ins suivants, qui fonctionnent avec les autres offres Jenkins dans la Place de marché Microsoft Azure, ainsi que n’importe quel maître Jenkins configuré localement :</span><span class="sxs-lookup"><span data-stu-id="6ab45-169">The Azure DevOps Team builds and maintains the solution template and the following plugins, which work with other Jenkins offerings in Azure Marketplace as well as any Jenkins master set up on premises:</span></span>

- <span data-ttu-id="6ab45-170">Le [plug-in Azure AD][configure-azure-ad] permet au serveur Jenkins de prendre en charge l’authentification unique pour les utilisateurs basés sur Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6ab45-170">[Azure AD plugin][configure-azure-ad] allows the Jenkins server to support SSO for users based on Azure AD.</span></span>

- <span data-ttu-id="6ab45-171">Le plug-in [Agents de machine virtuelle Azure][configure-agent] utilise un modèle Azure Resource Manager pour créer des agents Jenkins dans les machines virtuelles Azure.</span><span class="sxs-lookup"><span data-stu-id="6ab45-171">[Azure VM Agents][configure-agent] plugin uses an Azure Resource Manager template to create Jenkins agents in Azure virtual machines.</span></span>

- <span data-ttu-id="6ab45-172">Le plug-in [Informations d’identification Azure][configure-credential] vous permet de stocker les informations d’identification du principal de service Azure dans Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-172">[Azure Credentials][configure-credential] plugin allows you to store Azure service principal credentials in Jenkins.</span></span>

- <span data-ttu-id="6ab45-173">Le [plug-in Stockage Microsoft Azure][configure-storage] télécharge les artefacts de build vers le [stockage Blob Azure][blob] ou télécharge les dépendances de build à partir de ce dernier.</span><span class="sxs-lookup"><span data-stu-id="6ab45-173">[Windows Azure Storage plugin][configure-storage] uploads build artifacts to, or downloads build dependencies from, [Azure Blob storage][blob].</span></span>

<span data-ttu-id="6ab45-174">Nous vous recommandons également de consulter la liste en constante évolution de tous les plug-ins Azure disponibles et fonctionnant avec les ressources Azure.</span><span class="sxs-lookup"><span data-stu-id="6ab45-174">We also recommend reviewing the growing list of all available Azure plugins that work with Azure resources.</span></span> <span data-ttu-id="6ab45-175">Pour consulter la liste la plus récente, visitez l’[Index de plug-ins Jenkins][index] et recherchez Azure.</span><span class="sxs-lookup"><span data-stu-id="6ab45-175">To see all the latest list, visit [Jenkins Plugin Index][index] and search for Azure.</span></span> <span data-ttu-id="6ab45-176">Par exemple, les plug-ins suivants peuvent être déployés :</span><span class="sxs-lookup"><span data-stu-id="6ab45-176">For example, the following plugins are available for deployment:</span></span>

- <span data-ttu-id="6ab45-177">Les [Agents Azure Container][container-agents] vous aident à exécuter un conteneur en tant qu’agent dans Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-177">[Azure Container Agents][container-agents] helps you to run a container as an agent in Jenkins.</span></span>

- <span data-ttu-id="6ab45-178">Le [déploiement continu Kubernetes](https://aka.ms/azjenkinsk8s) déploie des configurations de ressources vers un cluster Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="6ab45-178">[Kubernetes Continuous Deploy](https://aka.ms/azjenkinsk8s) deploys resource configurations to a Kubernetes cluster.</span></span>

- <span data-ttu-id="6ab45-179">[Azure Container Service][acs] déploie des configurations sur Azure Container Service avec Kubernetes, DC/OS avec Marathon ou Docker Swarm.</span><span class="sxs-lookup"><span data-stu-id="6ab45-179">[Azure Container Service][acs] deploys configurations to Azure Container Service with Kubernetes, DC/OS with Marathon, or Docker Swarm.</span></span>

- <span data-ttu-id="6ab45-180">[Azure Functions][functions] déploie votre projet sur Azure Functions.</span><span class="sxs-lookup"><span data-stu-id="6ab45-180">[Azure Functions][functions] deploys your project to Azure Function.</span></span>

- <span data-ttu-id="6ab45-181">[Azure App Service][app-service] déploie vers Azure App Service.</span><span class="sxs-lookup"><span data-stu-id="6ab45-181">[Azure App Service][app-service] deploys to Azure App Service.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="6ab45-182">Considérations relatives à l’extensibilité</span><span class="sxs-lookup"><span data-stu-id="6ab45-182">Scalability considerations</span></span>

<span data-ttu-id="6ab45-183">Jenkins peut mettre à l’échelle pour prendre en charge des charges de travail très importantes.</span><span class="sxs-lookup"><span data-stu-id="6ab45-183">Jenkins can scale to support very large workloads.</span></span> <span data-ttu-id="6ab45-184">Pour les builds élastiques, n’exécutez pas les builds sur le serveur maître Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-184">For elastic builds, do not run builds on the Jenkins master server.</span></span> <span data-ttu-id="6ab45-185">Au lieu de cela, déchargez les tâches de build sur les agents Jenkins, qui peuvent être mis à l’échelle élastiquement selon les besoins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-185">Instead, offload build tasks to Jenkins agents, which can be elastically scaled in and out as need.</span></span> <span data-ttu-id="6ab45-186">Tenez compte de deux options pour la mise à l’échelle des agents :</span><span class="sxs-lookup"><span data-stu-id="6ab45-186">Consider two options for scaling agents:</span></span>

- <span data-ttu-id="6ab45-187">Utilisez le plug-in [agents de machine virtuelle Azure][vm-agent] pour créer des agents Jenkins qui s’exécutent dans des machines virtuelles Azure.</span><span class="sxs-lookup"><span data-stu-id="6ab45-187">Use the [Azure VM Agents][vm-agent] plugin to create Jenkins agents that run in Azure VMs.</span></span> <span data-ttu-id="6ab45-188">Ce plug-in permet la montée en charge élastique des agents et peut utiliser différents types de machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="6ab45-188">This plugin enables elastic scale-out for agents and can use distinct types of virtual machines.</span></span> <span data-ttu-id="6ab45-189">Vous pouvez sélectionner une autre image de base à partir de la Place de marché Microsoft Azure ou utiliser une image personnalisée.</span><span class="sxs-lookup"><span data-stu-id="6ab45-189">You can select a different base image from Azure Marketplace or use a custom image.</span></span> <span data-ttu-id="6ab45-190">Pour plus d’informations sur la façon dont les agents Jenkins mettent à l’échelle, consultez [Architecture pour la mise à l’échelle][scale] dans la documentation Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-190">For details about how the Jenkins agents scale, see [Architecting for Scale][scale] in the Jenkins documentation.</span></span>

- <span data-ttu-id="6ab45-191">Utilisez le plug-in [Agents Azure Container][container-agents] pour exécuter un conteneur en tant qu’agent dans [Azure Container Service avec Kubernetes](/azure/container-service/kubernetes/) ou dans [Azure Container Instances](/azure/container-instances/).</span><span class="sxs-lookup"><span data-stu-id="6ab45-191">Use the [Azure Container Agents][container-agents] plugin to run a container as an agent in either [Azure Container Service with Kubernetes](/azure/container-service/kubernetes/), or [Azure Container Instances](/azure/container-instances/).</span></span>

<span data-ttu-id="6ab45-192">Généralement, la mise à l’échelle de machines virtuelles coûte plus cher que celle de conteneurs.</span><span class="sxs-lookup"><span data-stu-id="6ab45-192">Virtual machines generally cost more to scale than containers.</span></span> <span data-ttu-id="6ab45-193">Toutefois, pour mettre des conteneurs à l’échelle, votre processus de génération doit s’exécuter avec des conteneurs.</span><span class="sxs-lookup"><span data-stu-id="6ab45-193">To use containers for scaling, however, your build process must run with containers.</span></span>

<span data-ttu-id="6ab45-194">De plus, utilisez le stockage Azure pour partager des artefacts de build qui peuvent être utilisés dans l’étape suivante du pipeline par d’autres agents de build.</span><span class="sxs-lookup"><span data-stu-id="6ab45-194">Also, use Azure Storage to share build artifacts that may be used in the next stage of the pipeline by other build agents.</span></span>

### <a name="scaling-the-jenkins-server"></a><span data-ttu-id="6ab45-195">Mise à l’échelle du serveur Jenkins</span><span class="sxs-lookup"><span data-stu-id="6ab45-195">Scaling the Jenkins server</span></span>

<span data-ttu-id="6ab45-196">Vous pouvez réduire ou augmenter la puissance de la machine virtuelle du serveur Jenkins en modifiant sa taille.</span><span class="sxs-lookup"><span data-stu-id="6ab45-196">You can scale the Jenkins server VM up or down by changing the VM size.</span></span> <span data-ttu-id="6ab45-197">Le [modèle de solution pour Jenkins sur Azure][azure-market] spécifie la taille de DS2 v2 (avec deux UC, 7 Go) par défaut.</span><span class="sxs-lookup"><span data-stu-id="6ab45-197">The [solution template for Jenkins on Azure][azure-market] specifies the DS2 v2 size (with two CPUs, 7 GB) by default.</span></span> <span data-ttu-id="6ab45-198">Cette taille gère une charge de travail d’équipe petite à moyenne.</span><span class="sxs-lookup"><span data-stu-id="6ab45-198">This size handles a small to medium team workload.</span></span> <span data-ttu-id="6ab45-199">Modifiez la taille de machine virtuelle en choisissant une autre option lors de la création du serveur.</span><span class="sxs-lookup"><span data-stu-id="6ab45-199">Change the VM size by choosing a different option when building out the server.</span></span>

<span data-ttu-id="6ab45-200">La sélection d’un serveur de taille appropriée dépend de la taille de la charge de travail attendue.</span><span class="sxs-lookup"><span data-stu-id="6ab45-200">Selecting the correct server size depends on the size of the expected workload.</span></span> <span data-ttu-id="6ab45-201">La communauté Jenkins gère un [guide de sélection][selection-guide] pour vous aider à identifier la configuration qui répond le mieux à vos besoins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-201">The Jenkins community maintains a [selection guide][selection-guide] to help identify the configuration that best meets your requirements.</span></span> <span data-ttu-id="6ab45-202">Azure propose de nombreuses [tailles pour les machines virtuelles Linux][sizes-linux] pour répondre à toutes les conditions requises.</span><span class="sxs-lookup"><span data-stu-id="6ab45-202">Azure offers many [sizes for Linux VMs][sizes-linux] to meet any requirements.</span></span> <span data-ttu-id="6ab45-203">Pour plus d’informations sur la mise à l’échelle du maître Jenkins, reportez-vous aux [meilleures pratiques][best-practices] de la communauté Jenkins, qui incluent également des détails sur la mise à l’échelle du maître Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-203">For more information about scaling the Jenkins master, refer to the Jenkins community of [best practices][best-practices], which also includes details about scaling Jenkins master.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="6ab45-204">Considérations relatives à la disponibilité</span><span class="sxs-lookup"><span data-stu-id="6ab45-204">Availability considerations</span></span>

<span data-ttu-id="6ab45-205">Dans le contexte d’un serveur Jenkins, la disponibilité signifie être en mesure de récupérer les informations d’état associées à votre flux de travail, telles que les résultats de tests, les bibliothèques que vous avez créées ou d’autres artefacts.</span><span class="sxs-lookup"><span data-stu-id="6ab45-205">Availability in the context of a Jenkins server means being able to recover any state information associated with your workflow, such as test results, libraries you have created, or other artifacts.</span></span> <span data-ttu-id="6ab45-206">Les états ou les artefacts de flux de travail critiques doivent être tenus à jour pour récupérer le flux de travail si le serveur Jenkins tombe en panne.</span><span class="sxs-lookup"><span data-stu-id="6ab45-206">Critical workflow state or artifacts must be maintained to recover the workflow if the Jenkins server goes down.</span></span> <span data-ttu-id="6ab45-207">Pour évaluer les exigences de disponibilité, tenez compte des deux mesures courantes :</span><span class="sxs-lookup"><span data-stu-id="6ab45-207">To assess your availability requirements, consider two common metrics:</span></span>

- <span data-ttu-id="6ab45-208">L’objectif de délai de récupération (RTO) spécifie la durée pendant laquelle le fonctionnement peut se poursuivre sans Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-208">Recovery Time Objective (RTO) specifies how long you can go without Jenkins.</span></span>

- <span data-ttu-id="6ab45-209">L’objectif de point de récupération (RPO) indique la quantité de données que vous pouvez vous permettre de perdre si une interruption de service affecte Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-209">Recovery Point Objective (RPO) indicates how much data you can afford to lose if a disruption in service affects Jenkins.</span></span>

<span data-ttu-id="6ab45-210">Dans la pratique, le RTO et le RPO impliquent la redondance et la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="6ab45-210">In practice, RTO and RPO imply redundancy and backup.</span></span> <span data-ttu-id="6ab45-211">La disponibilité n’est pas une question de récupération du matériel, qui fait partie d’Azure, mais plutôt de garantie du maintien à jour de l’état de votre serveur Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-211">Availability is not a question of hardware recovery &mdash; that is part of Azure &mdash; but rather ensuring you maintain the state of your Jenkins server.</span></span> <span data-ttu-id="6ab45-212">Microsoft propose un [contrat de niveau de service][sla] (SLA) pour les instances de machine virtuelle uniques.</span><span class="sxs-lookup"><span data-stu-id="6ab45-212">Microsoft offers a [service level agreement][sla] (SLA) for single VM instances.</span></span> <span data-ttu-id="6ab45-213">Si ce contrat de niveau de service (SLA) ne répond pas à vos exigences de durée de fonctionnement, assurez vous de disposer d’un plan de récupération d’urgence, ou envisagez l’utilisation d’un déploiement de [serveur Jenkins multimaître][multi-master] (non traitée dans ce document).</span><span class="sxs-lookup"><span data-stu-id="6ab45-213">If this SLA doesn't meet your uptime requirements, make sure you have a plan for disaster recovery, or consider using a [multi-master Jenkins server][multi-master] deployment (not covered in this document).</span></span>

<span data-ttu-id="6ab45-214">Envisagez l’utilisation des [scripts][disaster] de récupération d’urgence à l’étape 7 du déploiement pour créer un compte de stockage Azure avec des disques managés pour stocker l’état du serveur Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-214">Consider using the disaster recovery [scripts][disaster] in step 7 of the deployment to create an Azure Storage account with managed disks to store the Jenkins server state.</span></span> <span data-ttu-id="6ab45-215">Si Jenkins tombe en panne, il peut être restauré à l’état stocké dans ce compte de stockage distinct.</span><span class="sxs-lookup"><span data-stu-id="6ab45-215">If Jenkins goes down, it can be restored to the state stored in this separate storage account.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="6ab45-216">Considérations relatives à la sécurité</span><span class="sxs-lookup"><span data-stu-id="6ab45-216">Security considerations</span></span>

<span data-ttu-id="6ab45-217">Utilisez l’une des approches suivantes pour verrouiller la sécurité sur un serveur de base Jenkins, étant donné qu’il n’est pas sécurisé dans son état de base.</span><span class="sxs-lookup"><span data-stu-id="6ab45-217">Use the following approaches to help lock down security on a basic Jenkins server, since in its basic state, it is not secure.</span></span>

- <span data-ttu-id="6ab45-218">Configurer un moyen de connexion sécurisé au serveur Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-218">Set up a secure way to log into the Jenkins server.</span></span> <span data-ttu-id="6ab45-219">Cette architecture utilise le protocole HTTP et a une adresse IP publique, mais HTTP n’est pas sécurisé par défaut.</span><span class="sxs-lookup"><span data-stu-id="6ab45-219">This architecture uses HTTP and has a public IP, but HTTP is not secure by default.</span></span> <span data-ttu-id="6ab45-220">Envisagez de configurer [HTTPS sur le serveur Nginx][nginx] utilisé pour une ouverture de session sécurisée.</span><span class="sxs-lookup"><span data-stu-id="6ab45-220">Consider setting up [HTTPS on the Nginx server][nginx] being used for a secure logon.</span></span>

    > [!NOTE]
    > <span data-ttu-id="6ab45-221">Lors de l’ajout du protocole SSL sur votre serveur, créez une règle de groupe de sécurité réseau (NSG) pour le sous-réseau Jenkins afin d’ouvrir le port 443.</span><span class="sxs-lookup"><span data-stu-id="6ab45-221">When adding SSL to your server, create an NSG rule for the Jenkins subnet to open port 443.</span></span> <span data-ttu-id="6ab45-222">Pour plus d’informations, consultez [Guide d’ouverture de ports vers une machine virtuelle avec le portail Azure][port443].</span><span class="sxs-lookup"><span data-stu-id="6ab45-222">For more information, see [How to open ports to a virtual machine with the Azure portal][port443].</span></span>
    >

- <span data-ttu-id="6ab45-223">Assurez-vous que la configuration de Jenkins empêche la falsification de requête intersites (Gérer Jenkins \> Configurer la sécurité globale).</span><span class="sxs-lookup"><span data-stu-id="6ab45-223">Ensure that the Jenkins configuration prevents cross site request forgery (Manage Jenkins \> Configure Global Security).</span></span> <span data-ttu-id="6ab45-224">Il s’agit de la valeur par défaut pour le serveur Microsoft Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-224">This is the default for Microsoft Jenkins Server.</span></span>

- <span data-ttu-id="6ab45-225">Configurer l’accès en lecture seule au tableau de bord Jenkins à l’aide du [plug-in de stratégie d’autorisation de matrice][matrix].</span><span class="sxs-lookup"><span data-stu-id="6ab45-225">Configure read-only access to the Jenkins dashboard by using the [Matrix Authorization Strategy Plugin][matrix].</span></span>

- <span data-ttu-id="6ab45-226">Installer le plug-in [Informations d’identification Azure][configure-credential] pour utiliser Key Vault pour gérer les secrets des ressources Azure, des agents dans le pipeline et des composants tiers.</span><span class="sxs-lookup"><span data-stu-id="6ab45-226">Install the [Azure Credentials][configure-credential] plugin to use Key Vault to handle secrets for the Azure assets, the agents in the pipeline, and third-party components.</span></span>

- <span data-ttu-id="6ab45-227">Utilisez RBAC pour restreindre l’accès au principal du service à la condition minimale requise pour exécuter les travaux.</span><span class="sxs-lookup"><span data-stu-id="6ab45-227">Use RBAC to restrict the access of the service principal to the minimum required to run the jobs.</span></span> <span data-ttu-id="6ab45-228">Cela permet de limiter l’étendue des dommages causés par un travail non fiable.</span><span class="sxs-lookup"><span data-stu-id="6ab45-228">This helps limit the scope of damage from a rogue job.</span></span>

<span data-ttu-id="6ab45-229">Les travaux Jenkins nécessitent souvent des secrets pour accéder aux services Azure qui requièrent une autorisation, tels que Azure Container Service.</span><span class="sxs-lookup"><span data-stu-id="6ab45-229">Jenkins jobs often require secrets to access Azure services that require authorization, such as Azure Container Service.</span></span> <span data-ttu-id="6ab45-230">Utilisez [Key Vault][key-vault] avec le [plug-in Informations d’identification Azure][configure-credential] pour gérer ces secrets en toute sécurité.</span><span class="sxs-lookup"><span data-stu-id="6ab45-230">Use [Key Vault][key-vault] along with the [Azure Credential plugin][configure-credential] to manage these secrets securely.</span></span> <span data-ttu-id="6ab45-231">Utilisez Key Vault pour stocker les informations d’identification du principal de service, les mots de passe, les jetons et d’autres secrets.</span><span class="sxs-lookup"><span data-stu-id="6ab45-231">Use Key Vault to store service principal credentials, passwords, tokens, and other secrets.</span></span>

<span data-ttu-id="6ab45-232">Pour obtenir un aperçu global de l’état de toutes vos ressources Azure en termes de sécurité, utilisez [Azure Security Center][security-center].</span><span class="sxs-lookup"><span data-stu-id="6ab45-232">To get a central view of the security state of your Azure resources, use [Azure Security Center][security-center].</span></span> <span data-ttu-id="6ab45-233">Il surveille les problèmes potentiels de sécurité et fournit une image complète de la sécurité de votre déploiement.</span><span class="sxs-lookup"><span data-stu-id="6ab45-233">Security Center monitors potential security issues and provides a comprehensive picture of the security health of your deployment.</span></span> <span data-ttu-id="6ab45-234">Le Centre de sécurité est configuré pour chaque abonnement Azure.</span><span class="sxs-lookup"><span data-stu-id="6ab45-234">Security Center is configured per Azure subscription.</span></span> <span data-ttu-id="6ab45-235">Activez la collecte de données de sécurité comme décrit dans le [Guide de démarrage rapide d’Azure Security Center][quick-start].</span><span class="sxs-lookup"><span data-stu-id="6ab45-235">Enable security data collection as described in the [Azure Security Center quick start guide][quick-start].</span></span> <span data-ttu-id="6ab45-236">Lorsque la collecte de données est activée, Security Center analyse automatiquement les machines virtuelles créées dans le cadre de cet abonnement.</span><span class="sxs-lookup"><span data-stu-id="6ab45-236">When data collection is enabled, Security Center automatically scans any virtual machines created under that subscription.</span></span>

<span data-ttu-id="6ab45-237">Le serveur Jenkins a son propre système de gestion d’utilisateur et la communauté Jenkins fournit les meilleures pratiques pour la [sécurisation d’une instance Jenkins sur Azure][secure-jenkins].</span><span class="sxs-lookup"><span data-stu-id="6ab45-237">The Jenkins server has its own user management system, and the Jenkins community provides best practices for [securing a Jenkins instance on Azure][secure-jenkins].</span></span> <span data-ttu-id="6ab45-238">Le modèle de solution pour Jenkins sur Azure implémente ces meilleures pratiques.</span><span class="sxs-lookup"><span data-stu-id="6ab45-238">The solution template for Jenkins on Azure implements these best practices.</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="6ab45-239">Considérations relatives à la facilité de gestion</span><span class="sxs-lookup"><span data-stu-id="6ab45-239">Manageability considerations</span></span>

<span data-ttu-id="6ab45-240">Utilisez des groupes de ressources pour organiser les ressources Azure qui sont déployées.</span><span class="sxs-lookup"><span data-stu-id="6ab45-240">Use resource groups to organize the Azure resources that are deployed.</span></span> <span data-ttu-id="6ab45-241">Déployez des environnements de production ainsi que des environnements de développement ou de test dans des groupes de ressources distincts, afin de pouvoir surveiller les ressources de chaque environnement et regrouper les coûts de facturation par groupe de ressources.</span><span class="sxs-lookup"><span data-stu-id="6ab45-241">Deploy production environments and development/test environments in separate resource groups, so that you can monitor each environment’s resources and roll up billing costs by resource group.</span></span> <span data-ttu-id="6ab45-242">Vous pouvez également supprimer des ressources dans un ensemble, ce qui est très utile pour les déploiements de test.</span><span class="sxs-lookup"><span data-stu-id="6ab45-242">You can also delete resources as a set, which is very useful for test deployments.</span></span>

<span data-ttu-id="6ab45-243">Azure propose plusieurs fonctionnalités d’[analyse et de diagnostics][monitoring-diag] de l’infrastructure globale.</span><span class="sxs-lookup"><span data-stu-id="6ab45-243">Azure provides several features for [monitoring and diagnostics][monitoring-diag] of the overall infrastructure.</span></span> <span data-ttu-id="6ab45-244">Pour surveiller l’utilisation de l’UC, cette architecture déploie Azure Monitor.</span><span class="sxs-lookup"><span data-stu-id="6ab45-244">To monitor CPU usage, this architecture deploys Azure Monitor.</span></span> <span data-ttu-id="6ab45-245">Par exemple, vous pouvez utiliser Azure Monitor pour surveiller l’utilisation de l’UC et envoyer une notification si l’utilisation de l’UC dépasse 80 %.</span><span class="sxs-lookup"><span data-stu-id="6ab45-245">For example, you can use Azure Monitor to monitor CPU utilization, and send a notification if CPU usage exceeds 80 percent.</span></span> <span data-ttu-id="6ab45-246">(Une utilisation élevée de l’UC indique que vous devriez mettre à l’échelle la machine virtuelle du serveur Jenkins.) Vous pouvez aussi informer un utilisateur désigné si la machine virtuelle échoue ou est indisponible.</span><span class="sxs-lookup"><span data-stu-id="6ab45-246">(High CPU usage indicates that you might want to scale up the Jenkins server VM.) You can also notify a designated user if the VM fails or becomes unavailable.</span></span>

## <a name="communities"></a><span data-ttu-id="6ab45-247">Communautés</span><span class="sxs-lookup"><span data-stu-id="6ab45-247">Communities</span></span>

<span data-ttu-id="6ab45-248">Les communautés peuvent répondre aux questions et vous aider à paramétrer un déploiement réussi.</span><span class="sxs-lookup"><span data-stu-id="6ab45-248">Communities can answer questions and help you set up a successful deployment.</span></span> <span data-ttu-id="6ab45-249">Tenez compte des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="6ab45-249">Consider the following:</span></span>

- [<span data-ttu-id="6ab45-250">Blog de la communauté Jenkins</span><span class="sxs-lookup"><span data-stu-id="6ab45-250">Jenkins Community Blog</span></span>](https://jenkins.io/node/)
- [<span data-ttu-id="6ab45-251">Forum Azure</span><span class="sxs-lookup"><span data-stu-id="6ab45-251">Azure Forum</span></span>](https://azure.microsoft.com/support/forums/)
- [<span data-ttu-id="6ab45-252">Stack Overflow Jenkins</span><span class="sxs-lookup"><span data-stu-id="6ab45-252">Stack Overflow Jenkins</span></span>](https://stackoverflow.com/tags/jenkins/info)

<span data-ttu-id="6ab45-253">Pour plus de meilleures pratiques de la communauté Jenkins, visitez [meilleures pratiques Jenkins][jenkins-best].</span><span class="sxs-lookup"><span data-stu-id="6ab45-253">For more best practices from the Jenkins community, visit [Jenkins best practices][jenkins-best].</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="6ab45-254">Déployer la solution</span><span class="sxs-lookup"><span data-stu-id="6ab45-254">Deploy the solution</span></span>

<span data-ttu-id="6ab45-255">Pour déployer cette architecture, suivez les étapes ci-dessous pour installer le [modèle de solution pour Jenkins sur Azure][azure-market], puis installez les scripts de récupération d’urgence et de surveillance dans les étapes ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="6ab45-255">To deploy this architecture, follow the steps below to install the [solution template for Jenkins on Azure][azure-market], then install the scripts that set up monitoring and disaster recovery in the steps below.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="6ab45-256">Prérequis</span><span class="sxs-lookup"><span data-stu-id="6ab45-256">Prerequisites</span></span>

- <span data-ttu-id="6ab45-257">Cette architecture de référence requiert un abonnement Azure.</span><span class="sxs-lookup"><span data-stu-id="6ab45-257">This reference architecture requires an Azure subscription.</span></span>
- <span data-ttu-id="6ab45-258">Pour créer un principal de service Azure, vous devez disposer des droits d’administrateur pour le locataire Azure AD qui est associé au serveur Jenkins déployé.</span><span class="sxs-lookup"><span data-stu-id="6ab45-258">To create an Azure service principal, you must have admin rights to the Azure AD tenant that is associated with the deployed Jenkins server.</span></span>
- <span data-ttu-id="6ab45-259">Ces instructions supposent que l’administrateur Jenkins est également un utilisateur Azure avec au moins des privilèges de collaborateur.</span><span class="sxs-lookup"><span data-stu-id="6ab45-259">These instructions assume that the Jenkins administrator is also an Azure user with at least Contributor privileges.</span></span>

### <a name="step-1-deploy-the-jenkins-server"></a><span data-ttu-id="6ab45-260">Étape 1 : Déployer le serveur Jenkins</span><span class="sxs-lookup"><span data-stu-id="6ab45-260">Step 1: Deploy the Jenkins server</span></span>

1. <span data-ttu-id="6ab45-261">Ouvrez l’[image de place de marché Azure pour Jenkins][azure-market] dans votre navigateur web et cliquez sur **OBTENIR MAINTENANT** sur le côté gauche de la page.</span><span class="sxs-lookup"><span data-stu-id="6ab45-261">Open the [Azure Marketplace image for Jenkins][azure-market] in your web browser and select **GET IT NOW** from the left side of the page.</span></span>

2. <span data-ttu-id="6ab45-262">Passez en revue les détails de tarification et sélectionnez **Continuer**, puis sélectionnez **Créer** pour configurer le serveur Jenkins dans le portail Azure.</span><span class="sxs-lookup"><span data-stu-id="6ab45-262">Review the pricing details and select **Continue**, then select **Create** to configure the Jenkins server in the Azure portal.</span></span>

<span data-ttu-id="6ab45-263">Pour obtenir des instructions détaillées, consultez [Créer un serveur Jenkins sur une machine virtuelle Linux Azure à partir du portail Azure][create-jenkins].</span><span class="sxs-lookup"><span data-stu-id="6ab45-263">For detailed instructions, see [Create a Jenkins server on an Azure Linux VM from the Azure portal][create-jenkins].</span></span> <span data-ttu-id="6ab45-264">Pour cette architecture de référence, il suffit de rendre le serveur opérationnel avec l’ouverture de session d’administrateur.</span><span class="sxs-lookup"><span data-stu-id="6ab45-264">For this reference architecture, it is sufficient to get the server up and running with the admin logon.</span></span> <span data-ttu-id="6ab45-265">Vous pouvez ensuite le configurer pour utiliser divers autres services.</span><span class="sxs-lookup"><span data-stu-id="6ab45-265">Then you can provision it to use various other services.</span></span>

### <a name="step-2-set-up-sso"></a><span data-ttu-id="6ab45-266">Étape 2 : Configurer l’authentification unique</span><span class="sxs-lookup"><span data-stu-id="6ab45-266">Step 2: Set up SSO</span></span>

<span data-ttu-id="6ab45-267">L’étape est exécutée par l’administrateur Jenkins, qui doit également disposer d’un compte utilisateur dans le répertoire d’abonnement Azure AD et doit avoir le rôle Collaborateur.</span><span class="sxs-lookup"><span data-stu-id="6ab45-267">The step is run by the Jenkins administrator, who must also have a user account in the subscription’s Azure AD directory and must be assigned the Contributor role.</span></span>

<span data-ttu-id="6ab45-268">Utilisez le [plug-in Azure AD][configure-azure-ad] à partir du centre de mise à jour Jenkins sur le serveur Jenkins et suivez les instructions pour configurer l’authentification unique.</span><span class="sxs-lookup"><span data-stu-id="6ab45-268">Use the [Azure AD Plugin][configure-azure-ad] from the Jenkins Update Center in the Jenkins server and follow the instructions to set up SSO.</span></span>

### <a name="step-3-provision-jenkins-server-with-azure-vm-agent-plugin"></a><span data-ttu-id="6ab45-269">Étape 3 : Provisionner le serveur Jenkins avec le plug-in Agent de machine virtuelle Azure</span><span class="sxs-lookup"><span data-stu-id="6ab45-269">Step 3: Provision Jenkins server with Azure VM Agent plugin</span></span>

<span data-ttu-id="6ab45-270">L’étape est exécutée par l’administrateur Jenkins pour configurer le plug-in Agent de machine virtuelle Azure, qui est déjà installé.</span><span class="sxs-lookup"><span data-stu-id="6ab45-270">The step is run by the Jenkins administrator to set up the Azure VM Agent plugin, which is already installed.</span></span>

<span data-ttu-id="6ab45-271">[Pour configurer le plug-in, procédez comme suit][configure-agent].</span><span class="sxs-lookup"><span data-stu-id="6ab45-271">[Follow these steps to configure the plugin][configure-agent].</span></span> <span data-ttu-id="6ab45-272">Pour obtenir un tutoriel sur la configuration des principaux de service pour le plug-in, consultez [Mettre à l’échelle vos déploiements Jenkins pour répondre à la demande avec des agents de machines virtuelles Azure][scale-agent].</span><span class="sxs-lookup"><span data-stu-id="6ab45-272">For a tutorial about setting up service principals for the plugin, see [Scale your Jenkins deployments to meet demand with Azure VM agents][scale-agent].</span></span>

### <a name="step-4-provision-jenkins-server-with-azure-storage"></a><span data-ttu-id="6ab45-273">Étape 4 : Provisionner le serveur Jenkins avec Stockage Azure</span><span class="sxs-lookup"><span data-stu-id="6ab45-273">Step 4: Provision Jenkins server with Azure Storage</span></span>

<span data-ttu-id="6ab45-274">L’étape est exécutée par l’administrateur Jenkins qui configure le plug-in Stockage Microsoft Azure, qui est déjà installé.</span><span class="sxs-lookup"><span data-stu-id="6ab45-274">The step is run by the Jenkins administrator, who sets up the Windows Azure Storage Plugin, which is already installed.</span></span>

<span data-ttu-id="6ab45-275">[Pour configurer le plug-in, procédez comme suit][configure-storage].</span><span class="sxs-lookup"><span data-stu-id="6ab45-275">[Follow these steps to configure the plugin][configure-storage].</span></span>

### <a name="step-5-provision-jenkins-server-with-azure-credential-plugin"></a><span data-ttu-id="6ab45-276">Étape 5 : Provisionner le serveur Jenkins avec le plug-in Informations d’identification Azure</span><span class="sxs-lookup"><span data-stu-id="6ab45-276">Step 5: Provision Jenkins server with Azure Credential plugin</span></span>

<span data-ttu-id="6ab45-277">L’étape est exécutée par l’administrateur Jenkins pour configurer le plug-in Informations d’identification Azure, qui est déjà installé.</span><span class="sxs-lookup"><span data-stu-id="6ab45-277">The step is run by the Jenkins administrator to set up the Azure Credential plugin, which is already installed.</span></span>

<span data-ttu-id="6ab45-278">[Pour configurer le plug-in, procédez comme suit][configure-credential].</span><span class="sxs-lookup"><span data-stu-id="6ab45-278">[Follow these steps to configure the plugin][configure-credential].</span></span>

### <a name="step-6-provision-jenkins-server-for-monitoring-by-the-azure-monitor-service"></a><span data-ttu-id="6ab45-279">Étape 6 : Provisionner le serveur Jenkins pour la supervision par le service Azure Monitor</span><span class="sxs-lookup"><span data-stu-id="6ab45-279">Step 6: Provision Jenkins server for monitoring by the Azure Monitor Service</span></span>

<span data-ttu-id="6ab45-280">Pour configurer la surveillance de votre serveur Jenkins, suivez les instructions de [Création d’alertes de métrique dans Azure Monitor pour les services Azure][create-metric].</span><span class="sxs-lookup"><span data-stu-id="6ab45-280">To set up monitoring for your Jenkins server, follow the instructions in [Create metric alerts in Azure Monitor for Azure services][create-metric].</span></span>

### <a name="step-7-provision-jenkins-server-with-managed-disks-for-disaster-recovery"></a><span data-ttu-id="6ab45-281">Étape 7 : Provisionner le serveur Jenkins avec Managed Disks pour la reprise d’activité</span><span class="sxs-lookup"><span data-stu-id="6ab45-281">Step 7: Provision Jenkins server with Managed Disks for disaster recovery</span></span>

<span data-ttu-id="6ab45-282">Le groupe de produits Microsoft Jenkins a créé des scripts de récupération d’urgence qui génèrent un disque managé utilisé pour enregistrer l’état de Jenkins.</span><span class="sxs-lookup"><span data-stu-id="6ab45-282">The Microsoft Jenkins product group has created disaster recovery scripts that build a managed disk used to save the Jenkins state.</span></span> <span data-ttu-id="6ab45-283">Si le serveur tombe en panne, il peut être restauré à son état le plus récent.</span><span class="sxs-lookup"><span data-stu-id="6ab45-283">If the server goes down, it can be restored to its latest state.</span></span>

<span data-ttu-id="6ab45-284">Télécharger et exécuter des scripts de récupération d’urgence à partir de [GitHub][disaster].</span><span class="sxs-lookup"><span data-stu-id="6ab45-284">Download and run the disaster recovery scripts from [GitHub][disaster].</span></span>

<span data-ttu-id="6ab45-285">Vous pouvez consulter l’[exemple de scénario Azure](/azure/architecture/example-scenario) suivant qui décrit des solutions spécifiques à l’aide des mêmes technologies :</span><span class="sxs-lookup"><span data-stu-id="6ab45-285">You may wish to review the following [Azure example scenario](/azure/architecture/example-scenario) that demonstrates specific solutions using some of the same technologies:</span></span>

- [<span data-ttu-id="6ab45-286">Pipeline CI/CD pour les charges de travail basées sur des conteneurs</span><span class="sxs-lookup"><span data-stu-id="6ab45-286">CI/CD pipeline for container-based workloads</span></span>](/azure/architecture/example-scenario/apps/devops-with-aks)

<!-- links -->

[acs]: https://aka.ms/azjenkinsacs
[ad-sp]: /azure/active-directory/develop/active-directory-integrating-applications
[app-service]: https://plugins.jenkins.io/azure-app-service
[azure-ad]: /azure/active-directory/
[azure-market]: https://azuremarketplace.microsoft.com/marketplace/apps/azure-oss.jenkins?tab=Overview
[best-practices]: https://jenkins.io/doc/book/architecting-for-scale/
[blob]: /azure/storage/common/storage-java-jenkins-continuous-integration-solution
[configure-azure-ad]: https://plugins.jenkins.io/azure-ad
[configure-agent]: https://plugins.jenkins.io/azure-vm-agents
[configure-credential]: https://plugins.jenkins.io/azure-credentials
[configure-storage]: https://plugins.jenkins.io/windows-azure-storage
[container-agents]: https://aka.ms/azcontaineragent
[create-jenkins]: /azure/jenkins/install-jenkins-solution-template
[create-metric]: /azure/monitoring-and-diagnostics/insights-alerts-portal
[disaster]: https://github.com/Azure/jenkins/tree/master/disaster_recovery
[functions]: https://aka.ms/azjenkinsfunctions
[index]: https://plugins.jenkins.io
[jenkins-best]: https://wiki.jenkins.io/display/JENKINS/Jenkins+Best+Practices
[jenkins-on-azure]: /azure/jenkins/
[key-vault]: /azure/key-vault/
[managed-disk]: /azure/virtual-machines/linux/managed-disks-overview
[matrix]: https://plugins.jenkins.io/matrix-auth
[monitor]: /azure/monitoring-and-diagnostics/
[monitoring-diag]: /azure/architecture/best-practices/monitoring
[multi-master]: https://jenkins.io/doc/book/architecting-for-scale/
[nginx]: https://www.digitalocean.com/community/tutorials/how-to-create-an-ssl-certificate-on-nginx-for-ubuntu-14-04
[nsg]: /azure/virtual-network/virtual-networks-nsg
[quick-start]: /azure/security-center/security-center-get-started
[port443]: /azure/virtual-machines/windows/nsg-quickstart-portal
[premium]: /azure/virtual-machines/linux/premium-storage
[rbac]: /azure/active-directory/role-based-access-control-what-is
[rg]: /azure/azure-resource-manager/resource-group-overview
[scale]: https://jenkins.io/doc/book/architecting-for-scale/
[scale-agent]: /azure/jenkins/jenkins-azure-vm-agents
[selection-guide]: https://jenkins.io/doc/book/hardware-recommendations/
[service-principal]: /azure/active-directory/develop/active-directory-application-objects
[secure-jenkins]: https://jenkins.io/blog/2017/04/20/secure-jenkins-on-azure/
[security-center]: /azure/security-center/security-center-intro
[sizes-linux]: /azure/virtual-machines/linux/sizes?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json
[solution]: https://azure.microsoft.com/blog/announcing-the-solution-template-for-jenkins-on-azure/
[sla]: https://azure.microsoft.com/support/legal/sla/virtual-machines/
[storage-plugin]: https://wiki.jenkins.io/display/JENKINS/Windows+Azure+Storage+Plugin
[subnet]: /azure/virtual-network/virtual-network-manage-subnet
[vm-agent]: https://wiki.jenkins.io/display/JENKINS/Azure+VM+Agents+plugin
[vnet]: /azure/virtual-network/virtual-networks-overview
[0]: ./media/architecture-jenkins.png
