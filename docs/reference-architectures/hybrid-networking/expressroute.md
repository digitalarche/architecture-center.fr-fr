---
title: Connecter un réseau local à Azure à l’aide d’ExpressRoute
description: Comment implémenter une architecture réseau de site à site sécurisée qui s’étend sur un réseau virtuel Azure et un réseau local connecté à l’aide d’Azure ExpressRoute.
author: telmosampaio
ms.date: 11/28/2016
pnp.series.title: Connect an on-premises network to Azure
pnp.series.next: expressroute-vpn-failover
pnp.series.prev: vpn
cardTitle: ExpressRoute
ms.openlocfilehash: 754542b37988e0cd2694ae84eb6b03d68c147243
ms.sourcegitcommit: b2a4eb132857afa70201e28d662f18458865a48e
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/05/2018
ms.locfileid: "48819174"
---
# <a name="connect-an-on-premises-network-to-azure-using-expressroute"></a><span data-ttu-id="7254b-103">Connecter un réseau local à Azure à l’aide d’ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="7254b-103">Connect an on-premises network to Azure using ExpressRoute</span></span>

<span data-ttu-id="7254b-104">Cette architecture de référence montre comment connecter un réseau local à des réseaux virtuels dans Azure, avec [Azure ExpressRoute][expressroute-introduction].</span><span class="sxs-lookup"><span data-stu-id="7254b-104">This reference architecture shows how to connect an on-premises network to virtual networks on Azure, using [Azure ExpressRoute][expressroute-introduction].</span></span> <span data-ttu-id="7254b-105">Les connexions ExpressRoute utilisent une connexion privée et dédiée via un fournisseur de connectivité tiers.</span><span class="sxs-lookup"><span data-stu-id="7254b-105">ExpressRoute connections use a private, dedicated connection through a third-party connectivity provider.</span></span> <span data-ttu-id="7254b-106">La connexion privée étend votre réseau local à Azure.</span><span class="sxs-lookup"><span data-stu-id="7254b-106">The private connection extends your on-premises network into Azure.</span></span> [<span data-ttu-id="7254b-107">**Déployez cette solution**.</span><span class="sxs-lookup"><span data-stu-id="7254b-107">**Deploy this solution**.</span></span>](#deploy-the-solution)

<span data-ttu-id="7254b-108">![[0]][0]</span><span class="sxs-lookup"><span data-stu-id="7254b-108">![[0]][0]</span></span>

<span data-ttu-id="7254b-109">*Téléchargez un [fichier Visio][visio-download] de cette architecture.*</span><span class="sxs-lookup"><span data-stu-id="7254b-109">*Download a [Visio file][visio-download] of this architecture.*</span></span>

## <a name="architecture"></a><span data-ttu-id="7254b-110">Architecture</span><span class="sxs-lookup"><span data-stu-id="7254b-110">Architecture</span></span>

<span data-ttu-id="7254b-111">L’architecture est constituée des composants suivants.</span><span class="sxs-lookup"><span data-stu-id="7254b-111">The architecture consists of the following components.</span></span>

* <span data-ttu-id="7254b-112">**Réseau d’entreprise local**.</span><span class="sxs-lookup"><span data-stu-id="7254b-112">**On-premises corporate network**.</span></span> <span data-ttu-id="7254b-113">Un réseau local privé qui s’exécute au sein d’une organisation.</span><span class="sxs-lookup"><span data-stu-id="7254b-113">A private local-area network running within an organization.</span></span>

* <span data-ttu-id="7254b-114">**Circuit ExpressRoute**.</span><span class="sxs-lookup"><span data-stu-id="7254b-114">**ExpressRoute circuit**.</span></span> <span data-ttu-id="7254b-115">Un circuit de couche 2 ou 3 fourni par le fournisseur de connectivité et qui relie le réseau local à Azure via les routeurs de périphérie.</span><span class="sxs-lookup"><span data-stu-id="7254b-115">A layer 2 or layer 3 circuit supplied by the connectivity provider that joins the on-premises network with Azure through the edge routers.</span></span> <span data-ttu-id="7254b-116">Le circuit utilise l’infrastructure matérielle gérée par le fournisseur de connectivité.</span><span class="sxs-lookup"><span data-stu-id="7254b-116">The circuit uses the hardware infrastructure managed by the connectivity provider.</span></span>

* <span data-ttu-id="7254b-117">**Routeurs de périphérie locaux**.</span><span class="sxs-lookup"><span data-stu-id="7254b-117">**Local edge routers**.</span></span> <span data-ttu-id="7254b-118">Les routeurs qui connectent le réseau local au circuit géré par le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="7254b-118">Routers that connect the on-premises network to the circuit managed by the provider.</span></span> <span data-ttu-id="7254b-119">Selon l’approvisionnement de votre connexion, vous devrez peut-être fournir les adresses IP publiques utilisées par les routeurs.</span><span class="sxs-lookup"><span data-stu-id="7254b-119">Depending on how your connection is provisioned, you may need to provide the public IP addresses used by the routers.</span></span>
* <span data-ttu-id="7254b-120">**Routeurs Microsoft Edge**.</span><span class="sxs-lookup"><span data-stu-id="7254b-120">**Microsoft edge routers**.</span></span> <span data-ttu-id="7254b-121">Avec deux routeurs, vous disposez d’une configuration hautement disponible en mode actif-actif.</span><span class="sxs-lookup"><span data-stu-id="7254b-121">Two routers in an active-active highly available configuration.</span></span> <span data-ttu-id="7254b-122">Ces routeurs permettent à un fournisseur de connectivité de connecter ses circuits directement à son centre de données.</span><span class="sxs-lookup"><span data-stu-id="7254b-122">These routers enable a connectivity provider to connect their circuits directly to their datacenter.</span></span> <span data-ttu-id="7254b-123">Selon l’approvisionnement de votre connexion, vous devrez peut-être fournir les adresses IP publiques utilisées par les routeurs.</span><span class="sxs-lookup"><span data-stu-id="7254b-123">Depending on how your connection is provisioned, you may need to provide the public IP addresses used by the routers.</span></span>

* <span data-ttu-id="7254b-124">**Réseaux virtuels (VNet) Azure**</span><span class="sxs-lookup"><span data-stu-id="7254b-124">**Azure virtual networks (VNets)**.</span></span> <span data-ttu-id="7254b-125">Chaque réseau virtuel se trouve dans une région Azure unique et peut héberger plusieurs niveaux d’application.</span><span class="sxs-lookup"><span data-stu-id="7254b-125">Each VNet resides in a single Azure region, and can host multiple application tiers.</span></span> <span data-ttu-id="7254b-126">Les niveaux d’application peuvent être segmentés à l’aide de sous-réseaux dans chaque réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="7254b-126">Application tiers can be segmented using subnets in each VNet.</span></span>

* <span data-ttu-id="7254b-127">**Services publics Azure**.</span><span class="sxs-lookup"><span data-stu-id="7254b-127">**Azure public services**.</span></span> <span data-ttu-id="7254b-128">Les services Azure qui peuvent être utilisés dans une application hybride.</span><span class="sxs-lookup"><span data-stu-id="7254b-128">Azure services that can be used within a hybrid application.</span></span> <span data-ttu-id="7254b-129">Ces services sont également disponibles par Internet, mais en y accédant via un circuit ExpressRoute, vous profitez d’une latence faible et de performances plus prévisibles, étant donné que le trafic ne passe pas par Internet.</span><span class="sxs-lookup"><span data-stu-id="7254b-129">These services are also available over the Internet, but accessing them using an ExpressRoute circuit provides low latency and more predictable performance, because traffic does not go through the Internet.</span></span> <span data-ttu-id="7254b-130">Les connexions sont effectuées à l’aide de [l’homologation publique][expressroute-peering], avec des adresses qui appartiennent soit à votre organisation, soit à votre fournisseur de connectivité.</span><span class="sxs-lookup"><span data-stu-id="7254b-130">Connections are performed using [public peering][expressroute-peering], with addresses that are either owned by your organization or supplied by your connectivity provider.</span></span>

* <span data-ttu-id="7254b-131">**Services Office 365**.</span><span class="sxs-lookup"><span data-stu-id="7254b-131">**Office 365 services**.</span></span> <span data-ttu-id="7254b-132">Les applications et services Office 365 publics fournis par Microsoft.</span><span class="sxs-lookup"><span data-stu-id="7254b-132">The publicly available Office 365 applications and services provided by Microsoft.</span></span> <span data-ttu-id="7254b-133">Les connexions sont effectuées à l’aide de [l’homologation Microsoft][expressroute-peering], avec des adresses qui appartiennent soit à votre organisation, soit à votre fournisseur de connectivité.</span><span class="sxs-lookup"><span data-stu-id="7254b-133">Connections are performed using [Microsoft peering][expressroute-peering], with addresses that are either owned by your organization or supplied by your connectivity provider.</span></span> <span data-ttu-id="7254b-134">Vous pouvez également vous connecter directement à Microsoft CRM Online via l’homologation Microsoft.</span><span class="sxs-lookup"><span data-stu-id="7254b-134">You can also connect directly to Microsoft CRM Online through Microsoft peering.</span></span>

* <span data-ttu-id="7254b-135">**Fournisseurs de connectivité** (non affiché).</span><span class="sxs-lookup"><span data-stu-id="7254b-135">**Connectivity providers** (not shown).</span></span> <span data-ttu-id="7254b-136">Les sociétés qui fournissent une connexion à l’aide d’une connectivité de couche 2 ou 3 entre votre centre de données et un centre de données Azure.</span><span class="sxs-lookup"><span data-stu-id="7254b-136">Companies that provide a connection either using layer 2 or layer 3 connectivity between your datacenter and an Azure datacenter.</span></span>

## <a name="recommendations"></a><span data-ttu-id="7254b-137">Recommandations</span><span class="sxs-lookup"><span data-stu-id="7254b-137">Recommendations</span></span>

<span data-ttu-id="7254b-138">Les recommandations suivantes s’appliquent à la plupart des scénarios.</span><span class="sxs-lookup"><span data-stu-id="7254b-138">The following recommendations apply for most scenarios.</span></span> <span data-ttu-id="7254b-139">Suivez ces recommandations, sauf si vous avez un besoin spécifique qui vous oblige à les ignorer.</span><span class="sxs-lookup"><span data-stu-id="7254b-139">Follow these recommendations unless you have a specific requirement that overrides them.</span></span>

### <a name="connectivity-providers"></a><span data-ttu-id="7254b-140">Fournisseurs de connectivité</span><span class="sxs-lookup"><span data-stu-id="7254b-140">Connectivity providers</span></span>

<span data-ttu-id="7254b-141">Sélectionnez un fournisseur de connectivité ExpressRoute adapté selon votre localisation.</span><span class="sxs-lookup"><span data-stu-id="7254b-141">Select a suitable ExpressRoute connectivity provider for your location.</span></span> <span data-ttu-id="7254b-142">Pour obtenir une liste des fournisseurs de connectivité disponibles pour votre localisation, utilisez la commande Azure PowerShell suivante :</span><span class="sxs-lookup"><span data-stu-id="7254b-142">To get a list of connectivity providers available at your location, use the following Azure PowerShell command:</span></span>

```powershell
Get-AzureRmExpressRouteServiceProvider
```

<span data-ttu-id="7254b-143">Les fournisseurs de connectivité ExpressRoute connectent votre centre de données à Microsoft, comme suit :</span><span class="sxs-lookup"><span data-stu-id="7254b-143">ExpressRoute connectivity providers connect your datacenter to Microsoft in the following ways:</span></span>

* <span data-ttu-id="7254b-144">**Colocalisation avec un échange de cloud**.</span><span class="sxs-lookup"><span data-stu-id="7254b-144">**Co-located at a cloud exchange**.</span></span> <span data-ttu-id="7254b-145">Si vous êtes colocalisé avec une installation dans le cadre d’un échange de cloud, vous pouvez commander des interconnexions virtuelles vers Azure via l’échange Ethernet du fournisseur de colocalisation.</span><span class="sxs-lookup"><span data-stu-id="7254b-145">If you're co-located in a facility with a cloud exchange, you can order virtual cross-connections to Azure through the co-location provider’s Ethernet exchange.</span></span> <span data-ttu-id="7254b-146">Les fournisseurs de colocalisation peuvent offrir des interconnexions de couche 2 ou des interconnexions de couche 3 gérées entre votre infrastructure dans l’installation de colocalisation et Azure.</span><span class="sxs-lookup"><span data-stu-id="7254b-146">Co-location providers can offer either layer 2 cross-connections, or managed layer 3 cross-connections between your infrastructure in the co-location facility and Azure.</span></span>
* <span data-ttu-id="7254b-147">**Connexions Ethernet point à point**.</span><span class="sxs-lookup"><span data-stu-id="7254b-147">**Point-to-point Ethernet connections**.</span></span> <span data-ttu-id="7254b-148">Vous pouvez connecter vos centres de données/bureaux locaux à Azure via des liaisons Ethernet point à point.</span><span class="sxs-lookup"><span data-stu-id="7254b-148">You can connect your on-premises datacenters/offices to Azure through point-to-point Ethernet links.</span></span> <span data-ttu-id="7254b-149">Les fournisseurs Ethernet point à point peuvent offrir des connexions de couche 2 ou des connexions de couche 3 gérées entre votre site et Azure.</span><span class="sxs-lookup"><span data-stu-id="7254b-149">Point-to-point Ethernet providers can offer layer 2 connections, or managed layer 3 connections between your site and Azure.</span></span>
* <span data-ttu-id="7254b-150">**Réseaux universels (IPVPN)**.</span><span class="sxs-lookup"><span data-stu-id="7254b-150">**Any-to-any (IPVPN) networks**.</span></span> <span data-ttu-id="7254b-151">Vous pouvez intégrer votre réseau étendu (WAN) avec Azure.</span><span class="sxs-lookup"><span data-stu-id="7254b-151">You can integrate your wide area network (WAN) with Azure.</span></span> <span data-ttu-id="7254b-152">Les fournisseurs d’IPVPN (en général un VPN MPLS) offrent une connectivité universelle entre vos succursales et vos centres de données.</span><span class="sxs-lookup"><span data-stu-id="7254b-152">Internet protocol virtual private network (IPVPN) providers (typically a multiprotocol label switching VPN) offer any-to-any connectivity between your branch offices and datacenters.</span></span> <span data-ttu-id="7254b-153">Azure peut être interconnecté à votre réseau étendu afin qu’il apparaisse comme n’importe quelle autre succursale.</span><span class="sxs-lookup"><span data-stu-id="7254b-153">Azure can be interconnected to your WAN to make it look just like any other branch office.</span></span> <span data-ttu-id="7254b-154">Les fournisseurs de réseaux étendus offrent généralement une connectivité de couche 3 gérée.</span><span class="sxs-lookup"><span data-stu-id="7254b-154">WAN providers typically offer managed layer 3 connectivity.</span></span>

<span data-ttu-id="7254b-155">Pour plus d’informations sur les fournisseurs de connectivité, consultez l’article [Présentation d’ExpressRoute][expressroute-introduction].</span><span class="sxs-lookup"><span data-stu-id="7254b-155">For more information about connectivity providers, see the [ExpressRoute introduction][expressroute-introduction].</span></span>

### <a name="expressroute-circuit"></a><span data-ttu-id="7254b-156">Circuit ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="7254b-156">ExpressRoute circuit</span></span>

<span data-ttu-id="7254b-157">Vérifiez que votre organisation répond à la [configuration requise d’ExpressRoute][expressroute-prereqs] pour se connecter à Azure.</span><span class="sxs-lookup"><span data-stu-id="7254b-157">Ensure that your organization has met the [ExpressRoute prerequisite requirements][expressroute-prereqs] for connecting to Azure.</span></span>

<span data-ttu-id="7254b-158">Si ce n’est pas déjà fait, ajoutez un sous-réseau nommé `GatewaySubnet` à votre réseau virtuel Azure et créez une passerelle de réseau virtuel ExpressRoute à l’aide du service de passerelle VPN Azure.</span><span class="sxs-lookup"><span data-stu-id="7254b-158">If you haven't already done so, add a subnet named `GatewaySubnet` to your Azure VNet and create an ExpressRoute virtual network gateway using the Azure VPN gateway service.</span></span> <span data-ttu-id="7254b-159">Pour plus d’informations sur ce processus, consultez l’article [Workflows ExpressRoute d’approvisionnement du circuit et états du circuit][ExpressRoute-provisioning].</span><span class="sxs-lookup"><span data-stu-id="7254b-159">For more information about this process, see [ExpressRoute workflows for circuit provisioning and circuit states][ExpressRoute-provisioning].</span></span>

<span data-ttu-id="7254b-160">Créez un circuit ExpressRoute comme suit :</span><span class="sxs-lookup"><span data-stu-id="7254b-160">Create an ExpressRoute circuit as follows:</span></span>

1. <span data-ttu-id="7254b-161">Exécutez la commande PowerShell suivante :</span><span class="sxs-lookup"><span data-stu-id="7254b-161">Run the following PowerShell command:</span></span>
   
    ```powershell
    New-AzureRmExpressRouteCircuit -Name <<circuit-name>> -ResourceGroupName <<resource-group>> -Location <<location>> -SkuTier <<sku-tier>> -SkuFamily <<sku-family>> -ServiceProviderName <<service-provider-name>> -PeeringLocation <<peering-location>> -BandwidthInMbps <<bandwidth-in-mbps>>
    ```
2. <span data-ttu-id="7254b-162">Envoyez le `ServiceKey` du nouveau circuit au fournisseur de services.</span><span class="sxs-lookup"><span data-stu-id="7254b-162">Send the `ServiceKey` for the new circuit to the service provider.</span></span>

3. <span data-ttu-id="7254b-163">Attendez que le fournisseur approvisionne le circuit.</span><span class="sxs-lookup"><span data-stu-id="7254b-163">Wait for the provider to provision the circuit.</span></span> <span data-ttu-id="7254b-164">Pour vérifier l’état d’approvisionnement d’un circuit, exécutez la commande PowerShell suivante :</span><span class="sxs-lookup"><span data-stu-id="7254b-164">To verify the provisioning state of a circuit, run the following PowerShell command:</span></span>
   
    ```powershell
    Get-AzureRmExpressRouteCircuit -Name <<circuit-name>> -ResourceGroupName <<resource-group>>
    ```

    <span data-ttu-id="7254b-165">Le champ `Provisioning state` de la section `Service Provider` du résultat passera de `NotProvisioned` à `Provisioned` une fois le circuit prêt.</span><span class="sxs-lookup"><span data-stu-id="7254b-165">The `Provisioning state` field in the `Service Provider` section of the output will change from `NotProvisioned` to `Provisioned` when the circuit is ready.</span></span>

    > [!NOTE]
    > <span data-ttu-id="7254b-166">Si vous utilisez une connexion de couche 3, le fournisseur doit configurer et gérer le routage à votre place.</span><span class="sxs-lookup"><span data-stu-id="7254b-166">If you're using a layer 3 connection, the provider should configure and manage routing for you.</span></span> <span data-ttu-id="7254b-167">Vous fournissez les informations nécessaires pour permettre au fournisseur d’implémenter les itinéraires appropriés.</span><span class="sxs-lookup"><span data-stu-id="7254b-167">You provide the information necessary to enable the provider to implement the appropriate routes.</span></span>
    > 
    > 

4. <span data-ttu-id="7254b-168">Si vous utilisez une connexion de couche 2 :</span><span class="sxs-lookup"><span data-stu-id="7254b-168">If you're using a layer 2 connection:</span></span>

    1. <span data-ttu-id="7254b-169">Réservez deux sous-réseaux /30 constitués d’adresses IP publiques valides pour chaque type d’homologation que vous souhaitez implémenter.</span><span class="sxs-lookup"><span data-stu-id="7254b-169">Reserve two /30 subnets composed of valid public IP addresses for each type of peering you want to implement.</span></span> <span data-ttu-id="7254b-170">Ces sous-réseaux /30 seront utilisés pour fournir des adresses IP aux routeurs utilisés pour le circuit.</span><span class="sxs-lookup"><span data-stu-id="7254b-170">These /30 subnets will be used to provide IP addresses for the routers used for the circuit.</span></span> <span data-ttu-id="7254b-171">Si vous implémentez une homologation privée, publique ou Microsoft, vous aurez besoin de 6 sous-réseaux /30 avec des adresses IP publiques valides.</span><span class="sxs-lookup"><span data-stu-id="7254b-171">If you are implementing private, public, and Microsoft peering, you'll need 6 /30 subnets with valid public IP addresses.</span></span>     

    2. <span data-ttu-id="7254b-172">Configurez l’acheminement pour le circuit ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="7254b-172">Configure routing for the ExpressRoute circuit.</span></span> <span data-ttu-id="7254b-173">Exécutez les commandes PowerShell suivantes pour chaque type d’homologation à configurer (privée, publique et Microsoft).</span><span class="sxs-lookup"><span data-stu-id="7254b-173">Run the following PowerShell commands for each type of peering you want to configure (private, public, and Microsoft).</span></span> <span data-ttu-id="7254b-174">Pour plus d’informations, consultez l’article [Créer et modifier l’acheminement d’un circuit ExpressRoute à l’aide de PowerShell][configure-expressroute-routing].</span><span class="sxs-lookup"><span data-stu-id="7254b-174">For more information, see [Create and modify routing for an ExpressRoute circuit][configure-expressroute-routing].</span></span>
   
        ```powershell
        Set-AzureRmExpressRouteCircuitPeeringConfig -Name <<peering-name>> -Circuit <<circuit-name>> -PeeringType <<peering-type>> -PeerASN <<peer-asn>> -PrimaryPeerAddressPrefix <<primary-peer-address-prefix>> -SecondaryPeerAddressPrefix <<secondary-peer-address-prefix>> -VlanId <<vlan-id>>

        Set-AzureRmExpressRouteCircuit -ExpressRouteCircuit <<circuit-name>>
        ```

    3. <span data-ttu-id="7254b-175">Réservez un autre pool d’adresses IP publiques valides à utiliser pour la traduction d’adresse réseau (NAT) pour l’homologation publique et Microsoft.</span><span class="sxs-lookup"><span data-stu-id="7254b-175">Reserve another pool of valid public IP addresses to use for network address translation (NAT) for public and Microsoft peering.</span></span> <span data-ttu-id="7254b-176">Il est recommandé d’avoir un pool différent pour chaque homologation.</span><span class="sxs-lookup"><span data-stu-id="7254b-176">It is recommended to have a different pool for each peering.</span></span> <span data-ttu-id="7254b-177">Indiquez le pool à votre fournisseur de connectivité, afin qu’il puisse configurer des annonces (BGP) pour ces plages.</span><span class="sxs-lookup"><span data-stu-id="7254b-177">Specify the pool to your connectivity provider, so they can configure border gateway protocol (BGP) advertisements for those ranges.</span></span>

5. <span data-ttu-id="7254b-178">Exécutez les commandes PowerShell suivantes pour lier votre ou vos réseaux virtuels privés au circuit ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="7254b-178">Run the following PowerShell commands to link your private VNet(s) to the ExpressRoute circuit.</span></span> <span data-ttu-id="7254b-179">Pour plus d’informations, consultez l’article [Liaison d’un réseau virtuel à un circuit ExpressRoute][link-vnet-to-expressroute].</span><span class="sxs-lookup"><span data-stu-id="7254b-179">For more information,see [Link a virtual network to an ExpressRoute circuit][link-vnet-to-expressroute].</span></span>

    ```powershell
    $circuit = Get-AzureRmExpressRouteCircuit -Name <<circuit-name>> -ResourceGroupName <<resource-group>>
    $gw = Get-AzureRmVirtualNetworkGateway -Name <<gateway-name>> -ResourceGroupName <<resource-group>>
    New-AzureRmVirtualNetworkGatewayConnection -Name <<connection-name>> -ResourceGroupName <<resource-group>> -Location <<location> -VirtualNetworkGateway1 $gw -PeerId $circuit.Id -ConnectionType ExpressRoute
    ```

<span data-ttu-id="7254b-180">Vous pouvez connecter plusieurs réseaux virtuels situés dans des régions différentes à un même circuit ExpressRoute, tant que tous les réseaux virtuels et le circuit ExpressRoute sont situés dans la même région géopolitique.</span><span class="sxs-lookup"><span data-stu-id="7254b-180">You can connect multiple VNets located in different regions to the same ExpressRoute circuit, as long as all VNets and the ExpressRoute circuit are located within the same geopolitical region.</span></span>

### <a name="troubleshooting"></a><span data-ttu-id="7254b-181">Résolution de problèmes</span><span class="sxs-lookup"><span data-stu-id="7254b-181">Troubleshooting</span></span> 

<span data-ttu-id="7254b-182">Si un circuit ExpressRoute qui fonctionnait ne parvient plus à se connecter, en l’absence de toute modification de configuration en local ou sur votre réseau privé virtuel, vous devrez peut-être contacter le fournisseur de connectivité et travailler avec lui pour résoudre le problème.</span><span class="sxs-lookup"><span data-stu-id="7254b-182">If a previously functioning ExpressRoute circuit now fails to connect, in the absence of any configuration changes on-premises or within your private VNet, you may need to contact the connectivity provider and work with them to correct the issue.</span></span> <span data-ttu-id="7254b-183">Pour vérifier que le circuit ExpressRoute a été approvisionné, utilisez les commandes Powershell suivantes :</span><span class="sxs-lookup"><span data-stu-id="7254b-183">Use the following Powershell commands to verify that the ExpressRoute circuit has been provisioned:</span></span>

```powershell
Get-AzureRmExpressRouteCircuit -Name <<circuit-name>> -ResourceGroupName <<resource-group>>
```

<span data-ttu-id="7254b-184">Le résultat de cette commande montre plusieurs propriétés de votre circuit, y compris `ProvisioningState`, `CircuitProvisioningState` et `ServiceProviderProvisioningState` comme vous pouvez le voir ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="7254b-184">The output of this command shows several properties for your circuit, including `ProvisioningState`, `CircuitProvisioningState`, and `ServiceProviderProvisioningState` as shown below.</span></span>

```
ProvisioningState                : Succeeded
Sku                              : {
                                     "Name": "Standard_MeteredData",
                                     "Tier": "Standard",
                                     "Family": "MeteredData"
                                   }
CircuitProvisioningState         : Enabled
ServiceProviderProvisioningState : NotProvisioned
```

<span data-ttu-id="7254b-185">Si `ProvisioningState` n’est pas défini sur `Succeeded` une fois que vous avez tenté de créer un nouveau circuit, supprimez le circuit en utilisant la commande ci-dessous et essayez de le créer à nouveau.</span><span class="sxs-lookup"><span data-stu-id="7254b-185">If the `ProvisioningState` is not set to `Succeeded` after you tried to create a new circuit, remove the circuit by using the command below and try to create it again.</span></span>

```powershell
Remove-AzureRmExpressRouteCircuit -Name <<circuit-name>> -ResourceGroupName <<resource-group>>
```

<span data-ttu-id="7254b-186">Si votre fournisseur avait déjà approvisionné le circuit et que `ProvisioningState` est défini sur `Failed`, ou que `CircuitProvisioningState` n’est pas `Enabled`, contactez votre fournisseur pour obtenir de l’aide.</span><span class="sxs-lookup"><span data-stu-id="7254b-186">If your provider had already provisioned the circuit, and the `ProvisioningState` is set to `Failed`, or the `CircuitProvisioningState` is not `Enabled`, contact your provider for further assistance.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="7254b-187">Considérations relatives à l’extensibilité</span><span class="sxs-lookup"><span data-stu-id="7254b-187">Scalability considerations</span></span>

<span data-ttu-id="7254b-188">Les circuits ExpressRoute fournissent un chemin à bande passante élevée entre les réseaux.</span><span class="sxs-lookup"><span data-stu-id="7254b-188">ExpressRoute circuits provide a high bandwidth path between networks.</span></span> <span data-ttu-id="7254b-189">En règle générale, plus la bande passante est élevée, plus c’est cher.</span><span class="sxs-lookup"><span data-stu-id="7254b-189">Generally, the higher the bandwidth the greater the cost.</span></span> 

<span data-ttu-id="7254b-190">ExpressRoute propose deux [plans de tarification][expressroute-pricing] à ses clients, un plan de données limité et plan de données illimité.</span><span class="sxs-lookup"><span data-stu-id="7254b-190">ExpressRoute offers two [pricing plans][expressroute-pricing] to customers, a metered plan and an unlimited data plan.</span></span> <span data-ttu-id="7254b-191">Les frais varient en fonction de la bande passante du circuit.</span><span class="sxs-lookup"><span data-stu-id="7254b-191">Charges vary according to circuit bandwidth.</span></span> <span data-ttu-id="7254b-192">La bande passante disponible varie d’un fournisseur à l’autre.</span><span class="sxs-lookup"><span data-stu-id="7254b-192">Available bandwidth will likely vary from provider to provider.</span></span> <span data-ttu-id="7254b-193">Utilisez l’applet de commande `Get-AzureRmExpressRouteServiceProvider` pour voir les fournisseurs disponibles dans votre région et les bandes passantes qu’ils proposent.</span><span class="sxs-lookup"><span data-stu-id="7254b-193">Use the `Get-AzureRmExpressRouteServiceProvider` cmdlet to see the providers available in your region and the bandwidths that they offer.</span></span>
 
<span data-ttu-id="7254b-194">Un même circuit ExpressRoute peut prendre en charge un certain nombre d’homologations et de liens de réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="7254b-194">A single ExpressRoute circuit can support a certain number of peerings and VNet links.</span></span> <span data-ttu-id="7254b-195">Pour plus d’informations, consultez l’article sur les [limites d’ExpressRoute](/azure/azure-subscription-service-limits).</span><span class="sxs-lookup"><span data-stu-id="7254b-195">See [ExpressRoute limits](/azure/azure-subscription-service-limits) for more information.</span></span>

<span data-ttu-id="7254b-196">Le module complémentaire ExpressRoute Premium propose certaines fonctionnalités payantes supplémentaires :</span><span class="sxs-lookup"><span data-stu-id="7254b-196">For an extra charge, the ExpressRoute Premium add-on provides some additional capability:</span></span>

* <span data-ttu-id="7254b-197">Augmentation des limites d'itinéraire pour l'homologation publique et privée.</span><span class="sxs-lookup"><span data-stu-id="7254b-197">Increased route limits for public and private peering.</span></span> 
* <span data-ttu-id="7254b-198">Augmentation du nombre de liens de réseau virtuel par circuit ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="7254b-198">Increased number of VNet links per ExpressRoute circuit.</span></span> 
* <span data-ttu-id="7254b-199">Connectivité globale des services.</span><span class="sxs-lookup"><span data-stu-id="7254b-199">Global connectivity for services.</span></span>

<span data-ttu-id="7254b-200">Pour plus de détails, consultez la page sur la [tarification d’ExpressRoute][expressroute-pricing].</span><span class="sxs-lookup"><span data-stu-id="7254b-200">See [ExpressRoute pricing][expressroute-pricing] for details.</span></span> 

<span data-ttu-id="7254b-201">La conception des circuits ExpressRoute vous permet d’augmenter temporairement jusqu’à deux fois la limite de la bande passante obtenue sur le réseau sans frais supplémentaires,</span><span class="sxs-lookup"><span data-stu-id="7254b-201">ExpressRoute circuits are designed to allow temporary network bursts up to two times the bandwidth limit that you procured for no additional cost.</span></span> <span data-ttu-id="7254b-202">grâce à des liens redondants.</span><span class="sxs-lookup"><span data-stu-id="7254b-202">This is achieved by using redundant links.</span></span> <span data-ttu-id="7254b-203">Toutefois, tous les fournisseurs de connectivité ne prennent pas en charge cette fonction.</span><span class="sxs-lookup"><span data-stu-id="7254b-203">However, not all connectivity providers support this feature.</span></span> <span data-ttu-id="7254b-204">Avant toute chose, vérifiez donc que votre fournisseur de connectivité propose cette fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="7254b-204">Verify that your connectivity provider enables this feature before depending on it.</span></span>

<span data-ttu-id="7254b-205">Bien que certains fournisseurs vous permettent de modifier votre bande passante, assurez-vous de choisir une bande passante initiale qui dépasse vos besoins et vous donne la possibilité d’évoluer.</span><span class="sxs-lookup"><span data-stu-id="7254b-205">Although some providers allow you to change your bandwidth, make sure you pick an initial bandwidth that surpasses your needs and provides room for growth.</span></span> <span data-ttu-id="7254b-206">Si vous avez besoin d’augmenter la bande passante à l’avenir, vous avez deux choix :</span><span class="sxs-lookup"><span data-stu-id="7254b-206">If you need to increase bandwidth in the future, you are left with two options:</span></span>

- <span data-ttu-id="7254b-207">Augmentez la bande passante.</span><span class="sxs-lookup"><span data-stu-id="7254b-207">Increase the bandwidth.</span></span> <span data-ttu-id="7254b-208">Si possible, évitez cette option, car tous les fournisseurs ne vous permettent pas d’augmenter la bande passante de façon dynamique.</span><span class="sxs-lookup"><span data-stu-id="7254b-208">You should avoid this option as much as possible, and not all providers allow you to increase bandwidth dynamically.</span></span> <span data-ttu-id="7254b-209">Si vous avez vraiment besoin d’augmenter votre bande passante, contactez votre fournisseur pour vérifier qu’il prend en charge la modification des propriétés de bande passante ExpressRoute via les commandes Powershell.</span><span class="sxs-lookup"><span data-stu-id="7254b-209">But if a bandwidth increase is needed, check with your provider to verify they support changing ExpressRoute bandwidth properties via Powershell commands.</span></span> <span data-ttu-id="7254b-210">Si c’est le cas, exécutez les commandes ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="7254b-210">If they do, run the commands below.</span></span>

    ```powershell
    $ckt = Get-AzureRmExpressRouteCircuit -Name <<circuit-name>> -ResourceGroupName <<resource-group>>
    $ckt.ServiceProviderProperties.BandwidthInMbps = <<bandwidth-in-mbps>>
    Set-AzureRmExpressRouteCircuit -ExpressRouteCircuit $ckt
    ```

    <span data-ttu-id="7254b-211">Vous pouvez augmenter votre bande passante sans perte de connectivité.</span><span class="sxs-lookup"><span data-stu-id="7254b-211">You can increase the bandwidth without loss of connectivity.</span></span> <span data-ttu-id="7254b-212">La rétrogradation de la bande passante entraîne une interruption de connectivité, car vous devez supprimer le circuit et le recréer avec la nouvelle configuration.</span><span class="sxs-lookup"><span data-stu-id="7254b-212">Downgrading the bandwidth will result in disruption in connectivity, because you must delete the circuit and recreate it with the new configuration.</span></span>

- <span data-ttu-id="7254b-213">Changez de plan de tarification et/ou passez à la version Premium.</span><span class="sxs-lookup"><span data-stu-id="7254b-213">Change your pricing plan and/or upgrade to Premium.</span></span> <span data-ttu-id="7254b-214">Pour ce faire, exécutez les commandes suivantes :</span><span class="sxs-lookup"><span data-stu-id="7254b-214">To do so, run the following commands.</span></span> <span data-ttu-id="7254b-215">La propriété `Sku.Tier` peut avoir la valeur `Standard` ou `Premium` ; la propriété `Sku.Name` peut avoir la valeur `MeteredData` ou `UnlimitedData`.</span><span class="sxs-lookup"><span data-stu-id="7254b-215">The `Sku.Tier` property can be `Standard` or `Premium`; the `Sku.Name` property can be `MeteredData` or `UnlimitedData`.</span></span>

    ```powershell
    $ckt = Get-AzureRmExpressRouteCircuit -Name <<circuit-name>> -ResourceGroupName <<resource-group>>

    $ckt.Sku.Tier = "Premium"
    $ckt.Sku.Family = "MeteredData"
    $ckt.Sku.Name = "Premium_MeteredData"

    Set-AzureRmExpressRouteCircuit -ExpressRouteCircuit $ckt
    ```

    > [!IMPORTANT]
    > <span data-ttu-id="7254b-216">Assurez-vous que la propriété `Sku.Name` correspond aux propriétés `Sku.Tier` et `Sku.Family`.</span><span class="sxs-lookup"><span data-stu-id="7254b-216">Make sure the `Sku.Name` property matches the `Sku.Tier` and `Sku.Family`.</span></span> <span data-ttu-id="7254b-217">Si vous modifiez la famille et la couche, mais pas le nom, votre connexion sera désactivée.</span><span class="sxs-lookup"><span data-stu-id="7254b-217">If you change the family and tier, but not the name, your connection will be disabled.</span></span>
    > 
    > 

    <span data-ttu-id="7254b-218">Vous pouvez mettre à niveau la référence SKU sans interruption, mais vous ne pouvez pas passer du plan de tarification illimité au plan limité.</span><span class="sxs-lookup"><span data-stu-id="7254b-218">You can upgrade the SKU without disruption, but you cannot switch from the unlimited pricing plan to metered.</span></span> <span data-ttu-id="7254b-219">Lorsque vous rétrogradez la référence SKU, votre consommation de bande passante doit rester dans la limite par défaut de la référence SKU standard.</span><span class="sxs-lookup"><span data-stu-id="7254b-219">When downgrading the SKU, your bandwidth consumption must remain within the default limit of the standard SKU.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="7254b-220">Considérations relatives à la disponibilité</span><span class="sxs-lookup"><span data-stu-id="7254b-220">Availability considerations</span></span>

<span data-ttu-id="7254b-221">ExpressRoute ne prend pas en charge les protocoles de redondance de routeur tels que le protocole HSRP (Hot Standby Router Protocol) et le protocole VRRP (Virtual Router Redundancy Protocol) pour garantir la haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="7254b-221">ExpressRoute does not support router redundancy protocols such as hot standby routing protocol (HSRP) and virtual router redundancy protocol (VRRP) to implement high availability.</span></span> <span data-ttu-id="7254b-222">Il utilise une paire de sessions BGP redondantes pour chaque homologation.</span><span class="sxs-lookup"><span data-stu-id="7254b-222">Instead, it uses a redundant pair of BGP sessions per peering.</span></span> <span data-ttu-id="7254b-223">Pour faciliter les connexions hautement disponibles à votre réseau, Azure vous fournit deux ports redondants sur deux routeurs (compris avec Microsoft Edge) dans une configuration actif-actif.</span><span class="sxs-lookup"><span data-stu-id="7254b-223">To facilitate highly-available connections to your network, Azure provisions you with two redundant ports on two routers (part of the Microsoft edge) in an active-active configuration.</span></span>

<span data-ttu-id="7254b-224">Par défaut, les sessions BGP utilisent un délai d’inactivité de 60 secondes.</span><span class="sxs-lookup"><span data-stu-id="7254b-224">By default, BGP sessions use an idle timeout value of 60 seconds.</span></span> <span data-ttu-id="7254b-225">Si une session expire trois fois (180 secondes au total), le routeur est marqué comme non disponible et tout le trafic est redirigé vers le routeur restant.</span><span class="sxs-lookup"><span data-stu-id="7254b-225">If a session times out three times (180 seconds total), the router is marked as unavailable, and all traffic is redirected to the remaining router.</span></span> <span data-ttu-id="7254b-226">Ce délai d’attente de 180 secondes peut être trop long pour certaines applications critiques.</span><span class="sxs-lookup"><span data-stu-id="7254b-226">This 180-second timeout might be too long for critical applications.</span></span> <span data-ttu-id="7254b-227">Dans ce cas, vous pouvez modifier vos paramètres de délai d’attente BGP sur le routeur local et choisir une valeur inférieure.</span><span class="sxs-lookup"><span data-stu-id="7254b-227">If so, you can change your BGP time-out settings on the on-premises router to a smaller value.</span></span>

<span data-ttu-id="7254b-228">Vous pouvez configurer la haute disponibilité pour votre connexion Azure de différentes façons, selon votre type de fournisseur et le nombre de circuits ExpressRoute et de connexions de passerelle de réseau virtuel que vous souhaitez configurer.</span><span class="sxs-lookup"><span data-stu-id="7254b-228">You can configure high availability for your Azure connection in different ways, depending on the type of provider you use, and the number of ExpressRoute circuits and virtual network gateway connections you're willing to configure.</span></span> <span data-ttu-id="7254b-229">Voici un résumé des options disponibles :</span><span class="sxs-lookup"><span data-stu-id="7254b-229">The following summarizes your availability options:</span></span>

* <span data-ttu-id="7254b-230">Si vous utilisez une connexion de couche 2, déployez des routeurs redondants sur votre réseau local dans une configuration actif-actif.</span><span class="sxs-lookup"><span data-stu-id="7254b-230">If you're using a layer 2 connection, deploy redundant routers in your on-premises network in an active-active configuration.</span></span> <span data-ttu-id="7254b-231">Connectez le circuit principal à un routeur et le circuit secondaire à l’autre.</span><span class="sxs-lookup"><span data-stu-id="7254b-231">Connect the primary circuit to one router, and the secondary circuit to the other.</span></span> <span data-ttu-id="7254b-232">Vous bénéficierez ainsi d’une connexion hautement disponible aux deux extrémités de la connexion.</span><span class="sxs-lookup"><span data-stu-id="7254b-232">This will give you a highly available connection at both ends of the connection.</span></span> <span data-ttu-id="7254b-233">Cela peut s’avérer nécessaire si vous avez besoin du contrat de niveau de service d’ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="7254b-233">This is necessary if you require the ExpressRoute service level agreement (SLA).</span></span> <span data-ttu-id="7254b-234">Pour plus de détails, consultez l’article [SLA pour Azure ExpressRoute][sla-for-expressroute].</span><span class="sxs-lookup"><span data-stu-id="7254b-234">See [SLA for Azure ExpressRoute][sla-for-expressroute] for details.</span></span>

    <span data-ttu-id="7254b-235">Le diagramme suivant illustre une configuration avec des routeurs redondants locaux connectés au circuit principal et au circuit secondaire.</span><span class="sxs-lookup"><span data-stu-id="7254b-235">The following diagram shows a configuration with redundant on-premises routers connected to the primary and secondary circuits.</span></span> <span data-ttu-id="7254b-236">Chaque circuit gère le trafic pour une homologation publique et une homologation privée (chaque homologation est conçue comme une paire d’espaces d’adressage /30, comme décrit dans la section précédente).</span><span class="sxs-lookup"><span data-stu-id="7254b-236">Each circuit handles the traffic for a public peering and a private peering (each peering is designated a pair of /30 address spaces, as described in the previous section).</span></span>

    <span data-ttu-id="7254b-237">![[1]][1]</span><span class="sxs-lookup"><span data-stu-id="7254b-237">![[1]][1]</span></span>

* <span data-ttu-id="7254b-238">Si vous utilisez une connexion de couche 3, vérifiez qu’elle fournit des sessions BGP redondantes qui gèrent la disponibilité à votre place.</span><span class="sxs-lookup"><span data-stu-id="7254b-238">If you're using a layer 3 connection, verify that it provides redundant BGP sessions that handle availability for you.</span></span>

* <span data-ttu-id="7254b-239">Connectez le réseau virtuel à plusieurs circuits ExpressRoute fournis par différents fournisseurs de services.</span><span class="sxs-lookup"><span data-stu-id="7254b-239">Connect the VNet to multiple ExpressRoute circuits, supplied by different service providers.</span></span> <span data-ttu-id="7254b-240">Cette stratégie vous fournit des fonctionnalités de récupération d’urgence et de haute disponibilité supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="7254b-240">This strategy provides additional high-availability and disaster recovery capabilities.</span></span>

* <span data-ttu-id="7254b-241">Configurez un réseau VPN de site à site comme un chemin d’accès de basculement pour ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="7254b-241">Configure a site-to-site VPN as a failover path for ExpressRoute.</span></span> <span data-ttu-id="7254b-242">Pour en savoir plus sur cette option, consultez l’article [Connecter un réseau local à Azure à l’aide d’ExpressRoute avec basculement VPN][highly-available-network-architecture].</span><span class="sxs-lookup"><span data-stu-id="7254b-242">For more about this option, see [Connect an on-premises network to Azure using ExpressRoute with VPN failover][highly-available-network-architecture].</span></span>
 <span data-ttu-id="7254b-243">Cette option ne s’applique qu’à l’homologation privée.</span><span class="sxs-lookup"><span data-stu-id="7254b-243">This option only applies to private peering.</span></span> <span data-ttu-id="7254b-244">Pour les services Azure et Office 365, Internet est le seul chemin de basculement disponible.</span><span class="sxs-lookup"><span data-stu-id="7254b-244">For Azure and Office 365 services, the Internet is the only failover path.</span></span> 

## <a name="manageability-considerations"></a><span data-ttu-id="7254b-245">Considérations relatives à la facilité de gestion</span><span class="sxs-lookup"><span data-stu-id="7254b-245">Manageability considerations</span></span>

<span data-ttu-id="7254b-246">Vous pouvez utiliser le [kit de connectivité Azure (AzureCT)][azurect] pour contrôler la connectivité entre votre centre de données sur site et Azure.</span><span class="sxs-lookup"><span data-stu-id="7254b-246">You can use the [Azure Connectivity Toolkit (AzureCT)][azurect] to monitor connectivity between your on-premises datacenter and Azure.</span></span> 

## <a name="security-considerations"></a><span data-ttu-id="7254b-247">Considérations relatives à la sécurité</span><span class="sxs-lookup"><span data-stu-id="7254b-247">Security considerations</span></span>

<span data-ttu-id="7254b-248">Vous pouvez configurer les options de sécurité pour votre connexion Azure de différentes façons selon vos besoins en matière de conformité et vos préoccupations en matière de sécurité.</span><span class="sxs-lookup"><span data-stu-id="7254b-248">You can configure security options for your Azure connection in different ways, depending on your security concerns and compliance needs.</span></span> 

<span data-ttu-id="7254b-249">ExpressRoute fonctionne en couche 3.</span><span class="sxs-lookup"><span data-stu-id="7254b-249">ExpressRoute operates in layer 3.</span></span> <span data-ttu-id="7254b-250">Les menaces liées à la couche Application peuvent être évitées à l’aide d’une appliance de sécurité réseau qui limite le trafic aux ressources légitimes.</span><span class="sxs-lookup"><span data-stu-id="7254b-250">Threats in the application layer can be prevented by using a network security appliance that restricts traffic to legitimate resources.</span></span> <span data-ttu-id="7254b-251">En outre, les connexions ExpressRoute qui utilisent l’homologation publique ne peuvent être initiées que sur site.</span><span class="sxs-lookup"><span data-stu-id="7254b-251">Additionally, ExpressRoute connections using public peering can only be initiated from on-premises.</span></span> <span data-ttu-id="7254b-252">Ainsi, les services non autorisés ne peuvent pas accéder aux données locales à partir d’Internet, ni les compromettre.</span><span class="sxs-lookup"><span data-stu-id="7254b-252">This prevents a rogue service from accessing and compromising on-premises data from the Internet.</span></span>

<span data-ttu-id="7254b-253">Pour optimiser la sécurité, ajoutez des appliances de sécurité réseau entre le réseau local et les routeurs de périphérie du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="7254b-253">To maximize security, add network security appliances between the on-premises network and the provider edge routers.</span></span> <span data-ttu-id="7254b-254">Ainsi, vous pourrez limiter l’afflux de trafic non autorisé à partir du réseau virtuel :</span><span class="sxs-lookup"><span data-stu-id="7254b-254">This will help to restrict the inflow of unauthorized traffic from the VNet:</span></span>

<span data-ttu-id="7254b-255">![[2]][2]</span><span class="sxs-lookup"><span data-stu-id="7254b-255">![[2]][2]</span></span>

<span data-ttu-id="7254b-256">Pour des raisons de conformité ou en cas d’audit, il peut être nécessaire d’interdire l’accès direct à Internet à partir des composants qui s’exécutent dans le réseau virtuel et d’implémenter le [tunneling forcé][forced-tuneling].</span><span class="sxs-lookup"><span data-stu-id="7254b-256">For auditing or compliance purposes, it may be necessary to prohibit direct access from components running in the VNet to the Internet and implement [forced tunneling][forced-tuneling].</span></span> <span data-ttu-id="7254b-257">Dans ce cas, le trafic Internet doit être redirigé vers un proxy exécuté en local, où il peut être audité.</span><span class="sxs-lookup"><span data-stu-id="7254b-257">In this situation, Internet traffic should be redirected back through a proxy running  on-premises where it can be audited.</span></span> <span data-ttu-id="7254b-258">Le proxy peut être configuré pour bloquer les flux de trafic sortant non autorisés et filtrer le trafic entrant potentiellement malveillant.</span><span class="sxs-lookup"><span data-stu-id="7254b-258">The proxy can be configured to block unauthorized traffic flowing out, and filter potentially malicious inbound traffic.</span></span>

<span data-ttu-id="7254b-259">![[3]][3]</span><span class="sxs-lookup"><span data-stu-id="7254b-259">![[3]][3]</span></span>

<span data-ttu-id="7254b-260">Pour optimiser la sécurité, n’utilisez pas d’adresse IP publique pour vos machines virtuelles. Par contre, vous pouvez utiliser des groupes de sécurité réseau pour vous assurer que ces machines virtuelles ne sont pas accessibles publiquement.</span><span class="sxs-lookup"><span data-stu-id="7254b-260">To maximize security, do not enable a public IP address for your VMs, and use NSGs to ensure that these VMs aren't publicly accessible.</span></span> <span data-ttu-id="7254b-261">Les machines virtuelles doivent être disponibles uniquement via l’adresse IP interne.</span><span class="sxs-lookup"><span data-stu-id="7254b-261">VMs should only be available using the internal IP address.</span></span> <span data-ttu-id="7254b-262">Vous pouvez rendre ces adresses accessibles via le réseau ExpressRoute et ainsi permettre au personnel DevOps local d’en effectuer la configuration ou la maintenance.</span><span class="sxs-lookup"><span data-stu-id="7254b-262">These addresses can be made accessible through the ExpressRoute network, enabling on-premises DevOps staff to perform configuration or maintenance.</span></span>

<span data-ttu-id="7254b-263">Si vous devez exposer sur un réseau externe des points de terminaison de gestion pour les machines virtuelles, utilisez des groupes de sécurité réseau ou des listes de contrôle d’accès pour restreindre la visibilité de ces ports à une liste verte d’adresses IP ou de réseaux.</span><span class="sxs-lookup"><span data-stu-id="7254b-263">If you must expose management endpoints for VMs to an external network, use NSGs or access control lists to restrict the visibility of these ports to a whitelist of IP addresses or networks.</span></span>

> [!NOTE]
> <span data-ttu-id="7254b-264">Par défaut, les machines virtuelles Azure déployées via le portail Azure incluent une adresse IP publique qui fournit un accès en connexion.</span><span class="sxs-lookup"><span data-stu-id="7254b-264">By default, Azure VMs deployed through the Azure portal include a public IP address that provides login access.</span></span>  
> 
> 


## <a name="deploy-the-solution"></a><span data-ttu-id="7254b-265">Déployer la solution</span><span class="sxs-lookup"><span data-stu-id="7254b-265">Deploy the solution</span></span>

<span data-ttu-id="7254b-266">**Configuration requise.**</span><span class="sxs-lookup"><span data-stu-id="7254b-266">**Prequisites.**</span></span> <span data-ttu-id="7254b-267">Vous devez disposer d’une infrastructure locale existante déjà configurée avec une appliance réseau appropriée.</span><span class="sxs-lookup"><span data-stu-id="7254b-267">You must have an existing on-premises infrastructure already configured with a suitable network appliance.</span></span>

<span data-ttu-id="7254b-268">Pour déployer la solution, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="7254b-268">To deploy the solution, perform the following steps.</span></span>

1. <span data-ttu-id="7254b-269">Cliquez sur le bouton ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="7254b-269">Click the button below:</span></span><br><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmspnp%2Freference-architectures%2Fmaster%2Fhybrid-networking%2Fexpressroute%2Fazuredeploy.json" target="_blank"><img src="https://azuredeploy.net/deploybutton.png"/></a>
2. <span data-ttu-id="7254b-270">Attendez que le lien s’ouvre dans le portail Azure, puis procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="7254b-270">Wait for the link to open in the Azure portal, then follow these steps:</span></span>
   * <span data-ttu-id="7254b-271">Le nom du **groupe de ressources** est déjà défini dans le fichier de paramètres ; sélectionnez **Créer nouveau** et entrez `ra-hybrid-er-rg` dans la zone de texte.</span><span class="sxs-lookup"><span data-stu-id="7254b-271">The **Resource group** name is already defined in the parameter file, so select **Create New** and enter `ra-hybrid-er-rg` in the text box.</span></span>
   * <span data-ttu-id="7254b-272">Sélectionnez la région à partir de la zone déroulante **Emplacement**.</span><span class="sxs-lookup"><span data-stu-id="7254b-272">Select the region from the **Location** drop down box.</span></span>
   * <span data-ttu-id="7254b-273">Ne modifiez pas les zones de texte **Template Root Uri** (Uri racine de modèle) ou **Parameter Root Uri** (Uri racine de paramètre).</span><span class="sxs-lookup"><span data-stu-id="7254b-273">Do not edit the **Template Root Uri** or the **Parameter Root Uri** text boxes.</span></span>
   * <span data-ttu-id="7254b-274">Passez en revue les termes et conditions, puis cochez la case **J’accepte les termes et conditions mentionnés ci-dessus**.</span><span class="sxs-lookup"><span data-stu-id="7254b-274">Review the terms and conditions, then click the **I agree to the terms and conditions stated above** checkbox.</span></span>
   * <span data-ttu-id="7254b-275">Cliquez sur le bouton **Acheter**.</span><span class="sxs-lookup"><span data-stu-id="7254b-275">Click the **Purchase** button.</span></span>
3. <span data-ttu-id="7254b-276">Attendez la fin du déploiement.</span><span class="sxs-lookup"><span data-stu-id="7254b-276">Wait for the deployment to complete.</span></span>
4. <span data-ttu-id="7254b-277">Cliquez sur le bouton ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="7254b-277">Click the button below:</span></span><br><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmspnp%2Freference-architectures%2Fmaster%2Fhybrid-networking%2Fexpressroute%2Fazuredeploy-expressRouteCircuit.json" target="_blank"><img src="https://azuredeploy.net/deploybutton.png"/></a>
5. <span data-ttu-id="7254b-278">Attendez que le lien s’ouvre dans le portail Azure, puis procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="7254b-278">Wait for the link to open in the Azure portal, then follow these steps:</span></span>
   * <span data-ttu-id="7254b-279">Sélectionnez **Utiliser l’existant** dans la section **Groupe de ressources** et saisissez `ra-hybrid-er-rg` dans la zone de texte.</span><span class="sxs-lookup"><span data-stu-id="7254b-279">Select **Use existing** in the **Resource group** section and enter `ra-hybrid-er-rg` in the text box.</span></span>
   * <span data-ttu-id="7254b-280">Sélectionnez la région à partir de la zone déroulante **Emplacement**.</span><span class="sxs-lookup"><span data-stu-id="7254b-280">Select the region from the **Location** drop down box.</span></span>
   * <span data-ttu-id="7254b-281">Ne modifiez pas les zones de texte **Template Root Uri** (Uri racine de modèle) ou **Parameter Root Uri** (Uri racine de paramètre).</span><span class="sxs-lookup"><span data-stu-id="7254b-281">Do not edit the **Template Root Uri** or the **Parameter Root Uri** text boxes.</span></span>
   * <span data-ttu-id="7254b-282">Passez en revue les termes et conditions, puis cochez la case **J’accepte les termes et conditions mentionnés ci-dessus**.</span><span class="sxs-lookup"><span data-stu-id="7254b-282">Review the terms and conditions, then click the **I agree to the terms and conditions stated above** checkbox.</span></span>
   * <span data-ttu-id="7254b-283">Cliquez sur le bouton **Acheter**.</span><span class="sxs-lookup"><span data-stu-id="7254b-283">Click the **Purchase** button.</span></span>
6. <span data-ttu-id="7254b-284">Attendez la fin du déploiement.</span><span class="sxs-lookup"><span data-stu-id="7254b-284">Wait for the deployment to complete.</span></span>


<!-- links -->
[forced-tuneling]: ../dmz/secure-vnet-hybrid.md
[highly-available-network-architecture]: ./expressroute-vpn-failover.md

[expressroute-technical-overview]: /azure/expressroute/expressroute-introduction
[expressroute-prereqs]: /azure/expressroute/expressroute-prerequisites
[configure-expressroute-routing]: /azure/expressroute/expressroute-howto-routing-arm
[sla-for-expressroute]: https://azure.microsoft.com/support/legal/sla/expressroute
[link-vnet-to-expressroute]: /azure/expressroute/expressroute-howto-linkvnet-arm
[ExpressRoute-provisioning]: /azure/expressroute/expressroute-workflows
[expressroute-introduction]: /azure/expressroute/expressroute-introduction
[expressroute-peering]: /azure/expressroute/expressroute-circuit-peerings
[expressroute-pricing]: https://azure.microsoft.com/pricing/details/expressroute/
[expressroute-limits]: /azure/azure-subscription-service-limits#networking-limits
[azurect]: https://github.com/Azure/NetworkMonitoring/tree/master/AzureCT
[visio-download]: https://archcenter.blob.core.windows.net/cdn/hybrid-network-architectures.vsdx
[er-circuit-parameters]: https://github.com/mspnp/reference-architectures/tree/master/hybrid-networking/expressroute/parameters/expressRouteCircuit.parameters.json
[azure-powershell-download]: https://azure.microsoft.com/documentation/articles/powershell-install-configure/
[azure-cli]: https://azure.microsoft.com/documentation/articles/xplat-cli-install/
[0]: ./images/expressroute.png "Architecture réseau hybride avec Azure ExpressRoute"
[1]: ../_images/guidance-hybrid-network-expressroute/figure2.png "Utilisation de routeurs redondants avec les circuits ExpressRoute principaux et secondaires"
[2]: ../_images/guidance-hybrid-network-expressroute/figure3.png "Ajout d’appareils de sécurité au réseau local"
[3]: ../_images/guidance-hybrid-network-expressroute/figure4.png "Utilisation du tunneling forcé pour auditer le trafic Internet"
[4]: ../_images/guidance-hybrid-network-expressroute/figure5.png "Localisation du champ ServiceKey d’un circuit ExpressRoute"  