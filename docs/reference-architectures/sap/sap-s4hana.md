---
title: SAP S/4HANA pour machines virtuelles Linux sur Azure
titleSuffix: Azure Reference Architectures
description: Pratiques éprouvées d’exécution de SAP S/4HANA dans un environnement Linux sur Azure avec une haute disponibilité.
author: lbrader
ms.date: 05/11/2018
ms.custom: seodec18
ms.openlocfilehash: 356b80c79aeb13ac951654350eafa904ff5e5ec1
ms.sourcegitcommit: 88a68c7e9b6b772172b7faa4b9fd9c061a9f7e9d
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/08/2018
ms.locfileid: "53120235"
---
# <a name="sap-s4hana-for-linux-virtual-machines-on-azure"></a><span data-ttu-id="05821-103">SAP S/4HANA pour machines virtuelles Linux sur Azure</span><span class="sxs-lookup"><span data-stu-id="05821-103">SAP S/4HANA for Linux virtual machines on Azure</span></span>

<span data-ttu-id="05821-104">Cette architecture de référence présente un ensemble de pratiques éprouvées pour l’exécution de S/4HANA dans un environnement à haute disponibilité prenant en charge la reprise après sinistre sur Azure.</span><span class="sxs-lookup"><span data-stu-id="05821-104">This reference architecture shows a set of proven practices for running S/4HANA in a high availability environment that supports disaster recovery on Azure.</span></span> <span data-ttu-id="05821-105">Cette architecture est déployée avec des tailles de machine virtuelle spécifiques qui peuvent être modifiées en fonction des besoins de votre organisation.</span><span class="sxs-lookup"><span data-stu-id="05821-105">This architecture is deployed with specific virtual machine (VM) sizes that can be changed to accommodate your organization's needs.</span></span>

![Architecture de référence SAP S/4HANA pour machines virtuelles Linux sur Azure](./images/sap-s4hana.png)

<span data-ttu-id="05821-107">*Téléchargez un [fichier Visio][visio-download] de cette architecture.*</span><span class="sxs-lookup"><span data-stu-id="05821-107">*Download a [Visio file][visio-download] of this architecture.*</span></span>

> [!NOTE]
> <span data-ttu-id="05821-108">Le déploiement de cette architecture de référence requiert une licence appropriée des produits SAP et d’autres technologies non Microsoft.</span><span class="sxs-lookup"><span data-stu-id="05821-108">Deploying this reference architecture requires appropriate licensing of SAP products and other non-Microsoft technologies.</span></span>

## <a name="architecture"></a><span data-ttu-id="05821-109">Architecture</span><span class="sxs-lookup"><span data-stu-id="05821-109">Architecture</span></span>

<span data-ttu-id="05821-110">Cette architecture de référence décrit un système de production de niveau entreprise.</span><span class="sxs-lookup"><span data-stu-id="05821-110">This reference architecture describes a enterprise-grade, production-level system.</span></span> <span data-ttu-id="05821-111">En fonction des besoins de votre entreprise, cette configuration peut être réduite à une seule machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="05821-111">To suit your business needs, this configuration can be reduced to a single virtual machine.</span></span> <span data-ttu-id="05821-112">En revanche, les composants suivants sont requis :</span><span class="sxs-lookup"><span data-stu-id="05821-112">However, the following components are required:</span></span>

<span data-ttu-id="05821-113">**Réseau virtuel**.</span><span class="sxs-lookup"><span data-stu-id="05821-113">**Virtual network**.</span></span> <span data-ttu-id="05821-114">Le service [Réseau virtuel Azure](/azure/virtual-network/virtual-networks-overview) connecte en toute sécurité les ressources Azure entre elles.</span><span class="sxs-lookup"><span data-stu-id="05821-114">The [Azure Virtual Network](/azure/virtual-network/virtual-networks-overview) service securely connects Azure resources to each other.</span></span> <span data-ttu-id="05821-115">Dans cette architecture, le réseau virtuel se connecte à un environnement local via une passerelle déployée dans le hub d’une [topologie hub-and-spoke](../hybrid-networking/hub-spoke.md).</span><span class="sxs-lookup"><span data-stu-id="05821-115">In this architecture, the virtual network connects to an on-premises environment through a gateway deployed in the hub of a [hub-spoke topology](../hybrid-networking/hub-spoke.md).</span></span> <span data-ttu-id="05821-116">Le spoke est le réseau virtuel utilisé pour les applications SAP.</span><span class="sxs-lookup"><span data-stu-id="05821-116">The spoke is the virtual network used for the SAP applications.</span></span>

<span data-ttu-id="05821-117">**Sous-réseaux**.</span><span class="sxs-lookup"><span data-stu-id="05821-117">**Subnets**.</span></span> <span data-ttu-id="05821-118">Le réseau virtuel est subdivisé en [sous-réseaux](/azure/virtual-network/virtual-network-manage-subnet) distincts pour chaque niveau : passerelle, application, base de données et services partagés.</span><span class="sxs-lookup"><span data-stu-id="05821-118">The virtual network is subdivided into separate [subnets](/azure/virtual-network/virtual-network-manage-subnet) for each tier: gateway, application, database, and shared services.</span></span>

<span data-ttu-id="05821-119">**Machines virtuelles**.</span><span class="sxs-lookup"><span data-stu-id="05821-119">**Virtual machines**.</span></span> <span data-ttu-id="05821-120">Cette architecture utilise des machines virtuelles exécutant Linux regroupées comme suit pour les couches Application et Base de données :</span><span class="sxs-lookup"><span data-stu-id="05821-120">This architecture uses virtual machines running Linux for the application tier and database tier, grouped as follows:</span></span>

- <span data-ttu-id="05821-121">**Couche Application**.</span><span class="sxs-lookup"><span data-stu-id="05821-121">**Application tier**.</span></span> <span data-ttu-id="05821-122">Inclut le pool Fiori Front-end Server, le pool SAP Web Dispatcher, le pool du serveur d’applications et le cluster des services centraux SAP.</span><span class="sxs-lookup"><span data-stu-id="05821-122">Includes the Fiori Front-end Server pool, SAP Web Dispatcher pool, application server pool, and SAP Central Services cluster.</span></span> <span data-ttu-id="05821-123">Pour la haute disponibilité des services centraux sur les machines virtuelles Azure Linux, un service NFS (Network File Système) à haute disponibilité est requis.</span><span class="sxs-lookup"><span data-stu-id="05821-123">For high availability of Central Services on Azure Linux virtual machines, a highly available Network File System (NFS) service is required.</span></span>
- <span data-ttu-id="05821-124">**Cluster NFS**.</span><span class="sxs-lookup"><span data-stu-id="05821-124">**NFS cluster**.</span></span> <span data-ttu-id="05821-125">Cette architecture utilise un serveur [NFS](/azure/virtual-machines/workloads/sap/high-availability-guide-suse-nfs) exécuté sur un cluster Linux pour stocker les données partagées entre les systèmes SAP.</span><span class="sxs-lookup"><span data-stu-id="05821-125">This architecture uses an [NFS](/azure/virtual-machines/workloads/sap/high-availability-guide-suse-nfs) server running on a Linux cluster to store data shared between SAP systems.</span></span> <span data-ttu-id="05821-126">Vous pouvez partager ce cluster centralisé entre plusieurs systèmes SAP.</span><span class="sxs-lookup"><span data-stu-id="05821-126">This centralized cluster can be shared across multiple SAP systems.</span></span> <span data-ttu-id="05821-127">Pour la haute disponibilité du service NFS, vous pouvez utiliser la fonctionnalité High Availability Extension appropriée pour la distribution Linux sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="05821-127">For high availability of the NFS service, the appropriate High Availability Extension for the selected Linux distribution is used.</span></span>
- <span data-ttu-id="05821-128">**SAP HANA**.</span><span class="sxs-lookup"><span data-stu-id="05821-128">**SAP HANA**.</span></span> <span data-ttu-id="05821-129">La couche Base de données utilise au moins deux machines virtuelles Linux dans un cluster pour assurer la haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="05821-129">The database tier uses two or more Linux virtual machines in a cluster to achieve high availability.</span></span> <span data-ttu-id="05821-130">La réplication de système HANA (HSR) est utilisée pour répliquer du contenu entre les systèmes HANA principal et secondaire.</span><span class="sxs-lookup"><span data-stu-id="05821-130">HANA System Replication (HSR) is used to replicate contents between primary and secondary HANA systems.</span></span> <span data-ttu-id="05821-131">Le clustering Linux est utilisé pour détecter les défaillances du système et faciliter le basculement automatique.</span><span class="sxs-lookup"><span data-stu-id="05821-131">Linux clustering is used to detect system failures and facilitate automatic failover.</span></span> <span data-ttu-id="05821-132">Un mécanisme d’isolation basé sur le stockage ou sur le cloud peut être utilisé pour s’assurer que le système défaillant est isolé ou arrêté pour éviter la condition de division (Split-Brain) du cluster.</span><span class="sxs-lookup"><span data-stu-id="05821-132">A storage-based or cloud-based fencing mechanism can be used to ensure the failed system is isolated or shut down to avoid the cluster split-brain condition.</span></span>
- <span data-ttu-id="05821-133">**Jumpbox**.</span><span class="sxs-lookup"><span data-stu-id="05821-133">**Jumpbox**.</span></span> <span data-ttu-id="05821-134">Également appelé hôte bastion.</span><span class="sxs-lookup"><span data-stu-id="05821-134">Also called a bastion host.</span></span> <span data-ttu-id="05821-135">Il s’agit d’une machine virtuelle sécurisée sur le réseau, utilisée par les administrateurs pour se connecter aux autres machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="05821-135">This is a secure virtual machine on the network that administrators use to connect to the other virtual machines.</span></span> <span data-ttu-id="05821-136">Il peut exécuter Windows ou Linux.</span><span class="sxs-lookup"><span data-stu-id="05821-136">It can run Windows or Linux.</span></span> <span data-ttu-id="05821-137">Le jumpbox Windows facilite la navigation web lors de l’utilisation des outils de gestion HANA Cockpit ou HANA Studio.</span><span class="sxs-lookup"><span data-stu-id="05821-137">Use a Windows jumpbox for web browsing convenience when using HANA Cockpit or HANA Studio management tools.</span></span>

<span data-ttu-id="05821-138">**Équilibreurs de charge** :</span><span class="sxs-lookup"><span data-stu-id="05821-138">**Load balancers**.</span></span> <span data-ttu-id="05821-139">Les équilibreurs de charge SAP intégrés et [Azure Load Balancer](/azure/load-balancer/load-balancer-overview) sont utilisés pour assurer la haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="05821-139">Both built-in SAP load balancers and [Azure Load Balancer](/azure/load-balancer/load-balancer-overview) are used to achieve HA.</span></span> <span data-ttu-id="05821-140">Les instances Azure Load Balancer servent à distribuer le trafic vers les machines virtuelles du sous-réseau de la couche Application.</span><span class="sxs-lookup"><span data-stu-id="05821-140">Azure Load Balancer instances are used to distribute traffic to virtual machines in the application tier subnet.</span></span>

<span data-ttu-id="05821-141">**Groupes à haute disponibilité**.</span><span class="sxs-lookup"><span data-stu-id="05821-141">**Availability sets**.</span></span> <span data-ttu-id="05821-142">Les machines virtuelles de tous les pools et clusters (SAP Web Dispatcher, serveurs d’applications SAP, services centraux, NFS et HANA) sont réunies dans des [groupes à haute disponibilité](/azure/virtual-machines/windows/tutorial-availability-sets) distincts, et au moins deux machines virtuelles sont approvisionnées pour chaque rôle.</span><span class="sxs-lookup"><span data-stu-id="05821-142">Virtual machines for all pools and clusters (Web Dispatcher, SAP application servers, Central Services, NFS, and HANA) are grouped into separate [availability sets](/azure/virtual-machines/windows/tutorial-availability-sets), and at least two virtual machines are provisioned per role.</span></span> <span data-ttu-id="05821-143">Cela rend les machines virtuelles éligibles pour un [contrat de niveau de service](https://azure.microsoft.com/support/legal/sla/virtual-machines) (SLA) plus élevé.</span><span class="sxs-lookup"><span data-stu-id="05821-143">This makes the virtual machines eligible for a higher [service level agreement](https://azure.microsoft.com/support/legal/sla/virtual-machines) (SLA).</span></span>

<span data-ttu-id="05821-144">**Cartes réseau**.</span><span class="sxs-lookup"><span data-stu-id="05821-144">**NICs**.</span></span> <span data-ttu-id="05821-145">Les [cartes réseau](/azure/virtual-network/virtual-network-network-interface) assurent l’ensemble des communications des machines virtuelles sur un réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="05821-145">[Network interface cards](/azure/virtual-network/virtual-network-network-interface) (NICs) enable all communication of virtual machines on a virtual network.</span></span>

<span data-ttu-id="05821-146">**Groupes de sécurité réseau**.</span><span class="sxs-lookup"><span data-stu-id="05821-146">**Network security groups**.</span></span> <span data-ttu-id="05821-147">Pour limiter le trafic entrant, sortant et intra-sous-réseau dans le réseau virtuel, vous pouvez utiliser des [groupes de sécurité réseau](/azure/virtual-network/virtual-networks-nsg) (NSG).</span><span class="sxs-lookup"><span data-stu-id="05821-147">To restrict incoming, outgoing, and intra-subnet traffic in the virtual network, [network security groups](/azure/virtual-network/virtual-networks-nsg) (NSGs) are used.</span></span>

<span data-ttu-id="05821-148">**Passerelle**.</span><span class="sxs-lookup"><span data-stu-id="05821-148">**Gateway**.</span></span> <span data-ttu-id="05821-149">Une passerelle étend votre réseau local au réseau virtuel Azure.</span><span class="sxs-lookup"><span data-stu-id="05821-149">A gateway extends your on-premises network to the Azure virtual network.</span></span> <span data-ttu-id="05821-150">[ExpressRoute](/azure/architecture/reference-architectures/hybrid-networking/expressroute) est le service Azure recommandé pour la création de connexions privées qui ne passent pas par l’Internet public, mais il est également possible d’utiliser une connexion [site à site](/azure/vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal).</span><span class="sxs-lookup"><span data-stu-id="05821-150">[ExpressRoute](/azure/architecture/reference-architectures/hybrid-networking/expressroute) is the recommended Azure service for creating private connections that do not go over the public Internet, but a [Site-to-Site](/azure/vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal) connection can also be used.</span></span>

<span data-ttu-id="05821-151">**Stockage Azure**.</span><span class="sxs-lookup"><span data-stu-id="05821-151">**Azure Storage**.</span></span> <span data-ttu-id="05821-152">Pour bénéficier d’un stockage permanent du disque dur virtuel d’une machine virtuelle, le service [Stockage Azure](/azure/storage/) est requis.</span><span class="sxs-lookup"><span data-stu-id="05821-152">To provide persistent storage of a virtual machine's virtual hard disk (VHD), [Azure Storage](/azure/storage/) is required.</span></span>

## <a name="recommendations"></a><span data-ttu-id="05821-153">Recommandations</span><span class="sxs-lookup"><span data-stu-id="05821-153">Recommendations</span></span>

<span data-ttu-id="05821-154">Cette architecture décrit un petit déploiement d’entreprise de niveau production.</span><span class="sxs-lookup"><span data-stu-id="05821-154">This architecture describes a small production-level enterprise deployment.</span></span> <span data-ttu-id="05821-155">Votre déploiement sera différent en fonction des besoins de votre entreprise.</span><span class="sxs-lookup"><span data-stu-id="05821-155">Your deployment will differ based on your business requirements.</span></span> <span data-ttu-id="05821-156">Utilisez ces recommandations comme point de départ.</span><span class="sxs-lookup"><span data-stu-id="05821-156">Use these recommendations as a starting point.</span></span>

### <a name="virtual-machines"></a><span data-ttu-id="05821-157">Machines virtuelles</span><span class="sxs-lookup"><span data-stu-id="05821-157">Virtual machines</span></span>

<span data-ttu-id="05821-158">Dans les pools et les clusters de serveurs d’applications, ajustez le nombre de machines virtuelles en fonction de vos besoins.</span><span class="sxs-lookup"><span data-stu-id="05821-158">In application server pools and clusters, adjust the number of virtual machines based on your requirements.</span></span> <span data-ttu-id="05821-159">Le [guide de planification et implémentation de machines virtuelles Azure](/azure/virtual-machines/workloads/sap/planning-guide) inclut des informations sur l’exécution de SAP NetWeaver sur des machines virtuelles, qui s’appliquent également à SAP S/4HANA.</span><span class="sxs-lookup"><span data-stu-id="05821-159">The [Azure Virtual Machines planning and implementation guide](/azure/virtual-machines/workloads/sap/planning-guide) includes details about running SAP NetWeaver on virtual machines, but the information applies to SAP S/4HANA as well.</span></span>

<span data-ttu-id="05821-160">Pour plus d’informations sur la prise en charge SAP en fonction des types de machine virtuelle Azure et des mesures de débit (SAP), consultez la [Note SAP 1928533](https://launchpad.support.sap.com/#/notes/1928533).</span><span class="sxs-lookup"><span data-stu-id="05821-160">For details about SAP support for Azure virtual machine types and throughput metrics (SAPS), see [SAP Note 1928533](https://launchpad.support.sap.com/#/notes/1928533).</span></span>

### <a name="sap-web-dispatcher-pool"></a><span data-ttu-id="05821-161">Pool SAP Web Dispatcher</span><span class="sxs-lookup"><span data-stu-id="05821-161">SAP Web Dispatcher pool</span></span>

<span data-ttu-id="05821-162">Le composant Web Dispatcher sert d’équilibreur de charge pour le trafic SAP entre les serveurs d’applications SAP.</span><span class="sxs-lookup"><span data-stu-id="05821-162">The Web Dispatcher component is used as a load balancer for SAP traffic among the SAP application servers.</span></span> <span data-ttu-id="05821-163">Pour assurer la haute disponibilité du composant Web Dispatcher, Azure Load Balancer est utilisé pour implémenter l’installation Web Dispatcher parallèle dans une configuration de tourniquet pour la distribution du trafic HTTP(S) parmi les Web Dispatchers disponibles dans le pool back-end des équilibreurs.</span><span class="sxs-lookup"><span data-stu-id="05821-163">To achieve high availability for the Web Dispatcher component, Azure Load Balancer is used to implement the parallel Web Dispatcher setup in a round-robin configuration for HTTP(S) traffic distribution among the available Web Dispatchers in the balancers back-end pool.</span></span>

### <a name="fiori-front-end-server"></a><span data-ttu-id="05821-164">Fiori Front-end Server</span><span class="sxs-lookup"><span data-stu-id="05821-164">Fiori Front-end Server</span></span>

<span data-ttu-id="05821-165">Fiori Front-end Server utilise une [passerelle NetWeaver](https://help.sap.com/doc/saphelp_gateway20sp12/2.0/en-US/76/08828d832e4aa78748e9f82204a864/content.htm?no_cache=true).</span><span class="sxs-lookup"><span data-stu-id="05821-165">The Fiori Front-end Server uses a [NetWeaver Gateway](https://help.sap.com/doc/saphelp_gateway20sp12/2.0/en-US/76/08828d832e4aa78748e9f82204a864/content.htm?no_cache=true).</span></span> <span data-ttu-id="05821-166">Pour les déploiements à petite échelle, elle peut être chargée sur le serveur Fiori.</span><span class="sxs-lookup"><span data-stu-id="05821-166">For small deployments, it can be loaded on the Fiori server.</span></span> <span data-ttu-id="05821-167">Pour les déploiements à grande échelle, vous pouvez déployer un serveur distinct pour la passerelle NetWeaver devant le pool Fiori Front-end Server.</span><span class="sxs-lookup"><span data-stu-id="05821-167">For large deployments, a separate server for the NetWeaver Gateway may be deployed in front of the Fiori Front-end Server pool.</span></span>

### <a name="application-servers-pool"></a><span data-ttu-id="05821-168">Pool de serveurs d’applications</span><span class="sxs-lookup"><span data-stu-id="05821-168">Application servers pool</span></span>

<span data-ttu-id="05821-169">Pour gérer les groupes de connexion des serveurs d’applications ABAP, la transaction SMLG est utilisée.</span><span class="sxs-lookup"><span data-stu-id="05821-169">To manage logon groups for ABAP application servers, the SMLG transaction is used.</span></span> <span data-ttu-id="05821-170">Elle s’appuie sur la fonction d’équilibrage de charge au sein du serveur de messages des services centraux pour répartir la charge de travail entre le pool de serveurs d’applications pour le trafic des clients SAP GUI et RFC.</span><span class="sxs-lookup"><span data-stu-id="05821-170">It uses the load balancing function within the message server of the Central Services to distribute workload among SAP application servers pool for SAPGUIs and RFC traffic.</span></span> <span data-ttu-id="05821-171">La connexion des serveurs d’applications aux services centraux hautement disponibles se fait via le nom du réseau virtuel du cluster.</span><span class="sxs-lookup"><span data-stu-id="05821-171">The application server connection to the highly available Central Services is through the cluster virtual network name.</span></span> <span data-ttu-id="05821-172">De cette façon, il est inutile de modifier le profil du serveur d’applications pour la connectivité des services centraux après un basculement local.</span><span class="sxs-lookup"><span data-stu-id="05821-172">This avoids the need to change the application server profile for Central Services connectivity after a local failover.</span></span>

### <a name="sap-central-services-cluster"></a><span data-ttu-id="05821-173">Cluster des services centraux SAP</span><span class="sxs-lookup"><span data-stu-id="05821-173">SAP Central Services cluster</span></span>

<span data-ttu-id="05821-174">Vous pouvez déployer les services centraux vers une machine virtuelle unique lorsque la haute disponibilité n’est pas obligatoire.</span><span class="sxs-lookup"><span data-stu-id="05821-174">Central Services can be deployed to a single virtual machine when high availability is not a requirement.</span></span> <span data-ttu-id="05821-175">Toutefois, la machine virtuelle unique devient un point de défaillance unique(SPOF) potentiel pour l’environnement SAP.</span><span class="sxs-lookup"><span data-stu-id="05821-175">However, the single virtual machine becomes a potential single point of failure (SPOF) for the SAP environment.</span></span> <span data-ttu-id="05821-176">Pour un déploiement de services centraux à haute disponibilité, un cluster NFS à haute disponibilité et un cluster de services centraux à haute disponibilité sont utilisés.</span><span class="sxs-lookup"><span data-stu-id="05821-176">For a highly available Central Services deployment, a highly available NFS cluster and a highly available Central Services cluster are used.</span></span>

### <a name="nfs-cluster"></a><span data-ttu-id="05821-177">Cluster NFS</span><span class="sxs-lookup"><span data-stu-id="05821-177">NFS cluster</span></span>

<span data-ttu-id="05821-178">DRBD (Distributed Replicated Block Device) est utilisé pour la réplication entre les nœuds du cluster NFS.</span><span class="sxs-lookup"><span data-stu-id="05821-178">DRBD (Distributed Replicated Block Device) is used for replication between the nodes of the NFS cluster.</span></span>

### <a name="availability-sets"></a><span data-ttu-id="05821-179">Groupes à haute disponibilité</span><span class="sxs-lookup"><span data-stu-id="05821-179">Availability sets</span></span>

<span data-ttu-id="05821-180">Les groupes à haute disponibilité répartissent les serveurs dans des groupes d’infrastructure physique et de mise à jour différents pour améliorer la disponibilité des services.</span><span class="sxs-lookup"><span data-stu-id="05821-180">Availability sets distribute servers to different physical infrastructure and update groups to improve service availability.</span></span> <span data-ttu-id="05821-181">Placez les machines virtuelles qui présentent le même rôle dans un groupe de disponibilité afin d’éviter les temps d’arrêt causés par la maintenance de l’infrastructure Azure et de respecter les [contrats de niveau de service](https://azure.microsoft.com/support/legal/sla/virtual-machines).</span><span class="sxs-lookup"><span data-stu-id="05821-181">Put virtual machines that perform the same role into an availability sets to help guard against downtime caused by Azure infrastructure maintenance and to meet [SLAs](https://azure.microsoft.com/support/legal/sla/virtual-machines).</span></span> <span data-ttu-id="05821-182">Il est recommandé de placer au moins deux machines virtuelles dans un groupe à haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="05821-182">Two or more virtual machines per availability set is recommended.</span></span>

<span data-ttu-id="05821-183">Toutes les machines virtuelles d’un groupe doivent présenter le même rôle.</span><span class="sxs-lookup"><span data-stu-id="05821-183">All virtual machines in a set must perform the same role.</span></span> <span data-ttu-id="05821-184">N’associez pas de serveurs remplissant des rôles différents dans le même groupe à haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="05821-184">Do not mix servers of different roles in the same availability set.</span></span> <span data-ttu-id="05821-185">Par exemple, ne placez pas un nœud ASCS dans le même groupe de disponibilité que le serveur d’applications.</span><span class="sxs-lookup"><span data-stu-id="05821-185">For example, don't place a ASCS node in the same availability set with the application server.</span></span>

### <a name="nics"></a><span data-ttu-id="05821-186">Cartes réseau</span><span class="sxs-lookup"><span data-stu-id="05821-186">NICs</span></span>

<span data-ttu-id="05821-187">Les paysages SAP locaux traditionnels implémentent plusieurs cartes réseau par machine pour séparer le trafic administratif du trafic opérationnel.</span><span class="sxs-lookup"><span data-stu-id="05821-187">Traditional on-premises SAP landscapes implement multiple network interface cards (NICs) per machine to segregate administrative traffic from business traffic.</span></span> <span data-ttu-id="05821-188">Sur Azure, le réseau virtuel est un réseau à définition logicielle qui envoie tout le trafic via la même structure réseau.</span><span class="sxs-lookup"><span data-stu-id="05821-188">On Azure, the virtual network is a software-defined network that sends all traffic through the same network fabric.</span></span> <span data-ttu-id="05821-189">Par conséquent, il est inutile d’utiliser plusieurs cartes réseau.</span><span class="sxs-lookup"><span data-stu-id="05821-189">Therefore, the use of multiple NICs is unnecessary.</span></span> <span data-ttu-id="05821-190">Toutefois, si votre organisation a besoin de séparer le trafic, vous pouvez déployer plusieurs cartes réseau par machine virtuelle, connecter chaque carte réseau à un sous-réseau différent, puis utiliser des NSG pour appliquer des stratégies de contrôle d’accès distinctes.</span><span class="sxs-lookup"><span data-stu-id="05821-190">However, if your organization needs to segregate traffic, you can deploy multiple NICs per VM, connect each NIC to a different subnet, and then use NSGs to enforce different access control policies.</span></span>

### <a name="subnets-and-nsgs"></a><span data-ttu-id="05821-191">Sous-réseaux et NSG</span><span class="sxs-lookup"><span data-stu-id="05821-191">Subnets and NSGs</span></span>

<span data-ttu-id="05821-192">Cette architecture divise l’espace d’adressage du réseau virtuel en sous-réseaux.</span><span class="sxs-lookup"><span data-stu-id="05821-192">This architecture subdivides the virtual network address space into subnets.</span></span> <span data-ttu-id="05821-193">Chaque sous-réseau peut être associé à un NSG qui définit les stratégies d’accès pour ce sous-réseau.</span><span class="sxs-lookup"><span data-stu-id="05821-193">Each subnet can be associated with a NSG that defines the access policies for the subnet.</span></span> <span data-ttu-id="05821-194">Placez les serveurs d’applications dans un sous-réseau distinct afin de pouvoir les sécuriser plus facilement en gérant les stratégies de sécurité du sous-réseau plutôt que les serveurs individuels.</span><span class="sxs-lookup"><span data-stu-id="05821-194">Place application servers on a separate subnet so you can secure them more easily by managing the subnet security policies, not the individual servers.</span></span>

<span data-ttu-id="05821-195">Quand un NSG est associé à un sous-réseau, il s’applique ensuite à tous les serveurs au sein de ce sous-réseau.</span><span class="sxs-lookup"><span data-stu-id="05821-195">When a NSG is associated with a subnet, it then applies to all the servers within the subnet.</span></span> <span data-ttu-id="05821-196">Pour plus d’informations sur l’utilisation de NSG pour un contrôle précis des serveurs d’un sous-réseau, consultez [Filtrer le trafic réseau avec les groupes de sécurité réseau](https://azure.microsoft.com/blog/multiple-vm-nics-and-network-virtual-appliances-in-azure/).</span><span class="sxs-lookup"><span data-stu-id="05821-196">For more information about using NSGs for fine-grained control over the servers in a subnet, see [Filter network traffic with network security groups](https://azure.microsoft.com/blog/multiple-vm-nics-and-network-virtual-appliances-in-azure/).</span></span>

<span data-ttu-id="05821-197">Consultez également [Planification et conception de la passerelle VPN](/azure/vpn-gateway/vpn-gateway-plan-design).</span><span class="sxs-lookup"><span data-stu-id="05821-197">See also [Planning and design for VPN Gateway](/azure/vpn-gateway/vpn-gateway-plan-design).</span></span>

### <a name="load-balancers"></a><span data-ttu-id="05821-198">Équilibreurs de charge</span><span class="sxs-lookup"><span data-stu-id="05821-198">Load balancers</span></span>

<span data-ttu-id="05821-199">[SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw73ehp1/7.31.19/en-US/48/8fe37933114e6fe10000000a421937/frameset.htm) gère l’équilibrage de charge du trafic HTTP(S), y compris les applications de style Fiori, à destination d’un pool de serveurs d’applications SAP.</span><span class="sxs-lookup"><span data-stu-id="05821-199">[SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw73ehp1/7.31.19/en-US/48/8fe37933114e6fe10000000a421937/frameset.htm) handles load balancing of HTTP(S) traffic including Fiori style applications to a pool of SAP application servers.</span></span>

<span data-ttu-id="05821-200">Pour le trafic en provenance de clients SAP GUI se connectant à un serveur SAP via DIAG ou RFC (Remote Function Call), le serveur de messages des services centraux équilibre la charge par l’intermédiaire des [groupes de connexion](https://wiki.scn.sap.com/wiki/display/SI/ABAP+Logon+Group+based+Load+Balancing) des serveurs d’applications. Par conséquent, aucun équilibreur de charge supplémentaire n’est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="05821-200">For traffic from SAP GUI clients connecting a SAP server via DIAG or Remote Function Calls (RFC), the Central Service message server balances the load through SAP application server [logon groups](https://wiki.scn.sap.com/wiki/display/SI/ABAP+Logon+Group+based+Load+Balancing), so no additional load balancer is needed.</span></span>

### <a name="azure-storage"></a><span data-ttu-id="05821-201">Stockage Azure</span><span class="sxs-lookup"><span data-stu-id="05821-201">Azure Storage</span></span>

<span data-ttu-id="05821-202">Nous recommandons l’utilisation du Stockage Premium Azure pour les machines virtuelles du serveur de bases de données.</span><span class="sxs-lookup"><span data-stu-id="05821-202">We recommend using Azure Premium Storage for the database server virtual machines.</span></span> <span data-ttu-id="05821-203">Le stockage Premium offre une latence de lecture/écriture homogène.</span><span class="sxs-lookup"><span data-stu-id="05821-203">Premium storage provides consistent read/write latency.</span></span> <span data-ttu-id="05821-204">Pour des informations sur l’utilisation du stockage Premium pour les disques de système d’exploitation et de données d’une machine virtuelle à instance unique, consultez [SLA pour Machines virtuelles](https://azure.microsoft.com/support/legal/sla/virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="05821-204">For details about using Premium Storage for the operating system disks and data disks of a single-instance virtual machine, see [SLA for Virtual Machines](https://azure.microsoft.com/support/legal/sla/virtual-machines/).</span></span>

<span data-ttu-id="05821-205">Pour tous les systèmes SAP de production, nous vous recommandons d’utiliser [Azure Managed Disks](/azure/storage/storage-managed-disks-overview) Premium.</span><span class="sxs-lookup"><span data-stu-id="05821-205">For all production SAP systems, we recommend using Premium [Azure Managed Disks](/azure/storage/storage-managed-disks-overview).</span></span> <span data-ttu-id="05821-206">Des disques managés sont utilisés pour gérer les fichiers VHD pour les disques, pour des questions de fiabilité.</span><span class="sxs-lookup"><span data-stu-id="05821-206">Managed Disks are used to manage the VHD files for the disks, adding reliability.</span></span> <span data-ttu-id="05821-207">Ils assurent également l’isolement des disques des machines virtuelles au sein d’un groupe à haute disponibilité afin d’éviter les points de défaillance uniques.</span><span class="sxs-lookup"><span data-stu-id="05821-207">They also ensure that the disks for virtual machines within an availability set are isolated to avoid single points of failure.</span></span>

<span data-ttu-id="05821-208">Pour les serveurs d’applications SAP, y compris les machines virtuelles des services centraux, vous pouvez utiliser le stockage Azure standard afin de réduire les coûts. En effet, l’exécution des applications s’effectue en mémoire et utilise les disques uniquement pour la journalisation.</span><span class="sxs-lookup"><span data-stu-id="05821-208">For SAP application servers, including the Central Services virtual machines, you can use Azure Standard Storage to reduce cost, because application execution takes place in memory and uses disks for logging only.</span></span> <span data-ttu-id="05821-209">Toutefois, pour le moment le stockage standard est certifié uniquement pour le stockage non managé.</span><span class="sxs-lookup"><span data-stu-id="05821-209">However, at this time, Standard Storage is only certified for unmanaged storage.</span></span> <span data-ttu-id="05821-210">Dans la mesure où les serveurs d’applications n’hébergent pas de données, vous pouvez également utiliser les disques P4 et P6 de moins grande capacité pour réduire le coût.</span><span class="sxs-lookup"><span data-stu-id="05821-210">Since application servers do not host any data, you can also use the smaller P4 and P6 Premium Storage disks to help minimize cost.</span></span>

<span data-ttu-id="05821-211">Pour le magasin de données de sauvegarde, nous vous recommandons d’utiliser [le stockage de niveau d’accès froid et/ou le stockage de niveau d’accès archive](/azure/storage/storage-blob-storage-tiers).</span><span class="sxs-lookup"><span data-stu-id="05821-211">For the backup data store, we recommend using Azure [cool access tier storage and/or archive access tier storage](/azure/storage/storage-blob-storage-tiers).</span></span> <span data-ttu-id="05821-212">Ces niveaux de stockage sont des moyens économiques de stocker les données de longue durée moins souvent sollicitées.</span><span class="sxs-lookup"><span data-stu-id="05821-212">These storage tiers are cost-effective ways to store long-lived data that is less frequently accessed.</span></span>

## <a name="performance-considerations"></a><span data-ttu-id="05821-213">Considérations relatives aux performances</span><span class="sxs-lookup"><span data-stu-id="05821-213">Performance considerations</span></span>

<span data-ttu-id="05821-214">Les serveurs d’applications SAP communiquent constamment avec les serveurs de bases de données.</span><span class="sxs-lookup"><span data-stu-id="05821-214">SAP application servers carry on constant communications with the database servers.</span></span> <span data-ttu-id="05821-215">Pour les machines virtuelles de base de données HANA, vous pouvez activer [l’accélérateur d’écriture](/azure/virtual-machines/linux/how-to-enable-write-accelerator) pour améliorer la latence d’écriture du journal.</span><span class="sxs-lookup"><span data-stu-id="05821-215">For the HANA database virtual machines, consider enabling [Write Accelerator](/azure/virtual-machines/linux/how-to-enable-write-accelerator) to improve log write latency.</span></span> <span data-ttu-id="05821-216">Pour optimiser les communications entre les serveurs, utilisez le [réseau accéléré](https://azure.microsoft.com/blog/linux-and-windows-networking-performance-enhancements-accelerated-networking/).</span><span class="sxs-lookup"><span data-stu-id="05821-216">To optimize inter-server communications, use the [Accelerated Network](https://azure.microsoft.com/blog/linux-and-windows-networking-performance-enhancements-accelerated-networking/).</span></span> <span data-ttu-id="05821-217">Notez que ces accélérateurs sont disponibles uniquement pour certaines séries de machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="05821-217">Note that these accelerators are available only for certain VM series.</span></span>

<span data-ttu-id="05821-218">Pour obtenir un débit de bande passante de disque et d’ES/S élevé, les pratiques courantes en termes [d’optimisation des performances](/azure/virtual-machines/linux/premium-storage-performance) du volume de stockage s’appliquent à la disposition du stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="05821-218">To achieve high IOPS and disk bandwidth throughput, the common practices in storage volume [performance optimization](/azure/virtual-machines/linux/premium-storage-performance) apply to Azure storage layout.</span></span> <span data-ttu-id="05821-219">Par exemple, la combinaison de plusieurs disques pour créer un volume de disque agrégé par bandes améliore les performances d’E/S.</span><span class="sxs-lookup"><span data-stu-id="05821-219">For example, combining multiple disks together to create a striped disk volume improves IO performance.</span></span> <span data-ttu-id="05821-220">L’activation du cache de lecture sur un contenu de stockage qui change rarement améliore la vitesse de récupération des données.</span><span class="sxs-lookup"><span data-stu-id="05821-220">Enabling the read cache on storage content that changes infrequently enhances the speed of data retrieval.</span></span> <span data-ttu-id="05821-221">Pour plus d’informations sur les exigences en termes de performances, consultez [SAP note 1943937 - Hardware Configuration Check Tool](https://launchpad.support.sap.com/#/notes/1943937) (Note SAP 1943937 - Outil de vérification de la configuration matérielle) (compte SAP Service Marketplace requis pour l’accès).</span><span class="sxs-lookup"><span data-stu-id="05821-221">For details about performance requirements, see [SAP note 1943937 - Hardware Configuration Check Tool](https://launchpad.support.sap.com/#/notes/1943937) (SAP Service Marketplace account required for access).</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="05821-222">Considérations relatives à l’extensibilité</span><span class="sxs-lookup"><span data-stu-id="05821-222">Scalability considerations</span></span>

<span data-ttu-id="05821-223">Au niveau de la couche de l’application SAP, Azure propose un large éventail de tailles de machines virtuelles pour la montée en puissance ou la montée en charge. Pour obtenir une liste exhaustive, consultez la [note SAP 1928533](https://launchpad.support.sap.com/#/notes/1928533) - SAP Applications on Azure: Supported Products and Azure VM Types (Applications SAP sur Azure : compte SAP Service Marketplace requis pour l’accès).</span><span class="sxs-lookup"><span data-stu-id="05821-223">At the SAP application layer, Azure offers a wide range of virtual machine sizes for scaling up and scaling out. For an inclusive list, see [SAP Note 1928533](https://launchpad.support.sap.com/#/notes/1928533) - SAP Applications on Azure: Supported Products and Azure VM types (SAP Service Marketplace account required for access).</span></span> <span data-ttu-id="05821-224">À mesure que nous certifions des types de machines virtuelles supplémentaires, vous pouvez augmenter ou diminuer la taille des instances avec le même déploiement cloud.</span><span class="sxs-lookup"><span data-stu-id="05821-224">As we continue to certify more virtual machines types, you can scale up or down with the same cloud deployment.</span></span>

<span data-ttu-id="05821-225">Dans la couche Base de données, cette architecture exécute HANA sur des machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="05821-225">At the database layer, this architecture runs HANA on VMs.</span></span> <span data-ttu-id="05821-226">Si votre charge d travail dépasse la taille maximale de machine virtuelle, Microsoft propose également les [Grandes instances Azure](/azure/virtual-machines/workloads/sap/hana-overview-architecture) pour SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="05821-226">If your workload exceeds the maximum VM size, Microsoft also offers [Azure Large Instances](/azure/virtual-machines/workloads/sap/hana-overview-architecture) for SAP HANA.</span></span> <span data-ttu-id="05821-227">Ces serveurs physiques sont colocalisés dans le centre de données certifié Microsoft Azure et à ce jour, fournissent jusqu'à 20 To de capacité de mémoire pour une instance unique.</span><span class="sxs-lookup"><span data-stu-id="05821-227">These physical servers are co-located in a Microsoft Azure certified datacenter and as of this writing, provide up to 20 TB of memory capacity for a single instance.</span></span> <span data-ttu-id="05821-228">Une configuration à plusieurs nœuds est également possible avec une capacité totale de mémoire pouvant atteindre 60 To.</span><span class="sxs-lookup"><span data-stu-id="05821-228">Multi-node configuration is also possible with a total memory capacity of up to 60 TB.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="05821-229">Considérations relatives à la disponibilité</span><span class="sxs-lookup"><span data-stu-id="05821-229">Availability considerations</span></span>

<span data-ttu-id="05821-230">La redondance des ressources constitue le thème général dans les solutions d’infrastructure à haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="05821-230">Resource redundancy is the general theme in highly available infrastructure solutions.</span></span> <span data-ttu-id="05821-231">Pour les entreprises qui présentent un SLA moins strict, les machines virtuelles Azure à instance unique offrent un SLA garantissant un certain temps de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="05821-231">For enterprises that have a less stringent SLA, single-instance Azure VMs offer an uptime SLA.</span></span> <span data-ttu-id="05821-232">Pour plus d’informations, consultez [Contrats de niveau de service Azure](https://azure.microsoft.com/support/legal/sla/).</span><span class="sxs-lookup"><span data-stu-id="05821-232">For more information, see [Azure Service Level Agreement](https://azure.microsoft.com/support/legal/sla/).</span></span>

<span data-ttu-id="05821-233">Dans cette installation distribuée de l’application SAP, l’installation de base est répliquée pour assurer une haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="05821-233">In this distributed installation of the SAP application, the base installation is replicated to achieve high availability.</span></span> <span data-ttu-id="05821-234">Pour chaque couche de l’architecture, la conception mise en œuvre à des fins de haute disponibilité varie.</span><span class="sxs-lookup"><span data-stu-id="05821-234">For each layer of the architecture, the high availability design varies.</span></span>

### <a name="application-tier"></a><span data-ttu-id="05821-235">Couche Application</span><span class="sxs-lookup"><span data-stu-id="05821-235">Application tier</span></span>

- <span data-ttu-id="05821-236">Web Dispatcher.</span><span class="sxs-lookup"><span data-stu-id="05821-236">Web Dispatcher.</span></span> <span data-ttu-id="05821-237">La haute disponibilité est assurée grâce aux instances Web Dispatcher redondantes.</span><span class="sxs-lookup"><span data-stu-id="05821-237">High availability is achieved with redundant Web Dispatcher instances.</span></span> <span data-ttu-id="05821-238">Consultez [SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw70ehp2/7.02.16/en-us/48/8fe37933114e6fe10000000a421937/frameset.htm) dans la documentation SAP.</span><span class="sxs-lookup"><span data-stu-id="05821-238">See [SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw70ehp2/7.02.16/en-us/48/8fe37933114e6fe10000000a421937/frameset.htm) in the SAP documentation.</span></span>
- <span data-ttu-id="05821-239">Serveurs Fiori.</span><span class="sxs-lookup"><span data-stu-id="05821-239">Fiori servers.</span></span> <span data-ttu-id="05821-240">La haute disponibilité est obtenue en équilibrant la charge du trafic au sein d’un pool de serveurs.</span><span class="sxs-lookup"><span data-stu-id="05821-240">High availability is achieved by load balancing traffic within a pool of servers.</span></span>
- <span data-ttu-id="05821-241">Services centraux.</span><span class="sxs-lookup"><span data-stu-id="05821-241">Central Services.</span></span> <span data-ttu-id="05821-242">Pour la haute disponibilité des services centraux sur les machines virtuelles Azure Linux, le serveur High-Availability Extension de la distribution Linux sélectionnées est utilisé et le cluster NFS à haute disponibilité héberge le stockage DRBD.</span><span class="sxs-lookup"><span data-stu-id="05821-242">For high availability of Central Services on Azure Linux virtual machines, the appropriate High Availability Extension for the selected Linux distribution is used, and the highly available NFS cluster hosts DRBD storage.</span></span>
- <span data-ttu-id="05821-243">Serveurs d’applications.</span><span class="sxs-lookup"><span data-stu-id="05821-243">Application servers.</span></span> <span data-ttu-id="05821-244">La haute disponibilité est obtenue en équilibrant la charge du trafic au sein d’un pool de serveurs d’applications.</span><span class="sxs-lookup"><span data-stu-id="05821-244">High availability is achieved by load balancing traffic within a pool of application servers.</span></span>

### <a name="database-tier"></a><span data-ttu-id="05821-245">Couche base de données</span><span class="sxs-lookup"><span data-stu-id="05821-245">Database tier</span></span>

<span data-ttu-id="05821-246">Cette architecture de référence représente un système de base de données SAP HANA à haute disponibilité composée de deux machines virtuelles Azure.</span><span class="sxs-lookup"><span data-stu-id="05821-246">This reference architecture depicts a highly available SAP HANA database system consisting of two Azure virtual machines.</span></span> <span data-ttu-id="05821-247">La fonctionnalité de réplication du système natif de la couche Base de données assure un basculement manuel ou automatique entre les nœuds répliqués :</span><span class="sxs-lookup"><span data-stu-id="05821-247">The database tier's native system replication feature provides either manual or automatic failover between replicated nodes:</span></span>

- <span data-ttu-id="05821-248">Pour le basculement manuel, déployez plusieurs instances HAN et utilisez la Réplication de système HANA (HSR).</span><span class="sxs-lookup"><span data-stu-id="05821-248">For manual failover, deploy more than one HANA instance and use HANA System Replication (HSR).</span></span>
- <span data-ttu-id="05821-249">Pour le basculement automatique, utilisez les fonctionnalités HSR et Linux HAE (High Availability Extension) pour votre distribution Linux.</span><span class="sxs-lookup"><span data-stu-id="05821-249">For automatic failover, use both HSR and Linux High Availability Extension (HAE) for your Linux distribution.</span></span> <span data-ttu-id="05821-250">Linux HAE fournit des services de cluster aux ressources HANA, détectant les événements d’échec et orchestrant le basculement des services errants vers le nœud sain.</span><span class="sxs-lookup"><span data-stu-id="05821-250">Linux HAE provides the cluster services to the HANA resources, detecting failure events and orchestrating the failover of errant services to the healthy node.</span></span>

<span data-ttu-id="05821-251">Consultez [Certifications et configurations SAP en cours sur Microsoft Azure](/azure/virtual-machines/workloads/sap/sap-certifications).</span><span class="sxs-lookup"><span data-stu-id="05821-251">See [SAP certifications and configurations running on Microsoft Azure](/azure/virtual-machines/workloads/sap/sap-certifications).</span></span>

### <a name="disaster-recovery-considerations"></a><span data-ttu-id="05821-252">Considérations relatives à la récupération d’urgence</span><span class="sxs-lookup"><span data-stu-id="05821-252">Disaster recovery considerations</span></span>

<span data-ttu-id="05821-253">Chaque couche utilise une stratégie différente pour assurer une protection par récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="05821-253">Each tier uses a different strategy to provide disaster recovery (DR) protection.</span></span>

- <span data-ttu-id="05821-254">**Couche Serveurs d’applications**.</span><span class="sxs-lookup"><span data-stu-id="05821-254">**Application servers tier**.</span></span> <span data-ttu-id="05821-255">Les serveurs d’applications SAP ne contiennent pas de données d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="05821-255">SAP application servers do not contain business data.</span></span> <span data-ttu-id="05821-256">Sur Azure, une stratégie de récupération d’urgence simple consiste à créer des serveurs d’applications SAP dans la région secondaire, puis à les arrêter.</span><span class="sxs-lookup"><span data-stu-id="05821-256">On Azure, a simple DR strategy is to create SAP application servers in the secondary region, then shut them down.</span></span> <span data-ttu-id="05821-257">En cas de modification de la configuration ou de mise à jour du noyau sur le serveur d’applications principal, les mêmes modifications doivent être appliquées aux machines virtuelles dans la région secondaire.</span><span class="sxs-lookup"><span data-stu-id="05821-257">Upon any configuration changes or kernel updates on the primary application server, the same changes must be applied to the virtual machines in the secondary region.</span></span> <span data-ttu-id="05821-258">Par exemple, copiez les exécutables du noyau SAP vers les machines virtuelles de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="05821-258">For example, copy the SAP kernel executables to the DR virtual machines.</span></span> <span data-ttu-id="05821-259">Pour la réplication automatique des serveurs d’applications vers une région secondaire, [Azure Site Recovery](/azure/site-recovery/site-recovery-overview) est la solution recommandée.</span><span class="sxs-lookup"><span data-stu-id="05821-259">For automatic replication of application servers to a secondary region, [Azure Site Recovery](/azure/site-recovery/site-recovery-overview) is the recommended solution.</span></span> <span data-ttu-id="05821-260">Au moment d’écrire cet article, ASR ne prend pas encore en charge la réplication des paramètres de configuration du réseau accéléré dans les machines virtuelles Azure.</span><span class="sxs-lookup"><span data-stu-id="05821-260">As of the writing of this paper, ASR doesn't yet support the replication of the Accelerated Network configuration setting in Azure VMs.</span></span>

- <span data-ttu-id="05821-261">**Services centraux**.</span><span class="sxs-lookup"><span data-stu-id="05821-261">**Central Services**.</span></span> <span data-ttu-id="05821-262">Ce composant de la pile d’applications SAP ne conserve également aucune donnée d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="05821-262">This component of the SAP application stack also does not persist business data.</span></span> <span data-ttu-id="05821-263">Vous pouvez créer une machine virtuelle dans la région secondaire pour exécuter le rôle Services centraux.</span><span class="sxs-lookup"><span data-stu-id="05821-263">You can build a VM in the secondary region to run the Central Services role.</span></span> <span data-ttu-id="05821-264">Le seul contenu du nœud Services centraux principal à synchroniser est le contenu de partage /sapmnt.</span><span class="sxs-lookup"><span data-stu-id="05821-264">The only content from the primary Central Services node to synchronize is the /sapmnt share content.</span></span> <span data-ttu-id="05821-265">En outre, en cas de modification de la configuration ou de mise à jour du noyau sur les serveurs principaux des services centraux, celles-ci doivent être répétées sur la machine virtuelle dans la région secondaire exécutant des services centraux.</span><span class="sxs-lookup"><span data-stu-id="05821-265">Also, if configuration changes or kernel updates take place on the primary Central Services servers, they must be repeated on the VM in the secondary region running Central Services.</span></span> <span data-ttu-id="05821-266">Pour synchroniser les deux serveurs, vous pouvez utiliser Azure Site Recovery pour répliquer les nœuds de cluster ou simplement utiliser une copie planifiée régulièrement pour copier /sapmnt du côté de la récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="05821-266">To synchronize the two servers, you can use either Azure Site Recovery, to replicate the cluster nodes, or simply use a regularly scheduled copy job to copy /sapmnt to the DR side.</span></span> <span data-ttu-id="05821-267">Pour plus d’informations sur le processus de génération, de copie et de test de basculement, téléchargez [SAP NetWeaver: Building a Hyper-V and Microsoft Azure–based Disaster Recovery Solution](https://download.microsoft.com/download/9/5/6/956FEDC3-702D-4EFB-A7D3-2DB7505566B6/SAP%20NetWeaver%20-%20Building%20an%20Azure%20based%20Disaster%20Recovery%20Solution%20V1_5%20.docx) et lisez la section 4.3, « SAP SPOF layer (ASCS) ».</span><span class="sxs-lookup"><span data-stu-id="05821-267">For details about the build, copy, and test failover process, download [SAP NetWeaver: Building a Hyper-V and Microsoft Azure–based Disaster Recovery Solution](https://download.microsoft.com/download/9/5/6/956FEDC3-702D-4EFB-A7D3-2DB7505566B6/SAP%20NetWeaver%20-%20Building%20an%20Azure%20based%20Disaster%20Recovery%20Solution%20V1_5%20.docx), and refer to section 4.3, "SAP SPOF layer (ASCS)."</span></span> <span data-ttu-id="05821-268">Ce document s’applique à NetWeaver exécuté sur Windows, mais vous pouvez créer la configuration équivalente pour Linux.</span><span class="sxs-lookup"><span data-stu-id="05821-268">This paper applies to NetWeaver running on Windows, but you can create the equivalent configuration for Linux.</span></span> <span data-ttu-id="05821-269">Pour les services centraux, utilisez [Azure Site Recovery](/en-us/azure/site-recovery/site-recovery-overview) pour répliquer les nœuds de cluster et le stockage.</span><span class="sxs-lookup"><span data-stu-id="05821-269">For Central Services, use [Azure Site Recovery](/en-us/azure/site-recovery/site-recovery-overview) to replicate the cluster nodes and storage.</span></span> <span data-ttu-id="05821-270">Pour Linux, créez un géo-cluster à trois nœuds à l’aide d’une fonctionnalité High Availability Extension.</span><span class="sxs-lookup"><span data-stu-id="05821-270">For Linux, create a three node geo-cluster using a High Availability Extension.</span></span>

- <span data-ttu-id="05821-271">**Couche Base de données SAP**.</span><span class="sxs-lookup"><span data-stu-id="05821-271">**SAP database tier**.</span></span> <span data-ttu-id="05821-272">Utilisez HSR pour la réplication prise en charge par HANA.</span><span class="sxs-lookup"><span data-stu-id="05821-272">Use HSR for HANA-supported replication.</span></span> <span data-ttu-id="05821-273">Outre une installation locale haute disponibilité à deux nœuds, HSR prend en charge la réplication à plusieurs niveaux, où un troisième nœud d’une région Azure distincte agit comme une entité étrangère, extérieure au cluster, et s’enregistre sur le réplica secondaire de la paire HSR en cluster en tant que cible de réplication.</span><span class="sxs-lookup"><span data-stu-id="05821-273">In addition to a local, two-node high availability setup, HSR supports multi-tier replication where a third node in a separate Azure region acts as a foreign entity, not part of the cluster, and registers to the secondary replica of the clustered HSR pair as its replication target.</span></span> <span data-ttu-id="05821-274">Il en résulte une configuration en chaîne de la réplication.</span><span class="sxs-lookup"><span data-stu-id="05821-274">This form a replication daisy chain.</span></span> <span data-ttu-id="05821-275">Le basculement vers le nœud de récupération d’urgence est un processus manuel.</span><span class="sxs-lookup"><span data-stu-id="05821-275">The failover to the DR node is a manual process.</span></span>

<span data-ttu-id="05821-276">Pour utiliser Azure Site Recovery pour générer automatiquement un site de production entièrement répliqué de votre déploiement original, vous devez exécuter [des scripts de déploiement](/azure/site-recovery/site-recovery-runbook-automation) personnalisés.</span><span class="sxs-lookup"><span data-stu-id="05821-276">To use Azure Site Recovery to automatically build a fully replicated production site of your original, you must run customized [deployment scripts](/azure/site-recovery/site-recovery-runbook-automation).</span></span> <span data-ttu-id="05821-277">Site Recovery déploie d’abord les machines virtuelles dans des groupes à haute disponibilité, puis exécute des scripts pour ajouter des ressources telles que les équilibreurs de charge.</span><span class="sxs-lookup"><span data-stu-id="05821-277">Site Recovery first deploys the virtual machines in availability sets, then runs scripts to add resources such as load balancers.</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="05821-278">Considérations relatives à la facilité de gestion</span><span class="sxs-lookup"><span data-stu-id="05821-278">Manageability considerations</span></span>

<span data-ttu-id="05821-279">SAP HANA comporte une fonctionnalité de sauvegarde qui utilise l’infrastructure Azure sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="05821-279">SAP HANA has a backup feature that makes use of the underlying Azure infrastructure.</span></span> <span data-ttu-id="05821-280">Lors de la sauvegarde de la base de données SAP HANA en cours d’exécution sur des machines virtuelles, les captures instantanées de SAP HANA et du stockage Azure sont utilisées pour garantir la cohérence des fichiers de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="05821-280">To back up the SAP HANA database running on Azure virtual machines, both the SAP HANA snapshot and Azure storage snapshot are used to ensure the backup files' consistency.</span></span> <span data-ttu-id="05821-281">Pour plus d’informations, consultez le [guide de sauvegarde pour SAP HANA sur les machines virtuelles Azure](/azure/virtual-machines/workloads/sap/sap-hana-backup-guide) et les [FAQ sur le service de sauvegarde Azure](/azure/backup/backup-azure-backup-faq).</span><span class="sxs-lookup"><span data-stu-id="05821-281">For details, see [Backup guide for SAP HANA on Azure Virtual Machines](/azure/virtual-machines/workloads/sap/sap-hana-backup-guide) and the [Azure Backup service FAQ](/azure/backup/backup-azure-backup-faq).</span></span> <span data-ttu-id="05821-282">Seuls les déploiements HANA à conteneur unique prennent en charge l’instantané de stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="05821-282">Only HANA single container deployments support Azure storage snapshot.</span></span>

### <a name="identity-management"></a><span data-ttu-id="05821-283">Gestion des identités</span><span class="sxs-lookup"><span data-stu-id="05821-283">Identity management</span></span>

<span data-ttu-id="05821-284">Contrôlez l’accès aux ressources en utilisant le système centralisé de gestion des identités à tous les niveaux :</span><span class="sxs-lookup"><span data-stu-id="05821-284">Control access to resources by using a centralized identity management system at all levels:</span></span>

- <span data-ttu-id="05821-285">Fournissez l’accès aux ressources Azure via [le contrôle d’accès en fonction du rôle](/azure/active-directory/role-based-access-control-what-is) (RBAC).</span><span class="sxs-lookup"><span data-stu-id="05821-285">Provide access to Azure resources through [role-based access control](/azure/active-directory/role-based-access-control-what-is) (RBAC).</span></span>
- <span data-ttu-id="05821-286">Accordez l’accès aux machines virtuelles Azure via LDAP, Azure Active Directory, Kerberos ou un autre système.</span><span class="sxs-lookup"><span data-stu-id="05821-286">Grant access to Azure VMs through LDAP, Azure Active Directory, Kerberos, or another system.</span></span>
- <span data-ttu-id="05821-287">Prenez en charge l’accès dans les applications elles-mêmes via les services fournis par SAP ou utilisez [OAuth 2.0 et Azure Active Directory](/azure/active-directory/develop/active-directory-protocols-oauth-code).</span><span class="sxs-lookup"><span data-stu-id="05821-287">Support access within the apps themselves through the services that SAP provides, or use [OAuth 2.0 and Azure Active Directory](/azure/active-directory/develop/active-directory-protocols-oauth-code).</span></span>

### <a name="monitoring"></a><span data-ttu-id="05821-288">Surveillance</span><span class="sxs-lookup"><span data-stu-id="05821-288">Monitoring</span></span>

<span data-ttu-id="05821-289">Azure propose plusieurs fonctions de [surveillance et de diagnostic](/azure/architecture/best-practices/monitoring) de l’infrastructure globale.</span><span class="sxs-lookup"><span data-stu-id="05821-289">Azure provides several functions for [monitoring and diagnostics](/azure/architecture/best-practices/monitoring) of the overall infrastructure.</span></span> <span data-ttu-id="05821-290">En outre, l’analyse avancée des machines virtuelles Azure (Windows ou Linux) est gérée par Azure Operations Management Suite (OMS).</span><span class="sxs-lookup"><span data-stu-id="05821-290">Also, enhanced monitoring of Azure virtual machines (Linux or Windows) is handled by Azure Operations Management Suite (OMS).</span></span>

<span data-ttu-id="05821-291">Pour assurer une analyse basée sur SAP des ressources et des performances des services de l’infrastructure SAP, l’extension d’[analyse Azure améliorée pour SAP](/azure/virtual-machines/workloads/sap/deployment-guide#d98edcd3-f2a1-49f7-b26a-07448ceb60ca) est utilisée.</span><span class="sxs-lookup"><span data-stu-id="05821-291">To provide SAP-based monitoring of resources and service performance of the SAP infrastructure, the [Azure SAP Enhanced Monitoring](/azure/virtual-machines/workloads/sap/deployment-guide#d98edcd3-f2a1-49f7-b26a-07448ceb60ca) extension is used.</span></span> <span data-ttu-id="05821-292">Cette extension transmet les statistiques d’analyse Azure à l’application SAP pour les fonctions DBA Cockpit et de surveillance du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="05821-292">This extension feeds Azure monitoring statistics into the SAP application for operating system monitoring and DBA Cockpit functions.</span></span> <span data-ttu-id="05821-293">L’analyse avancée SAP est une condition préalable obligatoire pour l’exécution de SAP sur Azure.</span><span class="sxs-lookup"><span data-stu-id="05821-293">SAP enhanced monitoring is a mandatory prerequisite to run SAP on Azure.</span></span> <span data-ttu-id="05821-294">Pour plus d’informations, consultez la [Note SAP 2191498](https://launchpad.support.sap.com/#/notes/2191498), « SAP on Linux with Azure: Enhanced Monitoring ».</span><span class="sxs-lookup"><span data-stu-id="05821-294">For details, see [SAP Note 2191498](https://launchpad.support.sap.com/#/notes/2191498) – "SAP on Linux with Azure: Enhanced Monitoring."</span></span>

## <a name="security-considerations"></a><span data-ttu-id="05821-295">Considérations relatives à la sécurité</span><span class="sxs-lookup"><span data-stu-id="05821-295">Security considerations</span></span>

<span data-ttu-id="05821-296">SAP possède son propre moteur de gestion des utilisateurs (UME) pour contrôler l’accès et l’autorisation en fonction du rôle dans l’application SAP.</span><span class="sxs-lookup"><span data-stu-id="05821-296">SAP has its own Users Management Engine (UME) to control role-based access and authorization within the SAP application.</span></span> <span data-ttu-id="05821-297">Pour plus d’informations, consultez [SAP HANA Security—An Overview](https://archive.sap.com/documents/docs/DOC-62943) (compte SAP Service Marketplace requis pour l’accès.)</span><span class="sxs-lookup"><span data-stu-id="05821-297">For details, see [SAP HANA Security—An Overview](https://archive.sap.com/documents/docs/DOC-62943) (SAP Service Marketplace account required for access.)</span></span>

<span data-ttu-id="05821-298">Pour une sécurité réseau supplémentaire, envisagez d’implémenter une [zone DMZ réseau](/azure/architecture/reference-architectures/dmz/secure-vnet-hybrid), qui utilise une appliance virtuelle réseau pour créer un pare-feu devant le sous-réseau des pools Web Dispatcher et Fiori Front-End Server.</span><span class="sxs-lookup"><span data-stu-id="05821-298">For additional network security, consider implementing a [Network DMZ](/azure/architecture/reference-architectures/dmz/secure-vnet-hybrid), which uses a network virtual appliance to create a firewall in front of the subnet for Web Dispatcher and Fiori Front-End Server pools.</span></span>

<span data-ttu-id="05821-299">Les données sont chiffrées en transit et au repos à des fins de sécurité de l’infrastructure.</span><span class="sxs-lookup"><span data-stu-id="05821-299">For infrastructure security, data is encrypted in transit and at rest.</span></span> <span data-ttu-id="05821-300">La section « Considérations de sécurité » de [SAP NetWeaver on Azure Virtual Machines (VMs) – Planning and Implementation Guide](/azure/virtual-machines/workloads/sap/planning-guide) (SAP NetWeaver sur les machines virtuelles Azure - Guide de planification et d’implémentation) commence à traiter la sécurité réseau et s’applique à S/4HANA.</span><span class="sxs-lookup"><span data-stu-id="05821-300">The "Security considerations" section of the [SAP NetWeaver on Azure Virtual Machines–Planning and Implementation Guide](/azure/virtual-machines/workloads/sap/planning-guide) begins to address network security and applies to S/4HANA.</span></span> <span data-ttu-id="05821-301">Le guide spécifie également les ports réseau, que vous devez ouvrir sur les pare-feu pour autoriser la communication de l’application.</span><span class="sxs-lookup"><span data-stu-id="05821-301">The guide also specifies the network ports you must open on the firewalls to allow application communication.</span></span>

<span data-ttu-id="05821-302">[Azure Disk Encryption](/azure/security/azure-security-disk-encryption) permet de chiffrer des disques de machines virtuelles Linux IaaS.</span><span class="sxs-lookup"><span data-stu-id="05821-302">To encrypt Linux IaaS virtual machine disks, you can use [Azure Disk Encryption](/azure/security/azure-security-disk-encryption).</span></span> <span data-ttu-id="05821-303">Ce service exploite la fonctionnalité DM-Crypt de Linux pour assurer le chiffrement de volume du système d’exploitation et des disques de données.</span><span class="sxs-lookup"><span data-stu-id="05821-303">It uses the DM-Crypt feature of Linux to provide volume encryption for the operating system and the data disks.</span></span> <span data-ttu-id="05821-304">La solution fonctionne également avec Azure Key Vault, ce qui vous permet de contrôler et de gérer les clés et les secrets de chiffrement de disque dans votre abonnement Key Vault.</span><span class="sxs-lookup"><span data-stu-id="05821-304">The solution also works with Azure Key Vault to help you control and manage the disk-encryption keys and secrets in your key vault subscription.</span></span> <span data-ttu-id="05821-305">Les données sur les disques de vos machines virtuelles sont chiffrées au repos dans votre stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="05821-305">Data on the virtual machine disks are encrypted at rest in your Azure storage.</span></span>

<span data-ttu-id="05821-306">Pour le chiffrement des données SAP HANA au repos, nous recommandons l’utilisation de la technologie de chiffrement native SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="05821-306">For SAP HANA data-at-rest encryption, we recommend using the SAP HANA native encryption technology.</span></span>

> [!NOTE]
> <span data-ttu-id="05821-307">N’utilisez pas le chiffrement des données au repos HANA avec Azure Disk Encryption sur le même serveur.</span><span class="sxs-lookup"><span data-stu-id="05821-307">Do not use the HANA data-at-rest encryption with Azure Disk Encryption on the same server.</span></span> <span data-ttu-id="05821-308">Pour HANA, utilisez uniquement le chiffrement des données HANA.</span><span class="sxs-lookup"><span data-stu-id="05821-308">For HANA, use only HANA data encryption.</span></span>

## <a name="communities"></a><span data-ttu-id="05821-309">Communautés</span><span class="sxs-lookup"><span data-stu-id="05821-309">Communities</span></span>

<span data-ttu-id="05821-310">Les communautés peuvent répondre aux questions et vous aider à paramétrer un déploiement réussi.</span><span class="sxs-lookup"><span data-stu-id="05821-310">Communities can answer questions and help you set up a successful deployment.</span></span> <span data-ttu-id="05821-311">Tenez compte des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="05821-311">Consider the following:</span></span>

- <span data-ttu-id="05821-312">[Blog Running SAP Applications on the Microsoft Platform](https://blogs.msdn.microsoft.com/saponsqlserver/2017/05/04/sap-on-azure-general-update-for-customers-partners-april-2017/) (Exécution d’applications SAP sur la plateforme Microsoft)</span><span class="sxs-lookup"><span data-stu-id="05821-312">[Running SAP Applications on the Microsoft Platform Blog](https://blogs.msdn.microsoft.com/saponsqlserver/2017/05/04/sap-on-azure-general-update-for-customers-partners-april-2017/)</span></span>
- [<span data-ttu-id="05821-313">Support de la communauté Azure</span><span class="sxs-lookup"><span data-stu-id="05821-313">Azure Community Support</span></span>](https://azure.microsoft.com/support/community/)
- [<span data-ttu-id="05821-314">Communauté SAP</span><span class="sxs-lookup"><span data-stu-id="05821-314">SAP Community</span></span>](https://www.sap.com/community.html)
- [<span data-ttu-id="05821-315">Dépassement de capacité de la pile</span><span class="sxs-lookup"><span data-stu-id="05821-315">Stack Overflow</span></span>](https://stackoverflow.com/tags/sap/)

[visio-download]: https://archcenter.blob.core.windows.net/cdn/sap-reference-architectures.vsdx
