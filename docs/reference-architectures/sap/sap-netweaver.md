---
title: Déployer SAP NetWeaver (Windows) pour AnyDB sur des machines virtuelles Azure
titleSuffix: Azure Reference Architectures
description: Pratiques éprouvées d’exécution de SAP S/4HANA dans un environnement Linux sur Azure avec une haute disponibilité.
author: lbrader
ms.date: 08/03/2018
ms.topic: reference-architecture
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: seodec18, SAP, Windows
ms.openlocfilehash: e866727a40551b60e74fc26878a15a5a48e69cf6
ms.sourcegitcommit: 273e690c0cfabbc3822089c7d8bc743ef41d2b6e
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/08/2019
ms.locfileid: "55897624"
---
# <a name="deploy-sap-netweaver-windows-for-anydb-on-azure-virtual-machines"></a><span data-ttu-id="73cc0-103">Déployer SAP NetWeaver (Windows) pour AnyDB sur des machines virtuelles Azure</span><span class="sxs-lookup"><span data-stu-id="73cc0-103">Deploy SAP NetWeaver (Windows) for AnyDB on Azure virtual machines</span></span>

<span data-ttu-id="73cc0-104">Cette architecture de référence présente un ensemble de pratiques éprouvées pour l’exécution de SAP NetWeaver dans un environnement Windows sur Azure avec une haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="73cc0-104">This reference architecture shows a set of proven practices for running SAP NetWeaver in a Windows environment on Azure with high availability.</span></span> <span data-ttu-id="73cc0-105">La base de données est AnyDB, le terme SAP pour tout SGBD pris en charge en plus de SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="73cc0-105">The database is AnyDB, the SAP term for any supported DBMS besides SAP HANA.</span></span> <span data-ttu-id="73cc0-106">Cette architecture est déployée avec des tailles de machine virtuelle spécifiques qui peuvent être modifiées en fonction des besoins de votre organisation.</span><span class="sxs-lookup"><span data-stu-id="73cc0-106">This architecture is deployed with specific virtual machine (VM) sizes that can be changed to accommodate your organization's needs.</span></span>

![Architecture de référence pour SAP NetWeaver (Windows) pour AnyDB sur des machines virtuelles Azure](./images/sap-netweaver.png)

<span data-ttu-id="73cc0-108">*Téléchargez un [fichier Visio][visio-download] de cette architecture.*</span><span class="sxs-lookup"><span data-stu-id="73cc0-108">*Download a [Visio file][visio-download] of this architecture.*</span></span>

> [!NOTE]
> <span data-ttu-id="73cc0-109">Le déploiement de cette architecture de référence requiert une licence appropriée des produits SAP et d’autres technologies non Microsoft.</span><span class="sxs-lookup"><span data-stu-id="73cc0-109">Deploying this reference architecture requires appropriate licensing of SAP products and other non-Microsoft technologies.</span></span>

## <a name="architecture"></a><span data-ttu-id="73cc0-110">Architecture</span><span class="sxs-lookup"><span data-stu-id="73cc0-110">Architecture</span></span>

<span data-ttu-id="73cc0-111">L’architecture est constituée des composants d’infrastructure et des composants logiciels clés suivants.</span><span class="sxs-lookup"><span data-stu-id="73cc0-111">The architecture consists of the following infrastructure and key software components.</span></span>

<span data-ttu-id="73cc0-112">**Réseau virtuel**.</span><span class="sxs-lookup"><span data-stu-id="73cc0-112">**Virtual network**.</span></span> <span data-ttu-id="73cc0-113">Le service Réseau virtuel Azure connecte en toute sécurité les ressources Azure entre elles.</span><span class="sxs-lookup"><span data-stu-id="73cc0-113">The Azure Virtual Network service securely connects Azure resources to each other.</span></span> <span data-ttu-id="73cc0-114">Dans cette architecture, le réseau virtuel se connecte à un environnement local via une passerelle VPN déployée dans le hub d’une topologie [hub-and-spoke](../hybrid-networking/hub-spoke.md).</span><span class="sxs-lookup"><span data-stu-id="73cc0-114">In this architecture, the virtual network connects to an on-premises environment through a VPN gateway deployed in the hub of a [hub-spoke](../hybrid-networking/hub-spoke.md).</span></span> <span data-ttu-id="73cc0-115">Le spoke est le réseau virtuel utilisé pour les applications SAP et la couche Données.</span><span class="sxs-lookup"><span data-stu-id="73cc0-115">The spoke is the virtual network used for the SAP applications and database tier.</span></span>

<span data-ttu-id="73cc0-116">**Sous-réseaux**.</span><span class="sxs-lookup"><span data-stu-id="73cc0-116">**Subnets**.</span></span> <span data-ttu-id="73cc0-117">Le réseau virtuel est divisé en sous-réseaux distincts pour chaque couche : Application (SAP NetWeaver), Base de données, Services partagés (jumpbox) et Active Directory.</span><span class="sxs-lookup"><span data-stu-id="73cc0-117">The virtual network is subdivided into separate subnets for each tier: application (SAP NetWeaver), database, shared services (the jumpbox), and Active Directory.</span></span>

<span data-ttu-id="73cc0-118">**Machines virtuelles**.</span><span class="sxs-lookup"><span data-stu-id="73cc0-118">**Virtual machines**.</span></span> <span data-ttu-id="73cc0-119">Cette architecture utilise des machines virtuelles regroupées comme suit pour les couches Application et Base de données :</span><span class="sxs-lookup"><span data-stu-id="73cc0-119">This architecture uses virtual machines for the application tier and database tier, grouped as follows:</span></span>

- <span data-ttu-id="73cc0-120">**SAP NetWeaver**.</span><span class="sxs-lookup"><span data-stu-id="73cc0-120">**SAP NetWeaver**.</span></span> <span data-ttu-id="73cc0-121">La couche Application utilise des machines virtuelles Windows et exécute les services centraux SAP et des serveurs d’applications SAP.</span><span class="sxs-lookup"><span data-stu-id="73cc0-121">The application tier uses Windows virtual machines and runs SAP Central Services and SAP application servers.</span></span> <span data-ttu-id="73cc0-122">Les machines virtuelles qui exécutent les services centraux sont configurées en tant que cluster de basculement Windows Server pour la haute disponibilité, pris en charge par SIOS DataKeeper Cluster Edition.</span><span class="sxs-lookup"><span data-stu-id="73cc0-122">The VMs that run Central Services are configured as a Windows Server Failover Cluster for high availability, supported by SIOS DataKeeper Cluster Edition.</span></span>
- <span data-ttu-id="73cc0-123">**AnyDB**.</span><span class="sxs-lookup"><span data-stu-id="73cc0-123">**AnyDB**.</span></span> <span data-ttu-id="73cc0-124">La couche Base de données exécute AnyDB (Microsoft SQL Server, Oracle, IBM DB2, etc.) en tant que base de données source.</span><span class="sxs-lookup"><span data-stu-id="73cc0-124">The database tier runs AnyDB as the source database, such as Microsoft SQL Server, Oracle, or IBM DB2.</span></span>
- <span data-ttu-id="73cc0-125">**Jumpbox**.</span><span class="sxs-lookup"><span data-stu-id="73cc0-125">**Jumpbox**.</span></span> <span data-ttu-id="73cc0-126">Également appelé hôte bastion.</span><span class="sxs-lookup"><span data-stu-id="73cc0-126">Also called a bastion host.</span></span> <span data-ttu-id="73cc0-127">Il s’agit d’une machine virtuelle sécurisée sur le réseau, utilisée par les administrateurs pour se connecter aux autres machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="73cc0-127">This is a secure virtual machine on the network that administrators use to connect to the other virtual machines.</span></span>
- <span data-ttu-id="73cc0-128">**Contrôleurs de domaine Windows Server Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="73cc0-128">**Windows Server Active Directory domain controllers**.</span></span> <span data-ttu-id="73cc0-129">Les contrôleurs de domaine sont utilisés pour l’ensemble des machines virtuelles et des utilisateurs du domaine.</span><span class="sxs-lookup"><span data-stu-id="73cc0-129">The domain controllers are used on all VMs and users in the domain.</span></span>

<span data-ttu-id="73cc0-130">**Équilibreurs de charge** :</span><span class="sxs-lookup"><span data-stu-id="73cc0-130">**Load balancers**.</span></span> <span data-ttu-id="73cc0-131">Les instances [Azure Load Balancer](/azure/load-balancer/load-balancer-overview) servent à distribuer le trafic vers les machines virtuelles du sous-réseau de la couche Application.</span><span class="sxs-lookup"><span data-stu-id="73cc0-131">[Azure Load Balancer](/azure/load-balancer/load-balancer-overview) instances are used to distribute traffic to virtual machines in the application tier subnet.</span></span> <span data-ttu-id="73cc0-132">Il est possible d’obtenir une haute disponibilité au niveau de la couche données à l’aide d’équilibreurs de charge SAP intégrés, Azure Load Balancer, ou d’autres mécanismes, en fonction du système SGBD.</span><span class="sxs-lookup"><span data-stu-id="73cc0-132">At the data tier, high availability may be achieved using built-in SAP load balancers, Azure Load Balancer, or other mechanisms, depending on the DBMS.</span></span> <span data-ttu-id="73cc0-133">Pour plus d’informations, consultez [Déploiement SGBD de machines virtuelles Azure pour SAP NetWeaver](/azure/virtual-machines/workloads/sap/dbms-guide).</span><span class="sxs-lookup"><span data-stu-id="73cc0-133">For more information, see [Azure Virtual Machines DBMS deployment for SAP NetWeaver](/azure/virtual-machines/workloads/sap/dbms-guide).</span></span>

<span data-ttu-id="73cc0-134">**Groupes à haute disponibilité**.</span><span class="sxs-lookup"><span data-stu-id="73cc0-134">**Availability sets**.</span></span> <span data-ttu-id="73cc0-135">Les machines virtuelles pour les rôles SAP Web Dispatcher, Serveur d’applications SAP et (A)SCS sont réunies dans des [groupes à haute disponibilité](/azure/virtual-machines/windows/tutorial-availability-sets) distincts, et au moins deux machines virtuelles sont approvisionnées pour chaque rôle.</span><span class="sxs-lookup"><span data-stu-id="73cc0-135">Virtual machines for the SAP Web Dispatcher, SAP application server, and (A)SCS, roles are grouped into separate [availability sets](/azure/virtual-machines/windows/tutorial-availability-sets), and at least two virtual machines are provisioned per role.</span></span> <span data-ttu-id="73cc0-136">Cela rend les machines virtuelles éligibles pour un [contrat de niveau de service](https://azure.microsoft.com/support/legal/sla/virtual-machines) (SLA) plus élevé.</span><span class="sxs-lookup"><span data-stu-id="73cc0-136">This makes the virtual machines eligible for a higher [service level agreement](https://azure.microsoft.com/support/legal/sla/virtual-machines) (SLA).</span></span>

<span data-ttu-id="73cc0-137">**Cartes réseau**.</span><span class="sxs-lookup"><span data-stu-id="73cc0-137">**NICs**.</span></span> <span data-ttu-id="73cc0-138">Les [cartes réseau](/azure/virtual-network/virtual-network-network-interface) assurent l’ensemble des communications des machines virtuelles sur un réseau virtuel.</span><span class="sxs-lookup"><span data-stu-id="73cc0-138">[Network interface cards](/azure/virtual-network/virtual-network-network-interface) (NICs) enable all communication of virtual machines on a virtual network.</span></span>

<span data-ttu-id="73cc0-139">**Groupes de sécurité réseau**.</span><span class="sxs-lookup"><span data-stu-id="73cc0-139">**Network security groups**.</span></span> <span data-ttu-id="73cc0-140">Pour limiter le trafic entrant, sortant et intra-sous-réseau dans le réseau virtuel, vous pouvez créer des [groupes de sécurité réseau](/azure/virtual-network/virtual-networks-nsg) (NSG).</span><span class="sxs-lookup"><span data-stu-id="73cc0-140">To restrict incoming, outgoing, and intra-subnet traffic in the virtual network, you can create [network security groups](/azure/virtual-network/virtual-networks-nsg) (NSGs).</span></span>

<span data-ttu-id="73cc0-141">**Passerelle**.</span><span class="sxs-lookup"><span data-stu-id="73cc0-141">**Gateway**.</span></span> <span data-ttu-id="73cc0-142">Une passerelle étend votre réseau local au réseau virtuel Azure.</span><span class="sxs-lookup"><span data-stu-id="73cc0-142">A gateway extends your on-premises network to the Azure virtual network.</span></span> <span data-ttu-id="73cc0-143">[ExpressRoute](/azure/architecture/reference-architectures/hybrid-networking/expressroute) est le service Azure recommandé pour la création de connexions privées qui ne passent pas par l’Internet public, mais il est également possible d’utiliser une connexion [site à site](/azure/vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal).</span><span class="sxs-lookup"><span data-stu-id="73cc0-143">[ExpressRoute](/azure/architecture/reference-architectures/hybrid-networking/expressroute) is the recommended Azure service for creating private connections that do not go over the public Internet, but a [Site-to-Site](/azure/vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal) connection can also be used.</span></span>

<span data-ttu-id="73cc0-144">**Stockage Azure**.</span><span class="sxs-lookup"><span data-stu-id="73cc0-144">**Azure Storage**.</span></span> <span data-ttu-id="73cc0-145">Pour bénéficier d’un stockage permanent du disque dur virtuel d’une machine virtuelle, le service [Stockage Azure](/azure/storage/storage-standard-storage) est requis.</span><span class="sxs-lookup"><span data-stu-id="73cc0-145">To provide persistent storage of a virtual machine's virtual hard disk (VHD), [Azure Storage](/azure/storage/storage-standard-storage) is required.</span></span> <span data-ttu-id="73cc0-146">Il est également utilisé par le [témoin de cloud](/windows-server/failover-clustering/deploy-cloud-witness) pour mettre en œuvre les opérations du cluster de basculement.</span><span class="sxs-lookup"><span data-stu-id="73cc0-146">It is also used by [Cloud Witness](/windows-server/failover-clustering/deploy-cloud-witness) to implement a failover cluster operation.</span></span>

## <a name="recommendations"></a><span data-ttu-id="73cc0-147">Recommandations</span><span class="sxs-lookup"><span data-stu-id="73cc0-147">Recommendations</span></span>

<span data-ttu-id="73cc0-148">Vos exigences peuvent différer de celles de l’architecture décrite ici.</span><span class="sxs-lookup"><span data-stu-id="73cc0-148">Your requirements might differ from the architecture described here.</span></span> <span data-ttu-id="73cc0-149">Utilisez ces recommandations comme point de départ.</span><span class="sxs-lookup"><span data-stu-id="73cc0-149">Use these recommendations as a starting point.</span></span>

### <a name="sap-web-dispatcher-pool"></a><span data-ttu-id="73cc0-150">Pool SAP Web Dispatcher</span><span class="sxs-lookup"><span data-stu-id="73cc0-150">SAP Web Dispatcher pool</span></span>

<span data-ttu-id="73cc0-151">Le composant Web Dispatcher sert d’équilibreur de charge pour le trafic SAP entre les serveurs d’applications SAP.</span><span class="sxs-lookup"><span data-stu-id="73cc0-151">The Web Dispatcher component is used as a load balancer for SAP traffic among the SAP application servers.</span></span> <span data-ttu-id="73cc0-152">Afin d’assurer la haute disponibilité pour le composant Web Dispatcher, Azure Load Balancer est utilisé pour implémenter l’installation Web Dispatcher parallèle.</span><span class="sxs-lookup"><span data-stu-id="73cc0-152">To achieve high availability for the Web Dispatcher component, Azure Load Balancer is used to implement the parallel Web Dispatcher setup.</span></span> <span data-ttu-id="73cc0-153">Web Dispatcher utilise une configuration de tourniquet (round robin) pour la distribution du trafic HTTP(S) entre les instances Web Dispatcher disponibles dans le pool d’équilibreurs.</span><span class="sxs-lookup"><span data-stu-id="73cc0-153">Web Dispatcher uses in a round-robin configuration for HTTP(S) traffic distribution among the available Web Dispatchers in the balancers pool.</span></span>

<span data-ttu-id="73cc0-154">Pour plus d’informations sur l’exécution de SAP NetWeaver sur des machines virtuelles Azure, consultez [Planification et implémentation de machines virtuelles Azure pour SAP NetWeaver](/azure/virtual-machines/workloads/sap/planning-guide).</span><span class="sxs-lookup"><span data-stu-id="73cc0-154">For details about running SAP NetWeaver in Azure VMs, see [Azure Virtual Machines planning and implementation for SAP NetWeaver](/azure/virtual-machines/workloads/sap/planning-guide).</span></span>

### <a name="application-servers-pool"></a><span data-ttu-id="73cc0-155">Pool de serveurs d’applications</span><span class="sxs-lookup"><span data-stu-id="73cc0-155">Application servers pool</span></span>

<span data-ttu-id="73cc0-156">Pour gérer les groupes de connexion des serveurs d’applications ABAP, la transaction SMLG est utilisée.</span><span class="sxs-lookup"><span data-stu-id="73cc0-156">To manage logon groups for ABAP application servers, the SMLG transaction is used.</span></span> <span data-ttu-id="73cc0-157">Elle s’appuie sur la fonction d’équilibrage de charge au sein du serveur de messages des services centraux pour répartir la charge de travail entre le pool de serveurs d’applications pour le trafic des clients SAP GUI et RFC.</span><span class="sxs-lookup"><span data-stu-id="73cc0-157">It uses the load balancing function within the message server of the Central Services to distribute workload among SAP application servers pool for SAPGUIs and RFC traffic.</span></span> <span data-ttu-id="73cc0-158">La connexion des serveurs d’applications aux services centraux hautement disponibles se fait via le nom du réseau virtuel du cluster.</span><span class="sxs-lookup"><span data-stu-id="73cc0-158">The application server connection to the highly available Central Services is through the cluster virtual network name.</span></span>

### <a name="sap-central-services-cluster"></a><span data-ttu-id="73cc0-159">Cluster des services centraux SAP</span><span class="sxs-lookup"><span data-stu-id="73cc0-159">SAP Central Services cluster</span></span>

<span data-ttu-id="73cc0-160">Cette architecture de référence exécute les services centraux sur les machines virtuelles de la couche application.</span><span class="sxs-lookup"><span data-stu-id="73cc0-160">This reference architecture runs Central Services on VMs in the application tier.</span></span> <span data-ttu-id="73cc0-161">Les services centraux représentent un point de défaillance unique (SPOF) potentiel lors du déploiement sur une seule machine virtuelle — un déploiement classique quand la haute disponibilité ne constitue pas une exigence.</span><span class="sxs-lookup"><span data-stu-id="73cc0-161">The Central Services is a potential single point of failure (SPOF) when deployed to a single VM—typical deployment when high availability is not a requirement.</span></span> <span data-ttu-id="73cc0-162">Pour implémenter une solution à haute disponibilité, il est possible d’utiliser soit un cluster de disque partagé, soit un cluster de partage de fichiers.</span><span class="sxs-lookup"><span data-stu-id="73cc0-162">To implement a high availability solution, either a shared disk cluster or a file share cluster can be used.</span></span>

<span data-ttu-id="73cc0-163">Pour configurer des machines virtuelles pour un cluster de disque partagé, utilisez le [cluster de basculement Windows Server](https://blogs.sap.com/2018/01/25/how-to-create-sap-resources-in-windows-failover-cluster/).</span><span class="sxs-lookup"><span data-stu-id="73cc0-163">To configure VMs for a shared disk cluster, use [Windows Server Failover Cluster](https://blogs.sap.com/2018/01/25/how-to-create-sap-resources-in-windows-failover-cluster/).</span></span> <span data-ttu-id="73cc0-164">Le [témoin de cloud](/windows-server/failover-clustering/deploy-cloud-witness) est recommandé en tant que témoin de quorum.</span><span class="sxs-lookup"><span data-stu-id="73cc0-164">[Cloud Witness](/windows-server/failover-clustering/deploy-cloud-witness) is recommended as a quorum witness.</span></span> <span data-ttu-id="73cc0-165">Pour prendre en charge l’environnement de cluster de basculement, [SIOS DataKeeper Cluster Edition](https://azuremarketplace.microsoft.com/marketplace/apps/sios_datakeeper.sios-datakeeper-8) exécute la fonction de volume partagé de cluster en répliquant des disques indépendants détenus par les nœuds de cluster.</span><span class="sxs-lookup"><span data-stu-id="73cc0-165">To support the failover cluster environment, [SIOS DataKeeper Cluster Edition](https://azuremarketplace.microsoft.com/marketplace/apps/sios_datakeeper.sios-datakeeper-8) performs the cluster shared volume function by replicating independent disks owned by the cluster nodes.</span></span> <span data-ttu-id="73cc0-166">Azure ne prend pas en charge les disques partagés de manière native et nécessite donc les solutions fournies par SIOS.</span><span class="sxs-lookup"><span data-stu-id="73cc0-166">Azure does not natively support shared disks and therefore requires solutions provided by SIOS.</span></span>

<span data-ttu-id="73cc0-167">Pour plus d’informations, consultez « 3.</span><span class="sxs-lookup"><span data-stu-id="73cc0-167">For details, see "3.</span></span> <span data-ttu-id="73cc0-168">Important Update for SAP Customers Running ASCS on SIOS on Azure » (Mise à jour importante pour les clients SAP exécutant ASCS sur SIOS dans Azure) sur le blog clients en cours d’exécution ASC sur SIOS sur Azure » sur le blog [Running SAP applications on the Microsoft platform](https://blogs.msdn.microsoft.com/saponsqlserver/2017/05/04/sap-on-azure-general-update-for-customers-partners-april-2017/) (Exécution des applications SAP sur la plateforme Microsoft).</span><span class="sxs-lookup"><span data-stu-id="73cc0-168">Important Update for SAP Customers Running ASCS on SIOS on Azure” at [Running SAP applications on the Microsoft platform](https://blogs.msdn.microsoft.com/saponsqlserver/2017/05/04/sap-on-azure-general-update-for-customers-partners-april-2017/).</span></span>

<span data-ttu-id="73cc0-169">Une autre solution pour gérer le clustering consiste à implémenter un cluster de partage de fichiers à l’aide du cluster de basculement Windows Server.</span><span class="sxs-lookup"><span data-stu-id="73cc0-169">Another way to handle clustering is to implement a file share cluster using Windows Server Failover Cluster.</span></span> <span data-ttu-id="73cc0-170">[SAP](https://blogs.sap.com/2018/03/19/migration-from-a-shared-disk-cluster-to-a-file-share-cluster/) a récemment modifié le modèle de déploiement des services centraux pour accéder aux répertoires globaux /sapmnt via un chemin d’accès UNC.</span><span class="sxs-lookup"><span data-stu-id="73cc0-170">[SAP](https://blogs.sap.com/2018/03/19/migration-from-a-shared-disk-cluster-to-a-file-share-cluster/) recently modified the Central Services deployment pattern to access the /sapmnt global directories via a UNC path.</span></span> <span data-ttu-id="73cc0-171">Cette modification [élimine la nécessité](https://blogs.msdn.microsoft.com/saponsqlserver/2017/08/10/high-available-ascs-for-windows-on-file-share-shared-disk-no-longer-required/) de SIOS ou d’autres solutions de disque partagé sur les machines virtuelles des services centraux.</span><span class="sxs-lookup"><span data-stu-id="73cc0-171">This change [removes the requirement](https://blogs.msdn.microsoft.com/saponsqlserver/2017/08/10/high-available-ascs-for-windows-on-file-share-shared-disk-no-longer-required/) for SIOS or other shared disk solutions on the Central Services VMs.</span></span> <span data-ttu-id="73cc0-172">Il est toutefois recommandé de s’assurer que le partage UNC /sapmnt est [hautement disponible](https://blogs.sap.com/2017/07/21/how-to-create-a-high-available-sapmnt-share/).</span><span class="sxs-lookup"><span data-stu-id="73cc0-172">It is still recommended to ensure that the /sapmnt UNC share is [highly available](https://blogs.sap.com/2017/07/21/how-to-create-a-high-available-sapmnt-share/).</span></span> <span data-ttu-id="73cc0-173">Cela peut être effectué sur l’instance des services centraux en utilisant le cluster de basculement Windows Server avec le [serveur de fichiers Scale Out](https://blogs.msdn.microsoft.com/saponsqlserver/2017/11/14/file-server-with-sofs-and-s2d-as-an-alternative-to-cluster-shared-disk-for-clustering-of-an-sap-ascs-instance-in-azure-is-generally-available/) (SOFS) et la fonctionnalité d’[espaces de stockage direct](https://blogs.sap.com/2018/03/07/your-sap-on-azure-part-5-ascs-high-availability-with-storage-spaces-direct/) de Windows Server 2016.</span><span class="sxs-lookup"><span data-stu-id="73cc0-173">This can be done on the Central Services instance by using Windows Server Failover Cluster with [Scale Out File Server](https://blogs.msdn.microsoft.com/saponsqlserver/2017/11/14/file-server-with-sofs-and-s2d-as-an-alternative-to-cluster-shared-disk-for-clustering-of-an-sap-ascs-instance-in-azure-is-generally-available/) (SOFS) and the [Storage Spaces Direct](https://blogs.sap.com/2018/03/07/your-sap-on-azure-part-5-ascs-high-availability-with-storage-spaces-direct/) (S2D) feature in Windows Server 2016.</span></span>

### <a name="availability-sets"></a><span data-ttu-id="73cc0-174">Groupes à haute disponibilité</span><span class="sxs-lookup"><span data-stu-id="73cc0-174">Availability sets</span></span>

<span data-ttu-id="73cc0-175">Les groupes à haute disponibilité répartissent les serveurs dans des groupes d’infrastructure physique et de mise à jour différents pour améliorer la disponibilité des services.</span><span class="sxs-lookup"><span data-stu-id="73cc0-175">Availability sets distribute servers to different physical infrastructure and update groups to improve service availability.</span></span> <span data-ttu-id="73cc0-176">Placez les machines virtuelles qui présentent le même rôle dans un groupe de disponibilité afin d’éviter les temps d’arrêt causés par la maintenance de l’infrastructure Azure et de respecter les [contrats de niveau de service](https://azure.microsoft.com/support/legal/sla/virtual-machines) (SLA).</span><span class="sxs-lookup"><span data-stu-id="73cc0-176">Put virtual machines that perform the same role into an availability sets to help guard against downtime caused by Azure infrastructure maintenance and to meet [SLAs](https://azure.microsoft.com/support/legal/sla/virtual-machines) (SLAs).</span></span> <span data-ttu-id="73cc0-177">Il est recommandé de placer au moins deux machines virtuelles dans un groupe à haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="73cc0-177">Two or more virtual machines per availability set is recommended.</span></span>

<span data-ttu-id="73cc0-178">Toutes les machines virtuelles d’un groupe doivent présenter le même rôle.</span><span class="sxs-lookup"><span data-stu-id="73cc0-178">All virtual machines in a set must perform the same role.</span></span> <span data-ttu-id="73cc0-179">N’associez pas de serveurs remplissant des rôles différents dans le même groupe à haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="73cc0-179">Do not mix servers of different roles in the same availability set.</span></span> <span data-ttu-id="73cc0-180">Par exemple, ne placez pas un nœud Services centraux dans le même groupe de disponibilité que le serveur d’applications.</span><span class="sxs-lookup"><span data-stu-id="73cc0-180">For example, don't place a Central Services node in the same availability set with the application server.</span></span>

### <a name="nics"></a><span data-ttu-id="73cc0-181">Cartes réseau</span><span class="sxs-lookup"><span data-stu-id="73cc0-181">NICs</span></span>

<span data-ttu-id="73cc0-182">Les déploiements SAP locaux traditionnels implémentent plusieurs cartes réseau par machine pour séparer le trafic administratif du trafic opérationnel.</span><span class="sxs-lookup"><span data-stu-id="73cc0-182">Traditional on-premises SAP deployments implement multiple network interface cards (NICs) per machine to segregate administrative traffic from business traffic.</span></span> <span data-ttu-id="73cc0-183">Sur Azure, le réseau virtuel est un réseau à définition logicielle qui envoie tout le trafic via la même structure réseau.</span><span class="sxs-lookup"><span data-stu-id="73cc0-183">On Azure, the virtual network is a software-defined network that sends all traffic through the same network fabric.</span></span> <span data-ttu-id="73cc0-184">Par conséquent, il est inutile d’utiliser plusieurs cartes réseau.</span><span class="sxs-lookup"><span data-stu-id="73cc0-184">Therefore, the use of multiple NICs is unnecessary.</span></span> <span data-ttu-id="73cc0-185">Toutefois, si votre organisation a besoin de séparer le trafic, vous pouvez déployer plusieurs cartes réseau par machine virtuelle, connecter chaque carte réseau à un sous-réseau différent, puis utiliser des NSG pour appliquer des stratégies de contrôle d’accès distinctes.</span><span class="sxs-lookup"><span data-stu-id="73cc0-185">However, if your organization needs to segregate traffic, you can deploy multiple NICs per VM, connect each NIC to a different subnet, and then use NSGs to enforce different access control policies.</span></span>

### <a name="subnets-and-nsgs"></a><span data-ttu-id="73cc0-186">Sous-réseaux et NSG</span><span class="sxs-lookup"><span data-stu-id="73cc0-186">Subnets and NSGs</span></span>

<span data-ttu-id="73cc0-187">Cette architecture divise l’espace d’adressage du réseau virtuel en sous-réseaux.</span><span class="sxs-lookup"><span data-stu-id="73cc0-187">This architecture subdivides the virtual network address space into subnets.</span></span> <span data-ttu-id="73cc0-188">Cette architecture de référence est principalement axée sur le sous-réseau de la couche Application.</span><span class="sxs-lookup"><span data-stu-id="73cc0-188">This reference architecture focuses primarily on the application tier subnet.</span></span> <span data-ttu-id="73cc0-189">Chaque sous-réseau peut être associé à un NSG qui définit les stratégies d’accès pour ce sous-réseau.</span><span class="sxs-lookup"><span data-stu-id="73cc0-189">Each subnet can be associated with a NSG that defines the access policies for the subnet.</span></span> <span data-ttu-id="73cc0-190">Placez les serveurs d’applications dans un sous-réseau distinct afin de pouvoir les sécuriser plus facilement en gérant les stratégies de sécurité du sous-réseau plutôt que les serveurs individuels.</span><span class="sxs-lookup"><span data-stu-id="73cc0-190">Place application servers on a separate subnet so you can secure them more easily by managing the subnet security policies, not the individual servers.</span></span>

<span data-ttu-id="73cc0-191">Quand un NSG est associé à un sous-réseau, il s’applique à tous les serveurs au sein de ce sous-réseau.</span><span class="sxs-lookup"><span data-stu-id="73cc0-191">When a NSG is associated with a subnet, it applies to all the servers within the subnet.</span></span> <span data-ttu-id="73cc0-192">Pour plus d’informations sur l’utilisation de NSG pour un contrôle précis des serveurs d’un sous-réseau, consultez [Filtrer le trafic réseau avec les groupes de sécurité réseau](https://azure.microsoft.com/blog/multiple-vm-nics-and-network-virtual-appliances-in-azure).</span><span class="sxs-lookup"><span data-stu-id="73cc0-192">For more information about using NSGs for fine-grained control over the servers in a subnet, see [Filter network traffic with network security groups](https://azure.microsoft.com/blog/multiple-vm-nics-and-network-virtual-appliances-in-azure).</span></span>

### <a name="load-balancers"></a><span data-ttu-id="73cc0-193">Équilibreurs de charge</span><span class="sxs-lookup"><span data-stu-id="73cc0-193">Load balancers</span></span>

<span data-ttu-id="73cc0-194">[SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw73ehp1/7.31.19/en-US/48/8fe37933114e6fe10000000a421937/frameset.htm) gère l’équilibrage de charge du trafic HTTP(S) à destination d’un pool de serveurs d’applications SAP.</span><span class="sxs-lookup"><span data-stu-id="73cc0-194">[SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw73ehp1/7.31.19/en-US/48/8fe37933114e6fe10000000a421937/frameset.htm) handles load balancing of HTTP(S) traffic to a pool of SAP application servers.</span></span>

<span data-ttu-id="73cc0-195">Pour le trafic en provenance de clients SAP GUI se connectant à un serveur SAP via le protocole DIAG ou RFC (Remote Function Call), le serveur de messages des services centraux équilibre la charge par l’intermédiaire des [groupes de connexion](https://wiki.scn.sap.com/wiki/display/SI/ABAP+Logon+Group+based+Load+Balancing) des serveurs d’applications. Par conséquent, aucun équilibreur de charge supplémentaire n’est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="73cc0-195">For traffic from SAP GUI clients connecting a SAP server via DIAG protocol or Remote Function Calls (RFC), the Central Services message server balances the load through SAP application server [logon groups](https://wiki.scn.sap.com/wiki/display/SI/ABAP+Logon+Group+based+Load+Balancing), so no additional load balancer is needed.</span></span>

### <a name="azure-storage"></a><span data-ttu-id="73cc0-196">Stockage Azure</span><span class="sxs-lookup"><span data-stu-id="73cc0-196">Azure Storage</span></span>

<span data-ttu-id="73cc0-197">Pour toutes les machines virtuelles du serveur de base de données, nous recommandons l’utilisation du stockage Premium Azure afin de bénéficier d’une latence en lecture/écriture homogène.</span><span class="sxs-lookup"><span data-stu-id="73cc0-197">For all database server virtual machines, we recommend using Azure Premium Storage for consistent read/write latency.</span></span> <span data-ttu-id="73cc0-198">Pour les machines virtuelles à instance unique utilisant le stockage Premium pour tous les disques de système d’exploitation et de données, consultez [SLA pour Machines virtuelles](https://azure.microsoft.com/support/legal/sla/virtual-machines).</span><span class="sxs-lookup"><span data-stu-id="73cc0-198">For any single instance virtual machine using Premium Storage for all operating system disks and data disks, see [SLA for Virtual Machines](https://azure.microsoft.com/support/legal/sla/virtual-machines).</span></span> <span data-ttu-id="73cc0-199">En outre, pour les systèmes SAP de production, nous vous recommandons d’utiliser [Azure Managed Disks](/azure/storage/storage-managed-disks-overview) Premium dans tous les cas.</span><span class="sxs-lookup"><span data-stu-id="73cc0-199">Also, for production SAP systems, we recommend using Premium [Azure Managed Disks](/azure/storage/storage-managed-disks-overview) in all cases.</span></span> <span data-ttu-id="73cc0-200">Pour des questions de fiabilité, des disques managés sont utilisés pour gérer les fichiers VHD pour les disques.</span><span class="sxs-lookup"><span data-stu-id="73cc0-200">For reliability, Managed Disks are used to manage the VHD files for the disks.</span></span> <span data-ttu-id="73cc0-201">Les disques managés assurent l’isolement des disques des machines virtuelles au sein d’un groupe à haute disponibilité afin d’éviter les points de défaillance uniques.</span><span class="sxs-lookup"><span data-stu-id="73cc0-201">Managed disks ensure that the disks for virtual machines within an availability set are isolated to avoid single points of failure.</span></span>

<span data-ttu-id="73cc0-202">Pour les serveurs d’applications SAP, y compris les machines virtuelles des services centraux, vous pouvez utiliser le stockage Azure Standard afin de réduire les coûts. En effet, l’exécution des applications s’effectue en mémoire et utilise les disques uniquement pour la journalisation.</span><span class="sxs-lookup"><span data-stu-id="73cc0-202">For SAP application servers, including the Central Services virtual machines, you can use Azure Standard Storage to reduce cost, because application execution takes place in memory and disks are used for logging only.</span></span> <span data-ttu-id="73cc0-203">Toutefois, à l’heure actuelle, le stockage Standard est certifié uniquement pour le stockage non managé.</span><span class="sxs-lookup"><span data-stu-id="73cc0-203">However, at this time, Standard Storage is only certified for unmanaged storage.</span></span> <span data-ttu-id="73cc0-204">Dans la mesure où les serveurs d’applications n’hébergent pas de données, vous pouvez également utiliser les disques de stockage Premium P4 et P6 de moins grande capacité pour réduire les coûts.</span><span class="sxs-lookup"><span data-stu-id="73cc0-204">Since application servers do not host any data, you can also use the smaller P4 and P6 Premium Storage disks to help minimize cost.</span></span>

<span data-ttu-id="73cc0-205">Le service Stockage Azure est également utilisé par le [témoin de cloud](/windows-server/failover-clustering/deploy-cloud-witness) pour maintenir le quorum avec un appareil dans une région Azure distante en dehors de la région primaire où réside le cluster.</span><span class="sxs-lookup"><span data-stu-id="73cc0-205">Azure Storage is also used by [Cloud Witness](/windows-server/failover-clustering/deploy-cloud-witness) to maintain quorum with a device in a remote Azure region away from the primary region where the cluster resides.</span></span>

<span data-ttu-id="73cc0-206">Pour le magasin de données de sauvegarde, nous vous recommandons d’utiliser le stockage de [niveau d’accès froid](/azure/storage/storage-blob-storage-tiers) ou de [niveau d’accès archive](/azure/storage/storage-blob-storage-tiers) Azure.</span><span class="sxs-lookup"><span data-stu-id="73cc0-206">For the backup data store, we recommend using Azure [coolaccess tier](/azure/storage/storage-blob-storage-tiers) and [archive access tier storage](/azure/storage/storage-blob-storage-tiers).</span></span> <span data-ttu-id="73cc0-207">Ces niveaux de stockage offrent des moyens économiques de stocker les données durables rarement sollicitées.</span><span class="sxs-lookup"><span data-stu-id="73cc0-207">These storage tiers are cost-effective ways to store long-lived data that is infrequently accessed.</span></span>

## <a name="performance-considerations"></a><span data-ttu-id="73cc0-208">Considérations relatives aux performances</span><span class="sxs-lookup"><span data-stu-id="73cc0-208">Performance considerations</span></span>

<span data-ttu-id="73cc0-209">Les serveurs d’applications SAP communiquent constamment avec les serveurs de bases de données.</span><span class="sxs-lookup"><span data-stu-id="73cc0-209">SAP application servers carry on constant communications with the database servers.</span></span> <span data-ttu-id="73cc0-210">Pour les applications exigeant des performances élevées qui s’exécutent sur une plateforme de base de données de tout type, y compris SAP HANA, vous pouvez activer l’[accélérateur d’écriture](/azure/virtual-machines/linux/how-to-enable-write-accelerator) afin d’améliorer la latence d’écriture du journal.</span><span class="sxs-lookup"><span data-stu-id="73cc0-210">For performance-critical applications running on any database platforms, including SAP HANA, consider enabling [Write Accelerator](/azure/virtual-machines/linux/how-to-enable-write-accelerator) to improve log write latency.</span></span> <span data-ttu-id="73cc0-211">Pour optimiser les communications entre les serveurs, utilisez la [mise en réseau accéléré](https://azure.microsoft.com/blog/linux-and-windows-networking-performance-enhancements-accelerated-networking/).</span><span class="sxs-lookup"><span data-stu-id="73cc0-211">To optimize inter-server communications, use the [Accelerated Network](https://azure.microsoft.com/blog/linux-and-windows-networking-performance-enhancements-accelerated-networking/).</span></span> <span data-ttu-id="73cc0-212">Notez que ces accélérateurs sont disponibles uniquement pour certaines séries de machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="73cc0-212">Note that these accelerators are available only for certain VM series.</span></span>

<span data-ttu-id="73cc0-213">Pour obtenir un débit de bande passante de disque et d’ES/S élevé, les pratiques courantes en termes [d’optimisation des performances](/azure/virtual-machines/windows/premium-storage-performance) du volume de stockage s’appliquent à la disposition du stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="73cc0-213">To achieve high IOPS and disk bandwidth throughput, the common practices in storage volume [performance optimization](/azure/virtual-machines/windows/premium-storage-performance) apply to Azure storage layout.</span></span> <span data-ttu-id="73cc0-214">Par exemple, la combinaison de plusieurs disques pour créer un volume de disque agrégé par bandes améliore les performances d’E/S.</span><span class="sxs-lookup"><span data-stu-id="73cc0-214">For example, combining multiple disks together to create a striped disk volume improves IO performance.</span></span> <span data-ttu-id="73cc0-215">L’activation du cache de lecture sur un contenu de stockage qui change rarement améliore la vitesse de récupération des données.</span><span class="sxs-lookup"><span data-stu-id="73cc0-215">Enabling the read cache on storage content that changes infrequently enhances the speed of data retrieval.</span></span>

<span data-ttu-id="73cc0-216">Pour SAP sur SQL, l’article de blog [Top 10 Key Considerations for Deploying SAP Applications on Azure](https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/25/top-10-key-considerations-for-deploying-sap-applications-on-azure/) (10 principales considérations pour le déploiement d’applications SAP sur Azure) offre d’excellents conseils sur l’optimisation du stockage Azure pour les charges de travail SAP sur SQL Server.</span><span class="sxs-lookup"><span data-stu-id="73cc0-216">For SAP on SQL, the [Top 10 Key Considerations for Deploying SAP Applications on Azure](https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/25/top-10-key-considerations-for-deploying-sap-applications-on-azure/) blog offers excellent advice on optimizing Azure storage for SAP workloads on SQL Server.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="73cc0-217">Considérations relatives à l’extensibilité</span><span class="sxs-lookup"><span data-stu-id="73cc0-217">Scalability considerations</span></span>

<span data-ttu-id="73cc0-218">Au niveau de la couche de l’application SAP, Azure propose un large éventail de tailles de machines virtuelles pour la montée en puissance ou la montée en charge. Pour obtenir une liste exhaustive, consultez la [note SAP 1928533](https://launchpad.support.sap.com/#/notes/1928533) - SAP Applications on Azure: Supported Products and Azure VM Types (Applications SAP sur Azure : produits et types de machines virtuelles pris en charge).</span><span class="sxs-lookup"><span data-stu-id="73cc0-218">At the SAP application layer, Azure offers a wide range of virtual machine sizes for scaling up and scaling out. For an inclusive list, see [SAP note 1928533](https://launchpad.support.sap.com/#/notes/1928533) - SAP Applications on Azure: Supported Products and Azure VM Types.</span></span> <span data-ttu-id="73cc0-219">(l’accès requiert un compte SAP Service Marketplace).</span><span class="sxs-lookup"><span data-stu-id="73cc0-219">(SAP Service Marketplace account required for access).</span></span> <span data-ttu-id="73cc0-220">Il est possible de monter/descendre en puissance les serveurs d’applications SAP et les clusters des services centraux ou de les monter en charge en ajoutant des instances supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="73cc0-220">SAP application servers and the Central Services clusters can scale up/down or scale out by adding more instances.</span></span> <span data-ttu-id="73cc0-221">Vous pouvez monter/descendre en puissance la base de données AnyDB, mais pas la monter en charge. Le conteneur de base de données SAP pour AnyDB ne prend pas en charge le partitionnement.</span><span class="sxs-lookup"><span data-stu-id="73cc0-221">The AnyDB database can scale up/down but does not scale out. The SAP database container for AnyDB does not support sharding.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="73cc0-222">Considérations relatives à la disponibilité</span><span class="sxs-lookup"><span data-stu-id="73cc0-222">Availability considerations</span></span>

<span data-ttu-id="73cc0-223">La redondance des ressources constitue le thème général dans les solutions d’infrastructure à haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="73cc0-223">Resource redundancy is the general theme in highly available infrastructure solutions.</span></span> <span data-ttu-id="73cc0-224">Pour les entreprises qui présentent un SLA moins strict, les machines virtuelles Azure à instance unique offrent un SLA garantissant un certain temps de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="73cc0-224">For enterprises that have a less stringent SLA, single-instance Azure VMs offer an uptime SLA.</span></span> <span data-ttu-id="73cc0-225">Pour plus d’informations, consultez [Contrats de niveau de service Azure](https://azure.microsoft.com/support/legal/sla/).</span><span class="sxs-lookup"><span data-stu-id="73cc0-225">For more information, see [Azure Service Level Agreement](https://azure.microsoft.com/support/legal/sla/).</span></span>

<span data-ttu-id="73cc0-226">Dans cette installation distribuée de l’application SAP, l’installation de base est répliquée pour assurer une haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="73cc0-226">In this distributed installation of the SAP application, the base installation is replicated to achieve high availability.</span></span> <span data-ttu-id="73cc0-227">Pour chaque couche de l’architecture, la conception mise en œuvre à des fins de haute disponibilité varie.</span><span class="sxs-lookup"><span data-stu-id="73cc0-227">For each layer of the architecture, the high availability design varies.</span></span>

### <a name="application-tier"></a><span data-ttu-id="73cc0-228">Couche Application</span><span class="sxs-lookup"><span data-stu-id="73cc0-228">Application tier</span></span>

<span data-ttu-id="73cc0-229">Pour SAP Web Dispatcher, la haute disponibilité est assurée grâce à des instances redondantes.</span><span class="sxs-lookup"><span data-stu-id="73cc0-229">High availability for SAP Web Dispatcher is achieved with redundant instances.</span></span> <span data-ttu-id="73cc0-230">Consultez [SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw70ehp2/7.02.16/en-us/48/8fe37933114e6fe10000000a421937/frameset.htm) dans la documentation SAP.</span><span class="sxs-lookup"><span data-stu-id="73cc0-230">See [SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw70ehp2/7.02.16/en-us/48/8fe37933114e6fe10000000a421937/frameset.htm) in the SAP Documentation.</span></span>

<span data-ttu-id="73cc0-231">La haute disponibilité des services centraux est implémentée à l’aide du cluster de basculement Windows Server.</span><span class="sxs-lookup"><span data-stu-id="73cc0-231">High availability of the Central Services is implemented with Windows Server Failover Cluster.</span></span> <span data-ttu-id="73cc0-232">Lors du déploiement sur Azure, l’espace de stockage en cluster du cluster de basculement peut être configuré selon deux approches : soit en utilisant un volume en cluster partagé, soit en utilisant un partage de fichiers.</span><span class="sxs-lookup"><span data-stu-id="73cc0-232">When deployed on Azure, the cluster storage for the failover cluster can be configured using two approaches: either a clustered shared volume or a file share.</span></span>

<span data-ttu-id="73cc0-233">Comme les disques partagés ne sont pas pris en charge sur Azure, SIOS Datakeeper est utilisé pour répliquer le contenu des disques indépendants attachés aux nœuds de cluster et pour extraire les disques sous forme de volume partagé de cluster pour le gestionnaire du cluster.</span><span class="sxs-lookup"><span data-stu-id="73cc0-233">Since shared disks are not possible on Azure, SIOS Datakeeper is used to replicate the content of independent disks attached to the cluster nodes and to abstract the drives as a cluster shared volume for the cluster manager.</span></span> <span data-ttu-id="73cc0-234">Pour obtenir des informations relatives à l’implémentation, consultez [Clustering SAP ASCS on Azure](https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/20/clustering-sap-ascs-instance-using-windows-server-failover-cluster-on-microsoft-azure-with-sios-datakeeper-and-azure-internal-load-balancer/) (Clustering de SAP ASCS sur Azure).</span><span class="sxs-lookup"><span data-stu-id="73cc0-234">For implementation details, see [Clustering SAP ASCS on Azure](https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/20/clustering-sap-ascs-instance-using-windows-server-failover-cluster-on-microsoft-azure-with-sios-datakeeper-and-azure-internal-load-balancer/).</span></span>

<span data-ttu-id="73cc0-235">Une autre option consiste à utiliser un partage de fichiers fourni par le [serveur de fichiers avec montée en puissance parallèle](https://blogs.msdn.microsoft.com/saponsqlserver/2017/11/14/file-server-with-sofs-and-s2d-as-an-alternative-to-cluster-shared-disk-for-clustering-of-an-sap-ascs-instance-in-azure-is-generally-available/) (SOFS).</span><span class="sxs-lookup"><span data-stu-id="73cc0-235">Another option is to use a file share served up by the [Scale Out Fileserver](https://blogs.msdn.microsoft.com/saponsqlserver/2017/11/14/file-server-with-sofs-and-s2d-as-an-alternative-to-cluster-shared-disk-for-clustering-of-an-sap-ascs-instance-in-azure-is-generally-available/) (SOFS).</span></span> <span data-ttu-id="73cc0-236">Ce serveur offre des partages de fichiers résilients que vous pouvez utiliser en tant que volume partagé de cluster pour le cluster Windows.</span><span class="sxs-lookup"><span data-stu-id="73cc0-236">SOFS offers resilient file shares you can use as a cluster shared volume for the Windows cluster.</span></span> <span data-ttu-id="73cc0-237">Un cluster SOFS peut être partagé entre plusieurs nœuds Services centraux.</span><span class="sxs-lookup"><span data-stu-id="73cc0-237">A SOFS cluster can be shared among multiple Central Services nodes.</span></span> <span data-ttu-id="73cc0-238">À ce jour, SOFS est utilisé uniquement pour la conception à des fins de haute disponibilité, car le cluster SOFS ne s’étend pas à d’autres régions pour prendre en charge la récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="73cc0-238">As of this writing, SOFS is used only for high availability design, because the SOFS cluster does not extend across regions to provide disaster recovery support.</span></span>

<span data-ttu-id="73cc0-239">Pour les serveurs d’applications SAP, la haute disponibilité est assurée en équilibrant la charge du trafic au sein d’un pool de serveurs d’applications.</span><span class="sxs-lookup"><span data-stu-id="73cc0-239">High availability for the SAP application servers is achieved by load balancing traffic within a pool of application servers.</span></span>
<span data-ttu-id="73cc0-240">Consultez [Certifications et configurations SAP en cours sur Microsoft Azure](/azure/virtual-machines/workloads/sap/sap-certifications).</span><span class="sxs-lookup"><span data-stu-id="73cc0-240">See [SAP certifications and configurations running on Microsoft Azure](/azure/virtual-machines/workloads/sap/sap-certifications).</span></span>

### <a name="database-tier"></a><span data-ttu-id="73cc0-241">Couche base de données</span><span class="sxs-lookup"><span data-stu-id="73cc0-241">Database tier</span></span>

<span data-ttu-id="73cc0-242">Cette architecture de référence suppose que la base de données source soit en cours d’exécution sur AnyDB, c’est-à-dire un SGBD tel que SQL Server, SAP ASE, IBM DB2 ou Oracle.</span><span class="sxs-lookup"><span data-stu-id="73cc0-242">This reference architecture assumes the source database is running on AnyDB—that is, a DBMS such as SQL Server, SAP ASE, IBM DB2, or Oracle.</span></span> <span data-ttu-id="73cc0-243">La fonctionnalité de réplication native de la couche Base de données assure un basculement manuel ou automatique entre les nœuds répliqués.</span><span class="sxs-lookup"><span data-stu-id="73cc0-243">The database tier's native replication feature provides either manual or automatic failover between replicated nodes.</span></span>

<span data-ttu-id="73cc0-244">Pour plus d’informations sur l’implémentation de systèmes de base de données spécifiques, consultez [Déploiement SGBD de machines virtuelles Azure pour SAP](/azure/virtual-machines/workloads/sap/dbms-guide).</span><span class="sxs-lookup"><span data-stu-id="73cc0-244">For implementation details about specific database systems, see [Azure Virtual Machines DBMS deployment for SAP NetWeaver](/azure/virtual-machines/workloads/sap/dbms-guide).</span></span>

## <a name="disaster-recovery-considerations"></a><span data-ttu-id="73cc0-245">Considérations relatives à la récupération d’urgence</span><span class="sxs-lookup"><span data-stu-id="73cc0-245">Disaster recovery considerations</span></span>

<span data-ttu-id="73cc0-246">Pour la récupération d’urgence, vous devez être en mesure de basculer vers une région secondaire.</span><span class="sxs-lookup"><span data-stu-id="73cc0-246">For disaster recovery (DR), you must be able to fail over to a secondary region.</span></span> <span data-ttu-id="73cc0-247">Chaque couche utilise une stratégie différente pour assurer une protection par récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="73cc0-247">Each tier uses a different strategy to provide disaster recovery (DR) protection.</span></span>

- <span data-ttu-id="73cc0-248">**Couche Serveurs d’applications**.</span><span class="sxs-lookup"><span data-stu-id="73cc0-248">**Application servers tier**.</span></span> <span data-ttu-id="73cc0-249">Les serveurs d’applications SAP ne contiennent pas de données d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="73cc0-249">SAP application servers do not contain business data.</span></span> <span data-ttu-id="73cc0-250">Sur Azure, une stratégie de récupération d’urgence simple consiste à créer des serveurs d’applications SAP dans la région secondaire, puis à les arrêter.</span><span class="sxs-lookup"><span data-stu-id="73cc0-250">On Azure, a simple DR strategy is to create SAP application servers in the secondary region, then shut them down.</span></span> <span data-ttu-id="73cc0-251">En cas de modification de la configuration ou de mise à jour du noyau sur le serveur d’applications principal, les mêmes modifications doivent être appliquées aux machines virtuelles de la région secondaire</span><span class="sxs-lookup"><span data-stu-id="73cc0-251">Upon any configuration changes or kernel updates on the primary application server, the same changes must be copied to the virtual machines in the secondary region.</span></span> <span data-ttu-id="73cc0-252">(par exemple, les exécutables du noyau copiés sur les machines virtuelles de récupération d’urgence).</span><span class="sxs-lookup"><span data-stu-id="73cc0-252">For example, the kernel executables copied to the DR virtual machines.</span></span> <span data-ttu-id="73cc0-253">Pour la réplication automatique des serveurs d’applications vers une région secondaire, [Azure Site Recovery](/azure/site-recovery/site-recovery-overview) constitue la solution recommandée.</span><span class="sxs-lookup"><span data-stu-id="73cc0-253">For automatic replication of application servers to a secondary region, [Azure Site Recovery](/azure/site-recovery/site-recovery-overview) is the recommended solution.</span></span>

- <span data-ttu-id="73cc0-254">**Services centraux**.</span><span class="sxs-lookup"><span data-stu-id="73cc0-254">**Central Services**.</span></span> <span data-ttu-id="73cc0-255">Ce composant de la pile d’applications SAP ne conserve pas non plus de données d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="73cc0-255">This component of the SAP application stack also does not persist business data.</span></span> <span data-ttu-id="73cc0-256">Vous pouvez créer une machine virtuelle dans la région de récupération d’urgence pour exécuter le rôle Services centraux.</span><span class="sxs-lookup"><span data-stu-id="73cc0-256">You can build a VM in the disaster recovery region to run the Central Services role.</span></span> <span data-ttu-id="73cc0-257">Le seul contenu du nœud Services centraux principal à synchroniser est le contenu du partage /sapmnt.</span><span class="sxs-lookup"><span data-stu-id="73cc0-257">The only content from the primary Central Services node to synchronize is the /sapmnt share content.</span></span> <span data-ttu-id="73cc0-258">En outre, en cas de modification de la configuration ou de mise à jour du noyau sur les serveurs principaux des services centraux, celles-ci doivent être répétées sur la machine virtuelle de la région de récupération d’urgence exécutant les services centraux.</span><span class="sxs-lookup"><span data-stu-id="73cc0-258">Also, if configuration changes or kernel updates take place on the primary Central Services servers, they must be repeated on the VM in the disaster recovery region running Central Services.</span></span> <span data-ttu-id="73cc0-259">Pour synchroniser les deux serveurs, vous pouvez utiliser Azure Site Recovery pour répliquer les nœuds de cluster ou simplement utiliser une copie planifiée régulièrement pour copier /sapmnt vers la région de récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="73cc0-259">To synchronize the two servers, you can use either Azure Site Recovery to replicate the cluster nodes or simply use a regularly scheduled copy job to copy /sapmnt to the disaster recovery region.</span></span> <span data-ttu-id="73cc0-260">Pour plus d’informations sur le processus de génération, de copie et de test de basculement associé à cette méthode de réplication simple, téléchargez [SAP NetWeaver: Building a Hyper-V and Microsoft Azure–based Disaster Recovery Solution](https://download.microsoft.com/download/9/5/6/956FEDC3-702D-4EFB-A7D3-2DB7505566B6/SAP%20NetWeaver%20-%20Building%20an%20Azure%20based%20Disaster%20Recovery%20Solution%20V1_5%20.docx) (SAP NetWeaver : créer une solution de reprise d’activité après sinistre basée sur Hyper-V et Microsoft Azure) et lisez la section « 4.3.</span><span class="sxs-lookup"><span data-stu-id="73cc0-260">For details about this simple replication method's build, copy, and test failover process, download [SAP NetWeaver: Building a Hyper-V and Microsoft Azure–based Disaster Recovery Solution](https://download.microsoft.com/download/9/5/6/956FEDC3-702D-4EFB-A7D3-2DB7505566B6/SAP%20NetWeaver%20-%20Building%20an%20Azure%20based%20Disaster%20Recovery%20Solution%20V1_5%20.docx), and refer to "4.3.</span></span> <span data-ttu-id="73cc0-261">Couche SAP SPOF (ASCS).</span><span class="sxs-lookup"><span data-stu-id="73cc0-261">SAP SPOF layer (ASCS)."</span></span>

- <span data-ttu-id="73cc0-262">**Couche Base de données**.</span><span class="sxs-lookup"><span data-stu-id="73cc0-262">**Database tier**.</span></span> <span data-ttu-id="73cc0-263">Pour implémenter la récupération d’urgence, la meilleure solution consiste à utiliser la technologie de réplication intégrée de la base de données.</span><span class="sxs-lookup"><span data-stu-id="73cc0-263">DR is best implemented with the database's own integrated replication technology.</span></span> <span data-ttu-id="73cc0-264">Dans le cas de SQL Server, par exemple, nous vous recommandons d’utiliser le groupe de disponibilité AlwaysOn pour établir un réplica dans une région distante, en répliquant les transactions de façon asynchrone avec basculement manuel.</span><span class="sxs-lookup"><span data-stu-id="73cc0-264">In the case of SQL Server, for example, we recommend using AlwaysOn Availability Group to establish a replica in a remote region, replicating transactions asynchronously with manual failover.</span></span> <span data-ttu-id="73cc0-265">La réplication asynchrone évite d’affecter les performances des charges de travail interactives sur le site principal.</span><span class="sxs-lookup"><span data-stu-id="73cc0-265">Asynchronous replication avoids an impact to the performance of interactive workloads at the primary site.</span></span> <span data-ttu-id="73cc0-266">Le basculement manuel donne la possibilité d’évaluer l’impact de la récupération d’urgence et de déterminer si le fonctionnement à partir du site de récupération d’urgence est justifié.</span><span class="sxs-lookup"><span data-stu-id="73cc0-266">Manual failover offers the opportunity for a person to evaluate the DR impact and decide if operating from the DR site is justified.</span></span>

<span data-ttu-id="73cc0-267">Pour utiliser Azure Site Recovery pour générer automatiquement un site de production entièrement répliqué à partir de votre site d’origine, vous devez exécuter [des scripts de déploiement](/azure/site-recovery/site-recovery-runbook-automation) personnalisés.</span><span class="sxs-lookup"><span data-stu-id="73cc0-267">To use Azure Site Recovery to automatically build out a fully replicated production site of your original, you must run customized [deployment scripts](/azure/site-recovery/site-recovery-runbook-automation).</span></span> <span data-ttu-id="73cc0-268">Site Recovery déploie d’abord les machines virtuelles dans des groupes à haute disponibilité, puis exécute des scripts pour ajouter les ressources telles que les équilibreurs de charge.</span><span class="sxs-lookup"><span data-stu-id="73cc0-268">Site Recovery first deploys the VMs in availability sets, then runs scripts to add resources such as load balancers.</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="73cc0-269">Considérations relatives à la facilité de gestion</span><span class="sxs-lookup"><span data-stu-id="73cc0-269">Manageability considerations</span></span>

<span data-ttu-id="73cc0-270">Azure propose plusieurs fonctions de [surveillance et de diagnostic](/azure/architecture/best-practices/monitoring) de l’infrastructure globale.</span><span class="sxs-lookup"><span data-stu-id="73cc0-270">Azure provides several functions for [monitoring and diagnostics](/azure/architecture/best-practices/monitoring) of the overall infrastructure.</span></span> <span data-ttu-id="73cc0-271">En outre, l’analyse améliorée des machines virtuelles Azure est gérée par Azure Operations Management Suite (OMS).</span><span class="sxs-lookup"><span data-stu-id="73cc0-271">Also, enhanced monitoring of Azure virtual machines is handled by Azure Operations Management Suite (OMS).</span></span>

<span data-ttu-id="73cc0-272">Pour assurer une analyse basée sur SAP des ressources et des performances des services de l’infrastructure SAP, l’extension d’[analyse Azure améliorée pour SAP](/azure/virtual-machines/workloads/sap/deployment-guide#detailed-tasks-for-sap-software-deployment) est utilisée.</span><span class="sxs-lookup"><span data-stu-id="73cc0-272">To provide SAP-based monitoring of resources and service performance of the SAP infrastructure, the [Azure SAP Enhanced Monitoring](/azure/virtual-machines/workloads/sap/deployment-guide#detailed-tasks-for-sap-software-deployment) extension is used.</span></span> <span data-ttu-id="73cc0-273">Cette extension transmet les statistiques d’analyse Azure à l’application SAP pour les fonctions DBA Cockpit et de surveillance du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="73cc0-273">This extension feeds Azure monitoring statistics into the SAP application for operating system monitoring and DBA Cockpit functions.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="73cc0-274">Considérations relatives à la sécurité</span><span class="sxs-lookup"><span data-stu-id="73cc0-274">Security considerations</span></span>

<span data-ttu-id="73cc0-275">SAP possède son propre moteur de gestion des utilisateurs (UME) pour contrôler l’accès et l’autorisation en fonction du rôle dans l’application SAP.</span><span class="sxs-lookup"><span data-stu-id="73cc0-275">SAP has its own Users Management Engine (UME) to control role-based access and authorization within the SAP application.</span></span> <span data-ttu-id="73cc0-276">Pour plus d’informations, consultez les documents [SAP NetWeaver Application Server for ABAP Security Guide](https://help.sap.com/viewer/864321b9b3dd487d94c70f6a007b0397/7.4.19) (Guide de sécurité du serveur d’applications SAP NetWeaver pour ABAP) et [SAP NetWeaver Application Server Java Security Guide](https://help.sap.com/doc/saphelp_snc_uiaddon_10/1.0/en-US/57/d8bfcf38f66f48b95ce1f52b3f5184/frameset.htm) (Guide de sécurité du serveur d’applications SAP NetWeaver Java).</span><span class="sxs-lookup"><span data-stu-id="73cc0-276">For details, see [SAP NetWeaver Application Server for ABAP Security Guide](https://help.sap.com/viewer/864321b9b3dd487d94c70f6a007b0397/7.4.19) and [SAP NetWeaver Application Server Java Security Guide](https://help.sap.com/doc/saphelp_snc_uiaddon_10/1.0/en-US/57/d8bfcf38f66f48b95ce1f52b3f5184/frameset.htm).</span></span>

<span data-ttu-id="73cc0-277">Pour renforcer la sécurité réseau, vous pouvez implémenter une [zone DMZ réseau](../dmz/secure-vnet-hybrid.md), qui utilise une appliance virtuelle réseau pour créer un pare-feu devant le sous-réseau de Web Dispatcher.</span><span class="sxs-lookup"><span data-stu-id="73cc0-277">For additional network security, consider implementing a [network DMZ](../dmz/secure-vnet-hybrid.md), which uses a network virtual appliance to create a firewall in front of the subnet for Web Dispatcher.</span></span>

<span data-ttu-id="73cc0-278">Afin de garantir la sécurité de l’infrastructure, les données sont chiffrées en transit et au repos.</span><span class="sxs-lookup"><span data-stu-id="73cc0-278">For infrastructure security, data is encrypted in transit and at rest.</span></span> <span data-ttu-id="73cc0-279">La section « Considérations de sécurité » du guide [SAP NetWeaver on Azure Virtual Machines (VMs) – Planning and Implementation Guide](/azure/virtual-machines/workloads/sap/planning-guide) (SAP NetWeaver sur les machines virtuelles Azure - Guide de planification et d’implémentation) aborde la question de la sécurité réseau.</span><span class="sxs-lookup"><span data-stu-id="73cc0-279">The "Security considerations” section of the [SAP NetWeaver on Azure Virtual Machines (VMs) – Planning and Implementation Guide](/azure/virtual-machines/workloads/sap/planning-guide) begins to address network security.</span></span> <span data-ttu-id="73cc0-280">Le guide spécifie également les ports réseau, que vous devez ouvrir sur les pare-feu pour autoriser la communication de l’application.</span><span class="sxs-lookup"><span data-stu-id="73cc0-280">The guide also specifies the network ports you must open on the firewalls to allow application communication.</span></span>

<span data-ttu-id="73cc0-281">[Azure Disk Encryption](/azure/security/azure-security-disk-encryption) permet de chiffrer des disques de machines virtuelles Windows.</span><span class="sxs-lookup"><span data-stu-id="73cc0-281">To encrypt Windows virtual machine disks, you can use [Azure Disk Encryption](/azure/security/azure-security-disk-encryption).</span></span> <span data-ttu-id="73cc0-282">Ce service exploite la fonctionnalité BitLocker de Windows pour assurer le chiffrement de volume du système d’exploitation et des disques de données.</span><span class="sxs-lookup"><span data-stu-id="73cc0-282">It uses the BitLocker feature of Windows to provide volume encryption for the operating system and the data disks.</span></span> <span data-ttu-id="73cc0-283">La solution fonctionne également avec Azure Key Vault, ce qui vous permet de contrôler et de gérer les clés et les secrets de chiffrement de disque dans votre abonnement Key Vault.</span><span class="sxs-lookup"><span data-stu-id="73cc0-283">The solution also works with Azure Key Vault to help you control and manage the disk-encryption keys and secrets in your key vault subscription.</span></span> <span data-ttu-id="73cc0-284">Les données sur les disques de vos machines virtuelles sont chiffrées au repos dans votre stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="73cc0-284">Data on the virtual machine disks are encrypted at rest in your Azure storage.</span></span>

## <a name="communities"></a><span data-ttu-id="73cc0-285">Communautés</span><span class="sxs-lookup"><span data-stu-id="73cc0-285">Communities</span></span>

<span data-ttu-id="73cc0-286">Les communautés peuvent répondre aux questions et vous aider à paramétrer un déploiement réussi.</span><span class="sxs-lookup"><span data-stu-id="73cc0-286">Communities can answer questions and help you set up a successful deployment.</span></span> <span data-ttu-id="73cc0-287">Tenez compte des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="73cc0-287">Consider the following:</span></span>

- <span data-ttu-id="73cc0-288">[Blog Running SAP Applications on the Microsoft Platform](https://blogs.msdn.microsoft.com/saponsqlserver/2017/05/04/sap-on-azure-general-update-for-customers-partners-april-2017/) (Exécution d’applications SAP sur la plateforme Microsoft)</span><span class="sxs-lookup"><span data-stu-id="73cc0-288">[Running SAP Applications on the Microsoft Platform Blog](https://blogs.msdn.microsoft.com/saponsqlserver/2017/05/04/sap-on-azure-general-update-for-customers-partners-april-2017/)</span></span>
- [<span data-ttu-id="73cc0-289">Support de la communauté Azure</span><span class="sxs-lookup"><span data-stu-id="73cc0-289">Azure Community Support</span></span>](https://azure.microsoft.com/support/community/)
- [<span data-ttu-id="73cc0-290">Communauté SAP</span><span class="sxs-lookup"><span data-stu-id="73cc0-290">SAP Community</span></span>](https://www.sap.com/community.html)
- [<span data-ttu-id="73cc0-291">Stack Overflow</span><span class="sxs-lookup"><span data-stu-id="73cc0-291">Stack Overflow</span></span>](https://stackoverflow.com/tags/sap/)

## <a name="related-resources"></a><span data-ttu-id="73cc0-292">Ressources associées</span><span class="sxs-lookup"><span data-stu-id="73cc0-292">Related resources</span></span>

<span data-ttu-id="73cc0-293">Vous pouvez consulter les [exemples de scénarios Azure](/azure/architecture/example-scenario) suivants, qui décrivent des solutions spécifiques utilisant certaines de ces technologies :</span><span class="sxs-lookup"><span data-stu-id="73cc0-293">You may wish to review the following [Azure example scenarios](/azure/architecture/example-scenario) that demonstrate specific solutions using some of the same technologies:</span></span>

- [<span data-ttu-id="73cc0-294">Exécution des charges de travail de production SAP à l’aide d’Oracle Database sur Azure</span><span class="sxs-lookup"><span data-stu-id="73cc0-294">Running SAP production workloads using an Oracle Database on Azure</span></span>](/azure/architecture/example-scenario/apps/sap-production)
- [<span data-ttu-id="73cc0-295">Environnements de développement/test pour les charges de travail SAP sur Azure</span><span class="sxs-lookup"><span data-stu-id="73cc0-295">Dev/test environments for SAP workloads on Azure</span></span>](/azure/architecture/example-scenario/apps/sap-dev-test)

<!-- links -->

[visio-download]: https://archcenter.blob.core.windows.net/cdn/sap-reference-architectures.vsdx
