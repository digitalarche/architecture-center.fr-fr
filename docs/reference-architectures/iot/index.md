---
title: Architecture de référence Azure IoT
description: Architecture recommandée pour les applications IoT sur Azure utilisant des composants PaaS (Platform-as-a-Service)
titleSuffix: Azure Reference Architectures
author: MikeWasson
ms.date: 01/09/2019
ms.openlocfilehash: bde507527262a722219edba534275fb7ab499069
ms.sourcegitcommit: 7d9efe716e8c9e99f3fafa9d0213d48c23d9713d
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/09/2019
ms.locfileid: "54166026"
---
# <a name="azure-iot-reference-architecture"></a><span data-ttu-id="b4508-103">Architecture de référence Azure IoT</span><span class="sxs-lookup"><span data-stu-id="b4508-103">Azure IoT reference architecture</span></span>

<span data-ttu-id="b4508-104">Cette architecture de référence montre une architecture recommandée pour les applications IoT sur Azure utilisant des composants PaaS (Platform-as-a-Service).</span><span class="sxs-lookup"><span data-stu-id="b4508-104">This reference architecture shows a recommended architecture for IoT applications on Azure using PaaS (platform-as-a-service) components.</span></span>

![Diagramme de l’architecture](./_images/iot.png)

<span data-ttu-id="b4508-106">Les applications IoT peuvent être décrites comme des **éléments** (appareils) envoyant des données qui génèrent des **insights**.</span><span class="sxs-lookup"><span data-stu-id="b4508-106">IoT applications can be described as **things** (devices) sending data that generates **insights**.</span></span> <span data-ttu-id="b4508-107">Ces insights génèrent des **actions** permettant d’améliorer une activité ou un processus.</span><span class="sxs-lookup"><span data-stu-id="b4508-107">These insights generate **actions** to improve a business or process.</span></span> <span data-ttu-id="b4508-108">Un moteur (l’élément) envoyant des données de température en est un exemple.</span><span class="sxs-lookup"><span data-stu-id="b4508-108">An example is an engine (the thing) sending temperature data.</span></span> <span data-ttu-id="b4508-109">Ces données sont utilisées pour déterminer si le moteur fonctionne comme prévu (l’insight).</span><span class="sxs-lookup"><span data-stu-id="b4508-109">This data is used to evaluate whether the engine is performing as expected (the insight).</span></span> <span data-ttu-id="b4508-110">L’insight est utilisé pour hiérarchiser de manière proactive la planification de la maintenance du moteur (l’action).</span><span class="sxs-lookup"><span data-stu-id="b4508-110">The insight is used to proactively prioritize the maintenance schedule for the engine (the action).</span></span>

<span data-ttu-id="b4508-111">Cette architecture de référence utilise des composants Azure PaaS (Platform-as-a-Service).</span><span class="sxs-lookup"><span data-stu-id="b4508-111">This reference architecture uses Azure PaaS (platform-as-a-service) components.</span></span> <span data-ttu-id="b4508-112">Les autres options permettant de générer des solutions IoT sur Azure sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="b4508-112">Other options for building IoT solutions on Azure include:</span></span>

- <span data-ttu-id="b4508-113">[Azure IoT Central](/azure/iot-central/).</span><span class="sxs-lookup"><span data-stu-id="b4508-113">[Azure IoT Central](/azure/iot-central/).</span></span> <span data-ttu-id="b4508-114">IoT Central est une solution SaaS (Software-as-a-Service) entièrement managée.</span><span class="sxs-lookup"><span data-stu-id="b4508-114">IoT Central is a fully managed SaaS (software-as-a-service) solution.</span></span> <span data-ttu-id="b4508-115">Elle réduit les choix techniques et vous permet de vous concentrer exclusivement sur votre solution.</span><span class="sxs-lookup"><span data-stu-id="b4508-115">It abstracts the technical choices and lets you focus on your solution exclusively.</span></span> <span data-ttu-id="b4508-116">Cette simplicité présente l’inconvénient que la solution est moins personnalisable qu’une solution basée sur PaaS.</span><span class="sxs-lookup"><span data-stu-id="b4508-116">This simplicity comes with a tradeoff in being less customizable than a PaaS-based solution.</span></span>
- <span data-ttu-id="b4508-117">Utilisation de composants OSS comme la pile SMACK (Spark, Mesos, Akka, Cassandra, Kafka) déployés sur des machines virtuelles Azure.</span><span class="sxs-lookup"><span data-stu-id="b4508-117">Using OSS components such as the SMACK stack (Spark, Mesos, Akka, Cassandra, Kafka) deployed on Azure VMs.</span></span> <span data-ttu-id="b4508-118">Cette approche offre un très grand contrôle mais est plus complexe.</span><span class="sxs-lookup"><span data-stu-id="b4508-118">This approach offers a great deal of control but is more complex.</span></span>

<span data-ttu-id="b4508-119">De façon générale, il existe deux façons de traiter les données de télémétrie : le chemin à chaud et le chemin à froid.</span><span class="sxs-lookup"><span data-stu-id="b4508-119">At a high level, there are two ways to process telemetry data, hot path and cold path.</span></span> <span data-ttu-id="b4508-120">La différence réside dans les exigences de latence et d’accès aux données.</span><span class="sxs-lookup"><span data-stu-id="b4508-120">The difference has to do with requirements for latency and data access.</span></span>

- <span data-ttu-id="b4508-121">Le **chemin à chaud** analyse les données en quasi temps réel, à mesure qu’elles arrivent.</span><span class="sxs-lookup"><span data-stu-id="b4508-121">The **hot path** analyzes data in near-real-time, as it arrives.</span></span> <span data-ttu-id="b4508-122">Dans le chemin à chaud, les données de télémétrie doivent être traitées avec une latence très faible.</span><span class="sxs-lookup"><span data-stu-id="b4508-122">In the hot path, telemetry must be processed with very low latency.</span></span> <span data-ttu-id="b4508-123">Le chemin à chaud est généralement implémenté à l’aide d’un moteur de traitement de flux.</span><span class="sxs-lookup"><span data-stu-id="b4508-123">The hot path is typically implemented using a stream processing engine.</span></span> <span data-ttu-id="b4508-124">La sortie peut déclencher une alerte, ou être écrite dans un format structuré qui peut être interrogé en utilisant des outils d’analyse.</span><span class="sxs-lookup"><span data-stu-id="b4508-124">The output may trigger an alert, or be written to a structured format that can be queried using analytical tools.</span></span>
- <span data-ttu-id="b4508-125">Le **chemin à froid** effectue un traitement par lots à des intervalles plus longs (toutes les heures ou chaque jour).</span><span class="sxs-lookup"><span data-stu-id="b4508-125">The **cold path** performs batch processing at longer intervals (hourly or daily).</span></span> <span data-ttu-id="b4508-126">Le chemin à froid fonctionne généralement sur des volumes importants de données, mais les résultats n’ont pas besoin d’être aussi rapides que ceux du chemin à chaud.</span><span class="sxs-lookup"><span data-stu-id="b4508-126">The cold path typically operates over large volumes of data, but the results don't need to be as timely as the hot path.</span></span> <span data-ttu-id="b4508-127">Dans le chemin à froid, les données de télémétrie brutes sont capturées puis envoyées dans un processus de traitement par lots.</span><span class="sxs-lookup"><span data-stu-id="b4508-127">In the cold path, raw telemetry is captured and then fed into a batch process.</span></span>

## <a name="architecture"></a><span data-ttu-id="b4508-128">Architecture</span><span class="sxs-lookup"><span data-stu-id="b4508-128">Architecture</span></span>

<span data-ttu-id="b4508-129">Cette architecture est constituée des composants suivants.</span><span class="sxs-lookup"><span data-stu-id="b4508-129">This architecture consists of the following components.</span></span> <span data-ttu-id="b4508-130">Certaines applications peuvent ne pas avoir besoin de tous les composants listés ici.</span><span class="sxs-lookup"><span data-stu-id="b4508-130">Some applications may not require every component listed here.</span></span>

<span data-ttu-id="b4508-131">**Appareils IoT**.</span><span class="sxs-lookup"><span data-stu-id="b4508-131">**IoT devices**.</span></span> <span data-ttu-id="b4508-132">Les appareils peuvent s’inscrire de manière sécurisée au cloud et peuvent se connecter au cloud pour envoyer et recevoir des données.</span><span class="sxs-lookup"><span data-stu-id="b4508-132">Devices can securely register with the cloud, and can connect to the cloud to send and receive data.</span></span> <span data-ttu-id="b4508-133">Certains appareils peuvent être des **appareils de périphérie** qui effectuent un traitement de données sur l’appareil lui-même ou dans une passerelle locale.</span><span class="sxs-lookup"><span data-stu-id="b4508-133">Some devices may be **edge devices** that perform some data processing on the device itself or in a field gateway.</span></span> <span data-ttu-id="b4508-134">Nous recommandons [Azure IoT Edge](/azure/iot-edge/) pour le traitement en périphérie.</span><span class="sxs-lookup"><span data-stu-id="b4508-134">We recommend [Azure IoT Edge](/azure/iot-edge/) for edge processing.</span></span>

<span data-ttu-id="b4508-135">**Passerelle cloud**.</span><span class="sxs-lookup"><span data-stu-id="b4508-135">**Cloud gateway**.</span></span> <span data-ttu-id="b4508-136">Une passerelle cloud fournit un hub cloud pour que les appareils se connectent de manière sécurisée au cloud et envoient des données.</span><span class="sxs-lookup"><span data-stu-id="b4508-136">A cloud gateway provides a cloud hub for devices to connect securely to the cloud and send data.</span></span> <span data-ttu-id="b4508-137">Elle s’occupe aussi de la gestion des appareils et des fonctionnalités, dont la commande et le contrôle des appareils.</span><span class="sxs-lookup"><span data-stu-id="b4508-137">It also provides device management, capabilities, including command and control of devices.</span></span> <span data-ttu-id="b4508-138">Pour la passerelle cloud, nous recommandons [IoT Hub](/azure/iot-hub/).</span><span class="sxs-lookup"><span data-stu-id="b4508-138">For the cloud gateway, we recommend [IoT Hub](/azure/iot-hub/).</span></span> <span data-ttu-id="b4508-139">IoT Hub est un service cloud hébergé qui reçoit les événements des appareils en faisant office de répartiteur de messages entre les appareils et les services back-end.</span><span class="sxs-lookup"><span data-stu-id="b4508-139">IoT Hub is a hosted cloud service that ingests events from devices, acting as a message broken between devices and backend services.</span></span> <span data-ttu-id="b4508-140">IoT Hub fournit une connectivité sécurisée, l’ingestion des événements, la communication bidirectionnelle et la gestion des appareils.</span><span class="sxs-lookup"><span data-stu-id="b4508-140">IoT Hub provides secure connectivity, event ingestion, bidirectional communication, and device management.</span></span>

<span data-ttu-id="b4508-141">**Provisionnement des appareils**.</span><span class="sxs-lookup"><span data-stu-id="b4508-141">**Device provisioning.**</span></span> <span data-ttu-id="b4508-142">Pour l’inscription et la connexion de grands ensembles d’appareils, nous recommandons d’utiliser le [service IoT Hub Device Provisioning](/azure/iot-dps/) (DPS).</span><span class="sxs-lookup"><span data-stu-id="b4508-142">For registering and connecting large sets of devices, we recommend using the [IoT Hub Device Provisioning Service](/azure/iot-dps/) (DPS).</span></span> <span data-ttu-id="b4508-143">DPS vous permet d’attribuer des appareils à des points de terminaison Azure IoT Hub spécifiques à grande échelle et de les inscrire auprès de ces derniers.</span><span class="sxs-lookup"><span data-stu-id="b4508-143">DPS lets you assign and register devices to specific Azure IoT Hub endpoints at scale.</span></span>

<span data-ttu-id="b4508-144">**Traitement de flux**.</span><span class="sxs-lookup"><span data-stu-id="b4508-144">**Stream processing**.</span></span> <span data-ttu-id="b4508-145">Le traitement de flux analyse de grands flux d’enregistrements de données et évalue les règles pour ces flux.</span><span class="sxs-lookup"><span data-stu-id="b4508-145">Stream processing analyzes large streams of data records and evaluates rules for those streams.</span></span> <span data-ttu-id="b4508-146">Pour le traitement de flux, nous recommandons [Azure Stream Analytics](/azure/stream-analytics/).</span><span class="sxs-lookup"><span data-stu-id="b4508-146">For stream processing, we recommend [Azure Stream Analytics](/azure/stream-analytics/).</span></span> <span data-ttu-id="b4508-147">Stream Analytics peut exécuter une analyse complexe à grande échelle à l’aide de fonctions de fenêtrage temporel, d’agrégations de flux de données et de jonctions de sources de données externes.</span><span class="sxs-lookup"><span data-stu-id="b4508-147">Stream Analytics can execute complex analysis at scale, using time windowing functions, stream aggregations, and external data source joins.</span></span> <span data-ttu-id="b4508-148">Apache Spark sur [Azure Databricks](/azure/azure-databricks/) constitue une autre option.</span><span class="sxs-lookup"><span data-stu-id="b4508-148">Another option is Apache Spark on [Azure Databricks](/azure/azure-databricks/).</span></span>

<span data-ttu-id="b4508-149">Le machine learning permet l’exécution d’algorithmes prédictifs sur des données de télémétrie historiques, afin de prendre en charge des scénarios tels que la maintenance prédictive.</span><span class="sxs-lookup"><span data-stu-id="b4508-149">Machine learning allows predictive algorithms to be executed over historical telemetry data, enabling scenarios such as predictive maintenance.</span></span> <span data-ttu-id="b4508-150">Pour le machine learning, nous recommandons le [service Azure Machine Learning](/azure/machine-learning/service/).</span><span class="sxs-lookup"><span data-stu-id="b4508-150">For machine learning, we recommend [Azure Machine Learning Service](/azure/machine-learning/service/).</span></span>

<span data-ttu-id="b4508-151">Le **stockage du chemin à chaud** contient les données qui doivent être disponibles immédiatement sur l’appareil pour la création de rapports et la visualisation.</span><span class="sxs-lookup"><span data-stu-id="b4508-151">**Warm path storage** holds data that must be available immediately from device for reporting and visualization.</span></span> <span data-ttu-id="b4508-152">Pour le stockage du chemin à chaud, nous recommandons [Cosmos DB](/azure/cosmos-db/introduction).</span><span class="sxs-lookup"><span data-stu-id="b4508-152">For warm path storage, we recommend [Cosmos DB](/azure/cosmos-db/introduction).</span></span> <span data-ttu-id="b4508-153">Cosmos DB est une base de données multimodèle distribuée à l’échelle mondiale.</span><span class="sxs-lookup"><span data-stu-id="b4508-153">Cosmos DB is a globally distributed, multi-model database.</span></span>

<span data-ttu-id="b4508-154">Le **stockage de chemin à froid** contient les données qui sont conservées à plus long terme et qui sont utilisées pour le traitement par lots.</span><span class="sxs-lookup"><span data-stu-id="b4508-154">**Cold path storage** holds data that is kept longer term and is used for batch processing.</span></span> <span data-ttu-id="b4508-155">Pour le stockage de chemin à froid, nous recommandons le [Stockage Blob Azure](/azure/storage/blobs/storage-blobs-introduction).</span><span class="sxs-lookup"><span data-stu-id="b4508-155">For cold path storage, we recommend [Azure Blob Storage](/azure/storage/blobs/storage-blobs-introduction).</span></span> <span data-ttu-id="b4508-156">Les données peuvent être archivées dans le Stockage Blob à moindre coût et pour une durée indéterminée, et sont facilement accessibles pour le traitement par lots.</span><span class="sxs-lookup"><span data-stu-id="b4508-156">Data can be archived in Blob storage indefinitely at low cost, and is easily accessible for batch processing.</span></span>

<span data-ttu-id="b4508-157">La **transformation des données** manipule ou agrège le flux de données de télémétrie.</span><span class="sxs-lookup"><span data-stu-id="b4508-157">**Data transformation** manipulates or aggregates the telemetry stream.</span></span> <span data-ttu-id="b4508-158">Parmi les exemples figurent la transformation de protocole, comme la conversion de données binaires au format JSON, ou la combinaison de points de données.</span><span class="sxs-lookup"><span data-stu-id="b4508-158">Examples include protocol transformation, such as converting binary data to JSON, or combining data points.</span></span> <span data-ttu-id="b4508-159">Si les données doivent être transformées avant d’atteindre IoT Hub, nous recommandons d’utiliser une [passerelle de protocole](/azure/iot-hub/iot-hub-protocol-gateway) (non illustrée).</span><span class="sxs-lookup"><span data-stu-id="b4508-159">If the data must be transformed before reaching IoT Hub, we recommend using a [protocol gateway](/azure/iot-hub/iot-hub-protocol-gateway) (not shown).</span></span> <span data-ttu-id="b4508-160">Sinon, les données peuvent être transformées après avoir atteint IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="b4508-160">Otherwise, data can be transformed after it reaches IoT Hub.</span></span> <span data-ttu-id="b4508-161">Dans ce cas, nous recommandons d’utiliser [Azure Functions](/azure/azure-functions/).</span><span class="sxs-lookup"><span data-stu-id="b4508-161">In that case, we recommend using [Azure Functions](/azure/azure-functions/).</span></span> <span data-ttu-id="b4508-162">Functions dispose d’une intégration native à IoT Hub, à Cosmos DB et au Stockage Blob.</span><span class="sxs-lookup"><span data-stu-id="b4508-162">Functions has built-in integration with IoT Hub, Cosmos DB, and Blob Storage.</span></span>

<span data-ttu-id="b4508-163">L’**intégration des processus métier** effectue des actions basées sur les insights provenant des données de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="b4508-163">**Business process integration** performs actions based on insights from the device data.</span></span> <span data-ttu-id="b4508-164">Cela peut inclure le stockage de messages d’information, le déclenchement d’alarmes, l’envoi d’e-mails ou de SMS, ou l’intégration à CRM.</span><span class="sxs-lookup"><span data-stu-id="b4508-164">This could include storing informational messages, raising alarms, sending email or SMS messages, or integrating with CRM.</span></span> <span data-ttu-id="b4508-165">Nous recommandons d’utiliser [Azure Logic Apps](/azure/logic-apps/logic-apps-overview) pour l’intégration des processus métier.</span><span class="sxs-lookup"><span data-stu-id="b4508-165">We recommend using [Azure Logic Apps](/azure/logic-apps/logic-apps-overview) for business process integration.</span></span>

<span data-ttu-id="b4508-166">La **gestion des utilisateurs** permet de limiter les utilisateurs ou groupes qui peuvent effectuer des actions sur des appareils, comme la mise à niveau de microprogrammes.</span><span class="sxs-lookup"><span data-stu-id="b4508-166">**User management** restricts which users or groups can perform actions on devices, such as upgrading firmware.</span></span> <span data-ttu-id="b4508-167">Elle définit également les fonctionnalités pour les utilisateurs dans les applications.</span><span class="sxs-lookup"><span data-stu-id="b4508-167">It also defines capabilities for users in applications.</span></span> <span data-ttu-id="b4508-168">Nous recommandons d’utiliser [Azure Active Directory](/azure/active-directory/) pour authentifier et autoriser les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="b4508-168">We recommend using [Azure Active Directory](/azure/active-directory/) to authenticate and authorize users.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="b4508-169">Considérations relatives à l’extensibilité</span><span class="sxs-lookup"><span data-stu-id="b4508-169">Scalability considerations</span></span>

<span data-ttu-id="b4508-170">Une application IoT doit être générée comme des services discrets que vous pouvez mettre à l’échelle de manière indépendante.</span><span class="sxs-lookup"><span data-stu-id="b4508-170">An IoT application should be built as discrete services that can scale independently.</span></span> <span data-ttu-id="b4508-171">Considérez les points de scalabilité suivants :</span><span class="sxs-lookup"><span data-stu-id="b4508-171">Consider the following scalability points:</span></span>

<span data-ttu-id="b4508-172">**IoTHub**.</span><span class="sxs-lookup"><span data-stu-id="b4508-172">**IoTHub**.</span></span> <span data-ttu-id="b4508-173">Pour IoT Hub, tenez compte des facteurs d’échelle suivants :</span><span class="sxs-lookup"><span data-stu-id="b4508-173">For IoT Hub, consider the following scale factors:</span></span>

- <span data-ttu-id="b4508-174">Le [quota quotidien](/azure/iot-hub/iot-hub-devguide-quotas-throttling) maximal de messages dans IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="b4508-174">The maximum [daily quota](/azure/iot-hub/iot-hub-devguide-quotas-throttling) of messages into IoT Hub.</span></span>
- <span data-ttu-id="b4508-175">Le quota d’appareils connectés dans une instance IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="b4508-175">The quota of connected devices in an IoT Hub instance.</span></span>
- <span data-ttu-id="b4508-176">Débit d’ingestion : rapidité à laquelle IoT Hub peut ingérer les messages.</span><span class="sxs-lookup"><span data-stu-id="b4508-176">Ingestion throughput &mdash; how quickly IoT Hub can ingest messages.</span></span>
- <span data-ttu-id="b4508-177">Débit de traitement : rapidité à laquelle les messages entrants sont traités.</span><span class="sxs-lookup"><span data-stu-id="b4508-177">Processing throughput &mdash; how quickly the incoming messages are processed.</span></span>

<span data-ttu-id="b4508-178">Chaque hub IoT est approvisionné avec un certain nombre d’unités dans un niveau spécifique.</span><span class="sxs-lookup"><span data-stu-id="b4508-178">Each IoT hub is provisioned with a certain number of units in a specific tier.</span></span> <span data-ttu-id="b4508-179">Le niveau et le nombre d’unités déterminent le quota quotidien maximal de messages que les appareils peuvent envoyer au hub.</span><span class="sxs-lookup"><span data-stu-id="b4508-179">The tier and number of units determine the maximum daily quota of messages that devices can send to the hub.</span></span> <span data-ttu-id="b4508-180">Pour plus d’informations, consultez les quotas et la limitation IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="b4508-180">For more information, see IoT Hub quotas and throttling.</span></span> <span data-ttu-id="b4508-181">Vous pouvez effectuer un scale up d’un hub sans interrompre les opérations existantes.</span><span class="sxs-lookup"><span data-stu-id="b4508-181">You can scale up a hub without interrupting existing operations.</span></span>

<span data-ttu-id="b4508-182">**Stream Analytics**.</span><span class="sxs-lookup"><span data-stu-id="b4508-182">**Stream Analytics**.</span></span> <span data-ttu-id="b4508-183">Les tâches Stream Analytics supportent mieux la mise à l’échelle si elles sont parallèles sur tous les points du pipeline Stream Analytics, depuis l’entrée à interroger jusqu’à la sortie.</span><span class="sxs-lookup"><span data-stu-id="b4508-183">Stream Analytics jobs scale best if they are parallel at all points in the Stream Analytics pipeline, from input to query to output.</span></span> <span data-ttu-id="b4508-184">Une tâche entièrement parallèle permet à Stream Analytics de répartir le travail entre plusieurs nœuds de calcul.</span><span class="sxs-lookup"><span data-stu-id="b4508-184">A fully parallel job allows Stream Analytics to split the work across multiple compute nodes.</span></span> <span data-ttu-id="b4508-185">Sinon, Stream Analytics doit combiner les données de flux dans un seul et même endroit.</span><span class="sxs-lookup"><span data-stu-id="b4508-185">Otherwise, Stream Analytics has to combine the stream data into one place.</span></span> <span data-ttu-id="b4508-186">Pour plus d’informations, consultez [Profiter de la parallélisation de requête dans Azure Stream Analytics](/azure/stream-analytics/stream-analytics-parallelization).</span><span class="sxs-lookup"><span data-stu-id="b4508-186">For more information, see [Leverage query parallelization in Azure Stream Analytics](/azure/stream-analytics/stream-analytics-parallelization).</span></span>

<span data-ttu-id="b4508-187">IoT Hub partitionne automatiquement les messages d’appareil en fonction de l’ID de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="b4508-187">IoT Hub automatically partitions device messages based on the device ID.</span></span> <span data-ttu-id="b4508-188">Tous les messages provenant d’un appareil particulier arrivent toujours sur la même partition, mais une seule et même partition a des messages provenant de plusieurs appareils.</span><span class="sxs-lookup"><span data-stu-id="b4508-188">All of the messages from a particular device will always arrive on the same partition, but a single partition will have messages from multiple devices.</span></span> <span data-ttu-id="b4508-189">Par conséquent, l’unité de parallélisation est l’ID de la partition.</span><span class="sxs-lookup"><span data-stu-id="b4508-189">Therefore, the unit of parallelization is the partition ID.</span></span>

<span data-ttu-id="b4508-190">**Fonctions**.</span><span class="sxs-lookup"><span data-stu-id="b4508-190">**Functions**.</span></span> <span data-ttu-id="b4508-191">Lors de la lecture du point de terminaison Event Hubs, il existe un nombre maximal d’instances de fonction par partition de hub d’événements.</span><span class="sxs-lookup"><span data-stu-id="b4508-191">When reading from the Event Hubs endpoint, there is a maximum of function instance per event hub partition.</span></span> <span data-ttu-id="b4508-192">La vitesse de traitement maximale est déterminée par la rapidité à laquelle une instance de fonction peut traiter les événements d’une partition unique.</span><span class="sxs-lookup"><span data-stu-id="b4508-192">The maximum processing rate is determined by how fast one function instance can process the events from a single partition.</span></span> <span data-ttu-id="b4508-193">La fonction doit traiter les messages par lots.</span><span class="sxs-lookup"><span data-stu-id="b4508-193">The function should process messages in batches.</span></span>

<span data-ttu-id="b4508-194">**Cosmos DB**.</span><span class="sxs-lookup"><span data-stu-id="b4508-194">**Cosmos DB**.</span></span> <span data-ttu-id="b4508-195">Pour effectuer un scale out d’une collection Cosmos DB, créez la collection avec une clé de partition et ajoutez cette clé de partition dans chaque document que vous écrivez.</span><span class="sxs-lookup"><span data-stu-id="b4508-195">To scale out a Cosmos DB collection, create the collection with a partition key and include the partition key in each document that you write.</span></span> <span data-ttu-id="b4508-196">Pour plus d’informations, consultez [Bonnes pratiques lors du choix d’une clé de partition](/azure/cosmos-db/partition-data#best-practices-when-choosing-a-partition-key).</span><span class="sxs-lookup"><span data-stu-id="b4508-196">For more information, see [Best practices when choosing a partition key](/azure/cosmos-db/partition-data#best-practices-when-choosing-a-partition-key).</span></span>

- <span data-ttu-id="b4508-197">Si vous stockez et mettez à jour un seul document par appareil, l’ID de l’appareil est une bonne clé de partition.</span><span class="sxs-lookup"><span data-stu-id="b4508-197">If you store and update a single document per device, the device ID is a good partition key.</span></span> <span data-ttu-id="b4508-198">Les écritures sont réparties uniformément entre les différentes clés.</span><span class="sxs-lookup"><span data-stu-id="b4508-198">Writes are evenly distributed across the keys.</span></span> <span data-ttu-id="b4508-199">La taille de chaque partition est strictement limitée, car il existe un document unique pour chaque valeur de clé.</span><span class="sxs-lookup"><span data-stu-id="b4508-199">The size of each partition is strictly bounded, because there is a single document for each key value.</span></span>
- <span data-ttu-id="b4508-200">Si vous stockez un document distinct pour chaque message de l’appareil, l’utilisation de l’ID de l’appareil comme clé de partition dépassera rapidement la limite de 10 Go par partition.</span><span class="sxs-lookup"><span data-stu-id="b4508-200">If you store a separate document for every device message, using the device ID as a partition key would quickly exceed the 10-GB limit per partition.</span></span> <span data-ttu-id="b4508-201">Dans ce cas, l’ID de message est une meilleure clé de partition.</span><span class="sxs-lookup"><span data-stu-id="b4508-201">Message ID is a better partition key in that case.</span></span> <span data-ttu-id="b4508-202">En général, vous inclurez quand même l’ID de l’appareil dans le document pour l’indexation et l’interrogation.</span><span class="sxs-lookup"><span data-stu-id="b4508-202">Typically you would still include device ID in the document for indexing and querying.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="b4508-203">Considérations relatives à la sécurité</span><span class="sxs-lookup"><span data-stu-id="b4508-203">Security considerations</span></span>

### <a name="trustworthy-and-secure-communication"></a><span data-ttu-id="b4508-204">Communication fiable et sécurisée</span><span class="sxs-lookup"><span data-stu-id="b4508-204">Trustworthy and secure communication</span></span>

<span data-ttu-id="b4508-205">Toutes les informations reçues d’un appareil et envoyées vers celui-ci doivent être dignes de confiance.</span><span class="sxs-lookup"><span data-stu-id="b4508-205">All information received from and sent to a device must be trustworthy.</span></span> <span data-ttu-id="b4508-206">À moins qu’un appareil puisse prendre en charge les fonctionnalités de chiffrement suivantes, il doit être limité aux réseaux locaux et toutes les communications d’interconnexion doivent passer par une passerelle locale :</span><span class="sxs-lookup"><span data-stu-id="b4508-206">Unless a device can support the following cryptographic capabilities, it should be constrained to local networks and all internetwork communication should go through a field gateway:</span></span>

- <span data-ttu-id="b4508-207">Chiffrement des données avec un algorithme de chiffrement à clé symétrique publiquement analysé, largement implémenté et dont la sécurité a été prouvée.</span><span class="sxs-lookup"><span data-stu-id="b4508-207">Data encryption with a provably secure, publicly analyzed, and broadly implemented symmetric-key encryption algorithm.</span></span>
- <span data-ttu-id="b4508-208">Signature numérique avec un algorithme de signature à clé symétrique publiquement analysé, largement implémenté et dont la sécurité a été prouvée.</span><span class="sxs-lookup"><span data-stu-id="b4508-208">Digital signature with a provably secure, publicly analyzed, and broadly implemented symmetric-key signature algorithm.</span></span>
- <span data-ttu-id="b4508-209">Prise en charge soit de TLS 1.2 pour TCP ou d’autres chemins de communication basés sur les flux de données, soit de DTLS 1.2 pour les chemins de communication basés sur un datagramme.</span><span class="sxs-lookup"><span data-stu-id="b4508-209">Support for either TLS 1.2 for TCP or other stream-based communication paths or DTLS 1.2 for datagram-based communication paths.</span></span> <span data-ttu-id="b4508-210">La prise en charge de la gestion des certificats X.509 est facultative et peut être remplacée par le mode de clé prépartagée plus efficace en ce qui concerne le calcul et la communication pour TLS. Ce mode peut être implémenté avec une prise en charge des algorithmes AES et SHA-2.</span><span class="sxs-lookup"><span data-stu-id="b4508-210">Support of X.509 certificate handling is optional and can be replaced by the more compute-efficient and wire-efficient pre-shared key mode for TLS, which can be implemented with support for the AES and SHA-2 algorithms.</span></span>
- <span data-ttu-id="b4508-211">Clés par appareil et magasin de clés pouvant être mis à jour.</span><span class="sxs-lookup"><span data-stu-id="b4508-211">Updateable key-store and per-device keys.</span></span> <span data-ttu-id="b4508-212">Chaque appareil doit avoir un élément de clé unique ou des jetons qui l’identifient dans le système.</span><span class="sxs-lookup"><span data-stu-id="b4508-212">Each device must have unique key material or tokens that identify it toward the system.</span></span> <span data-ttu-id="b4508-213">Les appareils doivent stocker la clé de manière sécurisée sur l’appareil (par exemple, à l’aide d’un magasin de clés sécurisé).</span><span class="sxs-lookup"><span data-stu-id="b4508-213">The devices should store the key securely on the device (for example, using a secure key-store).</span></span> <span data-ttu-id="b4508-214">L’appareil doit être en mesure de mettre à jour les clés ou les jetons régulièrement ou de façon réactive dans des situations d’urgence comme une intrusion dans le système.</span><span class="sxs-lookup"><span data-stu-id="b4508-214">The device should be able to update the keys or tokens periodically, or reactively in emergency situations such as a system breach.</span></span>
- <span data-ttu-id="b4508-215">Les microprogrammes et les logiciels d’application sur l’appareil doivent autoriser les mises à jour pour permettre la réparation des failles de sécurité détectées.</span><span class="sxs-lookup"><span data-stu-id="b4508-215">The firmware and application software on the device must allow for updates to enable the repair of discovered security vulnerabilities.</span></span>

<span data-ttu-id="b4508-216">Toutefois, de nombreux appareils comportent trop de contraintes pour prendre en charge ces exigences.</span><span class="sxs-lookup"><span data-stu-id="b4508-216">However, many devices are too constrained to support these requirements.</span></span> <span data-ttu-id="b4508-217">Dans ce cas, une passerelle locale doit être utilisée.</span><span class="sxs-lookup"><span data-stu-id="b4508-217">In that case, a field gateway should be used.</span></span> <span data-ttu-id="b4508-218">Les appareils se connectent de manière sécurisée à la passerelle locale via un réseau local, et la passerelle permet une communication sécurisée vers le cloud.</span><span class="sxs-lookup"><span data-stu-id="b4508-218">Devices connect securely to the field gateway through a local area network, and the gateway enables secure communication to the cloud.</span></span>

### <a name="physical-tamper-proofing"></a><span data-ttu-id="b4508-219">Vérification des falsifications physiques</span><span class="sxs-lookup"><span data-stu-id="b4508-219">Physical tamper proofing</span></span>

<span data-ttu-id="b4508-220">Il est fortement recommandé que la conception de l’appareil intègre des fonctionnalités qui assurent une protection contre les tentatives de manipulation physique, afin de garantir l’intégrité et la fiabilité de la sécurité du système global.</span><span class="sxs-lookup"><span data-stu-id="b4508-220">It is strongly recommended that device design incorporates features that defend against physical manipulation attempts, to help ensure the security integrity and trustworthiness of the overall system.</span></span>

<span data-ttu-id="b4508-221">Par exemple : </span><span class="sxs-lookup"><span data-stu-id="b4508-221">For example:</span></span>

- <span data-ttu-id="b4508-222">Choisissez des microcontrôleurs/microprocesseurs ou du matériel auxiliaire qui fournissent un stockage sécurisé et l’utilisation d’un élément de clé de chiffrement, comme l’intégration d’un module de plateforme sécurisée (TPM).</span><span class="sxs-lookup"><span data-stu-id="b4508-222">Choose microcontrollers/microprocessors or auxiliary hardware that provide secure storage and use of cryptographic key material, such as trusted platform module (TPM) integration.</span></span>
- <span data-ttu-id="b4508-223">Chargeur de démarrage sécurisé et chargement de logiciels sécurisé, ancrés dans le module de plateforme sécurisée (TPM).</span><span class="sxs-lookup"><span data-stu-id="b4508-223">Secure boot loader and secure software loading, anchored in the TPM.</span></span>
- <span data-ttu-id="b4508-224">Utilisez des capteurs pour détecter les tentatives d’intrusion et les tentatives de manipulation de l’environnement de l’appareil, avec la génération d’alertes et, potentiellement, l’« auto-destruction numérique » de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="b4508-224">Use sensors to detect intrusion attempts and attempts to manipulate the device environment with alerting and potentially “digital self-destruction” of the device.</span></span>

<span data-ttu-id="b4508-225">Pour en savoir plus sur les considérations relatives à la sécurité, consultez [Architecture de sécurité de l’Internet des objets (IoT)](/azure/iot-fundamentals/iot-security-architecture).</span><span class="sxs-lookup"><span data-stu-id="b4508-225">For additional security considerations, see [Internet of Things (IoT) security architecture](/azure/iot-fundamentals/iot-security-architecture).</span></span>

### <a name="monitoring-and-logging"></a><span data-ttu-id="b4508-226">Surveillance et journalisation</span><span class="sxs-lookup"><span data-stu-id="b4508-226">Monitoring and logging</span></span>

<span data-ttu-id="b4508-227">La journalisation et la supervision des systèmes sont utilisées pour déterminer si la solution fonctionne et pour aider à résoudre les problèmes.</span><span class="sxs-lookup"><span data-stu-id="b4508-227">Logging and monitoring systems are used to determine whether the solution is functioning and to help troubleshoot problems.</span></span> <span data-ttu-id="b4508-228">La supervision et la journalisation des systèmes permettent de répondre aux questions opérationnelles suivantes :</span><span class="sxs-lookup"><span data-stu-id="b4508-228">Monitoring and logging systems help answer the following operational questions:</span></span>

- <span data-ttu-id="b4508-229">Les appareils ou les systèmes sont-ils dans une condition d’erreur ?</span><span class="sxs-lookup"><span data-stu-id="b4508-229">Are devices or systems in an error condition?</span></span>
- <span data-ttu-id="b4508-230">Les appareils ou les systèmes sont-ils correctement configurés ?</span><span class="sxs-lookup"><span data-stu-id="b4508-230">Are devices or systems correctly configured?</span></span>
- <span data-ttu-id="b4508-231">Les appareils ou les systèmes génèrent-ils des données précises ?</span><span class="sxs-lookup"><span data-stu-id="b4508-231">Are devices or systems generating accurate data?</span></span>
- <span data-ttu-id="b4508-232">Les systèmes répondent-ils aux attentes des entreprises et des utilisateurs finaux ?</span><span class="sxs-lookup"><span data-stu-id="b4508-232">Are systems meeting the expectations of both the business and end customers?</span></span>

<span data-ttu-id="b4508-233">Les outils de journalisation et de supervision comportent généralement les quatre composants suivants :</span><span class="sxs-lookup"><span data-stu-id="b4508-233">Logging and monitoring tools are typically comprised of the following four components:</span></span>

- <span data-ttu-id="b4508-234">Outils de visualisation des performances et de la chronologie du système pour superviser le système et pour le dépannage de base.</span><span class="sxs-lookup"><span data-stu-id="b4508-234">System performance and timeline visualization tools to monitor the system and for basic troubleshooting.</span></span>
- <span data-ttu-id="b4508-235">Ingestion de données mises en mémoire tampon, pour mettre en mémoire tampon des données de journal.</span><span class="sxs-lookup"><span data-stu-id="b4508-235">Buffered data ingestion, to buffer log data.</span></span>
- <span data-ttu-id="b4508-236">Magasin de persistance pour stocker des données de journal.</span><span class="sxs-lookup"><span data-stu-id="b4508-236">Persistence store to store log data.</span></span>
- <span data-ttu-id="b4508-237">Fonctionnalités de recherche et de requête pour afficher des données de journal afin de les utiliser dans un dépannage détaillé.</span><span class="sxs-lookup"><span data-stu-id="b4508-237">Search and query capabilities, to view log data for use in detailed troubleshooting.</span></span>

<span data-ttu-id="b4508-238">Les systèmes de supervision fournissent des insights sur l’intégrité,la sécurité, la stabilité et les performances d’une solution IoT.</span><span class="sxs-lookup"><span data-stu-id="b4508-238">Monitoring systems provide insights into the health, security, and stability, and performance of an IoT solution.</span></span> <span data-ttu-id="b4508-239">Ces systèmes peuvent également fournir une vue plus détaillée, en enregistrant les changements de configuration des composants et en fournissant les données de journalisation extraites qui peuvent permettre de détecter des failles de sécurité potentielles, améliorer le processus de gestion des incidents et aider le propriétaire du système à résoudre les problèmes.</span><span class="sxs-lookup"><span data-stu-id="b4508-239">These systems can also provide a more detailed view, recording component configuration changes and providing extracted logging data that can surface potential security vulnerabilities, enhance the incident management process, and help the owner of the system troubleshoot problems.</span></span> <span data-ttu-id="b4508-240">Les solutions de supervision complètes incluent la possibilité de demander des informations concernant des sous-systèmes spécifiques ou l’agrégation sur plusieurs sous-systèmes.</span><span class="sxs-lookup"><span data-stu-id="b4508-240">Comprehensive monitoring solutions include the ability to query information for specific subsystems or aggregating across multiple subsystems.</span></span>

<span data-ttu-id="b4508-241">Le développement de systèmes de supervision doit commencer par définir des critères pour l’intégrité des opérations, la conformité à la réglementation et l’audit.</span><span class="sxs-lookup"><span data-stu-id="b4508-241">Monitoring system development should begin by defining healthy operation, regulatory compliance, and audit requirements.</span></span> <span data-ttu-id="b4508-242">Les métriques collectées peuvent inclure ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="b4508-242">Metrics collected may include:</span></span>

- <span data-ttu-id="b4508-243">Appareils physiques, appareils de périphérie et composants d’infrastructure signalant les changements de configuration.</span><span class="sxs-lookup"><span data-stu-id="b4508-243">Physical devices, edge devices, and infrastructure components reporting configuration changes.</span></span>
- <span data-ttu-id="b4508-244">Applications signalant les changements de configuration, les journaux d’audit de sécurité, les taux de demandes, les temps de réponse, les taux d’erreur et les statistiques de nettoyage de la mémoire pour les langages managés.</span><span class="sxs-lookup"><span data-stu-id="b4508-244">Applications reporting configuration changes, security audit logs, request rates, response times, error rates, and garbage collection statistics for managed languages.</span></span>
- <span data-ttu-id="b4508-245">Bases de données, magasins de persistance et caches signalant les performances des requêtes et en écriture, les changements de schéma, le journal d’audit de sécurité, les verrous ou blocages, les performances d’index, le processeur, la mémoire et l’utilisation de disque.</span><span class="sxs-lookup"><span data-stu-id="b4508-245">Databases, persistence stores, and caches reporting query and write performance, schema changes, security audit log, locks or deadlocks, index performance, CPU, memory, and disk usage.</span></span>
- <span data-ttu-id="b4508-246">Services managés (IaaS, PaaS, SaaS et FaaS) générant des rapports sur les métriques d’intégrité et les changements de configuration qui affectent les performances et l’intégrité des systèmes dépendants.</span><span class="sxs-lookup"><span data-stu-id="b4508-246">Managed services (IaaS, PaaS, SaaS, and FaaS) reporting health metrics and configuration changes that impact dependent system health and performance.</span></span>

<span data-ttu-id="b4508-247">La visualisation des métriques de supervision avertit les opérateurs des instabilités du système et facilitent la réponse aux incidents.</span><span class="sxs-lookup"><span data-stu-id="b4508-247">Visualization of monitoring metrics alert operators to system instabilities and facilitate incident response.</span></span>

### <a name="tracing-telemetry"></a><span data-ttu-id="b4508-248">Suivi des données de télémétrie</span><span class="sxs-lookup"><span data-stu-id="b4508-248">Tracing telemetry</span></span>

<span data-ttu-id="b4508-249">Le suivi des données de télémétrie permet à un opérateur de suivre l’évolution d’un élément de télémétrie à partir de sa création par le biais du système.</span><span class="sxs-lookup"><span data-stu-id="b4508-249">Tracing telemetry allows an operator to follow the journey of a piece of telemetry from creation through the system.</span></span> <span data-ttu-id="b4508-250">Le suivi est important pour le débogage et la résolution des problèmes.</span><span class="sxs-lookup"><span data-stu-id="b4508-250">Tracing is important for debugging and troubleshooting.</span></span> <span data-ttu-id="b4508-251">Pour les solutions IoT qui utilisent Azure IoT Hub et les [SDK IoT Hub Device](/azure/iot-hub/iot-hub-devguide-sdks), les datagrammes de suivi peuvent provenir des messages cloud-à-appareil et être inclus dans le flux de données de télémétrie.</span><span class="sxs-lookup"><span data-stu-id="b4508-251">For IoT solutions that use Azure IoT Hub and the [IoT Hub Device SDKs](/azure/iot-hub/iot-hub-devguide-sdks), tracing datagrams can be originated as Cloud-to-Device messages and included in the telemetry stream.</span></span>

### <a name="logging"></a><span data-ttu-id="b4508-252">Journalisation</span><span class="sxs-lookup"><span data-stu-id="b4508-252">Logging</span></span>

<span data-ttu-id="b4508-253">Les systèmes de journalisation sont déterminants pour comprendre les actions ou les activités qu’une solution a effectuées et les défaillances qui se sont produites. De plus, ils peuvent aider à corriger ces défaillances.</span><span class="sxs-lookup"><span data-stu-id="b4508-253">Logging systems are integral in understanding what actions or activities a solution has performed, failures that have occurred, and can provide help in fixing those failures.</span></span> <span data-ttu-id="b4508-254">Les journaux peuvent être analysés pour comprendre et résoudre des conditions d’erreur, améliorer les caractéristiques de performances et garantir la conformité aux règles et réglementations applicables.</span><span class="sxs-lookup"><span data-stu-id="b4508-254">Logs can be analyzed to help understand and remedy error conditions, enhance performance characteristics, and ensure compliance with governing rule and regulations.</span></span>

<span data-ttu-id="b4508-255">Bien que la journalisation en texte brut ait moins d’impact sur les coûts de développement initiaux, elle est plus difficile à analyser/lire par un ordinateur.</span><span class="sxs-lookup"><span data-stu-id="b4508-255">Though plain-text logging is lower impact on upfront development costs, it is more challenging for a machine to parse/read.</span></span> <span data-ttu-id="b4508-256">Nous vous recommandons d’utiliser une journalisation structurée, car les informations collectées sont à la fois analysables par un ordinateur et lisibles par l’homme.</span><span class="sxs-lookup"><span data-stu-id="b4508-256">We recommend structured logging be used, as collected information is both machine parsable and human readable.</span></span> <span data-ttu-id="b4508-257">La journalisation structurée ajoute un contexte situationnel et des métadonnées aux informations du journal.</span><span class="sxs-lookup"><span data-stu-id="b4508-257">Structured logging adds situational context and metadata to the log information.</span></span> <span data-ttu-id="b4508-258">Dans la journalisation structurée, les propriétés sont de première classe, sous la forme de paires clé/valeur ou avec un schéma fixe pour améliorer les fonctionnalités de recherche et de requête.</span><span class="sxs-lookup"><span data-stu-id="b4508-258">In structured logging, properties are first class citizens formatted as key/value pairs, or with a fixed schema, to enhance search and query capabilities.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b4508-259">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="b4508-259">Next steps</span></span>

- <span data-ttu-id="b4508-260">Pour obtenir une présentation plus détaillée de l’architecture recommandée et des options d’implémentation, consultez [Architecture de référence Microsoft Azure IoT](http://aka.ms/iotrefarchitecture) (PDF).</span><span class="sxs-lookup"><span data-stu-id="b4508-260">For a more detailed discussion of the recommended architecture and implementation choices, see [Microsoft Azure IoT Reference Architecture](http://aka.ms/iotrefarchitecture) (PDF).</span></span>

- <span data-ttu-id="b4508-261">Pour obtenir une documentation détaillée sur les différents services Azure IoT, consultez [Notions de base d’Azure IoT](/azure/iot-fundamentals/).</span><span class="sxs-lookup"><span data-stu-id="b4508-261">For detailed documentation of the various Azure IoT services, see [Azure IoT Fundamentals](/azure/iot-fundamentals/).</span></span>
